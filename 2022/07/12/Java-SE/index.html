<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.7.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.7.0" type="image/png" sizes="32x32"><meta name="description" content="视频](https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1fh411y7R8?spm_id_from&#x3D;333.999.0.0)                     1.Java 前言                           1.就业方向                            2.开发场景                           1.SS">
<meta property="og:type" content="article">
<meta property="og:title" content="Java SE">
<meta property="og:url" content="http://example.com/2022/07/12/Java-SE/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="视频](https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1fh411y7R8?spm_id_from&#x3D;333.999.0.0)                     1.Java 前言                           1.就业方向                            2.开发场景                           1.SS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822000911430.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822001001255.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822001245906.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822001316724.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822001425646.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822001827109.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822002105801.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822002420235.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822004703738.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822010033827.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822011207216.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822011856076.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20211109164603603.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20211110150756219.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20211110160754570.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20211110163455558.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425131519990.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425132252508.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425134930305.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425143219122.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425143147501.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425143257471.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425143528785.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425213430476.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425213620453.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220425213700148.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182011345.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182110506.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182139354.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182350943.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182433688.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182556453.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220524182905703.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210831193128234.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526152742504.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526152931310.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210204153840134.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526153654447.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526153718100.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526154305255.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526154756007.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210526174716759.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210527162143650.png">
<meta property="og:image" content="d:/my-note/image/image-20210204231230181.png?lastModify=1622111542">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210529160508541.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210529154549770.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210529143432107.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210605124946225.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210605165836902.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210205170023114.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210205180331941.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210205174235117.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210605223332262.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210205184943824.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210205235319807.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210206000627123.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210606182905357.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210606194842545.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210207135146588.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210207140259233.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210207140331943.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210607112746130.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210607113923031.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210607210358734.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210609142637167.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210609142728436.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210609162621349.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210611223857542.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210612185213137.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210612221225036.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210612221510534.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210616175226212.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210614180302051.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210616182859668.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210616183213099.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617104512976.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617105831796.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617112235183.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617113019835.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617121232695.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617123358060.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617125629638.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617173337770.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617173359839.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617205048896.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617205428632.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210617210347258.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210628112954638.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210701204838517.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210701223006144.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210702161749826.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210702193753097.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210826021903501.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210826121233654.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210826122647557.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210827221746450.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210827222146768.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210827231819852.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210827232000680.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210827232252431.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210827232926859.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210909232538203.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210909232556751.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210909232714093.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210911142616714.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210913215516607.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210913221500969.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915132653769.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915134609272.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915134805835.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915134819634.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915141445579.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915141513989.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915141533157.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915174715684.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210915174921138.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210702221057179.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232236073.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237707.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237021.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237276.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237811.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237171.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237387.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237005.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237042.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232237193.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232238420.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232238674.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232238957.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232238800.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232241307.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232241551.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232241422.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240551.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240682.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240992.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240022.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240324.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240085.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232240563.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242557.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242314.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242521.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242667.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242184.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242604.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242268.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/202206232242719.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220705143519346.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707093232698.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212210111364.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212210159447.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212210732502.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212210759798.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212211106879.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212211115418.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212211445932.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212211453984.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220212211526127.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707131836777.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707131713076.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707131743961.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707131750532.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707132357417.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20220707164449078.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210529195100675.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210101235951470.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210102000020662.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210101235930869.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210529205820363.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210530152434688.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210530152526574.png">
<meta property="og:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210530152716492.png">
<meta property="article:published_time" content="2022-07-12T06:18:00.000Z">
<meta property="article:modified_time" content="2022-07-12T07:40:57.920Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="d:/ASoftWare/blog/source_posts/Java-SE/image-20210822000911430.png"><title>Java SE | Hexo</title><link ref="canonical" href="http://example.com/2022/07/12/Java-SE/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.7.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Hexo</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">Java SE</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2022-07-12</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2022-07-12</span></span></div></header><div class="post-body"><p>视频](<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fh411y7R8?spm_id_from=333.999.0.0" >https://www.bilibili.com/video/BV1fh411y7R8?spm_id_from=333.999.0.0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>)</p>

        <h1 id="1-Java-前言"   >
          <a href="#1-Java-前言" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Java-前言" class="headerlink" title="1.Java 前言"></a>1.Java 前言</h1>
      
        <h2 id="1-就业方向"   >
          <a href="#1-就业方向" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-就业方向" class="headerlink" title="1.就业方向"></a>1.就业方向</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822000911430.png" alt="image-20210822000911430"></p>

        <h2 id="2-开发场景"   >
          <a href="#2-开发场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-开发场景" class="headerlink" title="2.开发场景"></a>2.开发场景</h2>
      
        <h3 id="1-SSM等场景"   >
          <a href="#1-SSM等场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-SSM等场景" class="headerlink" title="1.SSM等场景"></a>1.SSM等场景</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822001001255.png" alt="image-20210822001001255"></p>

        <h3 id="2-安卓场景"   >
          <a href="#2-安卓场景" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-安卓场景" class="headerlink" title="2.安卓场景"></a>2.安卓场景</h3>
      
        <h3 id="3-大数据-Hadoop"   >
          <a href="#3-大数据-Hadoop" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-大数据-Hadoop" class="headerlink" title="3.大数据-Hadoop"></a>3.大数据-Hadoop</h3>
      
        <h2 id="3-应用领域"   >
          <a href="#3-应用领域" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-应用领域" class="headerlink" title="3.应用领域"></a>3.应用领域</h2>
      
        <h3 id="1-企业级应用"   >
          <a href="#1-企业级应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-企业级应用" class="headerlink" title="1.企业级应用"></a>1.企业级应用</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822001245906.png" alt="image-20210822001245906"></p>

        <h3 id="2-安卓平台应用"   >
          <a href="#2-安卓平台应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-安卓平台应用" class="headerlink" title="2.安卓平台应用"></a>2.安卓平台应用</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822001316724.png" alt="image-20210822001316724"></p>

        <h3 id="3-移动领域应用"   >
          <a href="#3-移动领域应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-移动领域应用" class="headerlink" title="3.移动领域应用"></a>3.移动领域应用</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822001425646.png" alt="image-20210822001425646"></p>

        <h1 id="2-Java-概述"   >
          <a href="#2-Java-概述" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Java-概述" class="headerlink" title="2.Java 概述"></a>2.Java 概述</h1>
      
        <h2 id="1-历史"   >
          <a href="#1-历史" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-历史" class="headerlink" title="1.历史"></a>1.历史</h2>
      
        <h3 id="1-什么是程序"   >
          <a href="#1-什么是程序" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-什么是程序" class="headerlink" title="1.什么是程序"></a>1.什么是程序</h3>
      <p>计算机执行某些操作或解决某个问题而编写的一系列有序指令的集合</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822001827109.png" alt="image-20210822001827109"></p>

        <h3 id="2-Java诞生"   >
          <a href="#2-Java诞生" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Java诞生" class="headerlink" title="2.Java诞生"></a>2.Java诞生</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822002105801.png" alt="image-20210822002105801"></p>

        <h3 id="3-Java-版本"   >
          <a href="#3-Java-版本" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Java-版本" class="headerlink" title="3.Java 版本"></a>3.Java 版本</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822002420235.png" alt="image-20210822002420235"></p>

        <h2 id="2-特点"   >
          <a href="#2-特点" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点" class="headerlink" title="2.特点"></a>2.特点</h2>
      <ol>
<li><p>Java语言是面向对象的(OOP)</p>
</li>
<li><p>Java语言是健壮的,Java的强类型机制,异常处理,垃圾的自动收集等是Java程序健壮性的重要保证</p>
</li>
<li><p>Java语言是跨平台性的</p>
<p>一个编译好的<code>*.class</code>文件可以在多个平台运行,原因是JVM,Java虚拟机</p>
</li>
<li><p>Java语言是解释型的</p>
<p>解释型语言: JavaScript,PHP 编译型语言: C&#x2F;C++</p>
<p>Java是半解释半编译,需要先编译为.class文件,再由解释器执行</p>
<p>区别: </p>
<p>解释型语言:不能直接被机器执行,需要解释器来执行</p>
<p>编译型语言:编译后的代码,可以直接被机器执行</p>
</li>
</ol>

        <h2 id="3-运行机制及运行过程"   >
          <a href="#3-运行机制及运行过程" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-运行机制及运行过程" class="headerlink" title="3.运行机制及运行过程"></a>3.运行机制及运行过程</h2>
      
        <h3 id="1-Java核心机制-Java虚拟机-JVM-Java-virtual-machine"   >
          <a href="#1-Java核心机制-Java虚拟机-JVM-Java-virtual-machine" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Java核心机制-Java虚拟机-JVM-Java-virtual-machine" class="headerlink" title="1.Java核心机制-Java虚拟机[JVM Java virtual machine]"></a>1.Java核心机制-Java虚拟机[JVM Java virtual machine]</h3>
      <ol>
<li>JVM是一个虚拟的计算机，具有指令集并使用不同的存储区域。负责执行指令，管理数据、内存、寄存器,包含在JDK中.</li>
<li>对于不同的平台，有不同的虚拟机。</li>
<li>Java虚拟机机制屏蔽了底层运行平台的差别，实现了“一次编译，到处运行”[说明]<br>示意图</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822004703738.png" alt="image-20210822004703738"></p>

        <h3 id="2-JDK-amp-JRE"   >
          <a href="#2-JDK-amp-JRE" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-JDK-amp-JRE" class="headerlink" title="2.JDK&amp;JRE"></a>2.JDK&amp;JRE</h3>
      
        <h4 id="1-JDK介绍"   >
          <a href="#1-JDK介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-JDK介绍" class="headerlink" title="1.JDK介绍"></a>1.JDK介绍</h4>
      <ol>
<li>JDK 的全称(Java Development Kit Java开发工具包)<br>JDK &#x3D; JRE + java的开发工具[java, javac,javadoc,javap等] </li>
<li>JDK是提供给Java开发人员使用的，其中包含了java的开发工具,也包括了JRE所以安装了JDK，就不用在单独家装JRE了。</li>
</ol>

        <h4 id="2-JRE基本介绍"   >
          <a href="#2-JRE基本介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-JRE基本介绍" class="headerlink" title="2.JRE基本介绍"></a>2.JRE基本介绍</h4>
      <ol>
<li>JRE(Java Runtime Environment Java运行环境)<br>JRE &#x3D; JVM + Java的核心类库[类]</li>
<li>包括Java虚拟机(JVM Java Virtual Machine)和Java程序所需的核心类库等,<br>如果想要运行一个开发好的Java程序，计算机中只需要安装JRE即可.</li>
</ol>

        <h3 id="3-JDK-amp-JRE-amp-JVM关系"   >
          <a href="#3-JDK-amp-JRE-amp-JVM关系" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-JDK-amp-JRE-amp-JVM关系" class="headerlink" title="3.JDK&amp;JRE&amp;JVM关系"></a>3.JDK&amp;JRE&amp;JVM关系</h3>
      <ol>
<li>JDK &#x3D; JRE+开发工具集(例如Javac,java编译工具等)</li>
<li>JRE &#x3D; JVM+ Java SE标准类库</li>
<li>如果只想运行开发好的.class文件只需要JRE</li>
</ol>

        <h2 id="4-Java开发环境搭建"   >
          <a href="#4-Java开发环境搭建" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Java开发环境搭建" class="headerlink" title="4.Java开发环境搭建"></a>4.Java开发环境搭建</h2>
      
        <h3 id="1-JDK安装"   >
          <a href="#1-JDK安装" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-JDK安装" class="headerlink" title="1.JDK安装"></a>1.JDK安装</h3>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase-downloads.html" >https://www.oracle.com/java/technologies/javase-downloads.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822010033827.png" alt="image-20210822010033827"></p>
<p>安装JDK步骤</p>
<ol>
<li>傻瓜式安装,下一步即可<br><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822011207216.png" alt="image-20210822011207216"></li>
</ol>
<p>细节说明</p>
<ul>
<li>安装路径不要有中文或者特殊符号如空格等。比如 d:\program\hspjdk8</li>
<li>当提示安装JRE时,可以选择不安装。</li>
</ul>

        <h3 id="2-配置Path"   >
          <a href="#2-配置Path" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-配置Path" class="headerlink" title="2.配置Path"></a>2.配置Path</h3>
      <p>若不配置</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210822011856076.png" alt="image-20210822011856076"></p>
<p>为了在所有环节下都能使用java命令</p>
<p>需要配置,步骤为</p>
<ol>
<li>我的电脑–属性–高级系统设置–环境变量</li>
<li>增加JAVA HOME 环境变量</li>
<li>编辑path环境变量,增加%JAVA _HOME%\ bin</li>
<li>打开DOS命令行，任意目录下敲入javac&#x2F;java。如果出现javac的参数信息,配置<br>成功。</li>
</ol>

        <h2 id="5-Java开发快速入门"   >
          <a href="#5-Java开发快速入门" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Java开发快速入门" class="headerlink" title="5.Java开发快速入门"></a>5.Java开发快速入门</h2>
      
        <h3 id="1-Java执行流程分析"   >
          <a href="#1-Java执行流程分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Java执行流程分析" class="headerlink" title="1.Java执行流程分析"></a>1.Java执行流程分析</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20211109164603603.png" alt="image-20211109164603603"></p>

        <h3 id="2-什么是编译"   >
          <a href="#2-什么是编译" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-什么是编译" class="headerlink" title="2.什么是编译"></a>2.什么是编译</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac Hello.java</span><br></pre></td></tr></table></div></figure>

<ol>
<li>有了java源文件，通过编译器将其编译成JVM可以识别的字节码文件。</li>
<li>在该源文件目录下,通过javac编译工具对Hello.java文件进行编译。</li>
<li>如果程序没有错误，没有任何提示，但在当前目录下会出现一个Hello.class文件.该文件称为字节码文件,也是可以执行的java的程序。</li>
</ol>

        <h3 id="3-什么是运行"   >
          <a href="#3-什么是运行" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-什么是运行" class="headerlink" title="3.什么是运行"></a>3.什么是运行</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></div></figure>

<ol>
<li>有了可执行的java程序(Hello.class字节码文件)</li>
<li>通过运行工具java.exe对字节码文件进行执行,本质就是将.class装载到JVM执行</li>
</ol>
<p>java程序开发注意事项<br>&#x3D;&#x3D;对修改后的Hello.java源文件需要重新编译，生成新的class文件后,再进行执行,才能生效。&#x3D;&#x3D;</p>

        <h3 id="4-开发注意事项和细节说明"   >
          <a href="#4-开发注意事项和细节说明" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-开发注意事项和细节说明" class="headerlink" title="4.开发注意事项和细节说明"></a>4.开发注意事项和细节说明</h3>
      <ol>
<li>Java源文件以.java为扩展名。源文件的基本组成部分是类(class)，如本类中的Hello类。</li>
<li>Java应用程序的执行入口是main()方法。它有固定的书写格式<br>public static void main(Stringl] args){…}</li>
<li>Java语言严格区分大小写。</li>
<li>Java方法由一条条语句构成，每个语句以“;”结束。</li>
<li>大括号都是成对出现的，缺一不可。[习惯，先写{}再写代码]</li>
<li>一个源文件中最多只能有一个public类。其它类的个数不限</li>
<li>如果源文件包含一个public类，则文件名必须按该类名命名!</li>
<li>一个源文件中最多只能有一个public类。其它类的个数不限，也可以将main方法写在非public类中，然后指定运行非public类，这样入口方法就是非public的main方法</li>
</ol>

        <h3 id="5-学习方法-仅做参考"   >
          <a href="#5-学习方法-仅做参考" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-学习方法-仅做参考" class="headerlink" title="5.学习方法(仅做参考)"></a>5.学习方法(仅做参考)</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20211110150756219.png" alt="image-20211110150756219"></p>

        <h3 id="6-转义字符"   >
          <a href="#6-转义字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-转义字符" class="headerlink" title="6.转义字符"></a>6.转义字符</h3>
      <ol>
<li>\t:一个制表位,实现对齐的功能</li>
<li>\n:换行符</li>
<li>\:一个\</li>
<li>\”:一个”</li>
<li>\&#39;:一个’</li>
<li>\r:一个回车 System.out.println(“\r北京”);</li>
</ol>

        <h3 id="7-易犯错误"   >
          <a href="#7-易犯错误" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-易犯错误" class="headerlink" title="7.易犯错误"></a>7.易犯错误</h3>
      <ol>
<li>找不到文件<br>解决方法:源文件名不存在或者写错,或者当前路径错误</li>
<li>主类名和文件名不一致<br>解决方法:声明为public的主类应与文件名一致,否知编译失败</li>
<li>缺少分号<br>解决方法:编译失败,注意错误出现的行数,再到源代码中指定位置改错</li>
</ol>

        <h3 id="8-注释"   >
          <a href="#8-注释" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-注释" class="headerlink" title="8.注释"></a>8.注释</h3>
      <p>用于注解说明解释程序的文字就是注释,注释提高了代码的阅读性(可读性);注释是一个程序员必须要具有的良好编程习惯。将自己的思想通过注释先整理出来，再用代码去体现</p>

        <h4 id="1-单行注释"   >
          <a href="#1-单行注释" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-单行注释" class="headerlink" title="1.单行注释"></a>1.单行注释</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单行注释</span></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-多行注释"   >
          <a href="#2-多行注释" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-多行注释" class="headerlink" title="2.多行注释"></a>2.多行注释</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></div></figure>

<ol>
<li>被注释的文字,不会被JVM(Java虚拟机)解释执行</li>
<li>多行注释里面不允许有多行注释嵌套</li>
</ol>

        <h4 id="3-文档注释"   >
          <a href="#3-文档注释" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-文档注释" class="headerlink" title="3.文档注释"></a>3.文档注释</h4>
      <p>注释内容可以被JDK提供的工具JavaDoc所解析,生成一套以网页文件形式体现的该程序的说明文档,一般写在类</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment">* <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javadoc -d 文件夹名 -xx -yy Demo.java</span><br></pre></td></tr></table></div></figure>

<p>javadoc 工具软件识别以下标签：</p>
<div class="table-container"><table>
<thead>
<tr>
<th align="left"><strong>标签</strong></th>
<th align="center"><strong>描述</strong></th>
<th align="center"><strong>示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">@author</td>
<td align="center">标识一个类的作者</td>
<td align="center">@author description</td>
</tr>
<tr>
<td align="left">@deprecated</td>
<td align="center">指名一个过期的类或成员</td>
<td align="center">@deprecated description</td>
</tr>
<tr>
<td align="left">{@docRoot}</td>
<td align="center">指明当前文档根目录的路径</td>
<td align="center">Directory Path</td>
</tr>
<tr>
<td align="left">@exception</td>
<td align="center">标志一个类抛出的异常</td>
<td align="center">@exception exception-name explanation</td>
</tr>
<tr>
<td align="left">{@inheritDoc}</td>
<td align="center">从直接父类继承的注释</td>
<td align="center">Inherits a comment from the immediate surperclass.</td>
</tr>
<tr>
<td align="left">{@link}</td>
<td align="center">插入一个到另一个主题的链接</td>
<td align="center">{@link name text}</td>
</tr>
<tr>
<td align="left">{@linkplain}</td>
<td align="center">插入一个到另一个主题的链接，但是该链接显示纯文本字体</td>
<td align="center">Inserts an in-line link to another topic.</td>
</tr>
<tr>
<td align="left">@param</td>
<td align="center">说明一个方法的参数</td>
<td align="center">@param parameter-name explanation</td>
</tr>
<tr>
<td align="left">@return</td>
<td align="center">说明返回值类型</td>
<td align="center">@return explanation</td>
</tr>
<tr>
<td align="left">@see</td>
<td align="center">指定一个到另一个主题的链接</td>
<td align="center">@see anchor</td>
</tr>
<tr>
<td align="left">@serial</td>
<td align="center">说明一个序列化属性</td>
<td align="center">@serial description</td>
</tr>
<tr>
<td align="left">@serialData</td>
<td align="center">说明通过writeObject( ) 和 writeExternal( )方法写的数据</td>
<td align="center">@serialData description</td>
</tr>
<tr>
<td align="left">@serialField</td>
<td align="center">说明一个ObjectStreamField组件</td>
<td align="center">@serialField name type description</td>
</tr>
<tr>
<td align="left">@since</td>
<td align="center">标记当引入一个特定的变化时</td>
<td align="center">@since release</td>
</tr>
<tr>
<td align="left">@throws</td>
<td align="center">和 @exception标签一样.</td>
<td align="center">The @throws tag has the same meaning as the @exception tag.</td>
</tr>
<tr>
<td align="left">{@value}</td>
<td align="center">显示常量的值，该常量必须是static属性。</td>
<td align="center">Displays the value of a constant, which must be a static field.</td>
</tr>
<tr>
<td align="left">@version</td>
<td align="center">指定类的版本</td>
<td align="center">@version info</td>
</tr>
</tbody></table></div>

        <h3 id="9-Java代码规范"   >
          <a href="#9-Java代码规范" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-Java代码规范" class="headerlink" title="9.Java代码规范"></a>9.Java代码规范</h3>
      <ol>
<li>类、方法的注释,要以javadoc的方式来写。</li>
<li>非Java Doc的注释，往往是给代码的维护者看的，着重告述读者为什么这样写,如何修改,注意什么问题等</li>
<li>使用tab操作,实现缩进,默认整体向右边移动，时候用shift+tab整体向左移4.运算符和&#x3D;两边习惯性各加一个空格。比如:2＋4*5+ 345 - 89</li>
<li>源文件使用utf-8编码</li>
<li>行宽度不要超过80字符</li>
<li>代码编写次行风格和行尾风格</li>
</ol>

        <h2 id="6-DOS"   >
          <a href="#6-DOS" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-DOS" class="headerlink" title="6.DOS"></a>6.DOS</h2>
      
        <h3 id="1-原理"   >
          <a href="#1-原理" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-原理" class="headerlink" title="1.原理"></a>1.原理</h3>
      <p>Dos: Disk Operating System磁盘操作系统,简单说一下windows的目录结构。[原理图]</p>
<p>发送命令给Dos系统</p>
<p>Dos系统</p>
<ol>
<li>接收指令</li>
<li>解析指令</li>
<li>执行指令</li>
</ol>

        <h3 id="2-相对路径-绝对路径"   >
          <a href="#2-相对路径-绝对路径" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-相对路径-绝对路径" class="headerlink" title="2.相对路径,绝对路径"></a>2.相对路径,绝对路径</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20211110160754570.png" alt="image-20211110160754570"></p>
<p>相对路径:从当前目录开始定位,形成一个路径</p>
<p>绝对路径:从顶级目录开始定位,形成的路径</p>

        <h3 id="2-常用指令"   >
          <a href="#2-常用指令" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用指令" class="headerlink" title="2.常用指令"></a>2.常用指令</h3>
      <ol>
<li><p>查看当前目录是有什么</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dir</span> <span class="built_in">dir</span> d:\abc2\test200</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>切换到其他盘下:盘符号cd<br>切换到c盘</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>/D c:</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>切换到当前盘的其他目录下(使用相对路径和绝对路径演示)</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> d:\abc2\test200 </span><br><span class="line"><span class="built_in">cd</span> ..\..\abc2\test200</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>切换到上一级:</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ..</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>切换到根目录:cd \</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> \</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>查看指定目录下的所有子级目录</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tree d:</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>清屏</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cls</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>退出Dos</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></div></figure>
</li>
<li><p>md[创建目录],rd[删除目录],copy[拷贝文件],del[删除文件],echo[输入内容到文件],type[输入一个空文件],move[剪切]</p>
</li>
</ol>

        <h1 id="3-变量"   >
          <a href="#3-变量" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-变量" class="headerlink" title="3.变量"></a>3.变量</h1>
      
        <h2 id="1-变量介绍"   >
          <a href="#1-变量介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-变量介绍" class="headerlink" title="1.变量介绍"></a>1.变量介绍</h2>
      
        <h3 id="1-变量原理"   >
          <a href="#1-变量原理" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-变量原理" class="headerlink" title="1.变量原理"></a>1.变量原理</h3>
      <p>变量是程序的基本组成单位<br>不论是使用哪种高级程序语言编写程序，变量都是其程序的基本组成单位，比如:<br>&#x2F;&#x2F;变量有三个基本要素(类型+名称+值)</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String []args)</span>&#123;</span><br><span class="line">        <span class="type">int</span> a=<span class="number">1</span>;<span class="comment">//定义了一个变量,类型int整型,名称a,值1</span></span><br><span class="line">        <span class="type">int</span> b=<span class="number">3</span>;<span class="comment">//定义了一个变量,类型int整型,名称b,值3</span></span><br><span class="line">        b=<span class="number">89</span>;</span><br><span class="line">        System.out.println(a);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>简单的原理示意图</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20211110163455558.png" alt="image-20211110163455558"></p>

        <h3 id="2-变量概念"   >
          <a href="#2-变量概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-变量概念" class="headerlink" title="2.变量概念"></a>2.变量概念</h3>
      <p>变量相当于内存中一个数据存储空间的表示，你可以把变量看做是一个房间的门牌号(&#x3D;&#x3D;地址的名字&#x3D;&#x3D;)，通过门牌号我们可以找到房间，而通过变量名可以访问到变量(值)。</p>
<ul>
<li>变量使用的基本步骤<ol>
<li>声明变量 int a;</li>
<li>赋值 a &#x3D; 60;</li>
<li>使用System.out.println(a);&#x2F;&#x2F;也可以一步到位[int a &#x3D; 60;通常我们是一步完成]</li>
</ol>
</li>
</ul>

        <h3 id="3-变量细节"   >
          <a href="#3-变量细节" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-变量细节" class="headerlink" title="3.变量细节"></a>3.变量细节</h3>
      <ol>
<li>变量表示内存中的一个存储区域[不同的变量，类型不同，占用的空间大小不同,比如: int 4个字节,double就是8个字节]</li>
<li>该区域有自己的名称[变量名]和类型[数据类型]</li>
<li>变量必须先声明，后使用,即有顺序</li>
<li>该区域的数据可以在&#x3D;&#x3D;同一类型&#x3D;&#x3D;范围内不断变化</li>
<li>变量在同一个作用域内不能重名</li>
<li>变量&#x3D;变量名+值+数据类型。变量&#x3D;&#x3D;三要素&#x3D;&#x3D;</li>
</ol>

        <h2 id="2-号的使用"   >
          <a href="#2-号的使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-号的使用" class="headerlink" title="2.+号的使用"></a>2.+号的使用</h2>
      <ol>
<li>当左右两边都是数值型,则作加法运算</li>
<li>当左右两边有一方为字符串,则作拼接运算</li>
</ol>

        <h2 id="3-数据类型"   >
          <a href="#3-数据类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-数据类型" class="headerlink" title="3.数据类型"></a>3.数据类型</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425131519990.png" alt="image-20220425131519990"></p>
<p>基本类型:</p>
<ul>
<li>byte</li>
<li>short</li>
<li>int</li>
<li>long</li>
<li>float</li>
<li>double</li>
<li>char</li>
<li>boolean</li>
</ul>
<p>引用类型:</p>
<ul>
<li>类</li>
<li>接口</li>
<li>数组</li>
</ul>

        <h3 id="1-整数类型"   >
          <a href="#1-整数类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-整数类型" class="headerlink" title="1.整数类型"></a>1.整数类型</h3>
      
        <h4 id="1-整型使用"   >
          <a href="#1-整型使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-整型使用" class="headerlink" title="1.整型使用"></a>1.整型使用</h4>
      <p>整数类型:用于存放整数值<br><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425132252508.png" alt="image-20220425132252508"></p>

        <h4 id="2-整型细节"   >
          <a href="#2-整型细节" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-整型细节" class="headerlink" title="2.整型细节"></a>2.整型细节</h4>
      <ol>
<li>Java各整数类型有固定的范围和字段长度，不受具体OS[操作系统]的影响，以保证java程序的可移植性。</li>
<li>Java的整型常量默认为int型，声明long型常量须后加’l’或’L’</li>
<li>java程序中变量常声明为int型,除非不足以表示大数，才使用long</li>
<li>bit:计算机中的最小存储单位。 byte:计算机中基本存储单元,1byte &#x3D; 8 bit.</li>
</ol>

        <h3 id="2-浮点数"   >
          <a href="#2-浮点数" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-浮点数" class="headerlink" title="2.浮点数"></a>2.浮点数</h3>
      
        <h4 id="1-浮点数使用"   >
          <a href="#1-浮点数使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-浮点数使用" class="headerlink" title="1.浮点数使用"></a>1.浮点数使用</h4>
      <p>浮点类型:可以表示一个小数</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425134930305.png" alt="image-20220425134930305"></p>
<ul>
<li>说明<ol>
<li>关于浮点数在机器中存放形式的简单说明:浮点数 &#x3D; 符号位 + 指数位 + 尾数位</li>
<li>尾数部分可能丢失,造成精度损失(小数都是近似值)</li>
</ol>
</li>
</ul>

        <h4 id="2-浮点数细节"   >
          <a href="#2-浮点数细节" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-浮点数细节" class="headerlink" title="2.浮点数细节"></a>2.浮点数细节</h4>
      <ol>
<li><p>与整数类型类似，Java浮点类型也有固定的范围和字段长度，不受具体OS的影响。[float 4个字节double是8个字节]</p>
</li>
<li><p>Java的浮点型常量默认为double型，声明float型常量,须后加’f’或‘F‘</p>
</li>
<li><p>浮点型常量有两种表示形式</p>
<p>十进制数形式:如:5.12    512.0f     .512(必须有小数点)</p>
<p>科学计数法形式:如:5.12e2[5.12*10的2次方]      5.12E-2 [5.12&#x2F;10的二次方]</p>
</li>
<li><p>通常情况下，应该使用double型,因为它比float型更精确。[举例说明]<br>double num9 &#x3D; 2.1234567851;  &#x2F;&#x2F;打印后2.1234567851<br>float num10 &#x3D; 2.1234567851F; &#x2F;&#x2F;打印后2.1234567</p>
</li>
<li><p>浮点数使用陷阱:2.7和8.1&#x2F;3比较</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="variable">num11</span> <span class="operator">=</span> <span class="number">2.7</span>;</span><br><span class="line"><span class="type">double</span> <span class="variable">num12</span> <span class="operator">=</span> <span class="number">8.1</span>/<span class="number">3</span>;</span><br><span class="line">System.out.println(num11);<span class="comment">//2.7</span></span><br><span class="line">System.out.println(num12);<span class="comment">//2.6999...7</span></span><br></pre></td></tr></table></div></figure>

<p>存在精度问题,当对运算结果是小数的进行比较判断时,需要小心,应该是以两个数的差值的绝对值在某个精度范围之内判断,即两个小数相减</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="variable">num11</span> <span class="operator">=</span> <span class="number">2.7</span>;</span><br><span class="line"><span class="type">double</span> <span class="variable">num12</span> <span class="operator">=</span> <span class="number">8.1</span>/<span class="number">3</span>;</span><br><span class="line">System.out.println(num11);<span class="comment">//2.7</span></span><br><span class="line">System.out.println(num12);<span class="comment">//2.6999...7</span></span><br><span class="line"><span class="keyword">if</span>(Math.abs(num11-num12) &lt; <span class="number">0.000001</span>)&#123;<span class="comment">//差值小于0.000001即为相等</span></span><br><span class="line">    System.out.println(<span class="string">&quot;相等&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h3 id="3-字符类型-char"   >
          <a href="#3-字符类型-char" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-字符类型-char" class="headerlink" title="3.字符类型(char)"></a>3.字符类型(char)</h3>
      
        <h4 id="1-字符型使用"   >
          <a href="#1-字符型使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-字符型使用" class="headerlink" title="1.字符型使用"></a>1.字符型使用</h4>
      <p>字符类型可以表示单个字符,字符类型是char,char是两个字节(可以存放汉字),多个字符可以用字符串String</p>

        <h4 id="2-字符型细节"   >
          <a href="#2-字符型细节" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-字符型细节" class="headerlink" title="2.字符型细节"></a>2.字符型细节</h4>
      <ol>
<li><p>字符常量是用单引号(‘’)括起来的单个字符。例如:<br>char c1 &#x3D; ‘a’;char c2 &#x3D;’中’; char c3 &#x3D;’9”;</p>
</li>
<li><p>Java中还允许使用转义字符’&#39;来将其后的字符转变为特殊字符型常量。例如:char c3 &#x3D; ‘\n’; &#x2F;&#x2F; ‘\n’表厅换行符</p>
</li>
<li><p>在java中,char的本质是一个整数，在输出时,是unicode码对应的字符。<br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://tool.chinaz.com/Tools/Unicode.aspx" >http://tool.chinaz.com/Tools/Unicode.aspx</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</li>
<li><p>可以直接给char赋一个整数，然后输出时，会按照对应的unicode字符 如赋值[97]输出’a’</p>
</li>
<li><p>char类型是可以进行运算的，相当于一个整数，因为它都对应有Unicode码.</p>
</li>
</ol>

        <h4 id="3-字符型本质"   >
          <a href="#3-字符型本质" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-字符型本质" class="headerlink" title="3.字符型本质"></a>3.字符型本质</h4>
      <ol>
<li>字符型存储到计算机中，需要将字符对应的码值(整数)找出来,比如’a’<br>存储:’a’ &#x3D;&#x3D;&gt; 码值97 &#x3D;&#x3D;&gt;二进制 &#x3D;&#x3D;&gt; 存储<br>读取:二进制 &#x3D;&#x3D;&gt; 97 &#x3D;&#x3D;&gt; ‘a’ &#x3D;&#x3D;&gt; 显示</li>
<li>字符和码值的对应关系是通过字符编码表决定的(规定)<ul>
<li>介绍一下字符编码表<ul>
<li>ASCII (ASCII编码表一个字节表示，一个128个字符)</li>
<li>Unicode (Unicode编码表固定大小的编码使用两个字节来表示字符，字母和汉字统一都是占用两个字节，这样浪费空间)</li>
<li>utf-8(编码表,大小可变的编码 字母使用1个字节,汉字使用3个字节)</li>
<li>gbk(可以表示汉字，而且范围广，字母使用1个字节,汉字2个字节)</li>
<li>gb2312(可以表示汉字，gb2312&lt; gbk)</li>
<li>big5码(繁体中文,台湾，香港)</li>
</ul>
</li>
</ul>
</li>
</ol>

        <h3 id="4-布尔类型boolean"   >
          <a href="#4-布尔类型boolean" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-布尔类型boolean" class="headerlink" title="4.布尔类型boolean"></a>4.布尔类型boolean</h3>
      <p>基本介绍</p>
<ol>
<li>布尔类型也叫boolean类型, booolean类型数据只允许取值true和false,无null</li>
<li>boolean类型占1个字节。</li>
<li>boolean类型适于逻辑运算,一般用于程序流程控制:<ul>
<li>if条件控制语句;</li>
<li>while循环控制语句;</li>
<li>do-while循环控制语句;</li>
<li>for循环控制语句</li>
</ul>
</li>
</ol>

        <h2 id="4-编码"   >
          <a href="#4-编码" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-编码" class="headerlink" title="4.编码"></a>4.编码</h2>
      
        <h3 id="1-ASCII"   >
          <a href="#1-ASCII" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-ASCII" class="headerlink" title="1.ASCII"></a>1.ASCII</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425143219122.png" alt="image-20220425143219122"></p>

        <h3 id="2-Unicode"   >
          <a href="#2-Unicode" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Unicode" class="headerlink" title="2.Unicode"></a>2.Unicode</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425143147501.png" alt="image-20220425143147501"></p>

        <h3 id="3-UTF-8"   >
          <a href="#3-UTF-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-UTF-8" class="headerlink" title="3.UTF-8"></a>3.UTF-8</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425143257471.png" alt="image-20220425143257471"></p>

        <h2 id="5-数据类型转换"   >
          <a href="#5-数据类型转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-数据类型转换" class="headerlink" title="5.数据类型转换"></a>5.数据类型转换</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425143528785.png" alt="image-20220425143528785"></p>

        <h3 id="1-自动类型转换"   >
          <a href="#1-自动类型转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-自动类型转换" class="headerlink" title="1.自动类型转换"></a>1.自动类型转换</h3>
      <ol>
<li>有多种类型的数据混合运算时,系统首先自动将所有数据转换成容量最大的那种数据类型,然后再进行计算</li>
<li>当我们把精度(容量)大的数据类型赋值给精度(容量)小的数据类型时,就会报错,反之就会进行自动类型转换</li>
<li>(byte,short)和char之间不会相互自动转换</li>
<li>byte,short,char 三者可以计算,在计算时首先转换为int类型</li>
<li>boolean不参与转换</li>
<li>自动提升原则:表达式结果的类型自动提升为 操作数中最大的类型</li>
</ol>

        <h3 id="2-强制类型转换"   >
          <a href="#2-强制类型转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-强制类型转换" class="headerlink" title="2.强制类型转换"></a>2.强制类型转换</h3>
      <p>自动类型转换的逆过程,将容量大的数据类型转为容量小的数据类型,使用时需要加上强制转换符(),但可能造成精度降低</p>
<ol>
<li><p>当进行数据的大小从 大 –&gt;小,就需要使用到强制转换</p>
</li>
<li><p>强转符号只针对于最近的操作数有效,往往会使用小括号提升优先级</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//int x = (int)10*3.5+6*1.5;</span></span><br><span class="line"><span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> (<span class="type">int</span>)(<span class="number">10</span>*<span class="number">3.5</span> + <span class="number">6</span>*<span class="number">1.5</span>);</span><br><span class="line">System.out.println(y)</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>char类型可以保存int的常量值,但不能保存int的变量值,需要强转</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"><span class="type">char</span> <span class="variable">c2</span> <span class="operator">=</span> m;</span><br><span class="line"><span class="type">char</span> <span class="variable">c3</span> <span class="operator">=</span> (<span class="type">char</span>)m;</span><br><span class="line">System.out.println(c2);</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>byte和short,char类型在进行运算时,当做int类型处理</p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>	<span class="type">short</span> s= <span class="number">12</span>;<span class="comment">//ok</span></span><br><span class="line">	s= s-<span class="number">9</span>;<span class="comment">//错误int -&gt;short</span></span><br><span class="line"><span class="number">2.</span> 	<span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">10</span>;<span class="comment">//ok</span></span><br><span class="line">   	b =b + <span class="number">11</span>;<span class="comment">//错误int-&gt;byte</span></span><br><span class="line">	b=(<span class="type">byte</span>)(b+<span class="number">11</span>);<span class="comment">//正确,使用强转</span></span><br><span class="line"><span class="number">3.</span> 	<span class="type">char</span> c=<span class="string">&#x27;a&#x27;</span>; /ok</span><br><span class="line">	<span class="type">int</span> i= <span class="number">16</span>; <span class="comment">//ok</span></span><br><span class="line">	<span class="type">float</span> <span class="variable">d</span> <span class="operator">=</span> <span class="number">.314F</span>; <span class="comment">//ok</span></span><br><span class="line">	<span class="type">double</span> <span class="variable">result</span> <span class="operator">=</span>c + i + d;<span class="comment">//ok float-&gt;double</span></span><br><span class="line"><span class="number">4.</span>	<span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">16</span>;M	<span class="comment">//ok</span></span><br><span class="line">	<span class="type">short</span> <span class="variable">s</span> <span class="operator">=</span><span class="number">14</span>;l	<span class="comment">//ok</span></span><br><span class="line">	<span class="type">short</span> t=s +b;M	<span class="comment">//错误int -&gt;short</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="3-基本数据类型和String类型的转换"   >
          <a href="#3-基本数据类型和String类型的转换" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-基本数据类型和String类型的转换" class="headerlink" title="3.基本数据类型和String类型的转换"></a>3.基本数据类型和String类型的转换</h3>
      <p>在程序开发中,我们经常需要将基本数据类型转成String类型,或者将String类型转成基本数据类型</p>
<ol>
<li>在将String类型转成基本数据类型时，要确保String类型能够转成有效的数据,比如我们可以把“123”，转成一个整数，但是不能把”hello”转成一个整数</li>
<li>如果格式不正确，就会抛出异常，程序就会终止,这个问题在异常处理章节中，会处理</li>
</ol>

        <h1 id="4-运算符"   >
          <a href="#4-运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-运算符" class="headerlink" title="4.运算符"></a>4.运算符</h1>
      
        <h2 id="1-运算符介绍"   >
          <a href="#1-运算符介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-运算符介绍" class="headerlink" title="1.运算符介绍"></a>1.运算符介绍</h2>
      <p>运算符是一种特殊的符号,用以表示数据的运算、赋值和比较等</p>
<ol>
<li>算术运算符</li>
<li>赋值运算符</li>
<li>关系运算符[比较运算符]</li>
<li>逻辑运算符</li>
<li>位运算符[需要二进制基础]</li>
<li>三元运算符</li>
</ol>

        <h2 id="2-算术运算符"   >
          <a href="#2-算术运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-算术运算符" class="headerlink" title="2.算术运算符"></a>2.算术运算符</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425213430476.png" alt="image-20220425213430476"></p>

        <h2 id="3-关系运算符"   >
          <a href="#3-关系运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-关系运算符" class="headerlink" title="3.关系运算符"></a>3.关系运算符</h2>
      <ol>
<li>关系运算符的结果都是boolean型，也就是要么是true,要么是false</li>
<li>关系表达式经常用在if结构的条件中或循环结构的条件中</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425213620453.png" alt="image-20220425213620453"></p>

        <h2 id="4-逻辑运算符"   >
          <a href="#4-逻辑运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-逻辑运算符" class="headerlink" title="4.逻辑运算符"></a>4.逻辑运算符</h2>
      <p>用于连接多个条件(多个关系表达式),最终的结果也是一个boolean值。</p>
<ol>
<li>短路与 &amp;&amp; , 短路或 || , 取反 !</li>
<li>逻辑与 &amp; , 逻辑或 | , 逻辑异或 ^</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220425213700148.png" alt="image-20220425213700148"></p>
<p>逻辑运算规则:</p>
<ol>
<li><p>a&amp;b : &amp;叫逻辑与;</p>
<p>规则:当a和b同时为true ,则结果为true,否则为false</p>
</li>
<li><p>a&amp;&amp;b : &amp;&amp;叫短路与</p>
<p>规则:当a和b同时为true ,则结果为true,否则为false</p>
</li>
<li><p>a|b:|叫逻辑或</p>
<p>规则:当a和b,有一个为true ,则结果为true,否则为false</p>
</li>
<li><p>a][b:||叫短路或</p>
<p>规则:当a和b，有一个为true ,则结果为true,否则为false</p>
</li>
<li><p>!a:叫取反，或者非运算</p>
<p>规则:当a 为true,则结果为false,当 a为false是，结果为true</p>
</li>
<li><p>a^b:叫逻辑异或</p>
<p>规则:当a和b不同时，则结果为true,否则为false</p>
</li>
</ol>

        <h3 id="1-短路与-与-逻辑与"   >
          <a href="#1-短路与-与-逻辑与" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-短路与-与-逻辑与" class="headerlink" title="1.短路与 与 逻辑与"></a>1.短路与 与 逻辑与</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182011345.png" alt="image-20220524182011345"></p>

        <h3 id="2-短路或-与-逻辑或"   >
          <a href="#2-短路或-与-逻辑或" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-短路或-与-逻辑或" class="headerlink" title="2.短路或 与 逻辑或"></a>2.短路或 与 逻辑或</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182110506.png" alt="image-20220524182110506"></p>

        <h3 id="3-取反"   >
          <a href="#3-取反" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-取反" class="headerlink" title="3.取反"></a>3.取反</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182139354.png" alt="image-20220524182139354"></p>

        <h2 id="5-赋值运算符"   >
          <a href="#5-赋值运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-赋值运算符" class="headerlink" title="5.赋值运算符"></a>5.赋值运算符</h2>
      
        <h2 id="6-三元运算符"   >
          <a href="#6-三元运算符" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-三元运算符" class="headerlink" title="6.三元运算符"></a>6.三元运算符</h2>
      
        <h2 id="7-运算符优先级"   >
          <a href="#7-运算符优先级" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-运算符优先级" class="headerlink" title="7.运算符优先级"></a>7.运算符优先级</h2>
      
        <h2 id="8-标识符"   >
          <a href="#8-标识符" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-标识符" class="headerlink" title="8.标识符"></a>8.标识符</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182350943.png" alt="image-20220524182350943"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182433688.png" alt="image-20220524182433688"></p>

        <h2 id="9-关键字"   >
          <a href="#9-关键字" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-关键字" class="headerlink" title="9.关键字"></a>9.关键字</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182556453.png" alt="image-20220524182556453"></p>

        <h2 id="10-原码-反码-补码"   >
          <a href="#10-原码-反码-补码" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-原码-反码-补码" class="headerlink" title="10.原码,反码,补码"></a>10.原码,反码,补码</h2>
      <p>对于有符号的而言:</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220524182905703.png" alt="image-20220524182905703"></p>

        <h1 id="5-控制结构-跳过"   >
          <a href="#5-控制结构-跳过" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-控制结构-跳过" class="headerlink" title="5.控制结构(跳过)"></a>5.控制结构(跳过)</h1>
      
        <h2 id="1-顺序"   >
          <a href="#1-顺序" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-顺序" class="headerlink" title="1.顺序"></a>1.顺序</h2>
      
        <h2 id="2-分支-if-else-switch"   >
          <a href="#2-分支-if-else-switch" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-分支-if-else-switch" class="headerlink" title="2.分支(if else switch)"></a>2.分支(if else switch)</h2>
      
        <h2 id="3-循环-for-while-do-while"   >
          <a href="#3-循环-for-while-do-while" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-循环-for-while-do-while" class="headerlink" title="3.循环(for while do-while)"></a>3.循环(for while do-while)</h2>
      
        <h2 id="4-break"   >
          <a href="#4-break" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-break" class="headerlink" title="4.break"></a>4.break</h2>
      
        <h2 id="5-continue"   >
          <a href="#5-continue" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-continue" class="headerlink" title="5.continue"></a>5.continue</h2>
      
        <h2 id="6-return"   >
          <a href="#6-return" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-return" class="headerlink" title="6.return"></a>6.return</h2>
      
        <h1 id="6-数组-排序-查找"   >
          <a href="#6-数组-排序-查找" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-数组-排序-查找" class="headerlink" title="6.数组,排序,查找"></a>6.数组,排序,查找</h1>
      
        <h1 id="10-Java-面向对象编程-高级"   >
          <a href="#10-Java-面向对象编程-高级" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-Java-面向对象编程-高级" class="headerlink" title="10.Java 面向对象编程(高级)"></a>10.Java 面向对象编程(高级)</h1>
      
        <h2 id="1-类变量和类方法"   >
          <a href="#1-类变量和类方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-类变量和类方法" class="headerlink" title="1.类变量和类方法"></a>1.类变量和类方法</h2>
      
        <h3 id="1-提出问题"   >
          <a href="#1-提出问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-提出问题" class="headerlink" title="1.提出问题"></a>1.提出问题</h3>
      <p>提出问题的主要目的就是思考解决之道，从而引出知识点.</p>
<p>问题:有一群小孩在玩堆雪人,不时有新的小孩加入,请问如何知道现在共有多少人在玩?，编写程序解决。</p>
<p>传统方法解决:</p>
<ol>
<li>在main方法中定义一个变量count</li>
<li>当一个小孩加入游戏后count++,最后count就记录有多少小孩玩游戏</li>
</ol>
<p>com.why.static_.ChildGame</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.static_;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/31 19:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChildGame</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//定义一个变量 count,记录加入的小孩数量</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">Child</span> <span class="variable">child1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&quot;白骨精&quot;</span>);</span><br><span class="line">        child1.join();</span><br><span class="line">        count++;</span><br><span class="line"></span><br><span class="line">        <span class="type">Child</span> <span class="variable">child2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&quot;狐狸精&quot;</span>);</span><br><span class="line">        child2.join();</span><br><span class="line">        count++;</span><br><span class="line"></span><br><span class="line">        <span class="type">Child</span> <span class="variable">child3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&quot;老鼠精&quot;</span>);</span><br><span class="line">        child3.join();</span><br><span class="line">        count++;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;共有&quot;</span> + count + <span class="string">&quot;个小孩加入了游戏&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Child</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">join</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;加入了游戏&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>问题分析:</p>
<ol>
<li>count独立于对象,与类无关</li>
<li>以后访问count比较麻烦</li>
<li>因此,引出类变量&#x2F;静态变量</li>
</ol>

        <h3 id="2-类变量入门"   >
          <a href="#2-类变量入门" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-类变量入门" class="headerlink" title="2.类变量入门"></a>2.类变量入门</h3>
      <p>思考:如果,设计一个int count表示总人数,我们在创建一个小孩时，就把count加1,并且 count是所有对象共享的就ok了!，我们使用类变量来解决ChildGame.java 改进</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.static_;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/31 19:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChildGame</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Child</span> <span class="variable">child1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&quot;白骨精&quot;</span>);</span><br><span class="line">        child1.join();</span><br><span class="line"></span><br><span class="line">        <span class="type">Child</span> <span class="variable">child2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&quot;狐狸精&quot;</span>);</span><br><span class="line">        child2.join();</span><br><span class="line"></span><br><span class="line">        <span class="type">Child</span> <span class="variable">child3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Child</span>(<span class="string">&quot;老鼠精&quot;</span>);</span><br><span class="line">        child3.join();</span><br><span class="line">		<span class="comment">//类变量可以通过类名来访问</span></span><br><span class="line">        System.out.println(<span class="string">&quot;共有&quot;</span> + Child.count + <span class="string">&quot;个小孩加入了游戏&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">//定义一个变量 count,是一个类变量(静态变量) static 静态</span></span><br><span class="line">    <span class="comment">//该变量的最大特点就是会被 Child 类的所有对象实例共享</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Child</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">join</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;加入了游戏&quot;</span>);</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//class Child&#123;</span></span><br><span class="line"><span class="comment">//    private String name;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    public Child(String name)&#123;</span></span><br><span class="line"><span class="comment">//        this.name = name;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    public void join()&#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(name + &quot;加入了游戏&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="3-类变量内存布局"   >
          <a href="#3-类变量内存布局" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-类变量内存布局" class="headerlink" title="3.类变量内存布局"></a>3.类变量内存布局</h3>
      <p>图解</p>
<p>jdk8以后:在堆中</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210831193128234.png" alt="image-20210831193128234"></p>
<p>jdk7以前</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/x_iya/article/details/81260154/" >https://blog.csdn.net/x_iya/article/details/81260154/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span><br><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.zhihu.com/question/59174759/answer/163207831" >https://www.zhihu.com/question/59174759/answer/163207831</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>有些书说在方法区.., jdk 版本有关系，记住一点:static变量是对象共享,static类变量,在类加载的时候生成</p>

        <h3 id="4-什么是类变量"   >
          <a href="#4-什么是类变量" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-什么是类变量" class="headerlink" title="4.什么是类变量"></a>4.什么是类变量</h3>
      <p>类变量也叫静态变量&#x2F;静态属性，是该类的所有对象共享的变量,任何一个该类的对象去访问它时,取到的都是相同的值,同样任何一个该类的对象去修改它时,修改的也是同一个变量。这个从前面的图也可看出来。</p>
<ul>
<li><p>如何定义类变量<br>定义语法:</p>
<ul>
<li>访问修饰符 static 数据类型 变量名;[推荐]</li>
<li>static 访问修饰符 数据类型 变量名;</li>
</ul>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">	pubiic <span class="keyword">static</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span> ;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">public</span> <span class="type">int</span> <span class="variable">totaLNum</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>如何访问类变量 VisitStatic.java</p>
<p>类名.类变量名</p>
<p>或者 对象名.类变量名【静态变量的访问修饰符的访问权限和范围和普通属性是一样的。】</p>
<p>推荐使用:类名.类变量名;</p>
</li>
</ul>

        <h2 id="2-理解main方法语法"   >
          <a href="#2-理解main方法语法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-理解main方法语法" class="headerlink" title="2.理解main方法语法"></a>2.理解main方法语法</h2>
      
        <h2 id="3-代码块"   >
          <a href="#3-代码块" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-代码块" class="headerlink" title="3.代码块"></a>3.代码块</h2>
      
        <h2 id="4-单例设计模式"   >
          <a href="#4-单例设计模式" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-单例设计模式" class="headerlink" title="4.单例设计模式"></a>4.单例设计模式</h2>
      
        <h2 id="5-final关键字"   >
          <a href="#5-final关键字" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-final关键字" class="headerlink" title="5.final关键字"></a>5.final关键字</h2>
      
        <h2 id="6-抽象类"   >
          <a href="#6-抽象类" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-抽象类" class="headerlink" title="6.抽象类"></a>6.抽象类</h2>
      
        <h2 id="7-接口"   >
          <a href="#7-接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-接口" class="headerlink" title="7.接口"></a>7.接口</h2>
      
        <h2 id="8-内部类"   >
          <a href="#8-内部类" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-内部类" class="headerlink" title="8.内部类"></a>8.内部类</h2>
      
        <h3 id="1-介绍"   >
          <a href="#1-介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍" class="headerlink" title="1.介绍"></a>1.介绍</h3>
      <ul>
<li><p>基本介绍</p>
<p>一个类的内部又完整的嵌套了另一个类结构。被嵌套的类称为内部类(inner class),嵌套其他类的类称为外部类(outer class)。是我们类的第五大成员【思考:类的五大成员[属性,方法,构造器,代码块,内部类]】，内部类最大的特点就是可以直接访问私有属性，并且可以体现类与类之间的包含关系</p>
<p>注意:内部类是学习的&#x3D;&#x3D;重点&#x3D;&#x3D;,</p>
</li>
<li><p>基本语法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Outer</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">	<span class="keyword">class</span> <span class="title class_">Inner</span>&#123;<span class="comment">//内部类</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Other</span>&#123;<span class="comment">//外部其他类</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//InnerClass01.java</span></span><br></pre></td></tr></table></div></figure>
</li>
<li><p>案例</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.InnerClass;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/31 21:15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InnerClass01</span> &#123;<span class="comment">//外部其他类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Outer</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">100</span>;<span class="comment">//属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Outer</span><span class="params">(<span class="type">int</span> n1)</span>&#123;<span class="comment">//构造器</span></span><br><span class="line">        <span class="built_in">this</span>.n1 = n1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;<span class="comment">//方法</span></span><br><span class="line">        System.out.println(<span class="string">&quot;m1()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#123;<span class="comment">//代码块</span></span><br><span class="line">        System.out.println(<span class="string">&quot;代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Inner</span> &#123;<span class="comment">//内部类,在Outer类的内部       </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h3 id="2-分类"   >
          <a href="#2-分类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-分类" class="headerlink" title="2.分类"></a>2.分类</h3>
      <p>定义在外部类局部位置上(比如方法内):</p>
<ol>
<li>局部内部类(有类名)</li>
<li>匿名内部类(没有类名，&#x3D;&#x3D;重点&#x3D;&#x3D;)</li>
</ol>
<p>定义在外部类的成员位置上:</p>
<ol>
<li>成员内部类(没用static修饰)</li>
<li>静态内部类(使用static修饰)</li>
</ol>

        <h3 id="3-局部内部类"   >
          <a href="#3-局部内部类" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-局部内部类" class="headerlink" title="3.局部内部类"></a>3.局部内部类</h3>
      <p>说明:</p>
<ol>
<li><p>局部内部类是定义在外部类的局部位置,比如方法中，并且有类名。</p>
</li>
<li><p>可以直接访问外部类的所有成员，包含私有的</p>
</li>
<li><p>不能添加访问修饰符,因为它的地位就是一个局部变量。局部变量是不能使用修饰符的。但是可以使用final 修饰，因为局部变量也可以使用final</p>
</li>
<li><p>作用域:仅仅在定义它的方法或代码块中。</p>
</li>
<li><p>局部内部类—访问—-&gt;外部类的成员[访问方式:直接访问],局部内部类可以直接访问外部类的成员</p>
</li>
<li><p>外部类—访问—-&gt;局部内部类的成员<br>访问方式:创建对象,再访问(注意:必须在作用域内)</p>
<p>外部类在方法中,可以创建Inner02对象,然后调用方法即可</p>
</li>
<li><p>外部其他类—不能访问—–&gt;局部内部类（因为局部内部类地位是一个局部变量)</p>
</li>
<li><p>如果外部类和局部内部类的成员重名时，默认遵循就近原则，如果想访问外部类的成员,则可以使用(外部类名.this.成员)去访问【演示)】<br>System.out.printIn(“外部类的n2&#x3D;”+外部类名.this.n2);<br>需要解释一下原因:</p>
</li>
</ol>
<p>记住:</p>
<ol>
<li>局部内部类定义在方法中&#x2F;代码块</li>
<li>作用域在方法体或者代码块中</li>
<li>本质仍然是一个类</li>
</ol>
<p>LocalnnerClass.java</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.InnerClass;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/31 22:12</span></span><br><span class="line"><span class="comment"> * 演示局部内部类的使用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalInnerClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Outer02</span> <span class="variable">outer02</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer02</span>();</span><br><span class="line">        outer02.m1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Outer02</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">100</span>;<span class="comment">//属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;<span class="comment">//方法</span></span><br><span class="line">        <span class="comment">//1.局部内部类是定义在外部类的局部位置,比如方法中，并且有类名。</span></span><br><span class="line">        <span class="comment">//3.不能添加访问修饰符,但是可以使用final</span></span><br><span class="line">        <span class="comment">//4.作用域:仅仅在定义它的方法或代码块中</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Inner02</span>&#123;<span class="comment">//局部内部类(本质上仍然是一个类)</span></span><br><span class="line">            <span class="comment">//2.可以直接访问外部类的所有成员,包含私有的</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">f1</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="comment">//5.局部内部类可以直接访问外部类的成员,比如下面 外部类 n1 和 m2()</span></span><br><span class="line">                System.out.println(<span class="string">&quot;n1 = &quot;</span> + n1);</span><br><span class="line">                Outer02.<span class="built_in">this</span>.m2();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;inner m2&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6.外部类在方法中,可以创建Inner02对象,然后调用方法即可</span></span><br><span class="line">        <span class="type">Inner02</span> <span class="variable">inner02</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Inner02</span>();</span><br><span class="line">        inner02.f1();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;m2()&quot;</span>);</span><br><span class="line">    &#125;<span class="comment">//私有方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="4-匿名内部类"   >
          <a href="#4-匿名内部类" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-匿名内部类" class="headerlink" title="4.匿名内部类"></a>4.匿名内部类</h3>
      
        <h4 id="1-本质"   >
          <a href="#1-本质" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-本质" class="headerlink" title="1.本质"></a>1.本质</h4>
      <p>说明:</p>
<ol>
<li>本质是类</li>
<li>内部类</li>
<li>该类没有名字(由系统分配)</li>
<li>同时还是一个对象</li>
</ol>
<p>特点:</p>
<ol>
<li><p>匿名内部类是定义在外部类的局部位置,比如方法中,并且没有类名</p>
</li>
<li><p>匿名内部类的基本语法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> 类或接口(参数列表)&#123;</span><br><span class="line">    类体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li></li>
</ol>
<p>AnonymousInnerClass.java</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.InnerClass;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/31 22:49</span></span><br><span class="line"><span class="comment"> * 演示匿名内部类的使用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnonymousInnerClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Outer04</span> <span class="variable">outer04</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer04</span>();</span><br><span class="line">        outer04.method();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Outer04</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">10</span>;<span class="comment">//属性</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;<span class="comment">//方法</span></span><br><span class="line">        <span class="comment">//1.基于接口的匿名内部类</span></span><br><span class="line">        <span class="comment">//1)需求:想使用A接口,并创建对象</span></span><br><span class="line">        <span class="comment">//2)传统方式:写一个类,实现A接口,并创建对象</span></span><br><span class="line"><span class="comment">//        A tiger = new Tiger();</span></span><br><span class="line"><span class="comment">//        tiger.cry();</span></span><br><span class="line">        <span class="comment">//3)需求,只使用一次tiger/dog,以后不再使用</span></span><br><span class="line">        <span class="comment">//4)使用匿名内部类简化开发</span></span><br><span class="line">        <span class="comment">//5)tiger的编译类型 --&gt; A</span></span><br><span class="line">        <span class="comment">//6)tiger的运行类型 --&gt; 匿名内部类</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            查看底层,会分配类名 外部类$编号</span></span><br><span class="line"><span class="comment">            class xxxx implements A&#123;</span></span><br><span class="line"><span class="comment">                @Override</span></span><br><span class="line"><span class="comment">                public void cry() &#123;</span></span><br><span class="line"><span class="comment">                    System.out.println(&quot;老虎叫&quot;);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//7)jdk底层创建匿名内部类 Outer04$1,立即就创建了 Outer04$1的实例,并且把地址返回给tiger</span></span><br><span class="line">        <span class="comment">//8)匿名内部类只能使用一次,就不能再使用</span></span><br><span class="line">        <span class="type">A</span> <span class="variable">tiger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cry</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;老虎叫&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        System.out.println(<span class="string">&quot;tiger的运行类型=&quot;</span>+tiger.getClass());</span><br><span class="line">        tiger.cry();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">A</span>&#123;<span class="comment">//接口</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cry</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//class Tiger implements A&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    @Override</span></span><br><span class="line"><span class="comment">//    public void cry() &#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;老虎cry&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Father</span><span class="params">(String name)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-使用"   >
          <a href="#2-使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-使用" class="headerlink" title="2.使用"></a>2.使用</h4>
      <p>基于接口实现匿名内部类,参考上文本质介绍</p>
<p>基于类实现匿名内部类</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.InnerClass;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/31 22:49</span></span><br><span class="line"><span class="comment"> * 演示匿名内部类的使用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnonymousInnerClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Outer04</span> <span class="variable">outer04</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer04</span>();</span><br><span class="line">        outer04.method();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Outer04</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">10</span>;<span class="comment">//属性</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;<span class="comment">//方法</span></span><br><span class="line">        <span class="comment">//1.基于接口的匿名内部类</span></span><br><span class="line">        <span class="comment">//1)需求:想使用A接口,并创建对象</span></span><br><span class="line">        <span class="comment">//2)传统方式:写一个类,实现A接口,并创建对象</span></span><br><span class="line"><span class="comment">//        A tiger = new Tiger();</span></span><br><span class="line"><span class="comment">//        tiger.cry();</span></span><br><span class="line">        <span class="comment">//3)需求,只使用一次tiger/dog,以后不再使用</span></span><br><span class="line">        <span class="comment">//4)使用匿名内部类简化开发</span></span><br><span class="line">        <span class="comment">//5)tiger的编译类型 --&gt; A</span></span><br><span class="line">        <span class="comment">//6)tiger的运行类型 --&gt; 匿名内部类</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            查看底层,会分配类名 外部类$编号</span></span><br><span class="line"><span class="comment">            class xxxx implements A&#123;</span></span><br><span class="line"><span class="comment">                @Override</span></span><br><span class="line"><span class="comment">                public void cry() &#123;</span></span><br><span class="line"><span class="comment">                    System.out.println(&quot;老虎叫&quot;);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//7)jdk底层创建匿名内部类 Outer04$1,立即就创建了 Outer04$1的实例,并且把地址返回给tiger</span></span><br><span class="line">        <span class="comment">//8)匿名内部类只能使用一次,就不能再使用</span></span><br><span class="line">        <span class="type">A</span> <span class="variable">tiger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">A</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cry</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;老虎叫&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        System.out.println(<span class="string">&quot;tiger的运行类型=&quot;</span>+tiger.getClass());</span><br><span class="line">        tiger.cry();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//基于类的匿名内部类</span></span><br><span class="line">        <span class="comment">//father 编译类型是 Father ,但是 运行类型 为 Outer04$2</span></span><br><span class="line">        <span class="comment">//底层会创建匿名内部类</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            class Outer04$2 extends Father&#123;</span></span><br><span class="line"><span class="comment">                @Override</span></span><br><span class="line"><span class="comment">                public void test() &#123;</span></span><br><span class="line"><span class="comment">                    System.out.println(&quot;匿名内部类重写了test方法&quot;);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//同时因为new也返回了匿名内部类的对象</span></span><br><span class="line">        <span class="comment">//&quot;jack&quot; 参数列表会传递给构造器</span></span><br><span class="line">        <span class="type">Father</span> <span class="variable">father</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Father</span>(<span class="string">&quot;jack&quot;</span>)&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;匿名内部类重写了test方法&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        System.out.println(father.getClass());<span class="comment">//此时的运行类型为Outer04$2</span></span><br><span class="line">        father.test();</span><br><span class="line">        System.out.println(father.name);</span><br><span class="line">        <span class="comment">//因此可以推出</span></span><br><span class="line">        <span class="comment">//若要实现基于抽象类的匿名内部类,其必须重写其中的抽象方法</span></span><br><span class="line">        <span class="type">Animal</span> <span class="variable">animal</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Animal</span>() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;抽象类的匿名内部类eat&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        animal.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">A</span>&#123;<span class="comment">//接口</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cry</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//class Tiger implements A&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    @Override</span></span><br><span class="line"><span class="comment">//    public void cry() &#123;</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;老虎cry&quot;);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Father</span>&#123;<span class="comment">//外部类</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Father</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="3-细节"   >
          <a href="#3-细节" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-细节" class="headerlink" title="3.细节"></a>3.细节</h4>
      <ol start="2">
<li>匿名内部类的语法比较奇特，请大家注意，因为匿名内部类既是一个类的定义,同时它本身也是一个对象，因此从语法上看，它既有定义类的特征，记有创建对象的特征，对前面代码分析可以看出这个特点，因此可以调用匿名内部类方法。</li>
<li>可以直接访问外部类的所有成员,包含私有的[案例演示]</li>
<li>不能添加访问修饰符,因为它的地位就是一个局部变量</li>
<li>作用域:仅仅在定义它的方法或代码块中。[过]</li>
<li>匿名内部类—访问—-&gt;外部类成员[访问方式:直接访问]</li>
<li>外部其他类—不能访问—–&gt;匿名内部类（因为匿名内部类地位是一个局部变量)</li>
<li>如果外部类和内部类的成员重名时，内部类访问的话，默认遵循就近原则，如果想访问外部类的成员，则可以使用(外部类名.this.成员)去访问</li>
</ol>
<p>AnonymousInnerClassDetail.java</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.InnerClass;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/9/3 23:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnonymousInnerClassDetail</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Outer05</span> <span class="variable">outer05</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer05</span>();</span><br><span class="line">        outer05.f1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Outer05</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">99</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">f1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//创建一个基于类的匿名内部类</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;匿名内部类重写 hi 方法&quot;</span> + n1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        p.hi();<span class="comment">//动态绑定,运行类型是 Outer05$1</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Person</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;匿名内部类2重写 hi 方法&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.ok(<span class="string">&quot;jjj&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;<span class="comment">//类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person hi&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ok</span><span class="params">(String str)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Str = &quot;</span> + str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//抽象类</span></span><br><span class="line"><span class="comment">//接口</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="4-实践"   >
          <a href="#4-实践" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-实践" class="headerlink" title="4.实践"></a>4.实践</h4>
      <p>当做实参直接传递,简洁高效</p>
<p>InnerClassExercise01.java</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="5-成员内部类"   >
          <a href="#5-成员内部类" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-成员内部类" class="headerlink" title="5.成员内部类"></a>5.成员内部类</h3>
      
        <h3 id="6-静态内部类"   >
          <a href="#6-静态内部类" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-静态内部类" class="headerlink" title="6.静态内部类"></a>6.静态内部类</h3>
      
        <h1 id="Java-集合"   >
          <a href="#Java-集合" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-集合" class="headerlink" title="Java 集合"></a>Java 集合</h1>
      
        <h2 id="1-数组与集合的比较"   >
          <a href="#1-数组与集合的比较" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-数组与集合的比较" class="headerlink" title="1.数组与集合的比较"></a>1.数组与集合的比较</h2>
      
        <h3 id="数组"   >
          <a href="#数组" class="heading-link"><i class="fas fa-link"></i></a><a href="#数组" class="headerlink" title="数组"></a>数组</h3>
      <ol>
<li>长度开始时必须指定,一旦指定,不能更改</li>
<li>保存的必须为同一类型的元素</li>
<li>使用数组进行增加&#x2F;删除元素的示意代码</li>
</ol>
<p>Person数组扩容:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Person[] pers = <span class="keyword">new</span> <span class="title class_">Person</span>[<span class="number">1</span>];<span class="comment">//大小为1的数组</span></span><br><span class="line">per[<span class="number">0</span>]=<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="comment">//增加新的Person对象</span></span><br><span class="line">Person[] pers2=<span class="keyword">new</span> <span class="title class_">Person</span>[pers.length+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>()&#123;&#125; <span class="comment">//拷贝pers数组元素到pers2上</span></span><br><span class="line">pers2[pers2.length-<span class="number">1</span>]=<span class="keyword">new</span> <span class="title class_">Person</span>();</span><br></pre></td></tr></table></div></figure>


        <h3 id="集合"   >
          <a href="#集合" class="heading-link"><i class="fas fa-link"></i></a><a href="#集合" class="headerlink" title="集合"></a>集合</h3>
      <ol>
<li>可以动态保存任意多个对象,使用比较方便</li>
<li>提供了一系列方便的操作对象的方法:add,remove,set,get</li>
<li>使用集合添加,删除新元素的示意代码,简洁明了</li>
</ol>

        <h2 id="2-集合体系框架"   >
          <a href="#2-集合体系框架" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-集合体系框架" class="headerlink" title="2.集合体系框架"></a>2.集合体系框架</h2>
      <ol>
<li>集合主要分为两组(单列集合,双列集合)</li>
<li>Collection有两个重要的子接口 List Set (单列集合,单个的元素)</li>
<li>Map接口的实现子类是双列集合 存放K-V(双列集合)</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526152742504.png" alt="image-20210526152742504"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526152931310.png" alt="image-20210526152931310"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210204153840134.png" alt="image-20210204153840134"></p>

        <h2 id="3-Collection"   >
          <a href="#3-Collection" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Collection" class="headerlink" title="3.Collection"></a>3.Collection</h2>
      
        <h3 id="1-概述"   >
          <a href="#1-概述" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h3>
      <ol>
<li>Collection实现子类可以存放多个元素,每个元素可以是Object</li>
<li>Collection的实现类中,List可以存放重复的元素,Set不可以</li>
<li>Collection的实现类中,List是有序的,Set是无序的</li>
<li>Collection接口没有直接实现的子类,是通过List与Set子接口来实现的</li>
</ol>

        <h3 id="2-常用方法"   >
          <a href="#2-常用方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法" class="headerlink" title="2.常用方法"></a>2.常用方法</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526153654447.png" alt="image-20210526153654447"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526153718100.png" alt="image-20210526153718100"></p>

        <h3 id="3-Collection遍历"   >
          <a href="#3-Collection遍历" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Collection遍历" class="headerlink" title="3.Collection遍历"></a>3.Collection遍历</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526154305255.png" alt="image-20210526154305255"></p>

        <h4 id="1-Iterator"   >
          <a href="#1-Iterator" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Iterator" class="headerlink" title="1.Iterator"></a>1.Iterator</h4>
      <ol>
<li><p>Iterator对象成为迭代器,主要用于遍历Collection集合中的元素</p>
</li>
<li><p>所有实现了Collection接口的集合类都有一个iterator()方法,用于返回一个实现了Iterator接口的对象,即可以返回一个迭代器</p>
</li>
<li><p>Iterator的结构</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526154756007.png" alt="image-20210526154756007"></p>
</li>
<li><p>Iterator仅用于遍历集合,Iterator本身并不存放对象</p>
<p>hasNext():判断是否存在更多的元素</p>
<p>next():将下一个元素返回</p>
<p>当退出while循环后,这时Iterator迭代器指向最后的元素,</p>
<p>若再次使用next则会报错NoSuchElementException</p>
</li>
</ol>

        <h4 id="2-增强for循环"   >
          <a href="#2-增强for循环" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-增强for循环" class="headerlink" title="2.增强for循环"></a>2.增强for循环</h4>
      <p>本质与Iterator一样,只能用于遍历集合或数组</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(元素类型 元素名 : 集合名或数组名)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="4-List"   >
          <a href="#4-List" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-List" class="headerlink" title="4.List"></a>4.List</h3>
      
        <h4 id="1-常用方法"   >
          <a href="#1-常用方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-常用方法" class="headerlink" title="1.常用方法"></a>1.常用方法</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210526174716759.png" alt="image-20210526174716759"></p>

        <h4 id="2-遍历"   >
          <a href="#2-遍历" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-遍历" class="headerlink" title="2.遍历"></a>2.遍历</h4>
      
        <h5 id="1-使用Iterator"   >
          <a href="#1-使用Iterator" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-使用Iterator" class="headerlink" title="1.使用Iterator"></a>1.使用Iterator</h5>
      
        <h5 id="2-使用增强for"   >
          <a href="#2-使用增强for" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-使用增强for" class="headerlink" title="2.使用增强for"></a>2.使用增强for</h5>
      
        <h5 id="3-使用普通for"   >
          <a href="#3-使用普通for" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-使用普通for" class="headerlink" title="3.使用普通for"></a>3.使用普通for</h5>
      
        <h4 id="3-ArrayList"   >
          <a href="#3-ArrayList" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ArrayList" class="headerlink" title="3.ArrayList"></a>3.ArrayList</h4>
      
        <h5 id="1-特点"   >
          <a href="#1-特点" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-特点" class="headerlink" title="1.特点"></a>1.特点</h5>
      <ol>
<li><p>ArrayList可以放任意值(包括null),并且可以存放多个</p>
</li>
<li><p>ArrayList是由数组实现数据存储</p>
</li>
<li><p>ArrayList基本等同于Vector,除了ArrayList是线程不安全的(执行效率高),在多个线程下,不建议使用ArrayList</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//源码不存在synchronized</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e, Object[] elementData, <span class="type">int</span> s)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (s == elementData.length)</span><br><span class="line">            elementData = grow();</span><br><span class="line">        elementData[s] = e;</span><br><span class="line">        size = s + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Appends the specified element to the end of this list.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e element to be appended to this list</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; (as specified by &#123;<span class="doctag">@link</span> Collection#add&#125;)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">        modCount++;</span><br><span class="line">        add(e, elementData, size);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h5 id="2-源码分析"   >
          <a href="#2-源码分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-源码分析" class="headerlink" title="2.源码分析"></a>2.源码分析</h5>
      <ol>
<li>ArrayList中维护了一个Object类型的数组elementData. [debug看源码]<br><code>transient Object[] elementData;</code></li>
<li>当创建对象时，如果使用的是无参构造器，则初始elementData容量为0(jdk7是10)</li>
<li>当添加元素时:先判断是否需要扩容，如果需要扩容，则调用grow方法，否则直接添加元素到合适位置</li>
<li>如果使用的是无参构造器，如果第一次添加，则扩容elementData为10,如果需要再次扩容的话，则扩容elementData为1.5倍。</li>
<li>如果使用的是指定容量capacity的构造器，则初始elementData容量为capacity</li>
<li>如果使用的是指定容量capacity的构造器,如果需要扩容，则直接扩容elementData为1.5倍。</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210527162143650.png" alt="image-20210527162143650"></p>

        <h6 id="1-扩容机制"   >
          <a href="#1-扩容机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-扩容机制" class="headerlink" title="1.扩容机制"></a>1.扩容机制</h6>
      <ol>
<li><p>ArrayList中维护了一个Object类型的数组elementData. <code>transient Object[] elementData;</code></p>
<p>transient 表示该属性不会被序列化</p>
</li>
<li><p>当创建ArrayList对象时，如果使用的是无参构造器，则初始elementData容量为0，第1次添加，则扩容elementData为10，如需要再次扩容，则扩容elementData为1.5倍。</p>
</li>
<li><p>如果使用的是指定大小的构造器，则初始elementData容量为指定大小，如果需要扩容,则直接扩容elementData为1.5倍。</p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e, Object[] elementData, <span class="type">int</span> s)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (s == elementData.length) <span class="comment">//如果数组的长度等于当前数组中元素的个数</span></span><br><span class="line">        elementData = grow(); <span class="comment">//进行扩容</span></span><br><span class="line">    elementData[s] = e; <span class="comment">//数组添加</span></span><br><span class="line">    size = s + <span class="number">1</span>; <span class="comment">//记录当前数组中元素的个数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Appends the specified element to the end of this list.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e element to be appended to this list</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; (as specified by &#123;<span class="doctag">@link</span> Collection#add&#125;)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    add(e, elementData, size);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">newCapacity</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;<span class="comment">//传入的值为数组个数+1</span></span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> elementData.length; <span class="comment">//扩容前数组的长度</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);<span class="comment">//扩容后变为的长度</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt;= <span class="number">0</span>) &#123;<span class="comment">//如果扩容后的长度小于等于数组元素个数+1</span></span><br><span class="line">        <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA)<span class="comment">//如果数组为空</span></span><br><span class="line">            <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);<span class="comment">//扩容为10</span></span><br><span class="line">        <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow 传入的为数组的个数+1 小于0</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OutOfMemoryError</span>(); <span class="comment">//抛出错误</span></span><br><span class="line">        <span class="keyword">return</span> minCapacity;<span class="comment">//返回数组个数+1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (newCapacity - MAX_ARRAY_SIZE &lt;= <span class="number">0</span>)</span><br><span class="line">        ? newCapacity</span><br><span class="line">        : hugeCapacity(minCapacity);<span class="comment">//如果新的长度小于等于最大的数组长度,返回新的长度,否则</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">hugeCapacity</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;<span class="comment">//传入的值为数组个数+1</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow </span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OutOfMemoryError</span>();</span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE)</span><br><span class="line">        ? Integer.MAX_VALUE</span><br><span class="line">        : MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h5 id="3-总结"   >
          <a href="#3-总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h5>
      <p>List接口的主要实现类,执行效率高,线程不安全,底层使用Object[]存储</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.jdk 7情况下</span></span><br><span class="line"><span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();<span class="comment">//底层创建了长度是10的object[]数组</span></span><br><span class="line">eLementDatalist.add(<span class="number">123</span>); <span class="comment">//eLementData[e] = new Integer(123);</span></span><br><span class="line">...</span><br><span class="line">list.add(<span class="number">11</span>);<span class="comment">//如果此次的添加导致底层elementData数组容量不够，则扩容。</span></span><br><span class="line"><span class="comment">//默认情况下，扩容为原来的容量的1.5倍，同时需要将原有数组中的数据复制到新的数组中。结论:建议开发中使用带参的构造器:</span></span><br><span class="line"><span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>(<span class="type">int</span> capacity)</span><br><span class="line"><span class="comment">//2.jdk 8中ArrayList的变化:</span></span><br><span class="line"><span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();<span class="comment">//底层object[] elementData初始化为&#123;&#125;.并没有创建</span></span><br><span class="line">list.add(<span class="number">123</span>);<span class="comment">//第一次调用add()时，底层才创建了长度10的数组，并将数据123添加到eLem...后续的添加和扩容操作与jdk 7无异。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//jdk7中的ArrayList的对象的创建类似于单例的饿汉式，而jdk8中的ArrayList的对象的创建类似于单例的懒汉式，延迟了数组的创建，节省内存。</span></span><br></pre></td></tr></table></div></figure>


        <h4 id="4-LinkedList"   >
          <a href="#4-LinkedList" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-LinkedList" class="headerlink" title="4.LinkedList"></a>4.LinkedList</h4>
      
        <h5 id="1-特点-1"   >
          <a href="#1-特点-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-特点-1" class="headerlink" title="1.特点"></a>1.特点</h5>
      <ol>
<li>实现了双向链表和双端队列特点</li>
<li>可以添加任意元素,元素可以重复,包括null</li>
<li>线程不安全,没有实现同步互斥</li>
</ol>
<p>底层使用双向链表,对于频繁的插入,删除,效率高</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractSequentialList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, Deque&lt;E&gt;, Cloneable, java.io.Serializable</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">transient</span> <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Pointer to first node.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> Node&lt;E&gt; first; <span class="comment">//指向头结点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Pointer to last node.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">transient</span> Node&lt;E&gt; last; <span class="comment">//指向尾结点</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>



<p><img   src="D:\my-note\image\image-20210204231230181.png?lastModify=1622111542" style=""  alt="image-20210204231230181"></p>

        <h5 id="2-与ArrayList的比较"   >
          <a href="#2-与ArrayList的比较" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-与ArrayList的比较" class="headerlink" title="2.与ArrayList的比较"></a>2.与ArrayList的比较</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210529160508541.png" alt="image-20210529160508541"></p>

        <h5 id="3-源码分析"   >
          <a href="#3-源码分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码分析" class="headerlink" title="3.源码分析"></a>3.源码分析</h5>
      <p>linkedList list &#x3D; new LinkedList();内部声明了Node类型的first和ast属性，默认值为null</p>
<p>list.add(123);&#x2F;&#x2F;将123封装到Node中，创建了Node对象。</p>
<p>构造方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedList</span><span class="params">()</span> &#123;<span class="comment">//初始化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210529154549770.png" alt="image-20210529154549770"></p>
<p>添加方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    linkLast(e);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">linkLast</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; l = last; <span class="comment">//获取last</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; newNode = <span class="keyword">new</span> <span class="title class_">Node</span>&lt;&gt;(l, e, <span class="literal">null</span>);<span class="comment">//创建一个新的node对象,l为node对象的prev,其下一个next=null,item为e</span></span><br><span class="line">    last = newNode;<span class="comment">//将last=新的对象,即添加到链表的尾部</span></span><br><span class="line">    <span class="keyword">if</span> (l == <span class="literal">null</span>)<span class="comment">//如果l是空的</span></span><br><span class="line">        first = newNode;<span class="comment">//说明没有first结点,将其指向newNode</span></span><br><span class="line">    <span class="keyword">else</span><span class="comment">//l不是空的,即l是原来的尾部</span></span><br><span class="line">        l.next = newNode;<span class="comment">//将l的next指向新添加的元素</span></span><br><span class="line">    size++;<span class="comment">//记录元素个数+1;</span></span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt; &#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = element;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">        <span class="built_in">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>删除方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> E <span class="title function_">remove</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> removeFirst();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> E <span class="title function_">removeFirst</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; f = first;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoSuchElementException</span>();</span><br><span class="line">    <span class="keyword">return</span> unlinkFirst(f);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> E <span class="title function_">unlinkFirst</span><span class="params">(Node&lt;E&gt; f)</span> &#123;</span><br><span class="line">    <span class="comment">// assert f == first &amp;&amp; f != null;</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">E</span> <span class="variable">element</span> <span class="operator">=</span> f.item;</span><br><span class="line">    <span class="keyword">final</span> Node&lt;E&gt; next = f.next;</span><br><span class="line">    f.item = <span class="literal">null</span>;</span><br><span class="line">    f.next = <span class="literal">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    first = next;</span><br><span class="line">    <span class="keyword">if</span> (next == <span class="literal">null</span>)</span><br><span class="line">        last = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        next.prev = <span class="literal">null</span>;</span><br><span class="line">    size--;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="5-Vector"   >
          <a href="#5-Vector" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Vector" class="headerlink" title="5.Vector"></a>5.Vector</h4>
      
        <h5 id="1-介绍-1"   >
          <a href="#1-介绍-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍-1" class="headerlink" title="1.介绍"></a>1.介绍</h5>
      <ol>
<li>Vector是List接口的实现类</li>
<li>Vector底层是一个对象数组Object[]存储</li>
<li>操作方法有 synchronized,线程同步,线程安全(意味着效率低)</li>
<li>开发中如果需要线程同步安全,考虑使用Vector</li>
</ol>

        <h5 id="2-与ArrayList比较"   >
          <a href="#2-与ArrayList比较" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-与ArrayList比较" class="headerlink" title="2.与ArrayList比较"></a>2.与ArrayList比较</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210529143432107.png" alt="image-20210529143432107"></p>

        <h5 id="3-源码分析-1"   >
          <a href="#3-源码分析-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码分析-1" class="headerlink" title="3.源码分析"></a>3.源码分析</h5>
      <p>构造方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">Vector</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Vector</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(initialCapacity, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Vector</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">int</span> capacityIncrement)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal Capacity: &quot;</span>+</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="built_in">this</span>.elementData = <span class="keyword">new</span> <span class="title class_">Object</span>[initialCapacity];</span><br><span class="line">    <span class="built_in">this</span>.capacityIncrement = capacityIncrement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>添加方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    add(e, elementData, elementCount);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(E e, Object[] elementData, <span class="type">int</span> s)</span> &#123;<span class="comment">//添加方法</span></span><br><span class="line">    <span class="keyword">if</span> (s == elementData.length) <span class="comment">// 若当前数组元素个数等于数组长度</span></span><br><span class="line">        elementData = grow();<span class="comment">//进行扩容</span></span><br><span class="line">    elementData[s] = e;<span class="comment">//添加元素</span></span><br><span class="line">    elementCount = s + <span class="number">1</span>; <span class="comment">//添加元素后数组中元素的个数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>扩容</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Object[] grow() &#123;</span><br><span class="line">    <span class="keyword">return</span> grow(elementCount + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> Object[] grow(<span class="type">int</span> minCapacity) &#123;</span><br><span class="line">    <span class="type">return</span> <span class="variable">elementData</span> <span class="operator">=</span> Arrays.copyOf(elementData,</span><br><span class="line">                                       newCapacity(minCapacity));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">newCapacity</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> elementData.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + ((capacityIncrement &gt; <span class="number">0</span>) ?</span><br><span class="line">                                     capacityIncrement : oldCapacity);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OutOfMemoryError</span>();</span><br><span class="line">        <span class="keyword">return</span> minCapacity;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (newCapacity - MAX_ARRAY_SIZE &lt;= <span class="number">0</span>)</span><br><span class="line">        ? newCapacity</span><br><span class="line">        : hugeCapacity(minCapacity);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">hugeCapacity</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OutOfMemoryError</span>();</span><br><span class="line">    <span class="keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?</span><br><span class="line">        Integer.MAX_VALUE :</span><br><span class="line">    MAX_ARRAY_SIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h3 id="5-Set"   >
          <a href="#5-Set" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Set" class="headerlink" title="5.Set"></a>5.Set</h3>
      
        <h4 id="1-概述-1"   >
          <a href="#1-概述-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-概述-1" class="headerlink" title="1.概述"></a>1.概述</h4>
      <ol>
<li>无序(添加和取出顺序不一致),没有索引</li>
<li>不允许重复元素,只有一个null</li>
</ol>
<ul>
<li><p>无序性</p>
<p>不等于随机性,存储的数据在底层中并非按照索引顺序添加,而是根据数据的哈希值决定</p>
</li>
<li><p>不可重复性</p>
<p>添加不能重复,本质上仍为equals判断,但是会需要Hashcode方法</p>
</li>
</ul>

        <h4 id="2-常用方法-1"   >
          <a href="#2-常用方法-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-1" class="headerlink" title="2.常用方法"></a>2.常用方法</h4>
      <p>和List接口一样,Set接口也是Collection的子接口,因此常用方法和collection接口一样</p>

        <h4 id="3-遍历"   >
          <a href="#3-遍历" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-遍历" class="headerlink" title="3.遍历"></a>3.遍历</h4>
      <ol>
<li>可以使用迭代器</li>
<li>增强for</li>
</ol>
<p>不能使用索引的方式来获取</p>

        <h4 id="4-HashSet"   >
          <a href="#4-HashSet" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-HashSet" class="headerlink" title="4.HashSet"></a>4.HashSet</h4>
      
        <h5 id="1-说明"   >
          <a href="#1-说明" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明" class="headerlink" title="1.说明"></a>1.说明</h5>
      <p>HashSet是 Set接口的典型实现，大多数时候使用Set集合时都使用这个实现类。HashSet按 Hash 算法来存储集合中的元素，因此具有很好的存取、查找、删除性能。<br>HashSet具有以下特点:</p>
<ol>
<li>不能保证元素的排列顺序</li>
<li>HashSet不是线程安全的</li>
<li>集合元素可以是null</li>
</ol>
<p>HashSet集合判断两个元素相等的标准:两个对象通过hashCode()方法比较相等，并且两个对象的equals()方法返回值也相等。<br>对于存放在Set容器中的对象，对应的类一定要重写equals()和hashCode(Objectobj)方法，以实现对象相等规则。即:“相等的对象必须具有相等的散列码”。</p>
<ol>
<li><p>HashSet是Set接口的实现</p>
</li>
<li><p>HashSet底层实际上是HashMap,HashMap的底层(数组+链表+红黑树)</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">()</span> &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>可以存放null值,但只能有一个(不可重复)</p>
</li>
<li><p>HashSet不保证元素是有序的,取决于hash后,再确定索引的结果(即不保证存放的元素的顺序与取出元素的顺序一致)</p>
</li>
<li><p>不能有重复元素&#x2F;对象</p>
</li>
</ol>
<p>扩容步骤</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.HashSet底层是HashMap</span><br><span class="line">2.添加一个元素时，先得到<span class="built_in">hash</span>值-会转成-&gt;索引值</span><br><span class="line">3.找到存储数据表table,看这个索引位置是否已经存放的有元素</span><br><span class="line">4.如果没有，直接加入</span><br><span class="line">5.如果有，调用equals比较，如果相同，就放弃添加,如果不相同，则添加到最后</span><br><span class="line">6.在Java8中,如果一条链表的元素个数超过TREEIFY_THRESHOLD(默认是8)，并且table的大小&gt;=MIN TREEIFY CAPACITY(默认64)就会进行树化(红黑树)</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tSet.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashSet01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HashSet</span> <span class="variable">hashSet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashSet</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.out.println(hashSet.add(&quot;john&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(hashSet.add(&quot;john&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(hashSet.add(&quot;lucy&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(hashSet.add(&quot;jack&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(hashSet.add(&quot;Rose&quot;));</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        System.out.println(hashSet.remove(&quot;john&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;set=&quot;+hashSet);</span></span><br><span class="line">        hashSet.add(<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        hashSet.add(<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        hashSet.add(<span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;tom&quot;</span>));</span><br><span class="line">        hashSet.add(<span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;tom&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;set=&quot;</span>+hashSet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Dog</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Dog&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) o;</span><br><span class="line">        <span class="keyword">return</span> Objects.equals(name, dog.name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="2-特点-1"   >
          <a href="#2-特点-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-1" class="headerlink" title="2.特点"></a>2.特点</h5>
      <ol>
<li>不能保证元素的排列顺序</li>
<li>HashSet不是线程安全的</li>
<li>集合元素可以是null(因为set中的元素不能重复,所以其至多只能有一个)</li>
</ol>
<p>作为Set接口的主要实现类;线程不安全;可以存储null,底层是数组</p>

        <h5 id="3-源码分析-2"   >
          <a href="#3-源码分析-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码分析-2" class="headerlink" title="3.源码分析"></a>3.源码分析</h5>
      <p>运行以下示例分析</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tSet.sHashSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashSetSource</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HashSet</span> <span class="variable">hashset</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashSet</span>();</span><br><span class="line">        hashset.add(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">        hashset.add(<span class="string">&quot;php&quot;</span>);</span><br><span class="line">        hashset.add(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;set=&quot;</span>+hashset);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h6 id="1-构造方法"   >
          <a href="#1-构造方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法" class="headerlink" title="1.构造方法"></a>1.构造方法</h6>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">()</span> &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h6 id="2-add方法"   >
          <a href="#2-add方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-add方法" class="headerlink" title="2.add方法"></a>2.add方法</h6>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Dummy value to associate with an Object in the backing Map</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">PRESENT</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123; <span class="comment">//e=&quot;java&quot;</span></span><br><span class="line">    <span class="keyword">return</span> map.put(e, PRESENT)==<span class="literal">null</span>;<span class="comment">//present HashSet中的一个对象,占位意义,因为使用的是map 需要有K-V键值对,HashSet存入的值是为Key值,而Value值不存在,即用一个创建的final对象来占位</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123; <span class="comment">//key 为传入的e value = PRESENT</span></span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//put中的hash函数</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);<span class="comment">//key的hash值与其无符号右移16位的异或操作 ^    </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//put中的putVal函数</span></span><br><span class="line"><span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent,</span></span><br><span class="line"><span class="params">               <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="type">int</span> n, i;<span class="comment">//定义了辅助变量</span></span><br><span class="line">    <span class="comment">//transient Node&lt;K,V&gt;[] table; Node结点的数组,table为HashMap的属性</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>)<span class="comment">//初始为空或者长度为0</span></span><br><span class="line">        <span class="comment">//resize为重新判别table,第一次扩容为16</span></span><br><span class="line">        n = (tab = resize()).length;<span class="comment">//获取tab的长度,初始为16</span></span><br><span class="line">    <span class="comment">/*根据table的长度,与key得到的hash值计算应该存放到table的哪个索引位置</span></span><br><span class="line"><span class="comment">    	并发这个位置的对象赋值给P</span></span><br><span class="line"><span class="comment">    	如果p==null,表示这个位置没有存放过元素,直接存放进入即可</span></span><br><span class="line"><span class="comment">    	newNode(hash, key, value, null); 存入hash值,来判断之后需要存入该索引的元素与之前的元素hash值相不相同,若相同,则比较key值,若key值也相同,则不存入</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="literal">null</span>) </span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;<span class="comment">//若tab[i]中存在元素</span></span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">//如果p的hash值等于传入的值的hash值</span></span><br><span class="line">        <span class="comment">//p为当前索引位置的第一个元素</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">           <span class="comment">//p.key值等于传入的key值或者key不为空并且key调用equals方法与p的key值比较为真</span></span><br><span class="line">            ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p; <span class="comment">//使e等于p</span></span><br><span class="line">        <span class="comment">//若头结点不是一样的元素,再判断p是不是一棵红黑树</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            <span class="comment">//红黑树</span></span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;<span class="comment">//是一个链表</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;<span class="comment">//如果e为空,即p的下一个结点为空</span></span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="literal">null</span>);<span class="comment">//添加上新的元素</span></span><br><span class="line">                    <span class="comment">//TREEIFY_THRESHOLD 树化的临界值8</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);<span class="comment">//如果binCount大于等于临界值,进行树化</span></span><br><span class="line">                    <span class="comment">//转化为红黑树,注意进行树化时会判断tab的长度,小于64的话会进行扩容,大于等于64则会先扩容</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//与第一个元素的比较相同</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">//若e元素与要加入的元素不相同</span></span><br><span class="line">                p = e;<span class="comment">//p=e进行下一次循环</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果e不为null,即存在了该key在map中</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123; <span class="comment">// existing mapping for key  </span></span><br><span class="line">            <span class="comment">// 将e.value值赋值给oldValue 即Present</span></span><br><span class="line">            <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;<span class="comment">//返回present</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)<span class="comment">//size记录当前元素的个数,threshold:记算的需要扩容的临界值</span></span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);<span class="comment">//HashMap留下的一个方法,在HashMap中使用为空函数,在LinkedHashMap中则有使用,</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">//返回空,代表成功</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//LinkedHashMap</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">afterNodeInsertion</span><span class="params">(<span class="type">boolean</span> evict)</span> &#123; <span class="comment">// possibly remove eldest</span></span><br><span class="line">    LinkedHashMap.Entry&lt;K,V&gt; first;</span><br><span class="line">    <span class="keyword">if</span> (evict &amp;&amp; (first = head) != <span class="literal">null</span> &amp;&amp; removeEldestEntry(first)) &#123;</span><br><span class="line">        <span class="type">K</span> <span class="variable">key</span> <span class="operator">=</span> first.key;</span><br><span class="line">        removeNode(hash(key), key, <span class="literal">null</span>, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>resize方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table; </span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCap</span> <span class="operator">=</span> (oldTab == <span class="literal">null</span>) ? <span class="number">0</span> : oldTab.length;<span class="comment">//oldTab为空返回0,否则返回length</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldThr</span> <span class="operator">=</span> threshold;</span><br><span class="line">    <span class="type">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The default initial capacity - MUST be a power of two.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;<span class="comment">//默认新的大小为16</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The load factor used when none specified in constructor.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//static final float DEFAULT_LOAD_FACTOR = 0.75f; 加载因子</span></span><br><span class="line">        newThr = (<span class="type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);<span class="comment">//计算临界值0.75*16=12</span></span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">float</span> <span class="variable">ft</span> <span class="operator">=</span> (<span class="type">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="type">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="type">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> <span class="title class_">Node</span>[newCap];<span class="comment">//新生成一个Node数组</span></span><br><span class="line">    table = newTab;<span class="comment">//将新的数组赋值给table</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="literal">null</span>) &#123;<span class="comment">//如果旧的table不为空</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="literal">null</span>) &#123;</span><br><span class="line">                oldTab[j] = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="literal">null</span>)</span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="built_in">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// preserve order</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="literal">null</span>, loTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="literal">null</span>, hiTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="literal">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="literal">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h6 id="3-扩容说明"   >
          <a href="#3-扩容说明" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-扩容说明" class="headerlink" title="3.扩容说明"></a>3.扩容说明</h6>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. HashSet底层是HashMap,第一次添加时,table 数组扩容到16，临界值(threshold)是16*加载因子(loadFactor)是0.75 = 12,如果table数组使用到了临界值12,就会扩容到16*2 =32,新的临界值就是32*0.75 = 24,依次类推</span><br><span class="line">2.在Java8中,如果一条链表的元素个数到达TREEIFYTHRESHOLD(默认是8),并且table的大小&gt;=MIN TREEIFY CAPACITY(默认64),就会进行树化(红黑树)，否则仍然采用数组扩容机制</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="4-总结"   >
          <a href="#4-总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结" class="headerlink" title="4.总结"></a>4.总结</h5>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">我们向HashSet中添加元素a,首先调用元素α所在类的hashCode()方法，计算元素a的哈希值，此哈希值接着通过某种算法计算出在HashSet底层数组中的存放位置（即为:索引位置)，判断数组此位置上是否已经有元素:</span><br><span class="line">	如果此位置上没有其他元素，则元素α添加成功。---&gt;情况1</span><br><span class="line">	如果此位置上有其他元素b(或以链表形式存在的多个元素)，则比较元素a与元素b的<span class="built_in">hash</span>值</span><br><span class="line">		如果<span class="built_in">hash</span>值不相同，则元素α添加成功。---&gt;情况2</span><br><span class="line">		如果<span class="built_in">hash</span>值相同，进而需要调用元素α所在类的equlas()方法:</span><br><span class="line">			equals(( )返回<span class="literal">true</span>,元素a添加失败</span><br><span class="line">			equals()返回<span class="literal">false</span>，则元素a添加成功。---&gt;情况2</span><br><span class="line">对于添加成功的情况2和情况3而言:元素α与已经存在指定索引位置上数据以链表的方式存储。</span><br><span class="line">jdk 7 :元素a放到数组中，指向原来的元素。</span><br><span class="line">jdk 8 ∶原来的元素在数组中，指向元素d</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210605124946225.png" alt="image-20210605124946225"></p>

        <h4 id="5-LinkedHashSet"   >
          <a href="#5-LinkedHashSet" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-LinkedHashSet" class="headerlink" title="5.LinkedHashSet"></a>5.LinkedHashSet</h4>
      
        <h5 id="1-说明-1"   >
          <a href="#1-说明-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-1" class="headerlink" title="1.说明"></a>1.说明</h5>
      <ol>
<li>LinkedHashSet 是 HashSet的子类</li>
<li>LinkedHashSet底层是一个 LinkedHashMap，底层维护了一个数组+双向链表</li>
<li>LinkedHashSet根据元素的hashCode值来决定元素的存储位置,同时使用链表维护元素的次序(图)，这使得元素看起来是以插入顺序保存的。</li>
<li>LinkedHashSet 不允许添重复元素</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210605165836902.png" alt="image-20210605165836902"></p>

        <h5 id="2-特点-2"   >
          <a href="#2-特点-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-2" class="headerlink" title="2.特点"></a>2.特点</h5>
      <ol>
<li><p>添加顺序与取出顺序一致(双向链表)</p>
</li>
<li><p>元素不能重复</p>
</li>
<li><p>LinkedHashSet底层维护的是LinkedHashMap(是HashMap的子类)</p>
</li>
<li><p>LinkedHashSet 底层结构(数组table+双向链表),数组中存入的元素为Entry而不是Node,第一次添加会扩容到16 ,数组是HashMap&amp;Node[],但是存放的元素为LinkedHashMap&amp;Entry类型</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//静态内部类</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Entry</span>&lt;K,V&gt; <span class="keyword">extends</span> <span class="title class_">HashMap</span>.Node&lt;K,V&gt; &#123;</span><br><span class="line">    Entry&lt;K,V&gt; before, after;</span><br><span class="line">    Entry(<span class="type">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="built_in">super</span>(hash, key, value, next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h5 id="3-源码"   >
          <a href="#3-源码" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码" class="headerlink" title="3.源码"></a>3.源码</h5>
      
        <h5 id="4-总结-1"   >
          <a href="#4-总结-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结-1" class="headerlink" title="4.总结"></a>4.总结</h5>
      <ul>
<li><code>HashSet</code>的linked:遍历的时候会按照添加顺序进行</li>
<li><code>HashSet</code>子类</li>
</ul>
<p>双向链表</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210205170023114.png" alt="image-20210205170023114"></p>

        <h4 id="6-TreeSet"   >
          <a href="#6-TreeSet" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-TreeSet" class="headerlink" title="6.TreeSet"></a>6.TreeSet</h4>
      
        <h5 id="1-说明-2"   >
          <a href="#1-说明-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-2" class="headerlink" title="1.说明"></a>1.说明</h5>
      <p>●TreeSet是SortedSet接口的实现类，TreeSet 可以确保集合元素处于排序状态。<br>●TreeSet底层使用红黑树结构存储数据<br>●新增的方法如下: (了 解)<br>➢Comparator comparator()<br>➢Object first()<br>➢Object last()<br>➢Object lower(Object e)<br>➢Object higher(Object e)<br>➢SortedSet subSet(fromElement, toElement)<br>➢SortedSet headSet(toElement)<br>➢SortedSet tailSet(fromElement)<br>●TreeSet两种排序方法:自 然排序和定制排序。默认情况下，TreeSet 采用自然排序。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210205180331941.png" alt="image-20210205180331941"></p>

        <h5 id="2-特点-3"   >
          <a href="#2-特点-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-3" class="headerlink" title="2.特点"></a>2.特点</h5>
      <ul>
<li><p>可以按照添加对象的指定属性进行排序</p>
</li>
<li><p>不能添加null</p>
</li>
<li><p>指定属性:同一个类,相同类的对象才能进行比较</p>
</li>
</ul>

        <h5 id="3-源码-1"   >
          <a href="#3-源码-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码-1" class="headerlink" title="3.源码"></a>3.源码</h5>
      
        <h6 id="1-构造器"   >
          <a href="#1-构造器" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造器" class="headerlink" title="1.构造器"></a>1.构造器</h6>
      <p>底层使用的是TreeMap</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">TreeSet</span><span class="params">(Comparator&lt;? <span class="built_in">super</span> E&gt; comparator)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(<span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;(comparator));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">TreeMap</span><span class="params">(Comparator&lt;? <span class="built_in">super</span> K&gt; comparator)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.comparator = comparator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h6 id="2-add方法-1"   >
          <a href="#2-add方法-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-add方法-1" class="headerlink" title="2.add方法"></a>2.add方法</h6>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> m.put(e, PRESENT)==<span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    Entry&lt;K,V&gt; t = root;</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">null</span>) &#123;</span><br><span class="line">        compare(key, key); <span class="comment">// type (and possibly null) check</span></span><br><span class="line"></span><br><span class="line">        root = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;&gt;(key, value, <span class="literal">null</span>);</span><br><span class="line">        size = <span class="number">1</span>;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> cmp;</span><br><span class="line">    Entry&lt;K,V&gt; parent;</span><br><span class="line">    <span class="comment">// split comparator and comparable paths</span></span><br><span class="line">    Comparator&lt;? <span class="built_in">super</span> K&gt; cpr = comparator;<span class="comment">//获取传入的比较器,即匿名内部类</span></span><br><span class="line">    <span class="keyword">if</span> (cpr != <span class="literal">null</span>) &#123;<span class="comment">//比较器不为空</span></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = cpr.compare(key, t.key);<span class="comment">//调用compare方法排序</span></span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> t.setValue(value);</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">        Comparable&lt;? <span class="built_in">super</span> K&gt; k = (Comparable&lt;? <span class="built_in">super</span> K&gt;) key;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = k.compareTo(t.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> t.setValue(value); <span class="comment">//返回present 即比较为0不加入</span></span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Entry&lt;K,V&gt; e = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;&gt;(key, value, parent);</span><br><span class="line">    <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        parent.left = e;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        parent.right = e;</span><br><span class="line">    fixAfterInsertion(e);</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>示例</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tSet.tTreeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myTreeSet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//构造器传入一个比较器(匿名内部类),指定排序规则</span></span><br><span class="line">        TreeSet&lt;Object&gt; treeSet = <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Comparator</span>() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Object o1, Object o2)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> ((String) o1).compareTo((String) o2);</span><br><span class="line"><span class="comment">//                return ((String) o1).length()-((String) o2).length();</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        treeSet.add(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">        treeSet.add(<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        treeSet.add(<span class="string">&quot;why&quot;</span>);</span><br><span class="line">        treeSet.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;treeSet=&quot;</span>+treeSet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h5 id="4-使用"   >
          <a href="#4-使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-使用" class="headerlink" title="4.使用"></a>4.使用</h5>
      <ul>
<li><p>自然排序(即原先自己的排序)</p>
<p>实现Comparable接口</p>
<p>比较两个对象是否相同的标准为<code>compareTo()</code> 返回为0 ,而不采用equals</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210205174235117.png" alt="image-20210205174235117"></p>
</li>
<li><p>定制排序(自定义类)</p>
<p>使用<code>Comparator</code>类定制</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Comparator com=<span class="keyword">new</span> <span class="title class_">Comparator</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Object o1, Object o2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(o1 <span class="keyword">instanceof</span> Person &amp;&amp; o2 <span class="keyword">instanceof</span> Person)&#123;</span><br><span class="line">            Person p1=(Person) o1;</span><br><span class="line">            Person p2=(Person) o2;</span><br><span class="line">            <span class="keyword">return</span> Integer.compare(p1.getAge(),p2.getAge());</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span>  <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;输入类型不匹配&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">TreeSet</span> <span class="variable">Set</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeSet</span>(com);</span><br><span class="line">Set.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Tom&quot;</span>,<span class="number">13</span>));</span><br><span class="line">Set.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Jerry&quot;</span>,<span class="number">14</span>));</span><br><span class="line">Set.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Nick&quot;</span>,<span class="number">15</span>));</span><br><span class="line">Set.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Tommy&quot;</span>,<span class="number">16</span>));</span><br><span class="line">Set.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Tomm&quot;</span>,<span class="number">16</span>));</span><br><span class="line">Set.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Merry&quot;</span>,<span class="number">17</span>));</span><br><span class="line"><span class="type">Iterator</span> <span class="variable">iterator</span> <span class="operator">=</span> Set.iterator();</span><br><span class="line"><span class="keyword">while</span>(iterator.hasNext())&#123;</span><br><span class="line">    System.out.println(iterator.next());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h5 id="5-总结"   >
          <a href="#5-总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-总结" class="headerlink" title="5.总结"></a>5.总结</h5>
      <ul>
<li><p>可以按照添加对象的指定属性进行排序</p>
</li>
<li><p>指定属性:同一个类,相同类的对象才能进行比较</p>
</li>
</ul>

        <h2 id="4-Map"   >
          <a href="#4-Map" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Map" class="headerlink" title="4.Map"></a>4.Map</h2>
      
        <h3 id="1-说明-3"   >
          <a href="#1-说明-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-3" class="headerlink" title="1.说明"></a>1.说明</h3>
      <p>双列数据,保存具有映射关系”key-value对”的集合</p>
<ul>
<li><p>无序的,不可重复的,使用Set存储所有的entry</p>
</li>
<li><p>key:无序,不可重复,使用Set存储所有的key </p>
<p>key的类重写equals和hashcode方法(<code>HashMap</code>为例)</p>
</li>
<li><p>value:无序的,可重复的,使用collection存储所有的value</p>
<p>value的类要重写equals</p>
</li>
<li><p>Map:双列数据，存储key-value对的数据 —类似于高中的函数: y &#x3D; f(x)</p>
</li>
<li><p>HashMap:作为Map的主要实现类;线程不安全的，效率高;存储null的key和value</p>
<ul>
<li>L inkedHashMap:保证在遍历map元素时，可以按照添加的顺序实现遍历。<br>原因:在原有的HashMap 底层结构基础上，添加了一-对指针，指向前一一个和后一个元素。对于频繁的遍历操作，此类执行效率高于HashMap。</li>
</ul>
</li>
<li><p>TreeMap:保证按照添加的key-value对进行排序，实现排序遍历。此时考虑key的自然排序或定制排序,底层使用红黑树</p>
</li>
<li><p>Hashtable:作为古老的实现类;线程安全的，效率低;不能存储null的key value </p>
<ul>
<li>Properties:常用来处理配置文件。key和value都是String类型</li>
</ul>
</li>
</ul>
<p>HashMap的底层:数组+链表+红黑树(jdk 8) </p>

        <h3 id="2-特点-4"   >
          <a href="#2-特点-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-4" class="headerlink" title="2.特点"></a>2.特点</h3>
      <p>●Map接口实现类的特点[很实用]<br>注意:这里讲的是JDK8的Map接口特点Map java</p>
<ol>
<li><p>Map用于保存具有映射关系的数据:Key-Value (双列元素)</p>
</li>
<li><p>Map中的key和value可以是任何引用类型的数据，会封装到HashMap$Node对象中</p>
</li>
<li><p>Map中的key不允许重复，原因和HashSet 一样</p>
</li>
<li><p>Map中的value可以重复</p>
</li>
<li><p>Map的key可以为null, value也可以为null ,注意key为null,只能有一个,value为null可以多个</p>
</li>
<li><p>常用String类作为Map的key</p>
</li>
<li><p>key和value之间存在单向一对一关系，即通过指定的key总能找到对应的value </p>
</li>
<li><p>Map存放数据的key-value示意图,一对k-v是放在一个HashMap&amp;Node中的，有因为Node实现了Entry 接口，有些书上也说一对k-v就是一个Entry(如图)</p>
<p>k-v为Node</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210605223332262.png" alt="image-20210605223332262"></p>
<p>为了方便程序员遍历,还会创建EntrySet集合,该集合存放的元素的类型Entry,而一个Entry对象就有k,v,EntrySet&lt;Entry&lt;k,v&gt;&gt;</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210205184943824.png" alt="image-20210205184943824"></p>
<p>示例:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">mapSource</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;no1&quot;</span>,<span class="string">&quot;why&quot;</span>);<span class="comment">//k-v</span></span><br><span class="line">        map.put(<span class="string">&quot;no2&quot;</span>,<span class="string">&quot;张无忌&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;no1&quot;</span>,<span class="string">&quot;张三丰&quot;</span>); <span class="comment">//有相同的key时,就进行替换</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">set</span> <span class="operator">=</span> map.entrySet();</span><br><span class="line">        <span class="type">Set</span> <span class="variable">set1</span> <span class="operator">=</span> map.keySet();</span><br><span class="line">        <span class="type">Collection</span> <span class="variable">values</span> <span class="operator">=</span> map.values();</span><br><span class="line"><span class="comment">//        System.out.println(set.getClass());//HashMap$EntrySet</span></span><br><span class="line">        <span class="keyword">for</span> (Object o : set) &#123;</span><br><span class="line"><span class="comment">//            System.out.println(o.getClass());//HashMap$Node</span></span><br><span class="line">            <span class="comment">//为了从HashMap$Node取出k-v</span></span><br><span class="line">            <span class="comment">//1.先做向下转型</span></span><br><span class="line">            Map.<span class="type">Entry</span> <span class="variable">entry</span> <span class="operator">=</span> (Map.Entry) o;</span><br><span class="line">            System.out.println(entry.getKey()+<span class="string">&quot;-&quot;</span>+entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1.k-v是放在一个HashMap&amp;Node中的,p.next = newNode(hash, key, value, null);</span></span><br><span class="line"><span class="comment">         * 2.为了方便程序员遍历,还会创建EntrySet集合,该集合存放的元素的类型Entry,而一个Entry对象就有k,v,EntrySet&lt;Entry&lt;k,v&gt;&gt;</span></span><br><span class="line"><span class="comment">         * 即transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span></span><br><span class="line"><span class="comment">         * 3.entrySet中定义的类型为Map.Entry,但实际存放的是HashMap&amp;Node(实现的是Map.Entry接口)</span></span><br><span class="line"><span class="comment">         * 4.当把HashMap&amp;Node对象存放到entrySet就方便遍历,因为Map.Entry提供了getKey与getValue方法</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h3 id="3-常用方法"   >
          <a href="#3-常用方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-常用方法" class="headerlink" title="3.常用方法"></a>3.常用方法</h3>
      <p>添加、删除、修改操作:</p>
<ul>
<li>Object put(Object key,Object value):将指定key-value添加到(或修改)当前map对象中</li>
<li>void putAl(Map m):将m中的所有key-value对存放到当前map中</li>
<li>Object remove(Object key): 移除指定key的key-value对， 并返回value</li>
<li>void clear(): 清空当前map中的所有数据</li>
</ul>
<p>元素查询的操作:</p>
<ul>
<li>Object get(Object key):获取指定key对应的value</li>
<li>boolean containsKey(Object key):是否包含指定的key</li>
<li>boolean containsValue(Object value):是否包含指定的value	</li>
<li>int size(): 返回map中key-value对的个数</li>
<li>boolean isEmpty():判断当前map是否为空</li>
<li>boolean equals(Object obj):判断当前map和参数对象obj是否相等</li>
</ul>
<p>元视图操作的方法:</p>
<ul>
<li>Set keySet(): 返回所有key构成的Set集合</li>
<li>Collection values(): 返回所有value构成的Collection集合</li>
<li>Set entrySet(): 返回所有key-value对构成的Set集合</li>
</ul>

        <h3 id="4-Map遍历方式-六种"   >
          <a href="#4-Map遍历方式-六种" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Map遍历方式-六种" class="headerlink" title="4.Map遍历方式(六种)"></a>4.Map遍历方式(六种)</h3>
      <ol>
<li><p>entrySet()</p>
<p>用entry&lt;k,v&gt;存入Set集合中</p>
<p>可以使用</p>
<ul>
<li><p>增强for循环(向下转型) </p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">mapSource</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;no1&quot;</span>,<span class="string">&quot;why&quot;</span>);<span class="comment">//k-v</span></span><br><span class="line">        map.put(<span class="string">&quot;no2&quot;</span>,<span class="string">&quot;张无忌&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;no1&quot;</span>,<span class="string">&quot;张三丰&quot;</span>); <span class="comment">//有相同的key时,就进行替换</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">set</span> <span class="operator">=</span> map.entrySet();</span><br><span class="line">        <span class="type">Set</span> <span class="variable">set1</span> <span class="operator">=</span> map.keySet();</span><br><span class="line">        <span class="type">Collection</span> <span class="variable">values</span> <span class="operator">=</span> map.values();</span><br><span class="line"><span class="comment">//        System.out.println(set.getClass());//HashMap$EntrySet</span></span><br><span class="line">        <span class="keyword">for</span> (Object o : set) &#123;</span><br><span class="line"><span class="comment">//            System.out.println(o.getClass());//HashMap$Node</span></span><br><span class="line">            <span class="comment">//为了从HashMap$Node取出k-v</span></span><br><span class="line">            <span class="comment">//1.先做向下转型</span></span><br><span class="line">            Map.<span class="type">Entry</span> <span class="variable">entry</span> <span class="operator">=</span> (Map.Entry) o;</span><br><span class="line">            System.out.println(entry.getKey()+<span class="string">&quot;-&quot;</span>+entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1.k-v是放在一个HashMap&amp;Node中的,p.next = newNode(hash, key, value, null);</span></span><br><span class="line"><span class="comment">         * 2.为了方便程序员遍历,还会创建EntrySet集合,该集合存放的元素的类型Entry,而一个Entry对象就有k,v,EntrySet&lt;Entry&lt;k,v&gt;&gt;</span></span><br><span class="line"><span class="comment">         * 即transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span></span><br><span class="line"><span class="comment">         * 3.entrySet中定义的类型为Map.Entry,但实际存放的是HashMap&amp;Node(实现的是Map.Entry接口)</span></span><br><span class="line"><span class="comment">         * 4.当把HashMap&amp;Node对象存放到entrySet就方便遍历,因为Map.Entry提供了getKey与getValue方法</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>迭代器</p>
</li>
</ul>
</li>
<li><p>keySet()</p>
<p>取出所有的key,进行遍历,因为是Set集合</p>
<p>可以使用</p>
<ul>
<li>增强for循环</li>
<li>迭代器</li>
</ul>
</li>
<li><p>values()</p>
<p>取出所有的values进行遍历,因为是Collection集合</p>
<p>可以使用</p>
<ul>
<li>增强for循环</li>
<li>迭代器</li>
<li>索引</li>
</ul>
</li>
</ol>

        <h3 id="5-HashMap"   >
          <a href="#5-HashMap" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-HashMap" class="headerlink" title="5.HashMap"></a>5.HashMap</h3>
      
        <h4 id="1-说明-4"   >
          <a href="#1-说明-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-4" class="headerlink" title="1.说明"></a>1.说明</h4>
      <p>HashMap源码中的重要常量</p>
<blockquote>
<p>DEFAULT_ INITIAL_ CAPACITY : HashMap的默认容量，16</p>
<p>MAXIMUM_ CAPACITY : HashMap的最大支持容量， 2^30</p>
<p>DEFAULT_ LOAD_ FACTOR: HashMap的默认 加载因子</p>
<p>TREEIFY _THRESHOLD: Bucket中链表长度大于该默认值，转化为红黑树</p>
<p>UNTREEIFY_ <em>THRESHOLD: Bucket中 红黑树存储的Node小于该默认值，转化为链表</em></p>
<p>MIN_TREEIFY_CAPACITY:桶中的Node被树化时最小的hash表容量。( 当桶中Node的<br>数量大到需要变红黑树时，若hash表容量小于MIN_ TREEIFY_ <em>CAPACITY时，此时应执行resize扩容操作这个MIN</em> TREEIFY_ <em>CAPACITY 的值至少是TREEIFY</em> _THRESHOLD的4倍。)</p>
<p>table:存储元素的数组，总是2的n次幂</p>
<p>entrySet:存储具体元素的集</p>
<p>size: HashMap中存储的键值对的数量</p>
<p>modCount: HashMap扩 容和结构改变的次数。</p>
<p>threshold:扩容的临界值&#x3D;容量*填充因子</p>
<p>loadFactor:填充因子(加载因子)</p>
</blockquote>

        <h4 id="2-特点-5"   >
          <a href="#2-特点-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-5" class="headerlink" title="2.特点"></a>2.特点</h4>
      <ol>
<li>HashMap是Map接口使用频率最高的实现类。</li>
<li>HashMap是以key-val对的方式来存储数据[案例Entry ]</li>
<li>key不能重复，但是是值可以重复，允许使用null键和null值。</li>
<li>如果添加相同的key ,则会覆盖原来的key-val ,等同于修改.(key不会替换，val会替换)</li>
<li>与HashSet一样，不保证映射的顺序，因为底层是以hash表的方式来存储的.</li>
<li>HashMap没有实现同步，因此是线程不安全的,不存在synchronized</li>
</ol>

        <h4 id="3-源码-2"   >
          <a href="#3-源码-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码-2" class="headerlink" title="3.源码"></a>3.源码</h4>
      
        <h5 id="1-扩容机制-1"   >
          <a href="#1-扩容机制-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-扩容机制-1" class="headerlink" title="1.扩容机制"></a>1.扩容机制</h5>
      <ol>
<li>HashMap底层维护了Node类型的数组table,默认为null</li>
<li>当创建对象时，将&#x3D;&#x3D;加载因子(loadfactor)&#x3D;&#x3D;初始化为0.75.</li>
<li>当添加key-val时，通过&#x3D;&#x3D;key的哈希值&#x3D;&#x3D;得到在table的索引。然后判断该索引处是否有元素，<br>如果没有元素直接添加。如果该索引处有元素，继续判断该元素的key是否和准备加入的<br>key相等，如果相等，则直接替换val;如果不相等需要判断是树结构还是链表结构，做出<br>相应处理。如果添加时发现容量不够，则需要扩容。</li>
<li>第1次添加，则需要扩容table容量为16,临界值(threshold)为12.</li>
<li>以后再扩容，则需要扩容table容量为原来的2倍，临界值为原来的2倍,即24,依次类推.</li>
<li>在Java8中，如果一条链表的元素个数不小于TREEIFY THRESHOLD(默认是8 )，并且table的大小&gt;&#x3D; MIN TREEIFY CAPACITY(默认64),就会进行树化(红黑树)</li>
</ol>

        <h5 id="2-put方法"   >
          <a href="#2-put方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-put方法" class="headerlink" title="2.put方法"></a>2.put方法</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123; <span class="comment">//key value 为传入的</span></span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//put中的hash函数</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);<span class="comment">//key的hash值与其无符号右移16位的异或操作 ^    </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//put中的putVal函数</span></span><br><span class="line"><span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent,</span></span><br><span class="line"><span class="params">               <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="type">int</span> n, i;<span class="comment">//定义了辅助变量</span></span><br><span class="line">    <span class="comment">//transient Node&lt;K,V&gt;[] table; Node结点的数组,table为HashMap的属性</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>)<span class="comment">//初始为空或者长度为0</span></span><br><span class="line">        <span class="comment">//resize为重新判别table,第一次扩容为16</span></span><br><span class="line">        n = (tab = resize()).length;<span class="comment">//获取tab的长度,初始为16</span></span><br><span class="line">    <span class="comment">/*根据table的长度,与key得到的hash值计算应该存放到table的哪个索引位置</span></span><br><span class="line"><span class="comment">    	并发这个位置的对象赋值给P</span></span><br><span class="line"><span class="comment">    	如果p==null,表示这个位置没有存放过元素,直接存放进入即可</span></span><br><span class="line"><span class="comment">    	newNode(hash, key, value, null); 存入hash值,来判断之后需要存入该索引的元素与之前的元素hash值相不相同,若相同,则比较key值,若key值也相同,则不存入</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="literal">null</span>) </span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;<span class="comment">//若tab[i]中存在元素</span></span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">//如果p的hash值等于传入的值的hash值</span></span><br><span class="line">        <span class="comment">//p为当前索引位置的第一个元素</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">           <span class="comment">//p.key值等于传入的key值或者key不为空并且key调用equals方法与p的key值比较为真</span></span><br><span class="line">            ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p; <span class="comment">//使e等于p</span></span><br><span class="line">        <span class="comment">//若头结点不是一样的元素,再判断p是不是一棵红黑树</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            <span class="comment">//红黑树</span></span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;<span class="comment">//是一个链表</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;<span class="comment">//如果e为空,即p的下一个结点为空</span></span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="literal">null</span>);<span class="comment">//添加上新的元素</span></span><br><span class="line">                    <span class="comment">//TREEIFY_THRESHOLD 树化的临界值8</span></span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);<span class="comment">//如果binCount大于等于临界值,进行树化</span></span><br><span class="line">                    <span class="comment">//转化为红黑树,注意进行树化时会判断tab的长度,小于64的话会进行扩容,大于等于64则会先扩容</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//与第一个元素的比较相同</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">//若e元素与要加入的元素不相同</span></span><br><span class="line">                p = e;<span class="comment">//p=e进行下一次循环</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果e不为null,即存在了该key在map中</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123; <span class="comment">// existing mapping for key  </span></span><br><span class="line">            <span class="comment">// 将e.value值赋值给oldValue 即Present</span></span><br><span class="line">            <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>)</span><br><span class="line">                e.value = value; <span class="comment">//将value值覆盖原来的value值</span></span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;<span class="comment">//返回present</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)<span class="comment">//size记录当前元素的个数,threshold:记算的需要扩容的临界值</span></span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);<span class="comment">//HashMap留下的一个方法,在HashMap中使用为空函数,在LinkedHashMap中则有使用,</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">//返回空,代表成功</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h5 id="3-resize方法"   >
          <a href="#3-resize方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-resize方法" class="headerlink" title="3.resize方法"></a>3.resize方法</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table; </span><br><span class="line">    <span class="comment">//oldTab为空返回0,否则返回length</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCap</span> <span class="operator">=</span> (oldTab == <span class="literal">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="comment">//记录旧的临界值</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldThr</span> <span class="operator">=</span> threshold;</span><br><span class="line">    <span class="comment">//定义新的table长度与临界值为0</span></span><br><span class="line">    <span class="type">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//如果旧table长度大于0</span></span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//如果旧长度大于HashMap支持的最大容量</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            <span class="comment">//临界值为Integer的最大值</span></span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="comment">//返回旧table</span></span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">       <span class="comment">//如果新长度(旧长度的两倍)小于HashMap支持的最大容量并且旧长度大于默认初始化值(16)</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            <span class="comment">//临界值扩展为原来的两倍</span></span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults </span></span><br><span class="line">    <span class="comment">//static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;<span class="comment">//默认新的大小为16</span></span><br><span class="line">    <span class="comment">//static final float DEFAULT_LOAD_FACTOR = 0.75f; 加载因子</span></span><br><span class="line">        <span class="comment">//计算临界值0.75*16=12</span></span><br><span class="line">        newThr = (<span class="type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//如果临界值为0</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">float</span> <span class="variable">ft</span> <span class="operator">=</span> (<span class="type">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="type">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="type">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;<span class="comment">//将新的临界值赋值给threshold</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> <span class="title class_">Node</span>[newCap];<span class="comment">//新生成一个Node数组</span></span><br><span class="line">    table = newTab;<span class="comment">//将新的数组赋值给table</span></span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="literal">null</span>) &#123;<span class="comment">//如果旧的table不为空</span></span><br><span class="line">        <span class="comment">//重新将旧数组中的值赋值给新的数组</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="literal">null</span>) &#123;<span class="comment">//赋值给e,如果该索引位置不为null</span></span><br><span class="line">                <span class="comment">//将该索引位置设为空</span></span><br><span class="line">                oldTab[j] = <span class="literal">null</span>;</span><br><span class="line">                <span class="comment">//如果e.next为空</span></span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="literal">null</span>)</span><br><span class="line">                    <span class="comment">//直接赋值给新的table[重新计算索引位置]</span></span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)<span class="comment">//如果是树</span></span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="built_in">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// 为链表</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="literal">null</span>, loTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="literal">null</span>, hiTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="literal">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="literal">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;<span class="comment">//返回新的table</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h5 id="4-树化treeifyBin"   >
          <a href="#4-树化treeifyBin" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-树化treeifyBin" class="headerlink" title="4.树化treeifyBin"></a>4.树化treeifyBin</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">treeifyBin</span><span class="params">(Node&lt;K,V&gt;[] tab, <span class="type">int</span> hash)</span> &#123;</span><br><span class="line">    <span class="type">int</span> n, index; Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="comment">//如果tab为空或者table的长度&lt;最小的树化临界值64</span></span><br><span class="line">    <span class="keyword">if</span> (tab == <span class="literal">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)</span><br><span class="line">        resize();<span class="comment">//进行扩容</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ((e = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="literal">null</span>) &#123;</span><br><span class="line">        TreeNode&lt;K,V&gt; hd = <span class="literal">null</span>, tl = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">if</span> (tl == <span class="literal">null</span>)</span><br><span class="line">                hd = p;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                p.prev = tl;</span><br><span class="line">                tl.next = p;</span><br><span class="line">            &#125;</span><br><span class="line">            tl = p;</span><br><span class="line">        &#125; <span class="keyword">while</span> ((e = e.next) != <span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">if</span> ((tab[index] = hd) != <span class="literal">null</span>)</span><br><span class="line">            hd.treeify(tab);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="4-总结-2"   >
          <a href="#4-总结-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结-2" class="headerlink" title="4.总结"></a>4.总结</h4>
      
        <h5 id="1-底层机制"   >
          <a href="#1-底层机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-底层机制" class="headerlink" title="1.底层机制"></a>1.底层机制</h5>
      <ol>
<li>(k,v)是一个Node 实现了Map.Entry&lt;K,V&gt;</li>
<li>jdk7.0的HashMap底层实现为[数组+链表],8.0为[数组+链表+红黑树]</li>
</ol>

        <h5 id="2-说明"   >
          <a href="#2-说明" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-说明" class="headerlink" title="2.说明:"></a>2.说明:</h5>
      <ol>
<li>HashMap是Map接口使用频率最高的实现类。</li>
<li>允许使用null键和Inull值，与HashSet一样，不保证映射的顺序。</li>
<li>所有的key构成的集合是Set:无序的、不可重复的。所以，key所在的类要重写:equals()和hashCode()</li>
<li>所有的value构成的集合是Collection:无序的、可以重复的。所以，value所在的类<br>要重写: equals() &#x3D;&#x3D;(待考证)&#x3D;&#x3D; (无用)</li>
<li>一个key-value构成一个entry</li>
<li>所有的entry构成的集合是Set:无序的、不可重复的</li>
<li>HashMap判断两个key相等的标准是:两个key通过equals()方法返回true,hashCode值也相等。</li>
<li>HashMap判断两个value相等的标准是:两个value通过equals()方法返回true。</li>
</ol>
<p>底层原理</p>
<p>扩容使用率0.75 * 16      不小于临界值12且添加的位置为非空时进行扩容</p>
<p>jdk7:</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210205235319807.png" alt="image-20210205235319807"></p>
<p>jdk8:</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210206000627123.png" alt="image-20210206000627123"></p>

        <h3 id="6-HashTable"   >
          <a href="#6-HashTable" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-HashTable" class="headerlink" title="6.HashTable"></a>6.HashTable</h3>
      
        <h4 id="1-说明-5"   >
          <a href="#1-说明-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-5" class="headerlink" title="1.说明"></a>1.说明</h4>
      <ol>
<li>存放的元素是键值对:即K-V</li>
<li>hashtable的键和值都不能为null</li>
<li>hashTable使用方法基本上和HashMap-样</li>
<li>hashTable是线程安全的，hashMap是线程不安全的</li>
<li>底层是数组HashTable$Entry[] 初始大小为11</li>
<li></li>
</ol>

        <h4 id="2-特点-6"   >
          <a href="#2-特点-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-6" class="headerlink" title="2.特点"></a>2.特点</h4>
      <ol>
<li>hashtable的键和值都不能为null</li>
<li>hashTable使用方法基本上和HashMap-样</li>
<li>hashTable是线程安全的，hashMap是线程不安全的</li>
</ol>

        <h4 id="3-源码-3"   >
          <a href="#3-源码-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码-3" class="headerlink" title="3.源码"></a>3.源码</h4>
      
        <h5 id="1-构造"   >
          <a href="#1-构造" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造" class="headerlink" title="1.构造"></a>1.构造</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">Hashtable</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)<span class="comment">//不带参,为11</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal Capacity: &quot;</span>+</span><br><span class="line">                                           initialCapacity);</span><br><span class="line">    <span class="comment">//0.75</span></span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Illegal Load: &quot;</span>+loadFactor);</span><br><span class="line">	<span class="comment">//如果初始化的长度为0,默认为1</span></span><br><span class="line">    <span class="keyword">if</span> (initialCapacity==<span class="number">0</span>)</span><br><span class="line">        initialCapacity = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//将加载因子赋值</span></span><br><span class="line">    <span class="built_in">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="comment">//new一个Entry数组</span></span><br><span class="line">    table = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;?,?&gt;[initialCapacity];</span><br><span class="line">    <span class="comment">//临界值为 初始化长度*加载因子与</span></span><br><span class="line">    <span class="comment">//private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span></span><br><span class="line">    <span class="comment">//中的最小值</span></span><br><span class="line">    threshold = (<span class="type">int</span>)Math.min(initialCapacity * loadFactor, MAX_ARRAY_SIZE + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h5 id="2-put方法-1"   >
          <a href="#2-put方法-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-put方法-1" class="headerlink" title="2.put方法"></a>2.put方法</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="comment">// Make sure the value is not null</span></span><br><span class="line">    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123; <span class="comment">//value为null抛出异常</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Makes sure the key is not already in the hashtable.</span></span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="type">int</span> <span class="variable">hash</span> <span class="operator">=</span> key.hashCode();</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    Entry&lt;K,V&gt; entry = (Entry&lt;K,V&gt;)tab[index];</span><br><span class="line">    <span class="keyword">for</span>(; entry != <span class="literal">null</span> ; entry = entry.next) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((entry.hash == hash) &amp;&amp; entry.key.equals(key)) &#123;</span><br><span class="line">            <span class="type">V</span> <span class="variable">old</span> <span class="operator">=</span> entry.value;</span><br><span class="line">            entry.value = value;</span><br><span class="line">            <span class="keyword">return</span> old;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    addEntry(hash, key, value, index);<span class="comment">//添加Entry</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addEntry</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="keyword">if</span> (count &gt;= threshold) &#123;<span class="comment">//如果count数目大于等于临界值</span></span><br><span class="line">        <span class="comment">// Rehash the table if the threshold is exceeded</span></span><br><span class="line">        rehash();</span><br><span class="line"></span><br><span class="line">        tab = table;</span><br><span class="line">        hash = key.hashCode();</span><br><span class="line">        index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;<span class="comment">//hash值与7FFFFFFF进行与操作与tab的长度取余</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Creates the new entry.</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;) tab[index];</span><br><span class="line">    tab[index] = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;&gt;(hash, key, value, e);</span><br><span class="line">    count++;</span><br><span class="line">    modCount++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h5 id="3-扩容"   >
          <a href="#3-扩容" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-扩容" class="headerlink" title="3.扩容"></a>3.扩容</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//扩容</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">rehash</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> table.length;<span class="comment">//记录旧table的长度</span></span><br><span class="line">    Entry&lt;?,?&gt;[] oldMap = table;<span class="comment">//记录旧table</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> (oldCapacity &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>; <span class="comment">//新长度为旧长度的两倍+1</span></span><br><span class="line">    <span class="comment">//如果新长度-最大值&gt;0即超过了HashTable的最大容量</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//如果旧长度与最大容量相等</span></span><br><span class="line">        <span class="keyword">if</span> (oldCapacity == MAX_ARRAY_SIZE)</span><br><span class="line">            <span class="comment">// Keep running with MAX_ARRAY_SIZE buckets</span></span><br><span class="line">            <span class="comment">//直接退出继续执行</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//新长度为最大容量</span></span><br><span class="line">        newCapacity = MAX_ARRAY_SIZE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//新new一个新长度的Entry数组</span></span><br><span class="line">    Entry&lt;?,?&gt;[] newMap = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;?,?&gt;[newCapacity];</span><br><span class="line"></span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">//计算新的临界值</span></span><br><span class="line">    threshold = (<span class="type">int</span>)Math.min(newCapacity * loadFactor, MAX_ARRAY_SIZE + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//table=新的数组</span></span><br><span class="line">    table = newMap;</span><br><span class="line">	<span class="comment">//将旧的数组中的值赋值到新的数组中</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> oldCapacity ; i-- &gt; <span class="number">0</span> ;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; old = (Entry&lt;K,V&gt;)oldMap[i] ; old != <span class="literal">null</span> ; ) &#123;</span><br><span class="line">            Entry&lt;K,V&gt; e = old;</span><br><span class="line">            old = old.next;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> (e.hash &amp; <span class="number">0x7FFFFFFF</span>) % newCapacity;</span><br><span class="line">            e.next = (Entry&lt;K,V&gt;)newMap[index];</span><br><span class="line">            newMap[index] = e;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="4-总结-3"   >
          <a href="#4-总结-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结-3" class="headerlink" title="4.总结"></a>4.总结</h4>
      
        <h4 id="5-与HashMap比较"   >
          <a href="#5-与HashMap比较" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-与HashMap比较" class="headerlink" title="5.与HashMap比较"></a>5.与HashMap比较</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210606182905357.png" alt="image-20210606182905357"></p>

        <h3 id="7-Properties"   >
          <a href="#7-Properties" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-Properties" class="headerlink" title="7.Properties"></a>7.Properties</h3>
      
        <h4 id="1-说明-6"   >
          <a href="#1-说明-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-6" class="headerlink" title="1.说明"></a>1.说明</h4>
      <ol>
<li><p>Properties类继承自Hashtable类并且实现了Map接口， 也是使用一种键值对的形式来保存数据。</p>
</li>
<li><p>他的使用特点和Hashtable类似</p>
</li>
<li><p>Properties 还可以用于从xx.properties文件中，加载数据到Properties类对象，并进行读取和修改</p>
</li>
<li><p>说明:工作后xx.properties 文件通常作为配置文件，这个知识点在IO流举例</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210606194842545.png" alt="image-20210606194842545"></p>
</li>
</ol>
<ul>
<li><p>Properties类是Hashtable的子类，该对象用于处理属性文件</p>
</li>
<li><p>由于属性文件里的key、value 都是字符串类型，所以Properties里的key和value都是字符串类型</p>
</li>
<li><p>存取数据时，建议使用setProperty(String key,String value)方法和getProperty(String key)方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Properties</span> <span class="variable">pros</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">pros.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;jdbc.properties&quot;</span>));</span><br><span class="line"><span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> pros. getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">System.out.println(user);</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h4 id="2-特点-7"   >
          <a href="#2-特点-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-7" class="headerlink" title="2.特点"></a>2.特点</h4>
      <ol>
<li>继承HashTable,K与V不能为null</li>
<li>存在getProperty方法,只能得到&lt;String,String&gt;的k-v键值对的值</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tMap.tProperties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myProperties</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="comment">//添加</span></span><br><span class="line">        properties.put(<span class="string">&quot;john&quot;</span>,<span class="number">100</span>); <span class="comment">//k-v</span></span><br><span class="line">        properties.put(<span class="string">&quot;lucy&quot;</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="comment">//修改</span></span><br><span class="line">        properties.put(<span class="string">&quot;lic&quot;</span>,<span class="number">80</span>);</span><br><span class="line">        properties.put(<span class="string">&quot;lic&quot;</span>,<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;properties=&quot;</span>+properties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//通过k获取对应的值</span></span><br><span class="line">        System.out.println(properties.get(<span class="string">&quot;lic&quot;</span>)); <span class="comment">//100</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//删除</span></span><br><span class="line">        properties.remove(<span class="string">&quot;lic&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;properties=&quot;</span>+properties);</span><br><span class="line">        properties.put(<span class="string">&quot;john&quot;</span>,<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">        System.out.println(properties.getProperty(<span class="string">&quot;john&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h4 id="3-源码-无"   >
          <a href="#3-源码-无" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码-无" class="headerlink" title="3.源码(无)"></a>3.源码(无)</h4>
      
        <h4 id="4-总结-4"   >
          <a href="#4-总结-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结-4" class="headerlink" title="4.总结"></a>4.总结</h4>
      
        <h3 id="8-TreeMap"   >
          <a href="#8-TreeMap" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-TreeMap" class="headerlink" title="8.TreeMap"></a>8.TreeMap</h3>
      
        <h4 id="1-说明-7"   >
          <a href="#1-说明-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-7" class="headerlink" title="1.说明"></a>1.说明</h4>
      
        <h4 id="2-特点-8"   >
          <a href="#2-特点-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-8" class="headerlink" title="2.特点"></a>2.特点</h4>
      <ul>
<li>按照key进行排序:自然排序,定制排序(具体与)<code>TreeSet</code>相似</li>
<li>key必须同一类型</li>
<li>如果当compare后为0,会将key的value值进行修改</li>
</ul>
<p>示例(还有定制排序,与TreeSet,未写入)</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tMap.tTreeMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.TreeMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myTreeMap</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//使用默认的构造器,自然排序(即默认的排序)</span></span><br><span class="line">        TreeMap&lt;Object, Object&gt; treeMap = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">        treeMap.put(<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;杰克&quot;</span>);</span><br><span class="line">        treeMap.put(<span class="string">&quot;tom&quot;</span>,<span class="string">&quot;汤姆&quot;</span>);</span><br><span class="line">        treeMap.put(<span class="string">&quot;kristina&quot;</span>,<span class="string">&quot;克里斯汀娜&quot;</span>);</span><br><span class="line">        treeMap.put(<span class="string">&quot;smith&quot;</span>,<span class="string">&quot;斯密斯&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;treeMap=&quot;</span>+treeMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h4 id="3-源码-4"   >
          <a href="#3-源码-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码-4" class="headerlink" title="3.源码"></a>3.源码</h4>
      
        <h4 id="4-总结-5"   >
          <a href="#4-总结-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结-5" class="headerlink" title="4.总结"></a>4.总结</h4>
      
        <h3 id="LinkedHashMap"   >
          <a href="#LinkedHashMap" class="heading-link"><i class="fas fa-link"></i></a><a href="#LinkedHashMap" class="headerlink" title="LinkedHashMap"></a>LinkedHashMap</h3>
      
        <h4 id="1-说明-8"   >
          <a href="#1-说明-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-8" class="headerlink" title="1.说明"></a>1.说明</h4>
      
        <h4 id="2-特点-9"   >
          <a href="#2-特点-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-特点-9" class="headerlink" title="2.特点"></a>2.特点</h4>
      
        <h4 id="3-源码-5"   >
          <a href="#3-源码-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-源码-5" class="headerlink" title="3.源码"></a>3.源码</h4>
      
        <h4 id="4-总结-6"   >
          <a href="#4-总结-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-总结-6" class="headerlink" title="4.总结"></a>4.总结</h4>
      <p>记录添加的顺序</p>
<p>重写<code>newNode</code>方法</p>

        <h2 id="5-集合总结"   >
          <a href="#5-集合总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-集合总结" class="headerlink" title="5.集合总结"></a>5.集合总结</h2>
      <p>在开发中，选择什么集合实现类，主要取决于业务操作特点，然后根据集合实现类特性进行<br>选择，分析如下:</p>
<ol>
<li>先判断存储的类型(一组对象[单列]或一组键值对[双列])</li>
<li>一组对象[单列] :Collection接口<ul>
<li><p>允许重复: List</p>
<ul>
<li>增删多: LinkedList [底层维护了一个双向链表]</li>
<li>改查多: ArrayList [底层维护Object类型的可变数组]</li>
</ul>
</li>
<li><p>不允许重复: Set</p>
<ul>
<li>无序(不注重顺序): HashSet [底层是HashMap ,维护了一个哈希表即(数组+链表+红黑树)]</li>
<li>排序: TreeSet</li>
<li>插入和取出顺序一致: LinkedHashSet , 维护数组+双向链表</li>
</ul>
</li>
</ul>
</li>
<li>一组键值对[双列] : Map<ul>
<li>键无序: HashMap [底层是:哈希表jdk7: 数组+链表，jdk8: 数组+链表+红黑树]</li>
<li>键排序: TreeMap</li>
<li>键插入和取出顺序一致: LinkedHashMap</li>
<li>读取文件Properties</li>
</ul>
</li>
</ol>

        <h2 id="6-Collections"   >
          <a href="#6-Collections" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-Collections" class="headerlink" title="6.Collections"></a>6.Collections</h2>
      
        <h3 id="1-介绍-2"   >
          <a href="#1-介绍-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍-2" class="headerlink" title="1.介绍"></a>1.介绍</h3>
      <ul>
<li>Collections是一个操作Set、List 和Map等集合的工具类</li>
<li>Collections中提供了一系列静态的方法对集合元素进行排序、查询和修改等操作</li>
</ul>

        <h3 id="2-操作"   >
          <a href="#2-操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-操作" class="headerlink" title="2.操作"></a>2.操作</h3>
      
        <h4 id="1-排序操作-均为static方法"   >
          <a href="#1-排序操作-均为static方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-排序操作-均为static方法" class="headerlink" title="1.排序操作:(均为static方法)"></a>1.排序操作:(均为static方法)</h4>
      <ul>
<li>reverse(List):反转List中元素的顺序</li>
<li>shuffle(List):对List 集合元素进行随机排序</li>
<li>sort(List):根据元素的自然顺序对指定List 集合元素按升序排序</li>
<li>sort(List, Comparator): 根据指定的Comparator产生的顺序对List集合元素进行排序</li>
<li>swap(List, int, int): 将指定list集合中的i处元素和j处元素进行交换</li>
</ul>

        <h4 id="2-查找、替换"   >
          <a href="#2-查找、替换" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-查找、替换" class="headerlink" title="2.查找、替换"></a>2.查找、替换</h4>
      <ul>
<li>Object max(Collection):根据元素的自然顺序，返回给定集合中的最大元素</li>
<li>Object max(Collection, Comparator): 根据Comparator指定的顺序，返回给定集合中的最大元素</li>
<li>Object min(Collection)</li>
<li>Object min(Collection, Comparator)</li>
<li>int frequency(Collection, Object): 返回指定集合中指定元素的出现次数</li>
<li>void copy(List dest,List src):将src中的内容复制到dest中</li>
<li>boolean replaceAll(List list, Object oldVal, Object newVal):使用新值替换List对象的所有旧值</li>
</ul>
<p>查看api</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210207135146588.png" alt="image-20210207135146588"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210207140259233.png" alt="image-20210207140259233"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210207140331943.png" alt="image-20210207140331943"></p>

        <h1 id="Java-IO流"   >
          <a href="#Java-IO流" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-IO流" class="headerlink" title="Java IO流"></a>Java IO流</h1>
      
        <h2 id="1-文件"   >
          <a href="#1-文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-文件" class="headerlink" title="1.文件"></a>1.文件</h2>
      
        <h3 id="1-什么是文件"   >
          <a href="#1-什么是文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-什么是文件" class="headerlink" title="1.什么是文件"></a>1.什么是文件</h3>
      <p>文件就是保存数据的地方</p>

        <h3 id="2-文件流"   >
          <a href="#2-文件流" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-文件流" class="headerlink" title="2.文件流"></a>2.文件流</h3>
      <p>文件在程序中是以流的形式来操作的</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210607112746130.png" alt="image-20210607112746130"></p>
<p>流:数据在数据源(文件)和程序(内存)之间经历的路径<br>输入流:数据从数据源(文件)到程序(内存)的路径<br>输出流数据从程序(内存)到数据源(文件)的路径</p>

        <h3 id="3-文件操作"   >
          <a href="#3-文件操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-文件操作" class="headerlink" title="3.文件操作"></a>3.文件操作</h3>
      
        <h4 id="1-文件创建"   >
          <a href="#1-文件创建" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-文件创建" class="headerlink" title="1.文件创建"></a>1.文件创建</h4>
      <ul>
<li><p>new File(String pathname) :根据路径构建一个File对象</p>
<p>不声明具体路径时默认在项目下</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210607113923031.png" alt="image-20210607113923031"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.new File(String pathname)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">create01</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//        String filePath = &quot;new1.txt&quot;;</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;d:\\new1.txt&quot;</span>;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filePath);</span><br><span class="line">    <span class="keyword">if</span>(file.createNewFile())&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;文件创建成功&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;创建失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>new File(File parent,String child) :根据父目录文件+子路径构建</p>
<p>添加一个父目录file文件</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.new File(File parent,String child)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">create02</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;d:\\&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;new2.txt&quot;</span>;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(file1,filePath);</span><br><span class="line">    <span class="keyword">if</span>(file.createNewFile())&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;文件创建成功&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;创建失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>new File(String parent,String child) :根据父目录+子路径构建</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.new File(String parent,String child)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">create03</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">parentPath</span> <span class="operator">=</span> <span class="string">&quot;d:/&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;new3.txt&quot;</span>;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(parentPath,filePath);</span><br><span class="line">    <span class="keyword">if</span>(file.createNewFile())&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;文件创建成功&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;创建失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>createNewFile创建新文件</p>
</li>
</ul>

        <h4 id="2-文件信息获取"   >
          <a href="#2-文件信息获取" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-文件信息获取" class="headerlink" title="2.文件信息获取"></a>2.文件信息获取</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">isInvalid()-&gt;<span class="type">boolean</span></span><br><span class="line"><span class="title function_">getPrefixLength</span><span class="params">()</span>-&gt;<span class="type">int</span> </span><br><span class="line"><span class="title function_">getName</span><span class="params">()</span>-&gt;String :获取文件名</span><br><span class="line">getParent()-&gt;String : 获取父级目录</span><br><span class="line">getParentFile()-&gt;File :获取父级目录,以File类型</span><br><span class="line">getPath()-&gt;String:获取路径</span><br><span class="line">isAbsolute()-&gt;<span class="type">boolean</span></span><br><span class="line"><span class="title function_">getAbsolutePath</span><span class="params">()</span>-&gt;String:获取绝对路径</span><br><span class="line">getAbsoluteFile()-&gt;File:获取绝对路径,以File类型</span><br><span class="line">    ...</span><br></pre></td></tr></table></div></figure>

<p>示例</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileGet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;e:\\new1.txt&quot;</span>);</span><br><span class="line">        System.out.println(file.isFile());</span><br><span class="line">        System.out.println(file.exists());</span><br><span class="line">        System.out.println(file.getName());</span><br><span class="line">        System.out.println(file.getParent());</span><br><span class="line">        System.out.println(file.getParentFile());</span><br><span class="line">        System.out.println(file.getPath());</span><br><span class="line">        System.out.println(file.isAbsolute());</span><br><span class="line">        System.out.println(file.getAbsolutePath());</span><br><span class="line">        System.out.println(file.getAbsoluteFile());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="3-目录操作与文件删除"   >
          <a href="#3-目录操作与文件删除" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-目录操作与文件删除" class="headerlink" title="3.目录操作与文件删除"></a>3.目录操作与文件删除</h4>
      <ul>
<li><p>mkdir() :创建一级目录</p>
<p>只创建一个目录<code>String filePath = &quot;d:\\demo02&quot;;</code>时使用</p>
</li>
<li><p>mkdirs() :创建多级目录</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断 d:\\demo02\\a\\b\\c  目录是否存在,如果不存在则创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m3</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">directoryPath</span> <span class="operator">=</span> <span class="string">&quot;d:\\demo02\\a\\b\\c&quot;</span>;</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(directoryPath);</span><br><span class="line">    <span class="keyword">if</span>(file.exists())&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;该目录存在&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file.mkdirs())&#123;</span><br><span class="line">            System.out.println(file+<span class="string">&quot;创建成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;创建失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>delete :删除空目录或者文件</p>
<p>删除文件</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Directory_</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        m1();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断 d:\\new1.txt 是否存在,如果存在则删除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;d:\\new1.txt&quot;</span>;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filePath);</span><br><span class="line">        <span class="keyword">if</span>(file.exists())&#123;</span><br><span class="line">            <span class="keyword">if</span> (file.delete()) &#123;</span><br><span class="line">                System.out.println(file+<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(file+<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;该文件不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>删除目录</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//判断 d:\\demo02  目录是否存在,如果存在则删除</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">//        String filePath = &quot;d:\\demo02&quot;;</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;d:\\demo02\\a\\b\\c&quot;</span>;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filePath);</span><br><span class="line">        <span class="keyword">if</span>(file.exists())&#123;</span><br><span class="line">            <span class="keyword">if</span> (file.delete()) &#123;</span><br><span class="line">                System.out.println(file+<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(file+<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;该目录不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure></li>
</ul>

        <h2 id="2-IO流原理及流的分类"   >
          <a href="#2-IO流原理及流的分类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-IO流原理及流的分类" class="headerlink" title="2.IO流原理及流的分类"></a>2.IO流原理及流的分类</h2>
      
        <h3 id="1-IO流原理"   >
          <a href="#1-IO流原理" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-IO流原理" class="headerlink" title="1.IO流原理"></a>1.IO流原理</h3>
      <ol>
<li>I&#x2F;O是Input&#x2F;Output的缩写，I&#x2F;O技术是非常实用的技术，用于处理数据传输。如读&#x2F;写文件，网络通讯等。</li>
<li>Java程序中，对于数据的输入&#x2F;输出操作以”流(stream)”的方式进行。</li>
<li>java.io包下提供了各种“流”类和接口，用以获取不同种类的数据，并通过方法输入或输出数据</li>
<li>输入input:读取外部数据(磁盘、光盘等存储设备的数据)到程序(内存)中。</li>
<li>输出output:将程序(内存)数据输出到磁盘、光盘等存储设备中</li>
</ol>

        <h3 id="2-流的分类"   >
          <a href="#2-流的分类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-流的分类" class="headerlink" title="2.流的分类"></a>2.流的分类</h3>
      <ul>
<li><p>按操作数据单位不同分为:字节流(8 bit)，字符流(按字符,字符对应字节与编码有关)</p>
<p>字节流操作二进制文件,是无损操作,对文件无损失,也可以操作文本文件,但是在读出的时候可能会因为编码问题有字节的分割导致乱码的出现</p>
<p>字符流操作文本文件,但是不能操作二进制文件</p>
</li>
<li><p>按数据流的流向不同分为:输入流，输出流</p>
</li>
<li><p>按流的角色的不同分为:节点流，处理流&#x2F;包装流</p>
<div class="table-container"><table>
<thead>
<tr>
<th>(抽象基类)</th>
<th>字节流</th>
<th>字符流</th>
</tr>
</thead>
<tbody><tr>
<td>输入流</td>
<td>InputStream</td>
<td>Reader</td>
</tr>
<tr>
<td>输出流</td>
<td>OutputStream</td>
<td>Writer</td>
</tr>
</tbody></table></div>
<ol>
<li>Java的IO流共涉及40多个类，实际上非常规则，都是从如上4个抽象基类派生的</li>
<li>由这四个类派生出来的子类名称都是以其父类名作为子类名后缀。</li>
</ol>
</li>
</ul>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210607210358734.png" alt="image-20210607210358734"></p>

        <h2 id="3-节点流和处理流-包装流"   >
          <a href="#3-节点流和处理流-包装流" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-节点流和处理流-包装流" class="headerlink" title="3.节点流和处理流(包装流)"></a>3.节点流和处理流(包装流)</h2>
      
        <h3 id="1-介绍-3"   >
          <a href="#1-介绍-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍-3" class="headerlink" title="1.介绍"></a>1.介绍</h3>
      <ol>
<li><p>节点流可以从一个特定的数据源读写数据,如FileReader,FileWriter</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210609142637167.png" alt="image-20210609142637167"></p>
</li>
<li><p>处理流(也叫包装流)是“连接”在已存在的流（节点流或处理流）之上，为程序提供更为强大的读写功能,也更加灵活,如BufferedReader,BufferedWriter (即包装了节点流),可以添加其他的流进入,所以数据源可以是文件或者是其他</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210609142728436.png" alt="image-20210609142728436"></p>
</li>
</ol>

        <h3 id="2-节点流与处理流图述"   >
          <a href="#2-节点流与处理流图述" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-节点流与处理流图述" class="headerlink" title="2.节点流与处理流图述"></a>2.节点流与处理流图述</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210609162621349.png" alt="image-20210609162621349"></p>

        <h3 id="3-节点流和处理流的区别和联系与功能"   >
          <a href="#3-节点流和处理流的区别和联系与功能" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-节点流和处理流的区别和联系与功能" class="headerlink" title="3.节点流和处理流的区别和联系与功能"></a>3.节点流和处理流的区别和联系与功能</h3>
      <ol>
<li><p>节点流是底层流&#x2F;低级流,直接跟数据源相接。</p>
</li>
<li><p>处理流(包装流)包装节点流，既可以消除不同节点流的实现差异，也可以提供更方便的方法来完成输入输出。</p>
</li>
<li><p>处理流(包装流)对节点流进行包装，使用了修饰器设计模式,不会直接与数据源相连</p>
<p>[模拟修饰器设计模式]</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.theShow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">BufferedReader_</span> <span class="variable">bufferedReader_</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader_</span>(<span class="keyword">new</span> <span class="title class_">FileReader_</span>());</span><br><span class="line">        bufferedReader_.readFiles(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.theShow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringReader_</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readString</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;读取字符串&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.theShow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">myReader</span> &#123;<span class="comment">//抽象类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFile</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readString</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.theShow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileReader_</span> <span class="keyword">extends</span> <span class="title class_">myReader</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFile</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;读取文件&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.theShow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BufferedReader_</span> <span class="keyword">extends</span> <span class="title class_">myReader</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> myReader myReader; <span class="comment">//属性为myReader_ 类型</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BufferedReader_</span><span class="params">(myReader myReader)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.myReader = myReader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//让方法灵活,扩展,多次读取文件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFiles</span><span class="params">(<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            myReader.readFile();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//扩展 readString ,批量处理字符串数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readStrings</span><span class="params">(<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            myReader.readString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure></li>
</ol>
<p>处理流的功能主要体现在以下两个方面:</p>
<ol>
<li>性能的提高:主要以增加缓冲的方式来提高输入输出的效率。</li>
<li>操作的便捷:处理流可能提供了一系列便捷的方法来一次输入输出大批量的数据,使用更加灵活方便</li>
</ol>

        <h2 id="4-输入流"   >
          <a href="#4-输入流" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-输入流" class="headerlink" title="4.输入流"></a>4.输入流</h2>
      
        <h3 id="1-InputStream-字节"   >
          <a href="#1-InputStream-字节" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-InputStream-字节" class="headerlink" title="1.InputStream(字节)"></a>1.InputStream(字节)</h3>
      
        <h4 id="1-FileInputStream-文件输入流"   >
          <a href="#1-FileInputStream-文件输入流" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-FileInputStream-文件输入流" class="headerlink" title="1.FileInputStream(文件输入流)"></a>1.FileInputStream(文件输入流)</h4>
      
        <h5 id="1-构造方法-1"   >
          <a href="#1-构造方法-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-1" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>FileInputStream(File file)</code>  通过打开与实际文件的连接创建一个 <code>FileInputStream</code> ，该文件由文件系统中的  <code>File</code>对象 <code>file</code>命名。</td>
</tr>
<tr>
<td><code>FileInputStream(FileDescriptor fdObj)</code>  创建 <code>FileInputStream</code>通过使用文件描述符 fdObj  ，其表示在文件系统中的现有连接到一个实际的文件。</td>
</tr>
<tr>
<td><code>FileInputStream(String name)</code>  通过打开与实际文件的连接来创建一个 <code>FileInputStream</code> ，该文件由文件系统中的路径名  <code>name</code>命名。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-2"   >
          <a href="#2-常用方法-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-2" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>int</code></td>
<td><code>available()</code>  返回从此输入流中可以读取（或跳过）的剩余字节数的估计值，而不会被下一次调用此输入流的方法阻塞。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>close()</code>  关闭此文件输入流并释放与流相关联的任何系统资源。</td>
</tr>
<tr>
<td><code>protected void</code></td>
<td><code>finalize()</code>  确保当这个文件输入流的 <code>close</code>方法没有更多的引用时被调用。</td>
</tr>
<tr>
<td><code>FileChannel</code></td>
<td><code>getChannel()</code>  返回与此文件输入流相关联的唯一的<a href="../../java/nio/channels/FileChannel.html"><code>FileChannel</code></a>对象。</td>
</tr>
<tr>
<td><code>FileDescriptor</code></td>
<td><code>getFD()</code>  返回表示与此 <code>FileInputStream</code>正在使用的文件系统中实际文件的连接的  <code>FileDescriptor</code>对象。</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read()</code>  从该输入流读取一个字节的数据。</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read(byte[] b)</code>  从该输入流读取最多 <code>b.length</code>个字节的数据为字节数组。</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read(byte[] b,  int off, int len)</code>  从该输入流读取最多 <code>len</code>字节的数据为字节数组。</td>
</tr>
<tr>
<td><code>long</code></td>
<td><code>skip(long n)</code>  跳过并从输入流中丢弃 <code>n</code>字节的数据。</td>
</tr>
</tbody></table></div>

        <h5 id="3-示例"   >
          <a href="#3-示例" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例" class="headerlink" title="3.示例"></a>3.示例</h5>
      
        <h6 id="read"   >
          <a href="#read" class="heading-link"><i class="fas fa-link"></i></a><a href="#read" class="headerlink" title="read"></a>read</h6>
      <p>字节读取在含有中文时,因为一个中文占有三个字节,会一个一个读取出,则会导致乱码</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFile01</span><span class="params">()</span>&#123;</span><br><span class="line">        String filePath=<span class="string">&quot;d:\\test.txt&quot;</span>;</span><br><span class="line">        <span class="type">int</span> read;</span><br><span class="line">        FileInputStream fileInputStream=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//创建FileInputStream 对象用于读取文件</span></span><br><span class="line">            fileInputStream = <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath);</span><br><span class="line">            <span class="comment">//从该输入流读取一个字节的数据,如果没有输入可用,此方法将阻止</span></span><br><span class="line">            <span class="comment">//如果返回-1,表示读取完毕</span></span><br><span class="line">            <span class="keyword">while</span>((read = fileInputStream.read()) != -<span class="number">1</span>)&#123;</span><br><span class="line">                System.out.print((<span class="type">char</span>) read);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileInputStream.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="2-BufferedInputStream-缓冲字节输入流"   >
          <a href="#2-BufferedInputStream-缓冲字节输入流" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-BufferedInputStream-缓冲字节输入流" class="headerlink" title="2.BufferedInputStream(缓冲字节输入流)"></a>2.BufferedInputStream(缓冲字节输入流)</h4>
      
        <h5 id="1-构造方法-2"   >
          <a href="#1-构造方法-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-2" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      
        <h5 id="2-常用方法-3"   >
          <a href="#2-常用方法-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-3" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-示例-1"   >
          <a href="#3-示例-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-1" class="headerlink" title="3.示例"></a>3.示例</h5>
      
        <h4 id="3-ObjectInputStream-对象字节输入流"   >
          <a href="#3-ObjectInputStream-对象字节输入流" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ObjectInputStream-对象字节输入流" class="headerlink" title="3.ObjectInputStream(对象字节输入流)"></a>3.ObjectInputStream(对象字节输入流)</h4>
      
        <h5 id="1-构造方法-3"   >
          <a href="#1-构造方法-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-3" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      
        <h5 id="2-常用方法-4"   >
          <a href="#2-常用方法-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-4" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-示例-2"   >
          <a href="#3-示例-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-2" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tInputStream.tObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myObjectStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\data.dat&quot;</span>;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath));</span><br><span class="line">        <span class="comment">//读取的顺序(反序列化的顺序)需要与保存数据(序列化)的顺序一致,否则会报异常</span></span><br><span class="line">        System.out.println(ois.readInt());</span><br><span class="line">        System.out.println(ois.readBoolean());</span><br><span class="line">        System.out.println(ois.readChar());</span><br><span class="line">        System.out.println(ois.readDouble());</span><br><span class="line">        System.out.println(ois.readUTF());</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        System.out.println(<span class="string">&quot;运行类型=&quot;</span>+o.getClass());</span><br><span class="line">        System.out.println(o); <span class="comment">//底层 Object -&gt; Dog</span></span><br><span class="line">        <span class="comment">//序列化后,反序列化时,若改变了object类中封装的内容,需要重新序列化</span></span><br><span class="line">        <span class="comment">//1.如果要调用Dog的方法,需要向下转型</span></span><br><span class="line">        <span class="comment">//2.需要我们将Dog类的定义,拷贝到可以引用的位置,应有一个公共类</span></span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;读取成功,反序列化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="2-Reader-字符"   >
          <a href="#2-Reader-字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Reader-字符" class="headerlink" title="2.Reader(字符)"></a>2.Reader(字符)</h3>
      
        <h4 id="1-FileReader"   >
          <a href="#1-FileReader" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-FileReader" class="headerlink" title="1.FileReader"></a>1.FileReader</h4>
      
        <h5 id="1-构造方法-4"   >
          <a href="#1-构造方法-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-4" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>FileReader(File file)</code>  创建一个新的 <code>FileReader</code> ，给出 <code>File</code>读取。</td>
</tr>
<tr>
<td><code>FileReader(FileDescriptor fd)</code>  创建一个新的 <code>FileReader</code> ，给定 <code>FileDescriptor</code>读取。</td>
</tr>
<tr>
<td><code>FileReader(String fileName)</code>  创建一个新的 <code>FileReader</code> ，给定要读取的文件的名称。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-5"   >
          <a href="#2-常用方法-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-5" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <ul>
<li>read:每次读取单个字符，返回该字符，如果到文件末尾返回-1</li>
<li>read(char[):批量读取多个字符到数组，返回读取到的字符数,如果到文件末尾返回-1</li>
</ul>
<p>相关API:</p>
<ul>
<li>new String(char[):将char[]转换成String</li>
<li>new String(char[,off,len):将char[]的指定部分转换成String</li>
</ul>
<p>Methods inherited from class java.io.<a href="../../java/io/InputStreamReader.html">InputStreamReader</a></p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">close, getEncoding, <span class="built_in">read</span>, <span class="built_in">read</span>, ready</span><br></pre></td></tr></table></div></figure>


        <h5 id="3-示例-3"   >
          <a href="#3-示例-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-3" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myFileReader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\story.txt&quot;</span>;</span><br><span class="line">        <span class="type">FileReader</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.创建FileReader对象</span></span><br><span class="line">            fileReader = <span class="keyword">new</span> <span class="title class_">FileReader</span>(filePath);</span><br><span class="line">            <span class="comment">//循环读取</span></span><br><span class="line">            <span class="type">int</span> len;</span><br><span class="line"><span class="comment">//            int data;</span></span><br><span class="line">            <span class="comment">//使用read单个字符读取</span></span><br><span class="line"><span class="comment">//            while ((data=fileReader.read())!=-1)&#123;</span></span><br><span class="line"><span class="comment">//                System.out.print((char)data);</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line">            <span class="comment">//使用char数组读取,返回的是实际的字符串</span></span><br><span class="line">            <span class="comment">//若返回-1,则说明文件结束</span></span><br><span class="line">            <span class="type">char</span>[] chars = <span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">8</span>];</span><br><span class="line">            <span class="keyword">while</span> ((len=fileReader.read(chars))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                System.out.print(<span class="keyword">new</span> <span class="title class_">String</span>(chars,<span class="number">0</span>,len));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (fileReader!=<span class="literal">null</span>)</span><br><span class="line">                    fileReader.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="2-BufferedReader"   >
          <a href="#2-BufferedReader" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-BufferedReader" class="headerlink" title="2.BufferedReader"></a>2.BufferedReader</h4>
      <p>属于字符流,是按照字符来读取数据的</p>
<p>关闭时,只需要关闭外层流即可</p>

        <h5 id="1-构造方法-5"   >
          <a href="#1-构造方法-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-5" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>BufferedReader(Reader in)</code>  创建使用默认大小的输入缓冲区的缓冲字符输入流。</td>
</tr>
<tr>
<td><code>BufferedReader(Reader in,  int sz)</code>  创建使用指定大小的输入缓冲区的缓冲字符输入流。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-6"   >
          <a href="#2-常用方法-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-6" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>void</code></td>
<td><code>close()</code>  关闭流并释放与之相关联的任何系统资源。</td>
</tr>
<tr>
<td><code>Stream&lt;String&gt;</code></td>
<td><code>lines()</code>  返回一个 <code>Stream</code> ，其元素是从这个  <code>BufferedReader</code>读取的行。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>mark(int readAheadLimit)</code>  标记流中的当前位置。</td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code>markSupported()</code>  告诉这个流是否支持mark（）操作。</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read()</code>  读一个字符</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read(char[] cbuf,  int off, int len)</code>  将字符读入数组的一部分。</td>
</tr>
<tr>
<td><code>String</code></td>
<td><code>readLine()</code>  读一行文字。</td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code>ready()</code>  告诉这个流是否准备好被读取。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>reset()</code>  将流重置为最近的标记。</td>
</tr>
<tr>
<td><code>long</code></td>
<td><code>skip(long n)</code>  跳过字符</td>
</tr>
</tbody></table></div>

        <h5 id="3-示例-4"   >
          <a href="#3-示例-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-4" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myBufferedReader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        String filePath=<span class="string">&quot;D:\\文件拷贝\\story.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//创建BufferedReader</span></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(filePath));</span><br><span class="line">        <span class="comment">//读取</span></span><br><span class="line">        String line;</span><br><span class="line">        <span class="comment">//按行读取,效率高,读取为null时读取完毕</span></span><br><span class="line">        <span class="keyword">while</span>((line=bufferedReader.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">            System.out.println(line);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//只需关闭BufferReader,因为底层会自己关闭节点流</span></span><br><span class="line">        bufferedReader.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>只需关闭外部流原因:包装流关闭实际为关闭其包装的节点流</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">        <span class="keyword">if</span> (in == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            in.close();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            in = <span class="literal">null</span>;</span><br><span class="line">            cb = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="3-InputStreamReader"   >
          <a href="#3-InputStreamReader" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-InputStreamReader" class="headerlink" title="3.InputStreamReader"></a>3.InputStreamReader</h4>
      
        <h5 id="1-构造方法-6"   >
          <a href="#1-构造方法-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-6" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      
        <h5 id="2-常用方法-7"   >
          <a href="#2-常用方法-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-7" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-示例-5"   >
          <a href="#3-示例-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-5" class="headerlink" title="3.示例"></a>3.示例</h5>
      
        <h2 id="5-输出流"   >
          <a href="#5-输出流" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-输出流" class="headerlink" title="5.输出流"></a>5.输出流</h2>
      
        <h3 id="1-OutputStream-字节"   >
          <a href="#1-OutputStream-字节" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-OutputStream-字节" class="headerlink" title="1.OutputStream(字节)"></a>1.OutputStream(字节)</h3>
      
        <h4 id="1-FileOutputStream"   >
          <a href="#1-FileOutputStream" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-FileOutputStream" class="headerlink" title="1.FileOutputStream"></a>1.FileOutputStream</h4>
      
        <h5 id="1-构造方法-7"   >
          <a href="#1-构造方法-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-7" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>FileOutputStream(File file)</code>  创建文件输出流以写入由指定的 <code>File</code>对象表示的文件。</td>
</tr>
<tr>
<td><code>FileOutputStream(File file,  boolean append)</code>  创建文件输出流以写入由指定的 <code>File</code>对象表示的文件。</td>
</tr>
<tr>
<td><code>FileOutputStream(FileDescriptor fdObj)</code>  创建文件输出流以写入指定的文件描述符，表示与文件系统中实际文件的现有连接。</td>
</tr>
<tr>
<td><code>FileOutputStream(String name)</code>  创建文件输出流以指定的名称写入文件。</td>
</tr>
<tr>
<td><code>FileOutputStream(String name,  boolean append)</code>  创建文件输出流以指定的名称写入文件。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-8"   >
          <a href="#2-常用方法-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-8" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>void</code></td>
<td><code>close()</code>  关闭此文件输出流并释放与此流相关联的任何系统资源。</td>
</tr>
<tr>
<td><code>protected void</code></td>
<td><code>finalize()</code>  清理与文件的连接，并确保当没有更多的引用此流时，将调用此文件输出流的 <code>close</code>方法。</td>
</tr>
<tr>
<td><code>FileChannel</code></td>
<td><code>getChannel()</code>  返回与此文件输出流相关联的唯一的<a href="../../java/nio/channels/FileChannel.html"><code>FileChannel</code></a>对象。</td>
</tr>
<tr>
<td><code>FileDescriptor</code></td>
<td><code>getFD()</code>  返回与此流相关联的文件描述符。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>write(byte[] b)</code>  将 <code>b.length</code>个字节从指定的字节数组写入此文件输出流。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>write(byte[] b,  int off, int len)</code>  将 <code>len</code>字节从位于偏移量 <code>off</code>的指定字节数组写入此文件输出流。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>write(int b)</code>  将指定的字节写入此文件输出流。</td>
</tr>
</tbody></table></div>

        <h5 id="3-示例-6"   >
          <a href="#3-示例-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-6" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myFileOutputStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将数据写入文件中,若文件不存在,则创建文件</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeFile</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//创建 FileOutputStream</span></span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;d:\\theOut.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 得到FileOutputStream 对象</span></span><br><span class="line">            <span class="comment">//使用new FileOutputStream(filePath)是为覆盖创建方式,会覆盖原先内容</span></span><br><span class="line">            <span class="comment">//new FileOutputStream(filePath,true)则为追加方式,追加到文件后面</span></span><br><span class="line">            fileOutputStream = <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath,<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//写入一个字节</span></span><br><span class="line">            <span class="comment">//            fileOutputStream.write(&#x27;H&#x27;);</span></span><br><span class="line">            <span class="comment">//写入字符串</span></span><br><span class="line">            String str=<span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">            <span class="comment">//str.getBytes()将字符串转为字节数组</span></span><br><span class="line">            fileOutputStream.write(str.getBytes());</span><br><span class="line">            <span class="comment">//            fileOutputStream.write(str.getBytes(),0,str.length());</span></span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileOutputStream.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="2-BufferedOutputStream"   >
          <a href="#2-BufferedOutputStream" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-BufferedOutputStream" class="headerlink" title="2.BufferedOutputStream"></a>2.BufferedOutputStream</h4>
      
        <h5 id="1-构造方法-8"   >
          <a href="#1-构造方法-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-8" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      
        <h5 id="2-常用方法-9"   >
          <a href="#2-常用方法-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-9" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-示例-7"   >
          <a href="#3-示例-7" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-7" class="headerlink" title="3.示例"></a>3.示例</h5>
      
        <h4 id="3-ObjectOutputStream"   >
          <a href="#3-ObjectOutputStream" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ObjectOutputStream" class="headerlink" title="3.ObjectOutputStream"></a>3.ObjectOutputStream</h4>
      
        <h5 id="1-构造方法-9"   >
          <a href="#1-构造方法-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-9" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      
        <h5 id="2-常用方法-10"   >
          <a href="#2-常用方法-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-10" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-示例-8"   >
          <a href="#3-示例-8" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-8" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tOutputStream.tObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myObjectOutputStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//序列化后,保存的文件格式,不是纯文本,而是按照自身的格式来保存</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\data.dat&quot;</span>;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            oos = <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath));</span><br><span class="line">            oos.writeInt(<span class="number">100</span>);<span class="comment">// int -&gt; Integer (实现了 Serializable)</span></span><br><span class="line">            oos.writeBoolean(<span class="literal">true</span>);<span class="comment">//boolean -&gt; Boolean (实现了 Serializable)</span></span><br><span class="line">            oos.writeChar(<span class="string">&#x27;a&#x27;</span>);<span class="comment">//char -&gt; Character (实现了 Serializable)</span></span><br><span class="line">            oos.writeDouble(<span class="number">9.5</span>);<span class="comment">//double -&gt; Double (实现了 Serializable)</span></span><br><span class="line">            oos.writeUTF(<span class="string">&quot;吴华毅&quot;</span>);<span class="comment">//String</span></span><br><span class="line">            <span class="comment">// 保存一个Dog对象</span></span><br><span class="line">            oos.writeObject(<span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;旺财&quot;</span>,<span class="number">10</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(oos!=<span class="literal">null</span>)</span><br><span class="line">                    oos.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;数据保存完毕(序列化形式)&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//dog需要公有public,否则信息不一致,反序列化会出错</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Dog</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Dog&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="2-Writer-字符"   >
          <a href="#2-Writer-字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Writer-字符" class="headerlink" title="2.Writer(字符)"></a>2.Writer(字符)</h3>
      
        <h4 id="1-FileWriter"   >
          <a href="#1-FileWriter" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-FileWriter" class="headerlink" title="1.FileWriter"></a>1.FileWriter</h4>
      
        <h5 id="1-构造方法-10"   >
          <a href="#1-构造方法-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-10" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>FileWriter(File file)</code>  给一个File对象构造一个FileWriter对象。</td>
</tr>
<tr>
<td><code>FileWriter(File file,  boolean append)</code>  给一个File对象构造一个FileWriter对象。</td>
</tr>
<tr>
<td><code>FileWriter(FileDescriptor fd)</code>  构造与文件描述符关联的FileWriter对象。</td>
</tr>
<tr>
<td><code>FileWriter(String fileName)</code>  构造一个给定文件名的FileWriter对象。</td>
</tr>
<tr>
<td><code>FileWriter(String fileName, boolean append)</code>  构造一个FileWriter对象，给出一个带有布尔值的文件名，表示是否附加写入的数据。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-11"   >
          <a href="#2-常用方法-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-11" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <ul>
<li>new FileWriter(File&#x2F;String):覆盖模式，相当于流的指针在首端</li>
<li>new FileWriter(File&#x2F;String,true):追加模式，相当于流的指针在尾端</li>
<li>write(int):写入单个字符</li>
<li>write(char[):写入指定数组</li>
<li>write(char[],off, len):写入指定数组的指定部分</li>
<li>write (string):写入整个字符串</li>
<li>write(string,off, len):写入字符串的指定部分</li>
</ul>
<p>相关API: String类:toCharArray:将String转换成char[]</p>
<p>&#x3D;&#x3D;注意:FileWriter使用后，必须要关闭(close)或刷新(flush)，否则写入不到指定的文件!&#x3D;&#x3D;</p>
<p>close等价于flush+关闭流</p>
<p>原因,在close后才会调用写入文件的方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeBytes</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    bb.flip();</span><br><span class="line">    <span class="type">int</span> <span class="variable">lim</span> <span class="operator">=</span> bb.limit();</span><br><span class="line">    <span class="type">int</span> <span class="variable">pos</span> <span class="operator">=</span> bb.position();</span><br><span class="line">    <span class="keyword">assert</span> (pos &lt;= lim);</span><br><span class="line">    <span class="type">int</span> <span class="variable">rem</span> <span class="operator">=</span> (pos &lt;= lim ? lim - pos : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rem &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ch.write(bb) != rem)</span><br><span class="line">                <span class="keyword">assert</span> <span class="literal">false</span> : rem;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            out.write(bb.array(), bb.arrayOffset() + pos, rem);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    bb.clear();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>



<p>Methods inherited from class java.io.<a href="../../java/io/OutputStreamWriter.html">OutputStreamWriter</a></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">close, flush, getEncoding, write, write, write</span><br></pre></td></tr></table></div></figure>


        <h5 id="3-示例-9"   >
          <a href="#3-示例-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-9" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myFileWriter</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\note.txt&quot;</span>;</span><br><span class="line">        <span class="type">FileWriter</span> <span class="variable">fileWriter</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * - write(int):写入单个字符</span></span><br><span class="line"><span class="comment">             * - write(char[]):写入指定数组</span></span><br><span class="line"><span class="comment">             * - write(char[],off, len):写入指定数组的指定部分</span></span><br><span class="line"><span class="comment">             * - write (string):写入整个字符串</span></span><br><span class="line"><span class="comment">             * - write(string,off, len):写入字符串的指定部分</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            fileWriter = <span class="keyword">new</span> <span class="title class_">FileWriter</span>(filePath);</span><br><span class="line">            fileWriter.write(<span class="string">&#x27;H&#x27;</span>);</span><br><span class="line">            <span class="type">char</span>[] chars = &#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line">            fileWriter.write(chars);</span><br><span class="line">            fileWriter.write(<span class="string">&quot;吴华毅hhh&quot;</span>.toCharArray(),<span class="number">0</span>,<span class="number">3</span>);</span><br><span class="line">            fileWriter.write(<span class="string">&quot; 你好 上海&quot;</span>);</span><br><span class="line">            fileWriter.write(<span class="string">&quot;北京 杭州&quot;</span>,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">            <span class="comment">//数据量大的情况下,可以使用循环操作</span></span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//对于FileWriter,一定要关闭流或者flush才能真正把数据写到文件中</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(fileWriter != <span class="literal">null</span>)</span><br><span class="line">                    fileWriter.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="2-BufferedWriter"   >
          <a href="#2-BufferedWriter" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-BufferedWriter" class="headerlink" title="2.BufferedWriter"></a>2.BufferedWriter</h4>
      <p>属于字符流,是按照字符来读取数据的</p>
<p>关闭时,只需要关闭外层流即可</p>

        <h5 id="1-构造方法-11"   >
          <a href="#1-构造方法-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-11" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>BufferedWriter(Writer out)</code>  创建使用默认大小的输出缓冲区的缓冲字符输出流。</td>
</tr>
<tr>
<td><code>BufferedWriter(Writer out,  int sz)</code>  创建一个新的缓冲字符输出流，使用给定大小的输出缓冲区。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-12"   >
          <a href="#2-常用方法-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-12" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>void</code></td>
<td><code>close()</code>  关闭流，先刷新。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>flush()</code>  刷新流。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>newLine()</code>  写一行行分隔符。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>write(char[] cbuf,  int off, int len)</code>  写入字符数组的一部分。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>write(int c)</code>  写一个字符</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>write(String s,  int off, int len)</code>  写一个字符串的一部分。</td>
</tr>
</tbody></table></div>

        <h5 id="3-示例-10"   >
          <a href="#3-示例-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-10" class="headerlink" title="3.示例"></a>3.示例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myBufferedWriter</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;d:\\ok.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//创建BufferedWriter</span></span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bufferedWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(filePath));</span><br><span class="line"><span class="comment">//        BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(filePath,true));//追加</span></span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello world by 吴华毅&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();<span class="comment">//插入一个和系统相关的换行符</span></span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello new world by 吴华毅&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();</span><br><span class="line">        bufferedWriter.write(<span class="string">&quot;hello the world by 吴华毅&quot;</span>);</span><br><span class="line">        bufferedWriter.newLine();</span><br><span class="line">        <span class="comment">//插入一个换行</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭包装流,传入的new FileWriter(filePath)会在底层关闭</span></span><br><span class="line">        bufferedWriter.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;完成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="3-OutputStreamWriter"   >
          <a href="#3-OutputStreamWriter" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-OutputStreamWriter" class="headerlink" title="3.OutputStreamWriter"></a>3.OutputStreamWriter</h4>
      
        <h5 id="1-构造方法-12"   >
          <a href="#1-构造方法-12" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方法-12" class="headerlink" title="1.构造方法"></a>1.构造方法</h5>
      
        <h5 id="2-常用方法-13"   >
          <a href="#2-常用方法-13" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-13" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-示例-11"   >
          <a href="#3-示例-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-示例-11" class="headerlink" title="3.示例"></a>3.示例</h5>
      
        <h2 id="6-Properties类"   >
          <a href="#6-Properties类" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-Properties类" class="headerlink" title="6.Properties类"></a>6.Properties类</h2>
      
        <h2 id="7-综合示例"   >
          <a href="#7-综合示例" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-综合示例" class="headerlink" title="7.综合示例"></a>7.综合示例</h2>
      
        <h3 id="1-文件流"   >
          <a href="#1-文件流" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-文件流" class="headerlink" title="1.文件流"></a>1.文件流</h3>
      
        <h4 id="1-FileInputStream和FileOutputStream"   >
          <a href="#1-FileInputStream和FileOutputStream" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-FileInputStream和FileOutputStream" class="headerlink" title="1.FileInputStream和FileOutputStream"></a>1.FileInputStream和FileOutputStream</h4>
      <p>文件的拷贝</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileCopy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//完成文件拷贝 D:\\theTest.bmp 拷贝到 D:\\文件拷贝\\</span></span><br><span class="line">        <span class="comment">//1.创建文件输入流,将文件读入到程序</span></span><br><span class="line">        <span class="comment">//2.创建文件输出流,将读入的数据输出到新的文件</span></span><br><span class="line">        <span class="comment">//3.读入读出是一个循环操作,若先完成输入再输出,文件过大则会出现问题</span></span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fileInputStream = <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;D:\\theTest.bmp&quot;</span>);</span><br><span class="line">            fileOutputStream = <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;D:\\文件拷贝\\theTest.bmp&quot;</span>);</span><br><span class="line">            <span class="type">int</span> bLen;</span><br><span class="line">            <span class="comment">//定义一个字节数组提高读取效率</span></span><br><span class="line">            <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">            <span class="keyword">while</span>((bLen = fileInputStream.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="comment">//读取后写入文件,边读边写</span></span><br><span class="line">                fileOutputStream.write(bytes,<span class="number">0</span>,bytes.length);<span class="comment">//需要指定长度</span></span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;完成复制&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;复制错误&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(fileInputStream!=<span class="literal">null</span>)</span><br><span class="line">                    fileInputStream.close();</span><br><span class="line">                <span class="keyword">if</span>(fileOutputStream!=<span class="literal">null</span>)</span><br><span class="line">                    fileOutputStream.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="2-FileReader和FileWriter"   >
          <a href="#2-FileReader和FileWriter" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-FileReader和FileWriter" class="headerlink" title="2.FileReader和FileWriter"></a>2.FileReader和FileWriter</h4>
      <p>是字符流,即按照字符操作I&#x2F;O</p>

        <h3 id="2-缓冲流"   >
          <a href="#2-缓冲流" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-缓冲流" class="headerlink" title="2.缓冲流"></a>2.缓冲流</h3>
      
        <h4 id="BufferedInputStream与BufferedOutputStream"   >
          <a href="#BufferedInputStream与BufferedOutputStream" class="heading-link"><i class="fas fa-link"></i></a><a href="#BufferedInputStream与BufferedOutputStream" class="headerlink" title="BufferedInputStream与BufferedOutputStream"></a>BufferedInputStream与BufferedOutputStream</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tOutputStream.tBufferedOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BufferedCopy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">srcFilePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\theTest.bmp&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">destFilePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\theTest2.bmp&quot;</span>;</span><br><span class="line">        <span class="type">BufferedInputStream</span> <span class="variable">bis</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bis = <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(srcFilePath));</span><br><span class="line">            bos = <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(destFilePath));</span><br><span class="line">            <span class="comment">//循环读取文件并写入目的路径</span></span><br><span class="line">            <span class="type">byte</span>[] bytes =<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="type">int</span> len;</span><br><span class="line">            <span class="keyword">while</span> ((len = bis.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                bos.write(bytes,<span class="number">0</span>,len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//关闭外层处理流</span></span><br><span class="line">                <span class="keyword">if</span>(bis!=<span class="literal">null</span>)</span><br><span class="line">                    bis.close();</span><br><span class="line">                <span class="keyword">if</span>(bos!=<span class="literal">null</span>)</span><br><span class="line">                    bos.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="BufferedWriter与BufferedReader"   >
          <a href="#BufferedWriter与BufferedReader" class="heading-link"><i class="fas fa-link"></i></a><a href="#BufferedWriter与BufferedReader" class="headerlink" title="BufferedWriter与BufferedReader"></a>BufferedWriter与BufferedReader</h4>
      <p>属于字符流,是按照字符来读取数据的</p>
<p>关闭处理流时,只需要关闭外层流(包装流)即可</p>
<p>按照字符操作,不要去操作二进制文件(声音,视频,doc,pdf,word),否则可能会造成文件的损坏</p>
<p>文件的拷贝</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tWriter.tBufferedWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BufferedCopy</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">srcFilePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\story.txt&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">destFilePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\story2.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            br = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(srcFilePath));</span><br><span class="line">            bw = <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(destFilePath));</span><br><span class="line"></span><br><span class="line">            String str;</span><br><span class="line">            <span class="keyword">while</span>((str=br.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">//读一行,写入,但不具有换行符.需要添加</span></span><br><span class="line">                bw.write(str);</span><br><span class="line">                <span class="comment">//插入换行符</span></span><br><span class="line">                bw.newLine();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;完成复制&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(br!=<span class="literal">null</span>)</span><br><span class="line">                    br.close();</span><br><span class="line">                <span class="keyword">if</span>(bw!=<span class="literal">null</span>)</span><br><span class="line">                    bw.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-对象处理流"   >
          <a href="#3-对象处理流" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-对象处理流" class="headerlink" title="3.对象处理流"></a>3.对象处理流</h3>
      <ol>
<li><p>将int num &#x3D; 100这个int数据保存到文件中,注意不是100数字，而是int 100，并且，能够<br>从文件中直接恢复int 100</p>
</li>
<li><p>将Dog dog &#x3D; new Dog(“小黄”，3)这个dog对象保存到文件中，并且能够从文件恢复</p>
</li>
<li><p>上面的要求，就是能够将基本数据类型或者对象进行序列化和反序列化操作</p>
<p>(即保存值与其的类型:序列化,将其恢复,读取值与其类型出来:反序列化)</p>
</li>
</ol>

        <h4 id="序列化和反序列化"   >
          <a href="#序列化和反序列化" class="heading-link"><i class="fas fa-link"></i></a><a href="#序列化和反序列化" class="headerlink" title="序列化和反序列化"></a>序列化和反序列化</h4>
      <ol>
<li><p>序列化就是在保存数据时,保存&#x3D;&#x3D;数据的值&#x3D;&#x3D;和&#x3D;&#x3D;数据类型&#x3D;&#x3D;</p>
</li>
<li><p>反序列化就是在恢复数据时,，恢复&#x3D;&#x3D;数据的值&#x3D;&#x3D;和&#x3D;&#x3D;数据类型&#x3D;&#x3D;</p>
</li>
<li><p>需要让某个对象支持序列化机制，则必须让其类是可序列化的，为了让某个类是可序列化的，该类必须实现如下两个接口之一:</p>
<p>Serializable&#x2F;&#x2F;这是一个标记接口 声明性质,没有方法</p>
<p>Externalizable</p>
</li>
</ol>
<p>序列化</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tOutputStream.tObjectOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myObjectOutputStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//序列化后,保存的文件格式,不是纯文本,而是按照自身的格式来保存</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\data.dat&quot;</span>;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            oos = <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath));</span><br><span class="line">            oos.writeInt(<span class="number">100</span>);<span class="comment">// int -&gt; Integer (实现了 Serializable)</span></span><br><span class="line">            oos.writeBoolean(<span class="literal">true</span>);<span class="comment">//boolean -&gt; Boolean (实现了 Serializable)</span></span><br><span class="line">            oos.writeChar(<span class="string">&#x27;a&#x27;</span>);<span class="comment">//char -&gt; Character (实现了 Serializable)</span></span><br><span class="line">            oos.writeDouble(<span class="number">9.5</span>);<span class="comment">//double -&gt; Double (实现了 Serializable)</span></span><br><span class="line">            oos.writeUTF(<span class="string">&quot;吴华毅&quot;</span>);<span class="comment">//String</span></span><br><span class="line">            <span class="comment">// 保存一个Dog对象</span></span><br><span class="line">            oos.writeObject(<span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;旺财&quot;</span>,<span class="number">10</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(oos!=<span class="literal">null</span>)</span><br><span class="line">                    oos.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;数据保存完毕(序列化形式)&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//dog需要公有public,否则信息不一致,反序列化会出错</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Dog</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Dog&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>反序列化</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tInputStream.tObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myObjectStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\data.dat&quot;</span>;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath));</span><br><span class="line">        <span class="comment">//读取的顺序(反序列化的顺序)需要与保存数据(序列化)的顺序一致,否则会报异常</span></span><br><span class="line">        System.out.println(ois.readInt());</span><br><span class="line">        System.out.println(ois.readBoolean());</span><br><span class="line">        System.out.println(ois.readChar());</span><br><span class="line">        System.out.println(ois.readDouble());</span><br><span class="line">        System.out.println(ois.readUTF());</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        System.out.println(<span class="string">&quot;运行类型=&quot;</span>+o.getClass());</span><br><span class="line">        System.out.println(o); <span class="comment">//底层 Object -&gt; Dog</span></span><br><span class="line">        <span class="comment">//序列化后,反序列化时,若改变了object类中封装的内容,需要重新序列化</span></span><br><span class="line">        <span class="comment">//1.如果要调用Dog的方法,需要向下转型</span></span><br><span class="line">        <span class="comment">//2.需要我们将Dog类的定义,拷贝到可以引用的位置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ois.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;读取成功,反序列化&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h4 id="注意事项"   >
          <a href="#注意事项" class="heading-link"><i class="fas fa-link"></i></a><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4>
      <ol>
<li>读写顺序要一致</li>
<li>要求实现序列化或反序列化对象,需要实现 Serializable</li>
<li>序列化的类中建议添加SerialVersionUID.为了提高版本的兼容性</li>
<li>序列化对象时，默认将里面所有属性都进行序列化，但除了static或transient修饰的成员</li>
<li>序列化对象时，要求里面属性的类型也需要实现序列化接口</li>
<li>序列化具备可继承性，也就是如果某类已经实现了序列化，则它的所有子类也已经默认实现了序列化</li>
</ol>

        <h3 id="4-标准输入输出流"   >
          <a href="#4-标准输入输出流" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-标准输入输出流" class="headerlink" title="4.标准输入输出流"></a>4.标准输入输出流</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210611223857542.png" alt="image-20210611223857542"></p>

        <h3 id="5-转换流"   >
          <a href="#5-转换流" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-转换流" class="headerlink" title="5.转换流"></a>5.转换流</h3>
      
        <h4 id="1-原因"   >
          <a href="#1-原因" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-原因" class="headerlink" title="1.原因"></a>1.原因</h4>
      <p>由于文件乱码问题(没有指定读取文件的编码方式)</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.transformation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeQuestion</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//读取D:\文件拷贝\note.txt文件</span></span><br><span class="line">        <span class="comment">//思路</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1.创建字符输入流 BufferedReader [处理流]</span></span><br><span class="line"><span class="comment">         * 2.使用 BufferedReader 对象读取文件</span></span><br><span class="line"><span class="comment">         * 3.默认情况下读取文件是按照UTF-8编码,若不是则会造成错误</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        String filePath = &quot;D:\\文件拷贝\\note.txt&quot;; //UTF-8编码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\note2.txt&quot;</span>;<span class="comment">//ANSI编码</span></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(filePath));</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> br.readLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;读取到的内容:&quot;</span>+s);</span><br><span class="line">        br.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>将字节流转换为字符流,字节流可以指定编码方式</p>
<p>先将字节流指定编码方式,再将字节流转化为字符流即可解决乱码问题</p>

        <h4 id="2-InputStreamReader-amp-OutputStreamWriter介绍"   >
          <a href="#2-InputStreamReader-amp-OutputStreamWriter介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-InputStreamReader-amp-OutputStreamWriter介绍" class="headerlink" title="2.InputStreamReader&amp;OutputStreamWriter介绍"></a>2.InputStreamReader&amp;OutputStreamWriter介绍</h4>
      <ol>
<li>InputStreamReader:Reader的子类，可以将InputStream(字节流)包装成Reader(字符流)</li>
<li>OutputStreamWriter:Writer的子类,实现将OutputStream(字节流)包装成Writer(字符流)</li>
<li>当处理纯文本数据时，如果使用字符流效率更高，并且可以有效解决中文问题,所以建议将字节流转换成字符流</li>
<li>可以在使用时指定编码格式(比如utf-8, gbk , gb2312, IS08859-1等)</li>
</ol>

        <h4 id="3-InputStreamReader-1"   >
          <a href="#3-InputStreamReader-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-InputStreamReader-1" class="headerlink" title="3.InputStreamReader"></a>3.InputStreamReader</h4>
      
        <h5 id="1-构造方式"   >
          <a href="#1-构造方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方式" class="headerlink" title="1.构造方式"></a>1.构造方式</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Constructor and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>InputStreamReader(InputStream in)</code>  创建一个使用默认字符集的InputStreamReader。</td>
</tr>
<tr>
<td><code>InputStreamReader(InputStream in, Charset cs)</code>  创建一个使用给定字符集的InputStreamReader。</td>
</tr>
<tr>
<td><code>InputStreamReader(InputStream in, CharsetDecoder dec)</code>  创建一个使用给定字符集解码器的InputStreamReader。</td>
</tr>
<tr>
<td><code>InputStreamReader(InputStream in, String charsetName)</code>  创建一个使用命名字符集的InputStreamReader。</td>
</tr>
</tbody></table></div>

        <h5 id="2-常用方法-14"   >
          <a href="#2-常用方法-14" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-14" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>void</code></td>
<td><code>close()</code>  关闭流并释放与之相关联的任何系统资源。</td>
</tr>
<tr>
<td><code>String</code></td>
<td><code>getEncoding()</code>  返回此流使用的字符编码的名称。</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read()</code>  读一个字符</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>read(char[] cbuf,  int offset, int length)</code>  将字符读入数组的一部分。</td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code>ready()</code>  告诉这个流是否准备好被读取。</td>
</tr>
</tbody></table></div>

        <h5 id="3-实例"   >
          <a href="#3-实例" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-实例" class="headerlink" title="3.实例"></a>3.实例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tReader.tInputSreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myInputStreamReader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//读取D:\文件拷贝\note.txt文件</span></span><br><span class="line"></span><br><span class="line">        String filePath=<span class="string">&quot;D:\\文件拷贝\\note2.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//1.将FIleInputStream转为InputStreamReader字符流</span></span><br><span class="line">        <span class="comment">//2.指定编码gbk</span></span><br><span class="line"><span class="comment">//        InputStreamReader isr = new InputStreamReader(new FileInputStream(filePath), &quot;gbk&quot;);</span></span><br><span class="line">        <span class="comment">//3.把InputStreamReader 传入 BufferedReader</span></span><br><span class="line"><span class="comment">//        BufferedReader br = new BufferedReader(isr);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//或者</span></span><br><span class="line"></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath), <span class="string">&quot;gbk&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.读取</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> br.readLine();</span><br><span class="line">        System.out.println(<span class="string">&quot;读取的内容:&quot;</span>+s);</span><br><span class="line">        <span class="comment">//5.关闭外层流</span></span><br><span class="line">        br.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h4 id="4-OutputStreamWriter"   >
          <a href="#4-OutputStreamWriter" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-OutputStreamWriter" class="headerlink" title="4.OutputStreamWriter"></a>4.OutputStreamWriter</h4>
      
        <h5 id="1-构造方式-1"   >
          <a href="#1-构造方式-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-构造方式-1" class="headerlink" title="1.构造方式"></a>1.构造方式</h5>
      
        <h5 id="2-常用方法-15"   >
          <a href="#2-常用方法-15" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-15" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      
        <h5 id="3-实例-1"   >
          <a href="#3-实例-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-实例-1" class="headerlink" title="3.实例"></a>3.实例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tWriter.tOutputStreamWriter;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myOutputStreamWriter</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> <span class="string">&quot;D:\\文件拷贝\\note3.txt&quot;</span>;</span><br><span class="line">        <span class="comment">//指定处理的编码 gbk/uft-8/uft8</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">charSet</span> <span class="operator">=</span> <span class="string">&quot;gbk&quot;</span>;</span><br><span class="line">        <span class="type">OutputStreamWriter</span> <span class="variable">osw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(filePath), charSet);</span><br><span class="line"></span><br><span class="line">        osw.write(<span class="string">&quot;hello,吴华毅&quot;</span>);</span><br><span class="line">        osw.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;按照&quot;</span>+charSet + <span class="string">&quot;保存文件成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="6-打印流"   >
          <a href="#6-打印流" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-打印流" class="headerlink" title="6.打印流"></a>6.打印流</h3>
      <p>只有输出流,没有输入流</p>

        <h4 id="1-PrintStream-字节流"   >
          <a href="#1-PrintStream-字节流" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-PrintStream-字节流" class="headerlink" title="1.PrintStream(字节流)"></a>1.PrintStream(字节流)</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tOutputStream.tPrintStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myPrintStream</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">PrintStream</span> <span class="variable">printStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintStream</span>(System.out);</span><br><span class="line">        <span class="comment">//默认情况下,PrintStream输出数据的位置是标准输出 即显示器</span></span><br><span class="line">        printStream.print(<span class="string">&quot;john,hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//因为print底层使用的是write , 所以可以直接调用write进行打印输出</span></span><br><span class="line">        printStream.write(<span class="string">&quot;你好&quot;</span>.getBytes());</span><br><span class="line">        printStream.close();</span><br><span class="line">        <span class="comment">//可以修改打印流输出的位置/设备</span></span><br><span class="line">        <span class="comment">//修改成到 &quot;d:\\f1.txt&quot;</span></span><br><span class="line">        <span class="comment">//输出的内容会输出到该文件中</span></span><br><span class="line">        System.setOut(<span class="keyword">new</span> <span class="title class_">PrintStream</span>(<span class="string">&quot;d:\\f1.txt&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h4 id="2-PrintWriter-字符流"   >
          <a href="#2-PrintWriter-字符流" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-PrintWriter-字符流" class="headerlink" title="2.PrintWriter(字符流)"></a>2.PrintWriter(字符流)</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tWriter.tPrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">myPrintWriter</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"><span class="comment">//        PrintWriter printWriter = new PrintWriter(System.out);</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">printWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(<span class="string">&quot;d:\\f2.txt&quot;</span>));</span><br><span class="line">        printWriter.print(<span class="string">&quot;你好&quot;</span>);</span><br><span class="line"></span><br><span class="line">        printWriter.close(); <span class="comment">//不关闭的话不刷新,无法写进文件中</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="7-Properties类读取"   >
          <a href="#7-Properties类读取" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-Properties类读取" class="headerlink" title="7.Properties类读取"></a>7.Properties类读取</h3>
      
        <h4 id="1-传统实现"   >
          <a href="#1-传统实现" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-传统实现" class="headerlink" title="1.传统实现"></a>1.传统实现</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyIO.tProperties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Properties01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//读取mysql.properties文件,得到ip,user,pwd</span></span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(<span class="string">&quot;src\\mysql.properties&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span> ;</span><br><span class="line">        <span class="keyword">while</span>((line = bufferedReader.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">            String[] split = line.split(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">            System.out.println(split[<span class="number">0</span>]+<span class="string">&quot;值是:&quot;</span>+split[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        bufferedReader.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-Properties类"   >
          <a href="#2-Properties类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Properties类" class="headerlink" title="2.Properties类"></a>2.Properties类</h4>
      
        <h5 id="1-介绍-4"   >
          <a href="#1-介绍-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍-4" class="headerlink" title="1.介绍"></a>1.介绍</h5>
      <p>是HashTable的一个子类</p>
<ol>
<li>专门用于读写配置文件的集合类<br>配置文件的格式:<br>键&#x3D;值<br>键&#x3D;值</li>
<li>注意:键值对不需要有空格,值不需要用引号引起来,默认类型是String</li>
</ol>

        <h5 id="2-常用方法-16"   >
          <a href="#2-常用方法-16" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-常用方法-16" class="headerlink" title="2.常用方法"></a>2.常用方法</h5>
      <ul>
<li>load:加载配置文件的键值对到Properties对象</li>
<li>list:将数据显示到指定设备</li>
<li>getProperty(key):根据键获取值</li>
<li>setProperty(key,value):设置键值对到Properties对象</li>
<li>store:将Properties中的键值对存储到配置文件.在idea中,保存信息到配置文件,如果含有中文，会存储为unicode码</li>
</ul>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210612185213137.png" alt="image-20210612185213137"></p>

        <h1 id="Java-Thread-基础"   >
          <a href="#Java-Thread-基础" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-Thread-基础" class="headerlink" title="Java Thread(基础)"></a>Java Thread(基础)</h1>
      
        <h2 id="1-基本概念"   >
          <a href="#1-基本概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-基本概念" class="headerlink" title="1.基本概念"></a>1.基本概念</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210612221225036.png" alt="image-20210612221225036"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210612221510534.png" alt="image-20210612221510534"></p>
<p><strong>程序</strong>是含有指令和数据的⽂件，被存储在磁盘或其他的数据存储设备中，也就是说程序是静态的代码。</p>
<p><strong>进程</strong>是程序的⼀次执⾏过程，是系统运⾏程序的基本单位，因此进程是动态的。系统运⾏⼀个程序即是⼀个进程从创建，运⾏到消亡的过程。简单来说，⼀个进程就是⼀个执⾏中的程序，它在计算机中⼀个指令接着⼀个指令地执⾏着，同时，每个进程还占有某些系统资源如 CPU 时间，内存空间，⽂件，输⼊输出设备的使⽤权等等。换句话说，当程序在执⾏时，将会被操作系统载⼊内存中。 线程是进程划分成的更⼩的运⾏单位。线程和进程最⼤的不同在于基本上各进程是独⽴的，⽽各线程则不⼀定，因为同⼀进程中的线程极有可能会相互影响。从另⼀⻆度来说，进程属于操作系统的范畴，主要是同⼀段时间内，可以同时执⾏⼀个以上的程序，⽽线程则是在同⼀程序内⼏乎同时执⾏⼀个以上的程序段。</p>
<p><strong>线程</strong>与进程相似，但线程是⼀个⽐进程更⼩的执⾏单位。⼀个进程在其执⾏的过程中可以产⽣多个线程。与进程不同的是同类的多个线程共享同⼀块内存空间和⼀组系统资源，所以系统在产⽣⼀个线程，或是在各个线程之间作切换⼯作时，负担要⽐进程⼩得多，也正因为如此，线程也被称为轻量级程。</p>
<p><strong>并发</strong>:同一时刻,多个任务交替执行,单核CPU实现的多任务即是并发</p>
<p><strong>并行</strong>:同一时刻,多个任务同时执行,多核CPU可以实现并行</p>

        <h2 id="2-线程"   >
          <a href="#2-线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-线程" class="headerlink" title="2.线程"></a>2.线程</h2>
      
        <h3 id="1-创建线程基本方式"   >
          <a href="#1-创建线程基本方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-创建线程基本方式" class="headerlink" title="1.创建线程基本方式"></a>1.创建线程基本方式</h3>
      
        <h4 id="1-继承Thread类-重写run方法"   >
          <a href="#1-继承Thread类-重写run方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-继承Thread类-重写run方法" class="headerlink" title="1.继承Thread类,重写run方法"></a>1.继承Thread类,重写run方法</h4>
      
        <h5 id="1-说明-9"   >
          <a href="#1-说明-9" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-9" class="headerlink" title="1.说明"></a>1.说明</h5>
      
        <h5 id="2-实例"   >
          <a href="#2-实例" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实例" class="headerlink" title="2.实例"></a>2.实例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyThread_base.ThreadUse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Thread1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//创建一个Cat对象当做线程使用</span></span><br><span class="line">        <span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line">        cat.start();<span class="comment">//启动线程</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1.当一个类继承了Thread方法,该类就可以当做线程使用</span></span><br><span class="line"><span class="comment"> * 2.重写run方法</span></span><br><span class="line"><span class="comment"> * 3.run Thread类 实现了Runnable接口的run方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;<span class="comment">//重写run方法,</span></span><br><span class="line">        <span class="type">int</span> count=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (count&lt;<span class="number">50</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Cat say &quot;</span>+count++);</span><br><span class="line">            <span class="comment">//休眠一秒</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="2-实现Runnable接口-重写run方法"   >
          <a href="#2-实现Runnable接口-重写run方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实现Runnable接口-重写run方法" class="headerlink" title="2.实现Runnable接口,重写run方法"></a>2.实现Runnable接口,重写run方法</h4>
      
        <h5 id="1-说明-10"   >
          <a href="#1-说明-10" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-10" class="headerlink" title="1.说明"></a>1.说明</h5>
      <ol>
<li>java是单继承的，在某些情况下一个类可能已经继承了某个父类,这时在用继承Thread类方法来创建线程显然不可能了。</li>
<li>java设计者们提供了另外一个方式创建线程，就是通过实现Runnable接口来创建线程</li>
</ol>

        <h5 id="2-实例-1"   >
          <a href="#2-实例-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实例-1" class="headerlink" title="2.实例"></a>2.实例</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="2-多线程机制"   >
          <a href="#2-多线程机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-多线程机制" class="headerlink" title="2.多线程机制"></a>2.多线程机制</h3>
      <p>启动一个进程,进程中会有线程,</p>
<p>主线程main 会开启别的线程,主线程或许会先结束</p>
<p>但是直到所有的线程结束,进程才会结束</p>

        <h3 id="3-为什么是start"   >
          <a href="#3-为什么是start" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-为什么是start" class="headerlink" title="3.为什么是start"></a>3.为什么是start</h3>
      <p>直接调用run方法,只是直接调用方法,而没有开启一个线程</p>
<p>run方法就是一个普通的方法,不会真正启动一个线程,直接调用会把run方法执行完毕,才向下执行,即串行化</p>
<p>start方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (threadStatus != <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalThreadStateException</span>();</span><br><span class="line">    group.add(<span class="built_in">this</span>);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">started</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        start0();</span><br><span class="line">        started = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!started) &#123;</span><br><span class="line">                group.threadStartFailed(<span class="built_in">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable ignore) &#123;</span><br><span class="line">            <span class="comment">/* do nothing. If start0 threw a Throwable then</span></span><br><span class="line"><span class="comment">                  it will be passed up the call stack */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//真正实现多线程的效果,是start0,而不是run,最后调度是由CPU统一调度</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">start0</span><span class="params">()</span>;<span class="comment">//本地方法,实现多线程的方法,由JVM虚拟机调用,底层是C/C++实现</span></span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210616175226212.png" alt="image-20210616175226212"></p>

        <h2 id="线程七大状态"   >
          <a href="#线程七大状态" class="heading-link"><i class="fas fa-link"></i></a><a href="#线程七大状态" class="headerlink" title="线程七大状态"></a>线程七大状态</h2>
      
        <h3 id="1-线程状态转换图"   >
          <a href="#1-线程状态转换图" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-线程状态转换图" class="headerlink" title="1.线程状态转换图"></a>1.线程状态转换图</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210614180302051.png" alt="image-20210614180302051"></p>

        <h3 id="2-实例-2"   >
          <a href="#2-实例-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实例-2" class="headerlink" title="2.实例"></a>2.实例</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyThread_base.state;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadState</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        System.out.println(t.getName()+<span class="string">&quot;状态 &quot;</span>+t.getState());</span><br><span class="line">        t.start();</span><br><span class="line">        <span class="keyword">while</span>(Thread.State.TERMINATED != t.getState())&#123;</span><br><span class="line">            System.out.println(t.getName()+<span class="string">&quot;状态 &quot;</span>+t.getState());</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(t.getName()+<span class="string">&quot;状态 &quot;</span>+t.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;hi &quot;</span>+i);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h1 id="Java-网络编程"   >
          <a href="#Java-网络编程" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-网络编程" class="headerlink" title="Java 网络编程"></a>Java 网络编程</h1>
      
        <h2 id="1-网络概念"   >
          <a href="#1-网络概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-网络概念" class="headerlink" title="1.网络概念"></a>1.网络概念</h2>
      
        <h3 id="1-网络通信"   >
          <a href="#1-网络通信" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-网络通信" class="headerlink" title="1.网络通信"></a>1.网络通信</h3>
      <ol>
<li>概念:两台设备之间通过网络实现数据传输</li>
<li>网络通信:将数据通过网络从一台设备传输到另一台设备</li>
<li>java.net包下提供了一系列的类或接口，供程序员使用,完成网络通信</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210616182859668.png" alt="image-20210616182859668"></p>

        <h3 id="2-网络"   >
          <a href="#2-网络" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-网络" class="headerlink" title="2.网络"></a>2.网络</h3>
      <ol>
<li>概念:两台或多台设备通过一定物理设备连接起来构成了网络</li>
<li>根据网络的覆盖范围不同，对网络进行分类:<br>局域网:覆盖范围最小,仅仅覆盖一个教室或一个机房<br>城域网:覆盖范围较大，可以覆盖一个城市<br>广域网:覆盖范围最大，可以覆盖全国，甚至全球,万维网是广域网的代表</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210616183213099.png" alt="image-20210616183213099"></p>

        <h3 id="3-IP地址"   >
          <a href="#3-IP地址" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-IP地址" class="headerlink" title="3.IP地址"></a>3.IP地址</h3>
      <ol>
<li>概念:用于唯一标识网络中的每台计算机</li>
<li>查看ip地址: ipconfig</li>
<li>IPV4:ip地址的表示形式:点分十进制XX.XX.XX.XX</li>
<li>每一个十进制数的范围:0~255</li>
<li>ip地址的组成&#x3D;网络地址+主机地址，比如:192.168.16.69</li>
<li>iPv6是互联网工程任务组设计的用于替代IPv4的下一代IP协议，其地址数量号称可以为全世界的每一粒沙子编上一个地址。使用128位表示一个地址,16个字节,是IPV4的四倍</li>
<li>由于IPv4最大的问题在于网络地址资源有限，严重制约了互联网的应用和发展。IPv6的使用，不仅能解决网络地址资源数量的问题，而且也解决了多种接入设备连入互联网的障碍</li>
</ol>

        <h4 id="ip地址分类"   >
          <a href="#ip地址分类" class="heading-link"><i class="fas fa-link"></i></a><a href="#ip地址分类" class="headerlink" title="ip地址分类"></a>ip地址分类</h4>
      <p>A类 0+7位网络号+24位主机号</p>
<p>B类 10+14位网络号+16位主机号</p>
<p>C类 110+21位网络号+8位主机号</p>
<p>D类 1110+28位多播组号</p>
<p>E类 11110+27位(留待后用)</p>

        <h3 id="4-域名"   >
          <a href="#4-域名" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-域名" class="headerlink" title="4.域名"></a>4.域名</h3>
      <ol>
<li><p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.baidu.com/" >www.baidu.com</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</li>
<li><p>好处:为了方便记忆,解决记ip的困难</p>
</li>
<li><p>概念:将ip地址映射成域名</p>
<p>DNS协议</p>
</li>
</ol>

        <h3 id="5-端口号"   >
          <a href="#5-端口号" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-端口号" class="headerlink" title="5.端口号"></a>5.端口号</h3>
      <ol>
<li>概念:用于标识计算机上某个特定的网络程序</li>
<li>表示形式:以整数形式,范围0~65535</li>
<li>0~1024已经被占用,比如ssh 22, ftp 21, smtp 25 http 80</li>
<li>常见的网络程序端口号:<ul>
<li>tomcat :8080</li>
<li>mysql:3306</li>
<li>oracle:1521 </li>
<li>sqlserver:1433</li>
</ul>
</li>
</ol>

        <h3 id="6-网络通信协议"   >
          <a href="#6-网络通信协议" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-网络通信协议" class="headerlink" title="6.网络通信协议"></a>6.网络通信协议</h3>
      <p>**本质:**在网络编程中,数据的组织形式就是协议</p>
<p>协议(tcp&#x2F;ip)</p>
<p>TCP&#x2F;IP (Transmission ControlProtocol&#x2F;Internet Protocol)的简写,中文译名为&#x3D;&#x3D;传输控制协议&#x3D;&#x3D;&#x2F;&#x3D;&#x3D;因特网互联协议&#x3D;&#x3D;，又叫网络通讯协议</p>
<p>这个协议是lnternet最基本的协议、Internet国际互联网络的基础，简单地说，就是由网络层的IP协议和传输层的TCP协议组成的[示意图]</p>
<p><strong>数据进入协议栈时的封装过程:</strong></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617104512976.png" alt="image-20210617104512976"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617105831796.png" alt="image-20210617105831796"></p>

        <h3 id="7-TCP与UDP"   >
          <a href="#7-TCP与UDP" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-TCP与UDP" class="headerlink" title="7.TCP与UDP"></a>7.TCP与UDP</h3>
      <p>TCP协议:传输控制协议</p>
<ol>
<li>使用TCP协议前，须先建立TCP连接，形成传输数据通道</li>
<li>传输前，采用”三次握手”方式,是可靠的</li>
<li>TCP协议进行通信的两个应用进程:客户端、服务端</li>
<li>在连接中可进行大数据量的传输</li>
<li>传输完毕，需释放已建立的连接，效率低</li>
</ol>
<p>UDP协议:用户数据协议</p>
<ol>
<li>将数据、源、目的封装成数据包,不需要建立连接</li>
<li>每个数据报的大小限制在64K内</li>
<li>因无需连接，故是不可靠的</li>
<li>发送数据结束时无需释放资源(因为不是面向连接的)，速度快</li>
<li>举例:厕所通知:发短信</li>
</ol>

        <h3 id="8-InetAddress类"   >
          <a href="#8-InetAddress类" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-InetAddress类" class="headerlink" title="8.InetAddress类"></a>8.InetAddress类</h3>
      
        <h4 id="1-相关方法"   >
          <a href="#1-相关方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-相关方法" class="headerlink" title="1.相关方法"></a>1.相关方法</h4>
      <ol>
<li>获取本机InetAddress对象getLocalHost</li>
<li>根据指定主机名&#x2F;域名获取ip地址对象getByName</li>
<li>获取InetAddress对象的主机名getHostName</li>
<li>获取InetAddress对象的地址 getHostAddress</li>
</ol>

        <h4 id="2-示例"   >
          <a href="#2-示例" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-示例" class="headerlink" title="2.示例"></a>2.示例</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.MyInetAddress;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InetAddress01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnknownHostException &#123;</span><br><span class="line">        <span class="type">InetAddress</span> <span class="variable">localHost</span> <span class="operator">=</span> InetAddress.getLocalHost();</span><br><span class="line">        System.out.println(localHost);<span class="comment">//DESKTOP-IFHJD48/192.168.71.1</span></span><br><span class="line">        <span class="comment">//根据指定主机名,获取InetAddress对象</span></span><br><span class="line">        <span class="type">InetAddress</span> <span class="variable">byName</span> <span class="operator">=</span> InetAddress.getByName(<span class="string">&quot;DESKTOP-IFHJD48&quot;</span>);</span><br><span class="line">        System.out.println(byName);</span><br><span class="line">        <span class="comment">//根据域名返回InetAddress对象,比如www.baidu.com</span></span><br><span class="line">        <span class="type">InetAddress</span> <span class="variable">byName1</span> <span class="operator">=</span> InetAddress.getByName(<span class="string">&quot;www.baidu.com&quot;</span>);</span><br><span class="line">        System.out.println(byName1);</span><br><span class="line">        <span class="comment">//通过InetAddress对象,获取对应的地址</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">hostAddress</span> <span class="operator">=</span> byName1.getHostAddress();</span><br><span class="line">        System.out.println(hostAddress);</span><br><span class="line">        <span class="comment">//通过InetAddress对象,获取对应的主机名/域名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">hostName</span> <span class="operator">=</span> byName1.getHostName();</span><br><span class="line">        System.out.println(hostName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h3 id="9-Socket"   >
          <a href="#9-Socket" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-Socket" class="headerlink" title="9.Socket"></a>9.Socket</h3>
      
        <h4 id="1-基本介绍"   >
          <a href="#1-基本介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-基本介绍" class="headerlink" title="1.基本介绍"></a>1.基本介绍</h4>
      <ol>
<li>套接字(Socket)开发网络应用程序被广泛采用，以至于成为事实上的标准。</li>
<li>通信的两端都要有Socket，是两台机器间通信的端点</li>
<li>网络通信其实就是Socket间的通信。</li>
<li>Socket允许程序把网络连接当成一个流，数据在两个Socket间通过IO传输。</li>
<li>一般主动发起通信的应用程序属客户端,等待通信请求的为服务端</li>
</ol>

        <h4 id="2-TCP网络通信编程"   >
          <a href="#2-TCP网络通信编程" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-TCP网络通信编程" class="headerlink" title="2.TCP网络通信编程"></a>2.TCP网络通信编程</h4>
      <ol>
<li>基于客户端-服务端的网络通信</li>
<li>底层使用的是TCP&#x2F;IP协议</li>
<li>应用场景举例:客户端发送数据，服务端接受并显示</li>
<li>基于Socket的TCP编程</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617112235183.png" alt="image-20210617112235183"></p>

        <h4 id="3-UDP网络通信编程"   >
          <a href="#3-UDP网络通信编程" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-UDP网络通信编程" class="headerlink" title="3.UDP网络通信编程"></a>3.UDP网络通信编程</h4>
      
        <h2 id="2-TCP网络通信编程-1"   >
          <a href="#2-TCP网络通信编程-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-TCP网络通信编程-1" class="headerlink" title="2.TCP网络通信编程"></a>2.TCP网络通信编程</h2>
      
        <h3 id="1-实例1-字节流"   >
          <a href="#1-实例1-字节流" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-实例1-字节流" class="headerlink" title="1.实例1(字节流)"></a>1.实例1(字节流)</h3>
      <p>使用字节流</p>
<p>两个程序:服务端与客户端</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617113019835.png" alt="image-20210617113019835"></p>
<p>思路:</p>
<p>客户端</p>
<ol>
<li>连接服务端(ip，端口)</li>
<li>连接上后，生成Socket,通过socket.getOutputStream()</li>
<li>通过输出流，写入数据到数据通道</li>
</ol>
<p>服务端:</p>
<ol>
<li>在本机的9999端口监听,等待连接</li>
<li>当没有客户端连接9999端口时，程序会阻塞,等待连接</li>
<li>通过socket.getlnputStream()读取客户端写入到数据通道的数据,显示</li>
</ol>
<p>client</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketTCP01Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1,连接服务端(IP,端口)</span></span><br><span class="line">        <span class="comment">//连接InetAddress.getLocalHost()的9999端口,连接成功,返回一个socket对象</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line"><span class="comment">//        System.out.println(&quot;客户端 socket=&quot;+socket.getClass());</span></span><br><span class="line">        <span class="comment">//2.连接上后,生成Socket,通过socket.getOutputStream()</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="comment">//3.通过输入流,写入数据到数据通道</span></span><br><span class="line">        os.write(<span class="string">&quot;hello,server&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">//4.关闭流对象和socket</span></span><br><span class="line">        os.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;客户端退出&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>server</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketTCP01Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//思路:</span></span><br><span class="line">        <span class="comment">//1.在本机的9999端口监听,等待连接,要求本机没有其他服务监听9999</span></span><br><span class="line">        <span class="comment">//ServerSocket可以通过accept()返回多个socket对象[多个客户端连接服务器的并发]</span></span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">//2.当没有客户端连接9999端口时,程序会阻塞,等待连接</span></span><br><span class="line">        <span class="comment">//如果有客户端连接,则会返回Socket对象,程序继续</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line"><span class="comment">//        System.out.println(&quot;socket =&quot;+socket.getClass());</span></span><br><span class="line">        <span class="comment">//3.通过socket.getInputStream()读取客户端写入到数据通道的数据,显示</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">while</span>((len=is.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.print(<span class="keyword">new</span> <span class="title class_">String</span>(bytes,<span class="number">0</span>,len));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.关闭流对象和socket</span></span><br><span class="line">        is.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h3 id="2-实例2-字节流"   >
          <a href="#2-实例2-字节流" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实例2-字节流" class="headerlink" title="2.实例2(字节流)"></a>2.实例2(字节流)</h3>
      <p>使用字节流</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617121232695.png" alt="image-20210617121232695"></p>
<p>客户端与服务端互相发送消息的时候,没有结束标记,会导致阻塞,应该有结束标记</p>
<p>设置写入结束标记<code>socket.shutdownOutput();</code></p>
<p>client</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketTCP02Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1,连接服务端(IP,端口)</span></span><br><span class="line">        <span class="comment">//连接InetAddress.getLocalHost()的9999端口,连接成功,返回一个socket对象</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line"><span class="comment">//        System.out.println(&quot;客户端 socket=&quot;+socket.getClass());</span></span><br><span class="line">        <span class="comment">//2.连接上后,生成Socket,通过socket.getOutputStream()</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="comment">//3.通过输入流,写入数据到数据通道</span></span><br><span class="line">        os.write(<span class="string">&quot;hello,server&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">//设置结束标记</span></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        <span class="comment">//4.接收消息</span></span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">while</span>((len=is.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(bytes,<span class="number">0</span>,len));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5.关闭流对象和socket</span></span><br><span class="line">        is.close();</span><br><span class="line">        os.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;客户端退出&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>server</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketTCP02Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//思路:</span></span><br><span class="line">        <span class="comment">//1.在本机的9999端口监听,等待连接,要求本机没有其他服务监听9999</span></span><br><span class="line">        <span class="comment">//ServerSocket可以通过accept()返回多个socket对象[多个客户端连接服务器的并发]</span></span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">//2.当没有客户端连接9999端口时,程序会阻塞,等待连接</span></span><br><span class="line">        <span class="comment">//如果有客户端连接,则会返回Socket对象,程序继续</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line"><span class="comment">//        System.out.println(&quot;socket =&quot;+socket.getClass());</span></span><br><span class="line">        <span class="comment">//3.通过socket.getInputStream()读取客户端写入到数据通道的数据,显示</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">while</span>((len=is.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(bytes,<span class="number">0</span>,len));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.接收完毕,回送消息</span></span><br><span class="line">        os.write(<span class="string">&quot;hello,client&quot;</span>.getBytes());</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        <span class="comment">//5.关闭流对象和socket</span></span><br><span class="line">        os.close();</span><br><span class="line">        is.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="3-实例3-字符流"   >
          <a href="#3-实例3-字符流" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-实例3-字符流" class="headerlink" title="3.实例3(字符流)"></a>3.实例3(字符流)</h3>
      <p>使用字符流</p>
<p>使用writer.newLine()&#x2F;&#x2F;换行符 作为结束标记,需要使用readLine读取</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617123358060.png" alt="image-20210617123358060"></p>
<p>client:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketTCP03Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1,连接服务端(IP,端口)</span></span><br><span class="line">        <span class="comment">//连接InetAddress.getLocalHost()的9999端口,连接成功,返回一个socket对象</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line"><span class="comment">//        System.out.println(&quot;客户端 socket=&quot;+socket.getClass());</span></span><br><span class="line">        <span class="comment">//2.连接上后,生成Socket,通过socket.getOutputStream()</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(os));</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(is));</span><br><span class="line">        <span class="comment">//3.通过输入流,写入数据到数据通道</span></span><br><span class="line">        bw.write(<span class="string">&quot;hello,server&quot;</span>);</span><br><span class="line">        bw.newLine();<span class="comment">//插入换行符,表示写入的内容结束,此时要求对方使用readLine()方法读取</span></span><br><span class="line">        bw.write(<span class="string">&quot;the test&quot;</span>);</span><br><span class="line">        bw.flush();<span class="comment">//使用字符流,需要手动刷新,否则数据不会写入数据通道</span></span><br><span class="line">        <span class="comment">//设置结束标记</span></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        <span class="comment">//4.接收消息</span></span><br><span class="line">        String str;</span><br><span class="line">        <span class="keyword">while</span>((str=br.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5.关闭流对象和socket</span></span><br><span class="line">        br.close();</span><br><span class="line">        bw.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;客户端退出&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>server:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketTCP03Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//思路:</span></span><br><span class="line">        <span class="comment">//1.在本机的9999端口监听,等待连接,要求本机没有其他服务监听9999</span></span><br><span class="line">        <span class="comment">//ServerSocket可以通过accept()返回多个socket对象[多个客户端连接服务器的并发]</span></span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">//2.当没有客户端连接9999端口时,程序会阻塞,等待连接</span></span><br><span class="line">        <span class="comment">//如果有客户端连接,则会返回Socket对象,程序继续</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line"><span class="comment">//        System.out.println(&quot;socket =&quot;+socket.getClass());</span></span><br><span class="line">        <span class="comment">//3.通过socket.getInputStream()读取客户端写入到数据通道的数据,显示</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="comment">//使用转换流,将字节流转换为字符流,并使用处理流包装</span></span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(os));</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(is));</span><br><span class="line">        String str;</span><br><span class="line">        <span class="keyword">while</span>((str = br.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.接收完毕,回送消息</span></span><br><span class="line">        bw.write(<span class="string">&quot;hello,client&quot;</span>);</span><br><span class="line">        bw.newLine();</span><br><span class="line">        bw.flush();</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line">        <span class="comment">//5.关闭流对象和socket</span></span><br><span class="line">        bw.close();</span><br><span class="line">        br.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="4-实例4-网络上传文件"   >
          <a href="#4-实例4-网络上传文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-实例4-网络上传文件" class="headerlink" title="4.实例4(网络上传文件)"></a>4.实例4(网络上传文件)</h3>
      <p>使用BufferedInputStream与BufferedOutputStream字节流</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617125629638.png" alt="image-20210617125629638"></p>
<p>思路:</p>
<p>客户端:</p>
<ol>
<li>输入流将磁盘文件读入,存放到字节数组中</li>
<li>socket字节流,将字节数组写入传输</li>
<li>接收服务端回馈消息</li>
<li>关闭</li>
</ol>
<p>服务端:</p>
<ol>
<li>socket读取传输过来的数据,保存在一个字节数组中</li>
<li>将字节数组通过输出流输出到指定目录</li>
<li>socket得到输出流,发送收到图片消息</li>
<li>关闭</li>
</ol>
<p>client:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TCPFileUploadClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//进行连接</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getLocalHost(),<span class="number">9999</span>);</span><br><span class="line">        String filePath=<span class="string">&quot;D:\\文件拷贝\\theTest.bmp&quot;</span>;</span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath);</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">byte</span>[] bytes = StreamUtil.streamToByteArray(fis);</span><br><span class="line">        outputStream.write(bytes);</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"><span class="comment">//        int len;</span></span><br><span class="line"><span class="comment">//        byte[] bytes = new byte[1024];</span></span><br><span class="line"><span class="comment">//        while((len=fis.read(bytes))!=-1)&#123;</span></span><br><span class="line"><span class="comment">//            outputStream.write(bytes,0,len);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        socket.shutdownOutput();</span></span><br><span class="line"><span class="comment">//        InputStream inputStream = socket.getInputStream();</span></span><br><span class="line"><span class="comment">//        while ((len=inputStream.read(bytes))!=-1)&#123;</span></span><br><span class="line"><span class="comment">//            System.out.print(new String(bytes,0,len));</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//1.直接使用读取</span></span><br><span class="line"><span class="comment">//        int len;</span></span><br><span class="line"><span class="comment">//        byte[] bytes2 = new byte[1024];</span></span><br><span class="line"><span class="comment">//        InputStream inputStream = socket.getInputStream();</span></span><br><span class="line"><span class="comment">//        while ((len=inputStream.read(bytes2))!=-1)&#123;</span></span><br><span class="line"><span class="comment">//            System.out.print(new String(bytes2,0,len));</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//2.使用处理流</span></span><br><span class="line"><span class="comment">//        BufferedReader br = new BufferedReader(new InputStreamReader(socket.getInputStream()));</span></span><br><span class="line"><span class="comment">//        String str;</span></span><br><span class="line"><span class="comment">//        while((str=br.readLine())!=null)&#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(str);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//3.使用StreamUtils</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> StreamUtil.streamToString(socket.getInputStream());</span><br><span class="line">        System.out.println(s);</span><br><span class="line"></span><br><span class="line">        fis.close();</span><br><span class="line">        outputStream.close();</span><br><span class="line"><span class="comment">//        br.close();</span></span><br><span class="line"><span class="comment">//        inputStream.close();</span></span><br><span class="line">        socket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>server:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TCPFileUploadServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//等待连接</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//连接成功,获取socket传过来的数据,将其写出</span></span><br><span class="line"><span class="comment">//        int len;</span></span><br><span class="line"><span class="comment">//        byte[] bytes = new byte[1024];</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;src\\test.bmp&quot;</span>);</span><br><span class="line"><span class="comment">//        while((len=inputStream.read(bytes))!=-1)&#123;</span></span><br><span class="line"><span class="comment">//            fileOutputStream.write(bytes,0,len);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="type">byte</span>[] array = StreamUtil.streamToByteArray(inputStream);</span><br><span class="line">        fileOutputStream.write(array);</span><br><span class="line">        <span class="comment">//接收完毕,返回信息</span></span><br><span class="line"><span class="comment">//        OutputStream outputStream = socket.getOutputStream();</span></span><br><span class="line"><span class="comment">//        outputStream.write(&quot;收到图片&quot;.getBytes());</span></span><br><span class="line"></span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(socket.getOutputStream()));</span><br><span class="line">        bw.write(<span class="string">&quot;收到图片&quot;</span>);</span><br><span class="line">        bw.flush();<span class="comment">//把内容刷新到数据通道</span></span><br><span class="line">        socket.shutdownOutput();<span class="comment">//结束标记</span></span><br><span class="line"><span class="comment">//        outputStream.close();</span></span><br><span class="line">        bw.close();</span><br><span class="line">        inputStream.close();</span><br><span class="line">        fileOutputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>StreamUtil</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.TCP.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] streamToByteArray(InputStream inputStream) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((len=inputStream.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            bos.write(bytes,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">byte</span>[] array = bos.toByteArray();</span><br><span class="line">        bos.close();</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">streamToString</span><span class="params">(InputStream inputStream)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream));</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line = bufferedReader.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">            builder.append(line+<span class="string">&quot;\r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        bufferedReader.close();</span><br><span class="line">        <span class="keyword">return</span> builder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="5-netstat-指令"   >
          <a href="#5-netstat-指令" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-netstat-指令" class="headerlink" title="5.netstat 指令"></a>5.netstat 指令</h3>
      <ol>
<li>netstat -an可以查看当前主机网络情况，包括端口&#x3D;&#x3D;监听情况&#x3D;&#x3D;和&#x3D;&#x3D;网络连接情况&#x3D;&#x3D;</li>
<li>netstat -an | more可以分页显示</li>
<li>netstat -anb | more 查看程序</li>
<li>要求在dos控制台下执行</li>
</ol>
<p>说明:</p>
<ol>
<li>Listening表示某个端口在监听</li>
<li>如果有一个外部程序(客户端)连接到该端口,就会显示一条连接信息</li>
<li>可以输入ctrl+c退出</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617173337770.png" alt="image-20210617173337770"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617173359839.png" alt="image-20210617173359839"></p>

        <h3 id="6-说明"   >
          <a href="#6-说明" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-说明" class="headerlink" title="6.说明"></a>6.说明</h3>
      <p>当客户端连接到服务端后,实际上客户端也是通过一个端口和服务端进行通讯的,这个端口是TCP&#x2F;IP来分配的,是不确定的,随机的</p>
<p>程序验证 使用netstat</p>

        <h2 id="3-UDP网络通信编程-1"   >
          <a href="#3-UDP网络通信编程-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-UDP网络通信编程-1" class="headerlink" title="3.UDP网络通信编程"></a>3.UDP网络通信编程</h2>
      
        <h3 id="1-说明-11"   >
          <a href="#1-说明-11" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-说明-11" class="headerlink" title="1.说明"></a>1.说明</h3>
      <ol>
<li><p>类 DatagramSocket和 DatagramPacket实现了基于UDP 协议网络程序</p>
</li>
<li><p>UDP数据报通过数据报套接字DatagramSocket 发送和接收，系统不保证UDP数据报一定能够安全送到目的地，也不能确定什么时候可以抵达。</p>
</li>
<li><p>DatagramPacket对象封装了UDP数据报，在数据报中包含了发送端的IP地址和端口号以及接收端的IP地址和端口号。</p>
</li>
<li><p>UDP协议中每个数据报都给出了完整的地址信息，因此无须建立发送方和接收方的连接</p>
</li>
<li><p>没有明确的服务端和客户端,演变成数据的发送端和接收端</p>
</li>
<li><p>接收数据和发送数据是通过DatagramSocket对象完成</p>
<p>send,receive</p>
</li>
<li><p>将数据封装到DatagramPacket对象(装包),发送</p>
</li>
<li><p>当接收到DatagramPacket对象,需要进行拆包,取出数据</p>
</li>
<li><p>DatagramSocket可以指定在哪个端口接收数据</p>
</li>
</ol>

        <h3 id="2-基本流程"   >
          <a href="#2-基本流程" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-基本流程" class="headerlink" title="2.基本流程"></a>2.基本流程</h3>
      <ol>
<li>核心的两个类&#x2F;对象 DatagramSocket与DatagramPacket</li>
<li>建立发送端，接收端</li>
<li>发送数据前,建立数据包&#x2F;报,DatagramPacket对象</li>
<li>调用DatagramSocket的发送、接收方法</li>
<li>关闭DatagramSocket</li>
</ol>

        <h3 id="3-实例1"   >
          <a href="#3-实例1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-实例1" class="headerlink" title="3.实例1"></a>3.实例1</h3>
      <ol>
<li>编写一个接收端A,和一个发送端B</li>
<li>接收端A在9999端口等待接收数据(receive)</li>
<li>发送端A向接收端B发送数据hello，明天吃火锅~”</li>
<li>接收端B接收到发送端A发送的数据，回复“好的,明天见”,再退出</li>
<li>发送端接收回复的数据，再退出</li>
</ol>
<p>发送端</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.UDP.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UDPSender</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1.创建DatagramSocket对象,准备发送和接收数据</span></span><br><span class="line">        <span class="comment">//在端口9998准备接收数据</span></span><br><span class="line">        <span class="type">DatagramSocket</span> <span class="variable">datagramSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DatagramSocket</span>(<span class="number">9998</span>);</span><br><span class="line">        <span class="comment">//2.将需要发送的数据进行装包到DatagramPacket对象中</span></span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="string">&quot;hello 明天吃火锅&quot;</span>.getBytes();</span><br><span class="line">        <span class="type">DatagramPacket</span> <span class="variable">packet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DatagramPacket</span>(bytes,<span class="number">0</span>,bytes.length, InetAddress.getByName(<span class="string">&quot;192.168.72.1&quot;</span>),<span class="number">9999</span>);</span><br><span class="line">        datagramSocket.send(packet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.接收</span></span><br><span class="line">        <span class="type">byte</span>[] bytes1 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">64</span>*<span class="number">1024</span>];</span><br><span class="line">        <span class="type">DatagramPacket</span> <span class="variable">packet1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DatagramPacket</span>(bytes1,bytes1.length);</span><br><span class="line">        datagramSocket.receive(packet1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.拆包</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> packet1.getLength();</span><br><span class="line">        <span class="type">byte</span>[] data = packet1.getData();</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(data, <span class="number">0</span>, length));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭</span></span><br><span class="line">        datagramSocket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;发送端退出&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>接收端</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.UDP.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramPacket;</span><br><span class="line"><span class="keyword">import</span> java.net.DatagramSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UDPReceiver</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1.创建一个DatagramSocket对象,在9999端口准备接收数据</span></span><br><span class="line">        <span class="type">DatagramSocket</span> <span class="variable">datagramSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DatagramSocket</span>(<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">//2.构建一个DatagramPacket对象,准备接收数据</span></span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">64</span>*<span class="number">1024</span>];<span class="comment">//UDP协议数据包最大不超过64KB</span></span><br><span class="line">        <span class="type">DatagramPacket</span> <span class="variable">packet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DatagramPacket</span>(bytes,bytes.length);</span><br><span class="line">        <span class="comment">//3.调用接收方法,将通过网络传输的DatagramPacket对象填充到packet中</span></span><br><span class="line">        <span class="comment">//有数据包发送到本机的9999端口时,该方法会接收到数据,否则会阻塞等待</span></span><br><span class="line">        System.out.println(<span class="string">&quot;接收端等待数据传输..&quot;</span>);</span><br><span class="line">        datagramSocket.receive(packet);</span><br><span class="line">        <span class="comment">//4.对packet进行拆包,取出数据,显示</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> packet.getLength();<span class="comment">//实际接收到的数据长度</span></span><br><span class="line">        <span class="type">byte</span>[] data = packet.getData();<span class="comment">//接收到的数据</span></span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(data, <span class="number">0</span>, length));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送给发送端</span></span><br><span class="line">        <span class="type">byte</span>[] bytes1 = <span class="string">&quot;好的,明天见&quot;</span>.getBytes();</span><br><span class="line">        <span class="type">DatagramPacket</span> <span class="variable">packet1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DatagramPacket</span>(bytes1,<span class="number">0</span>,bytes1.length, InetAddress.getByName(<span class="string">&quot;192.168.72.1&quot;</span>),<span class="number">9998</span>);</span><br><span class="line">        datagramSocket.send(packet1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.关闭资源</span></span><br><span class="line">        datagramSocket.close();</span><br><span class="line">        System.out.println(<span class="string">&quot;接收端退出&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="4-练习"   >
          <a href="#4-练习" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-练习" class="headerlink" title="4.练习"></a>4.练习</h2>
      
        <h3 id="1"   >
          <a href="#1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1" class="headerlink" title="1."></a>1.</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617205048896.png" alt="image-20210617205048896"></p>
<p>服务端</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.homework.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">answerServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//监听9999端口</span></span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9999</span>);</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(is));</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(os));</span><br><span class="line">        String s=br.readLine();</span><br><span class="line">        String answer;</span><br><span class="line">        <span class="keyword">if</span> (s.equals(<span class="string">&quot;name&quot;</span>))&#123;</span><br><span class="line">            answer=<span class="string">&quot;我是why&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.equals(<span class="string">&quot;hobby&quot;</span>))&#123;</span><br><span class="line">            answer=<span class="string">&quot;编写Java&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            answer=<span class="string">&quot;不懂&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        bw.write(answer);</span><br><span class="line">        bw.flush();</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line">        bw.close();</span><br><span class="line">        br.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>客户端</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.homework.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">questionClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//连接本机9999端口</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getLocalHost(),<span class="number">9999</span>);</span><br><span class="line">        <span class="comment">//连接上后传输字符</span></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">os</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(os));</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入你的问题:&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        bw.write(scanner.next());</span><br><span class="line">        bw.flush();</span><br><span class="line"></span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(is));</span><br><span class="line">        String s;</span><br><span class="line">        <span class="keyword">while</span>((s=br.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">        bw.close();</span><br><span class="line">        br.close();</span><br><span class="line">        socket.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>存在问题:只能问一次,怎么问多次</p>
<p>扩展:聊天</p>

        <h3 id="2"   >
          <a href="#2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2" class="headerlink" title="2."></a>2.</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617205428632.png" alt="image-20210617205428632"></p>

        <h3 id="3-下载文件的应用"   >
          <a href="#3-下载文件的应用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-下载文件的应用" class="headerlink" title="3.下载文件的应用"></a>3.下载文件的应用</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210617210347258.png" alt="image-20210617210347258"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.homework.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TCPDownLoadClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//与本机9999端口建立连接</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getLocalHost(),<span class="number">8521</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入要下载的文件名:&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">downLoad</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入要保存为的文件名:&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">save</span> <span class="operator">=</span> scanner.next();</span><br><span class="line"></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">bw</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(outputStream));</span><br><span class="line">        bw.write(downLoad);</span><br><span class="line">        bw.flush();</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">byte</span>[] bytes = StreamUtil.streamToByteArray(inputStream);<span class="comment">//将下载来的文件保存在字节数组中</span></span><br><span class="line">        <span class="comment">//保存路径</span></span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;src\\com\\why\\MyInternet\\Socket\\homework\\demo03\\&quot;</span>+save);</span><br><span class="line"></span><br><span class="line">        fileOutputStream.write(bytes);<span class="comment">//将文件写入</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭</span></span><br><span class="line">        bw.close();</span><br><span class="line">        fileOutputStream.close();</span><br><span class="line">        inputStream.close();</span><br><span class="line">        outputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;下载完成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.MyInternet.Socket.homework.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TCPDownLoadServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//监听端口8521</span></span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">8521</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;等待客户端连接&quot;</span>);</span><br><span class="line">        <span class="comment">//等待客户端连接</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line">        <span class="comment">//读取客户端发送的需要下载的文件</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> StreamUtil.streamToString(inputStream);<span class="comment">//获得想要下载的文件名称</span></span><br><span class="line">        System.out.println(<span class="string">&quot;客户端需要下载的文件名:&quot;</span>+s);</span><br><span class="line"></span><br><span class="line">        String filePath=<span class="string">&quot;src\\com\\why\\MyInternet\\Socket\\homework\\demo03\\save\\&quot;</span>+s;<span class="comment">//获得文件路径</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filePath);</span><br><span class="line">        System.out.println(<span class="string">&quot;正在判断文件&quot;</span>+s+<span class="string">&quot;是否存在&quot;</span>);</span><br><span class="line">        <span class="comment">//判断文件是否存在</span></span><br><span class="line">        <span class="keyword">if</span> (!file.exists())&#123;</span><br><span class="line">            <span class="comment">//不存在路径改变为默认</span></span><br><span class="line">            filePath = <span class="string">&quot;src\\com\\why\\MyInternet\\Socket\\homework\\demo03\\save\\default.bmp&quot;</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;文件不存在&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;文件存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">byte</span>[] bytes = StreamUtil.streamToByteArray(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(filePath));</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> socket.getOutputStream();</span><br><span class="line">        outputStream.write(bytes);</span><br><span class="line">        socket.shutdownOutput();</span><br><span class="line"></span><br><span class="line"><span class="comment">//        FileInputStream fileInputStream = new FileInputStream(filePath);//读取要下载的文件</span></span><br><span class="line"><span class="comment">//        byte[] bytes = StreamUtil.streamToByteArray(fileInputStream);//将文件保存在数组中</span></span><br><span class="line">        outputStream.close();</span><br><span class="line">        inputStream.close();</span><br><span class="line">        socket.close();</span><br><span class="line">        serverSocket.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>






        <h2 id="5-Java多用户通信系统"   >
          <a href="#5-Java多用户通信系统" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Java多用户通信系统" class="headerlink" title="5.Java多用户通信系统"></a>5.Java多用户通信系统</h2>
      
        <h3 id="1-需求分析"   >
          <a href="#1-需求分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-需求分析" class="headerlink" title="1.需求分析"></a>1.需求分析</h3>
      <ul>
<li>用户登录</li>
<li>拉取在线用户列表</li>
<li>无异常退出(客户端,服务端)</li>
<li>私聊</li>
<li>群聊</li>
<li>发文件</li>
<li>服务器推送新闻</li>
</ul>

        <h3 id="2-系统分析"   >
          <a href="#2-系统分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-系统分析" class="headerlink" title="2.系统分析"></a>2.系统分析</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210628112954638.png" alt="image-20210628112954638"></p>

        <h3 id="3-QQ用户登录"   >
          <a href="#3-QQ用户登录" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-QQ用户登录" class="headerlink" title="3.QQ用户登录"></a>3.QQ用户登录</h3>
      
        <h4 id="1-客户端"   >
          <a href="#1-客户端" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-客户端" class="headerlink" title="1.客户端"></a>1.客户端</h4>
      
        <h5 id="1-读取输入工具类"   >
          <a href="#1-读取输入工具类" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-读取输入工具类" class="headerlink" title="1.读取输入工具类"></a>1.读取输入工具类</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/28 20:04</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Utility</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Scanner scanner;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        scanner=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Utility</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">char</span> <span class="title function_">readMenuSelection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            String str=readKeyBoard(<span class="number">1</span>,<span class="literal">false</span>);</span><br><span class="line">            <span class="type">char</span> c=str.charAt(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="number">1</span> || c == <span class="number">2</span> || c == <span class="number">3</span> || c == <span class="number">4</span> || c == <span class="number">5</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> c;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.print(<span class="string">&quot;选择错误,请重新输入:&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">char</span> <span class="title function_">readChar</span><span class="params">()</span>&#123;</span><br><span class="line">        String str=readKeyBoard(<span class="number">1</span>,<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> str.charAt(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">char</span> <span class="title function_">readChar</span><span class="params">(<span class="type">char</span> defaultValue)</span>&#123;</span><br><span class="line">        String str=readKeyBoard(<span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> str.length()==<span class="number">0</span>?defaultValue:str.charAt(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">readInt</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            String str=readKeyBoard(<span class="number">2</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">int</span> n=Integer.parseInt(str);</span><br><span class="line">                <span class="keyword">return</span> n;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (NumberFormatException var3)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;数字输入错误,请重新输入:&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">readInt</span><span class="params">(<span class="type">int</span> defaultValue)</span> &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> readKeyBoard(<span class="number">2</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (str.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> defaultValue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> Integer.parseInt(str);</span><br><span class="line">                <span class="keyword">return</span> n;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NumberFormatException var4) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;数字输入错误,请重新输入:&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">readString</span><span class="params">(<span class="type">int</span> limit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> readKeyBoard(limit, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">readString</span><span class="params">(<span class="type">int</span> limit, String defaultValue)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> readKeyBoard(limit, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> str.equals(<span class="string">&quot;&quot;</span>) ? defaultValue : str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">char</span> <span class="title function_">readConfirmSelection</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            String str=readKeyBoard(<span class="number">1</span>,<span class="literal">false</span>).toUpperCase();</span><br><span class="line">            <span class="type">char</span> c=str.charAt(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span>(c==<span class="string">&#x27;Y&#x27;</span>||c==<span class="string">&#x27;N&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> c;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.print(<span class="string">&quot;选择错误,请重新输入:&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">readKeyBoard</span><span class="params">(<span class="type">int</span> limit, <span class="type">boolean</span> blankReturn)</span>&#123;</span><br><span class="line">        String line=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (scanner.hasNextLine())&#123;</span><br><span class="line">            line=scanner.nextLine();</span><br><span class="line">            <span class="keyword">if</span>(line.length()==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(blankReturn)&#123;</span><br><span class="line">                    <span class="keyword">return</span> line;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(line.length()&gt;=<span class="number">1</span> &amp;&amp; line.length()&lt;=limit)&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">&quot;输入长度（不大于&quot;</span> + limit + <span class="string">&quot;）错误，请重新输入：&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> line;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="2-菜单"   >
          <a href="#2-菜单" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-菜单" class="headerlink" title="2.菜单"></a>2.菜单</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.view;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.clientServices.UserClientServices;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.utils.Utility;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 客户端菜单界面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QQView</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">loop</span> <span class="operator">=</span> <span class="literal">true</span>; <span class="comment">//控制是否显示菜单</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>; <span class="comment">//接收用户的键盘输入</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">UserClientServices</span> <span class="variable">userClientServices</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserClientServices</span>(); <span class="comment">//用于登录服务器/注册用户</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">QQView</span>().mainMenu();</span><br><span class="line">        System.out.println(<span class="string">&quot;退出客户端&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//显示主菜单</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">mainMenu</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(loop)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;=======欢迎登录网络通信系统=======&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t 1.登入系统&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t 9.退出系统&quot;</span>);</span><br><span class="line">            System.out.print(<span class="string">&quot;请输入选择:&quot;</span>);</span><br><span class="line">            key = Utility.readString(<span class="number">1</span>);<span class="comment">//读取选择</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (key)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                    System.out.print(<span class="string">&quot;请输入用户号:&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> Utility.readString(<span class="number">50</span>);</span><br><span class="line">                    System.out.print(<span class="string">&quot;请输入密  码:&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> Utility.readString(<span class="number">50</span>);</span><br><span class="line">                    <span class="comment">//需要在服务端验证该用户是否合法</span></span><br><span class="line">                    <span class="comment">//先试用true假设合法</span></span><br><span class="line">                    <span class="comment">//编写UserClientService[用户登录/注册]服务</span></span><br><span class="line">                    <span class="keyword">if</span>(userClientServices.checkUser(userId,pwd))&#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;用户登录成功&quot;</span>);</span><br><span class="line">                        <span class="comment">//进入到二级菜单</span></span><br><span class="line">                        <span class="keyword">while</span>(loop)&#123;</span><br><span class="line">                            System.out.println(<span class="string">&quot;=======网络通信二级菜单(&quot;</span>+userId+<span class="string">&quot;)=======&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 1.显示在线用户列表&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 2.群发消息&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 3.私聊消息&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 4.发送文件&quot;</span>);</span><br><span class="line">                            System.out.println(<span class="string">&quot;\t\t 9.退出系统&quot;</span>);</span><br><span class="line">                            System.out.print(<span class="string">&quot;请输入你的选择:&quot;</span>);</span><br><span class="line">                            key = Utility.readString(<span class="number">1</span>);</span><br><span class="line">                            <span class="keyword">switch</span> (key)&#123;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                                    System.out.println(<span class="string">&quot;显示在线用户列表&quot;</span>);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">                                    System.out.println(<span class="string">&quot;群发消息&quot;</span>);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;3&quot;</span>:</span><br><span class="line">                                    System.out.println(<span class="string">&quot;私聊消息&quot;</span>);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;4&quot;</span>:</span><br><span class="line">                                    System.out.println(<span class="string">&quot;发送文件&quot;</span>);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&quot;9&quot;</span>:</span><br><span class="line">                                    loop = <span class="literal">false</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">default</span>:</span><br><span class="line">                                    System.out.print(<span class="string">&quot;输入错误,重新输入:&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;9&quot;</span>:</span><br><span class="line">                    loop = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="3-登录注册"   >
          <a href="#3-登录注册" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-登录注册" class="headerlink" title="3.登录注册"></a>3.登录注册</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.clientServices;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/28 21:00</span></span><br><span class="line"><span class="comment"> * 该类完成用户登录验证和用户注册等功能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserClientServices</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">User</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();<span class="comment">//可能在其他地方需要使用user信息,因此作为成员属性</span></span><br><span class="line">    <span class="comment">//socket可能在其他地方使用,存放在线程中,因此作为属性</span></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getU</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> u;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setU</span><span class="params">(User u)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.u = u;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据userId和pwd到服务器验证该用户是否合法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">checkUser</span><span class="params">(String userId,String pwd)</span>&#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//设置user对象属性</span></span><br><span class="line">        u.setUserId(userId);</span><br><span class="line">        u.setPasswd(pwd);</span><br><span class="line">        <span class="comment">//连接到服务器,发送u对象</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket = <span class="keyword">new</span> <span class="title class_">Socket</span>(InetAddress.getByName(<span class="string">&quot;192.168.72.1&quot;</span>), <span class="number">9999</span>);</span><br><span class="line">            <span class="comment">//得打哦ObjectOutputStream对象</span></span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">            oos.writeObject(u);<span class="comment">//发送User对象给服务端</span></span><br><span class="line">            <span class="comment">//读取从服务端回复的Message对象</span></span><br><span class="line">            <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">            <span class="type">Message</span> <span class="variable">ms</span> <span class="operator">=</span> (Message) ois.readObject();<span class="comment">//向下转型</span></span><br><span class="line">            <span class="keyword">if</span> (ms.getMesType().equals(MessageType.MESSAGE_LOGIN_SUCCEED))&#123;<span class="comment">//登录成功</span></span><br><span class="line">                <span class="comment">//成功,启动一个线程持有socket,帮助与服务器端一直通讯</span></span><br><span class="line">                <span class="comment">//创建一个和服务器端保持通信的线程-&gt;创建一个类 ClientConnectServerThread</span></span><br><span class="line">                <span class="type">ClientConnectServerThread</span> <span class="variable">CCST</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClientConnectServerThread</span>(socket);</span><br><span class="line">                <span class="comment">//启动客户端的线程</span></span><br><span class="line">                CCST.start();</span><br><span class="line">                <span class="comment">//为了后面客户端的扩展,将线程放入到集合中进行管理</span></span><br><span class="line">                ManageClientConnectServerThread.addThread(userId,CCST);</span><br><span class="line"></span><br><span class="line">                result = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;<span class="comment">//登录失败</span></span><br><span class="line">                <span class="comment">//如果登录失败,需要关闭socket</span></span><br><span class="line">                socket.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="4-线程持有socket"   >
          <a href="#4-线程持有socket" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-线程持有socket" class="headerlink" title="4.线程持有socket"></a>4.线程持有socket</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.clientServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/28 21:22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClientConnectServerThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="comment">//该现场需要持有socket</span></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造器可以接受一个socket对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ClientConnectServerThread</span><span class="params">(Socket socket)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为了方便获取socket</span></span><br><span class="line">    <span class="keyword">public</span> Socket <span class="title function_">getSocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//因为Thread需要在后台和服务器通信,因此使用while循环</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="comment">//一直读取服务器的消息</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;客户端线程,等待读取从服务器端发送的消息&quot;</span>);</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());<span class="comment">//获取信息</span></span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject(); <span class="comment">//如果服务器没有发送Message对象,线程会阻塞在这里</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="5-管理线程"   >
          <a href="#5-管理线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-管理线程" class="headerlink" title="5.管理线程"></a>5.管理线程</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.clientServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@dateTime</span> 2021/6/28 21:32</span></span><br><span class="line"><span class="comment"> * 该类管理客户端连接到服务器端的线程的类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ManageClientConnectServerThread</span> &#123;</span><br><span class="line">    <span class="comment">//把多线程放入一个HashMap中,key为用户id,value为线程</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String,ClientConnectServerThread&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将某个线程加入到集合中</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addThread</span><span class="params">(String userId,ClientConnectServerThread CCST)</span>&#123;</span><br><span class="line">        hashMap.put(userId,CCST);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过userId获得对应的线程</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ClientConnectServerThread <span class="title function_">getThread</span><span class="params">(String userId)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hashMap.get(userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-服务端"   >
          <a href="#2-服务端" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-服务端" class="headerlink" title="2.服务端"></a>2.服务端</h4>
      
        <h5 id="1-监听端口-等待连接"   >
          <a href="#1-监听端口-等待连接" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-监听端口-等待连接" class="headerlink" title="1.监听端口,等待连接"></a>1.监听端口,等待连接</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.ServerServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/29 20:40</span></span><br><span class="line"><span class="comment"> * 服务器,监听9999,等待客户端连接,并保持通信</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QQServer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">ServerSocket</span> <span class="variable">ss</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//创建一个集合存放多个用户,如果是这些用户登录即认为合法</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String,User&gt; validUsers = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">    <span class="keyword">static</span> &#123;<span class="comment">//在静态代码块,初始化validUsers</span></span><br><span class="line">        validUsers.put(<span class="string">&quot;100&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;100&quot;</span>,<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;200&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;200&quot;</span>,<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;300&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;300&quot;</span>,<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;至尊宝&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;至尊宝&quot;</span>,<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;紫霞仙子&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;紫霞仙子&quot;</span>,<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">        validUsers.put(<span class="string">&quot;菩提老祖&quot;</span>,<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;菩提老祖&quot;</span>,<span class="string">&quot;123456&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//验证用户是否有效方法</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkUser</span><span class="params">(String userId,String passwd)</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> validUsers.get(userId);</span><br><span class="line">        <span class="keyword">if</span>(user==<span class="literal">null</span>)&#123;<span class="comment">//说明该user不存在</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!user.getPasswd().equals(passwd))&#123;<span class="comment">//userId正确,密码错误</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">QQServer</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//端口可以写在一个配置文件中</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;服务端在9999端口监听&quot;</span>);</span><br><span class="line">            ss = <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9999</span>);</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>)&#123;<span class="comment">//当和某个客户端建立连接后,继续监听</span></span><br><span class="line">                <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> ss.accept();<span class="comment">//需要循环监听,没有客户端连接,则会阻塞</span></span><br><span class="line">                <span class="comment">//得到socket关联的对象输入流</span></span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">                <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">                <span class="comment">//读取客户端发送的user对象</span></span><br><span class="line">                <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) ois.readObject();</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                <span class="keyword">if</span>(checkUser(user.getUserId(),user.getPasswd()))&#123;<span class="comment">//登录成功</span></span><br><span class="line">                    System.out.println(user.getUserId()+<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">                    message.setMesType(MessageType.MESSAGE_LOGIN_SUCCEED);</span><br><span class="line">                    <span class="comment">//创建一个线程,和客户端保持通讯,该线程持有socket对象</span></span><br><span class="line">                    oos.writeObject(message);</span><br><span class="line">                    <span class="type">ServerConnectClientThread</span> <span class="variable">SCCT</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerConnectClientThread</span>(socket, user.getUserId());</span><br><span class="line">                    SCCT.start();</span><br><span class="line">                    ManageServerConnectClientThread.addThread(user.getUserId(),SCCT);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;<span class="comment">//登录失败</span></span><br><span class="line">                    System.out.println(user.getUserId()+<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">                    message.setMesType(MessageType.MESSAGE_LOGIN_FAIL);</span><br><span class="line">                    oos.writeObject(message);</span><br><span class="line">                    socket.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//将message回复给客户端</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//若退出while循环,说明服务器不再监听,因此关闭ServerSocket</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                ss.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="2-验证成功-线程持有socket"   >
          <a href="#2-验证成功-线程持有socket" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-验证成功-线程持有socket" class="headerlink" title="2.验证成功,线程持有socket"></a>2.验证成功,线程持有socket</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.ServerServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/29 21:00</span></span><br><span class="line"><span class="comment"> * 该类对应的对象和某个客户端保持通信</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerConnectClientThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> String userId;<span class="comment">//连接到服务端的用户id</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServerConnectClientThread</span><span class="params">(Socket socket, String userId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">        <span class="built_in">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;<span class="comment">//线程处于run的状态,可以发送/接收消息</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;服务端和客户端&quot;</span>+userId+<span class="string">&quot;保持通信,读取数据&quot;</span>);</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject();</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="3-管理线程"   >
          <a href="#3-管理线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-管理线程" class="headerlink" title="3.管理线程"></a>3.管理线程</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.ServerServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/29 21:09</span></span><br><span class="line"><span class="comment"> * 用于管理和客户端通信的线程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ManageServerConnectClientThread</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String,ServerConnectClientThread&gt; hashMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将某个线程加入到集合中</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addThread</span><span class="params">(String userId,ServerConnectClientThread SCCT)</span>&#123;</span><br><span class="line">        hashMap.put(userId,SCCT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过userId获得对应的线程</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ServerConnectClientThread <span class="title function_">getThread</span><span class="params">(String userId)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hashMap.get(userId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="4-拉取在线用户"   >
          <a href="#4-拉取在线用户" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-拉取在线用户" class="headerlink" title="4.拉取在线用户"></a>4.拉取在线用户</h3>
      
        <h4 id="1-发送获得在线用户列表的请求-客户端"   >
          <a href="#1-发送获得在线用户列表的请求-客户端" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-发送获得在线用户列表的请求-客户端" class="headerlink" title="1.发送获得在线用户列表的请求(客户端)"></a>1.发送获得在线用户列表的请求(客户端)</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//写在UserClientServices</span></span><br><span class="line"><span class="comment">//向服务器端请求在线用户列表</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onlineFriendList</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//发送一个Message,类型为 MESSAGE_GET_ONLINE_FRIENDS</span></span><br><span class="line">    <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">    message.setMesType(MessageType.MESSAGE_GET_ONLINE_FRIENDS);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//发送给服务器,应该得到对应的socket对应的ObjectOutputStream对象</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//得到该用户对应的线程</span></span><br><span class="line">        <span class="type">ClientConnectServerThread</span> <span class="variable">connectServerThread</span> <span class="operator">=</span> ManageClientConnectServerThread.getThread(u.getUserId());</span><br><span class="line">        <span class="comment">//得到线程持有的socket</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> connectServerThread.getSocket();</span><br><span class="line">        <span class="comment">//得到socket的OutputStream</span></span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">        oos.writeObject(message);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.clientServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/28 21:22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClientConnectServerThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="comment">//该现场需要持有socket</span></span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造器可以接受一个socket对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ClientConnectServerThread</span><span class="params">(Socket socket)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//为了方便获取socket</span></span><br><span class="line">    <span class="keyword">public</span> Socket <span class="title function_">getSocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//因为Thread需要在后台和服务器通信,因此使用while循环</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="comment">//一直读取服务器的消息</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;客户端线程,等待读取从服务器端发送的消息&quot;</span>);</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());<span class="comment">//获取信息</span></span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject(); <span class="comment">//如果服务器没有发送Message对象,线程会阻塞在这里</span></span><br><span class="line">                <span class="comment">//后面需要使用message</span></span><br><span class="line">                <span class="comment">//判断Message类型,做对应的业务处理</span></span><br><span class="line">                <span class="comment">//如果读取到的是服务端返回的在线用户列表</span></span><br><span class="line">                <span class="keyword">if</span> (message.getMesType().equals(MessageType.MESSAGE_RET_ONLINE_FRIENDS))&#123;</span><br><span class="line">                    <span class="comment">//取出在线列表信息,并显示</span></span><br><span class="line">                    <span class="comment">//规定返回的信息为空格隔开</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;\n显示在线用户列表:&quot;</span>);</span><br><span class="line">                    String[] onlineUsers = message.getContent().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;onlineUsers.length;i++)&#123;</span><br><span class="line">                        System.out.println((i+<span class="number">1</span>)+<span class="string">&quot;.&quot;</span>+onlineUsers[i]);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;是其他类型的message,暂时不处理&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-返回相应信息-服务端"   >
          <a href="#2-返回相应信息-服务端" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-返回相应信息-服务端" class="headerlink" title="2.返回相应信息(服务端)"></a>2.返回相应信息(服务端)</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.ServerServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/29 21:00</span></span><br><span class="line"><span class="comment"> * 该类对应的对象和某个客户端保持通信</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerConnectClientThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> String userId;<span class="comment">//连接到服务端的用户id</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServerConnectClientThread</span><span class="params">(Socket socket, String userId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">        <span class="built_in">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;<span class="comment">//线程处于run的状态,可以发送/接收消息</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;服务端和客户端&quot;</span>+userId+<span class="string">&quot;保持通信,读取数据&quot;</span>);</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject();</span><br><span class="line">                <span class="comment">//判断message对象类型</span></span><br><span class="line">                <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_GET_ONLINE_FRIENDS))&#123;<span class="comment">//客户端请求在线用户列表</span></span><br><span class="line">                    System.out.println(message.getSender()+<span class="string">&quot;需要在线用户列表&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">onlineUser</span> <span class="operator">=</span> ManageServerConnectClientThread.getOnlineUser();</span><br><span class="line">                    <span class="comment">//构建一个Message对象,返回Message对象给客户端</span></span><br><span class="line">                    <span class="type">Message</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                    result.setContent(onlineUser);</span><br><span class="line">                    result.setMesType(MessageType.MESSAGE_RET_ONLINE_FRIENDS);</span><br><span class="line">                    result.setGetter(result.getSender());</span><br><span class="line">                    <span class="comment">//返回给客户端</span></span><br><span class="line">                    <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">                    oos.writeObject(result);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;是其他类型的message,暂时不处理&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="5-无异常退出系统"   >
          <a href="#5-无异常退出系统" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-无异常退出系统" class="headerlink" title="5.无异常退出系统"></a>5.无异常退出系统</h3>
      
        <h4 id="1-思路"   >
          <a href="#1-思路" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-思路" class="headerlink" title="1.思路"></a>1.思路</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210701204838517.png" alt="image-20210701204838517"></p>

        <h4 id="2-客户端实现"   >
          <a href="#2-客户端实现" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-客户端实现" class="headerlink" title="2.客户端实现"></a>2.客户端实现</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userClientServices.logout();</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//编写方法,退出客户端,并且发送信息Message对象给服务端,使服务端关闭与该客户端连接的socket</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">        message.setSender(u.getUserId());<span class="comment">//指定关闭的客户端</span></span><br><span class="line">        message.setMesType(MessageType.MESSAGE_CLIENT_EXIT);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">            <span class="comment">//一个客户端可以创建多个socket的时候使用(个人觉得有误)</span></span><br><span class="line"><span class="comment">//            ClientConnectServerThread connectServerThread = ManageClientConnectServerThread.getThread(u.getUserId());</span></span><br><span class="line"><span class="comment">//            Socket socket = connectServerThread.getSocket();</span></span><br><span class="line"><span class="comment">//            ObjectOutputStream oos = new ObjectOutputStream(socket.getOutputStream());</span></span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">            System.out.println(u.getUserId()+<span class="string">&quot;退出系统&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">0</span>);<span class="comment">//结束进程</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="3-服务端实现"   >
          <a href="#3-服务端实现" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-服务端实现" class="headerlink" title="3.服务端实现"></a>3.服务端实现</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.ServerServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/6/29 21:00</span></span><br><span class="line"><span class="comment"> * 该类对应的对象和某个客户端保持通信</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerConnectClientThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> String userId;<span class="comment">//连接到服务端的用户id</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServerConnectClientThread</span><span class="params">(Socket socket, String userId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">        <span class="built_in">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;<span class="comment">//线程处于run的状态,可以发送/接收消息</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;服务端和客户端&quot;</span>+userId+<span class="string">&quot;保持通信,读取数据&quot;</span>);</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">                <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject();</span><br><span class="line">                <span class="comment">//判断message对象类型</span></span><br><span class="line">                <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_GET_ONLINE_FRIENDS))&#123;<span class="comment">//客户端请求在线用户列表</span></span><br><span class="line">                    System.out.println(message.getSender()+<span class="string">&quot;需要在线用户列表&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">onlineUser</span> <span class="operator">=</span> ManageServerConnectClientThread.getOnlineUser();</span><br><span class="line">                    <span class="comment">//构建一个Message对象,返回Message对象给客户端</span></span><br><span class="line">                    <span class="type">Message</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">                    result.setContent(onlineUser);</span><br><span class="line">                    result.setMesType(MessageType.MESSAGE_RET_ONLINE_FRIENDS);</span><br><span class="line">                    result.setGetter(result.getSender());</span><br><span class="line">                    <span class="comment">//返回给客户端</span></span><br><span class="line">                    <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">                    oos.writeObject(result);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_CLIENT_EXIT))&#123;<span class="comment">//客户端退出</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">sender</span> <span class="operator">=</span> message.getSender();</span><br><span class="line">                    System.out.println(userId+<span class="string">&quot;退出系统&quot;</span>);</span><br><span class="line">                    ManageServerConnectClientThread.rmThread(sender);</span><br><span class="line">                    socket.close();<span class="comment">//关闭连接</span></span><br><span class="line">                    <span class="comment">//退出线程</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;是其他类型的message,暂时不处理&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="6-私聊"   >
          <a href="#6-私聊" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-私聊" class="headerlink" title="6.私聊"></a>6.私聊</h3>
      
        <h4 id="1-思路分析"   >
          <a href="#1-思路分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-思路分析" class="headerlink" title="1.思路分析"></a>1.思路分析</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210701223006144.png" alt="image-20210701223006144"></p>

        <h4 id="2-客户端"   >
          <a href="#2-客户端" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-客户端" class="headerlink" title="2.客户端"></a>2.客户端</h4>
      <p>信息发送的服务MessageClientServices</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessageToOne</span><span class="params">(String content,String senderId,String getterId)</span>&#123;</span><br><span class="line">    <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">    message.setSender(senderId);</span><br><span class="line">    message.setGetter(getterId);</span><br><span class="line">    message.setContent(content);</span><br><span class="line">    message.setSendTime(<span class="keyword">new</span> <span class="title class_">Date</span>().toString());<span class="comment">//发送时间</span></span><br><span class="line">    message.setMesType(MessageType.MESSAGE_COMM_MES);</span><br><span class="line">    System.out.println(senderId+<span class="string">&quot;对&quot;</span>+getterId+<span class="string">&quot;说:&quot;</span>+content);</span><br><span class="line">    <span class="comment">//发送给服务端,需要与获取服务端保持通信的socket</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(ManageClientConnectServerThread.getThread(senderId).getSocket().getOutputStream());</span><br><span class="line">        <span class="comment">//发送给服务端</span></span><br><span class="line">        oos.writeObject(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>写在线程中</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_COMM_MES))&#123;</span><br><span class="line">    <span class="comment">//把从服务器端发送过来的消息进行显示</span></span><br><span class="line">    <span class="keyword">if</span> (message.getContent().equals(<span class="string">&quot;该用户不在线,发送失败&quot;</span>))&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;\n&quot;</span>+message.getContent());</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;\n&quot;</span>+message.getSendTime()+<span class="string">&quot;...&quot;</span>+message.getSender()+<span class="string">&quot;对你说:&quot;</span>+message.getContent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="3-服务端"   >
          <a href="#3-服务端" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-服务端" class="headerlink" title="3.服务端"></a>3.服务端</h4>
      <p>写在线程中</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_COMM_MES))&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">getter</span> <span class="operator">=</span> message.getGetter();</span><br><span class="line">    <span class="type">String</span> <span class="variable">sender</span> <span class="operator">=</span> message.getSender();</span><br><span class="line">    <span class="comment">//获取getterId所通信的线程</span></span><br><span class="line">    <span class="type">ServerConnectClientThread</span> <span class="variable">SCCT</span> <span class="operator">=</span> ManageServerConnectClientThread.getThread(getter);</span><br><span class="line">    <span class="keyword">if</span>(SCCT==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">        message.setContent(<span class="string">&quot;该用户不在线,发送失败&quot;</span>);</span><br><span class="line">        oos.writeObject(message);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//获取该线程持有的socket</span></span><br><span class="line">        <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> SCCT.getSocket();</span><br><span class="line">        <span class="comment">//获得输出流</span></span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">        <span class="comment">//发送给getter客户端,即转发,如果客户不在线,可以保存在数据库,实现离线留言</span></span><br><span class="line">        oos.writeObject(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>






        <h3 id="7-群发"   >
          <a href="#7-群发" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-群发" class="headerlink" title="7.群发"></a>7.群发</h3>
      
        <h4 id="1-客户端-1"   >
          <a href="#1-客户端-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-客户端-1" class="headerlink" title="1.客户端"></a>1.客户端</h4>
      <p>写在线程中</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (message.getMesType().equals(MessageType.MESSAGE_COMM_MES_All))&#123;</span><br><span class="line">    <span class="comment">//把群发过来的消息进行显示</span></span><br><span class="line">    System.out.println(<span class="string">&quot;\n&quot;</span>+message.getSendTime()+<span class="string">&quot;...&quot;</span>+message.getSender()+<span class="string">&quot;对大家说:&quot;</span>+message.getContent());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>写在信息发送的服务<code>MessageClientServices</code></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessageToAll</span><span class="params">(String content,String senderId)</span>&#123;</span><br><span class="line">    <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">    message.setSender(senderId);</span><br><span class="line">    message.setContent(content);</span><br><span class="line">    message.setSendTime(<span class="keyword">new</span> <span class="title class_">Date</span>().toString());</span><br><span class="line">    message.setMesType(MessageType.MESSAGE_COMM_MES_All);</span><br><span class="line">    System.out.println(senderId+<span class="string">&quot;对大家说:&quot;</span>+content);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(ManageClientConnectServerThread.getThread(senderId).getSocket().getOutputStream());</span><br><span class="line">        oos.writeObject(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="2-服务端-1"   >
          <a href="#2-服务端-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-服务端-1" class="headerlink" title="2.服务端"></a>2.服务端</h4>
      <p>写在线程中</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_COMM_MES_All))&#123;</span><br><span class="line">    <span class="comment">//获取管理的所有线程的存储hashMap,并进行遍历,对所有的线程持有的socket进行转发(不包括sender)</span></span><br><span class="line">    HashMap&lt;String, ServerConnectClientThread&gt; hashMap = ManageServerConnectClientThread.getHashMap();</span><br><span class="line">    Iterator&lt;String&gt; iterator = hashMap.keySet().iterator();</span><br><span class="line">    <span class="comment">//遍历</span></span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">        <span class="comment">//得到该线程对应通信的用户id</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">onlineUserId</span> <span class="operator">=</span> iterator.next().toString();</span><br><span class="line">        <span class="comment">//不与sender一致,进行发送</span></span><br><span class="line">        <span class="keyword">if</span>(!onlineUserId.equals(message.getSender()))&#123;</span><br><span class="line">            <span class="type">ServerConnectClientThread</span> <span class="variable">thread</span> <span class="operator">=</span> ManageServerConnectClientThread.getThread(onlineUserId);</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> thread.getSocket();</span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>






        <h3 id="8-发文件"   >
          <a href="#8-发文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-发文件" class="headerlink" title="8.发文件"></a>8.发文件</h3>
      
        <h4 id="1-思路分析-1"   >
          <a href="#1-思路分析-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-思路分析-1" class="headerlink" title="1.思路分析"></a>1.思路分析</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210702161749826.png" alt="image-20210702161749826"></p>

        <h4 id="2-客户端-1"   >
          <a href="#2-客户端-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-客户端-1" class="headerlink" title="2.客户端"></a>2.客户端</h4>
      <p>发送文件服务FileClientServices</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.clientServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/7/2 17:55</span></span><br><span class="line"><span class="comment"> * 该类/对象 完成文件传输服务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileClientServices</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> src 源文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dest 传输到的保存的目录</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> senderId 发送者id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> getterId 接收用户id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendFileToOne</span><span class="params">(String src,String dest,String senderId,String getterId)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//读取src 文件,--&gt;message</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">        message.setMesType(MessageType.MESSAGE_FILE_MES);</span><br><span class="line">        message.setSender(senderId);</span><br><span class="line">        message.setGetter(getterId);</span><br><span class="line">        message.setSrc(src);</span><br><span class="line">        message.setDest(dest);</span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">//需要将文件进行读取</span></span><br><span class="line">        <span class="type">byte</span>[] fileBytes = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) <span class="keyword">new</span> <span class="title class_">File</span>(src).length()];</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fis = <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(src);</span><br><span class="line">            fis.read(fileBytes);<span class="comment">//将src文件读入到字节数组中</span></span><br><span class="line">            <span class="comment">//将文件对应的字节数组设置到message</span></span><br><span class="line">            message.setFileBytes(fileBytes);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(fis != <span class="literal">null</span>)&#123;</span><br><span class="line">                    fis.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//提示</span></span><br><span class="line">        System.out.println(<span class="string">&quot;\n&quot;</span>+senderId + <span class="string">&quot;给&quot;</span> + getterId + <span class="string">&quot;发送文件:&quot;</span> + src + <span class="string">&quot;到对方的电脑目录:&quot;</span>+dest);</span><br><span class="line">        <span class="comment">//发送</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ClientConnectServerThread</span> <span class="variable">thread</span> <span class="operator">=</span> ManageClientConnectServerThread.getThread(senderId);</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> thread.getSocket();</span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h4 id="3-服务端-1"   >
          <a href="#3-服务端-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-服务端-1" class="headerlink" title="3.服务端"></a>3.服务端</h4>
      <p>线程中</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(message.getMesType().equals(MessageType.MESSAGE_FILE_MES))&#123;</span><br><span class="line">    <span class="comment">//根据getterId获取对应线程,将message对象转发</span></span><br><span class="line">    <span class="type">ServerConnectClientThread</span> <span class="variable">thread</span> <span class="operator">=</span> ManageServerConnectClientThread.getThread(message.getGetter());</span><br><span class="line">    <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> thread.getSocket();</span><br><span class="line">    <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">    oos.writeObject(message);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></div></figure>


        <h3 id="9-服务端推送新闻"   >
          <a href="#9-服务端推送新闻" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-服务端推送新闻" class="headerlink" title="9.服务端推送新闻"></a>9.服务端推送新闻</h3>
      
        <h4 id="1-思路分析-2"   >
          <a href="#1-思路分析-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-思路分析-2" class="headerlink" title="1.思路分析"></a>1.思路分析</h4>
      
        <h4 id="2-客户端-2"   >
          <a href="#2-客户端-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-客户端-2" class="headerlink" title="2.客户端"></a>2.客户端</h4>
      
        <h4 id="3-服务端-2"   >
          <a href="#3-服务端-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-服务端-2" class="headerlink" title="3.服务端"></a>3.服务端</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.qq.ServerServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.qq.Utility;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.Message;</span><br><span class="line"><span class="keyword">import</span> com.why.qq.qqCommon.MessageType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2021/7/2 19:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SendNewsToAllService</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//为了可以多次推送</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;请输入服务器要推送的新闻/消息[输入exit退出推送]&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">news</span> <span class="operator">=</span> Utility.readString(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;exit&quot;</span>.equals(news))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//构建一个消息,群发</span></span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">            message.setSender(<span class="string">&quot;服务器&quot;</span>);</span><br><span class="line">            message.setContent(news);</span><br><span class="line">            message.setSendTime(<span class="keyword">new</span> <span class="title class_">Date</span>().toString());</span><br><span class="line">            message.setMesType(MessageType.MESSAGE_COMM_MES_All);</span><br><span class="line">            System.out.println(<span class="string">&quot;服务器推送消息给所有人说:&quot;</span>+news);</span><br><span class="line">            <span class="comment">//遍历所有通信线程,得到socket并发送message对象</span></span><br><span class="line">            HashMap&lt;String, ServerConnectClientThread&gt; hashMap = ManageServerConnectClientThread.getHashMap();</span><br><span class="line">            Iterator&lt;String&gt; iterator = hashMap.keySet().iterator();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">onlineUser</span> <span class="operator">=</span> iterator.next().toString();</span><br><span class="line">                    <span class="type">ServerConnectClientThread</span> <span class="variable">thread</span> <span class="operator">=</span> ManageServerConnectClientThread.getThread(onlineUser);</span><br><span class="line">                    <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> thread.getSocket();</span><br><span class="line">                    <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">                    oos.writeObject(message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="10-离线留言和发文件"   >
          <a href="#10-离线留言和发文件" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-离线留言和发文件" class="headerlink" title="10.离线留言和发文件"></a>10.离线留言和发文件</h3>
      
        <h4 id="1-思路分析-3"   >
          <a href="#1-思路分析-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-思路分析-3" class="headerlink" title="1.思路分析"></a>1.思路分析</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210702193753097.png" alt="image-20210702193753097"></p>

        <h1 id="Java-反射"   >
          <a href="#Java-反射" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-反射" class="headerlink" title="Java 反射"></a>Java 反射</h1>
      
        <h2 id="1-概述-2"   >
          <a href="#1-概述-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-概述-2" class="headerlink" title="1.概述"></a>1.概述</h2>
      
        <h3 id="1-为什么有反射"   >
          <a href="#1-为什么有反射" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-为什么有反射" class="headerlink" title="1.为什么有反射"></a>1.为什么有反射</h3>
      <figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.根据配置文件re.properties指定信息,创建Cat对象并调用方法</span></span><br><span class="line"><span class="comment">#2.这样的需求在学习框架时特别多,即通过外部文件配置,在不修改源码情况下,来控制程序,也符合设计模式的 ocp原则(开闭原则 : 不修改源码,来扩容功能)</span></span><br><span class="line"><span class="comment">#3.快速入门</span></span><br></pre></td></tr></table></div></figure>

<p>建立一个re.properties</p>
<figure class="highlight properties"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">classfullpath</span>=<span class="string">com.why.Cat</span></span><br><span class="line"><span class="attr">method</span>=<span class="string">hi</span></span><br></pre></td></tr></table></div></figure>

<p>Cat.java</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/25 20:33</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;招财猫&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hi &quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>此时通过读取文件创建类无法创建,需要用到反射</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.question;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/25 20:35</span></span><br><span class="line"><span class="comment"> * 反射问题的引入</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionQuestion</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//根据配置文件re.properties指定信息,创建Cat对象并调用方法</span></span><br><span class="line">        <span class="comment">//1.传统方式</span></span><br><span class="line">        <span class="comment">//Cat cat = new Cat();</span></span><br><span class="line">        <span class="comment">//cat.hi();</span></span><br><span class="line">        <span class="comment">//2.使用Properties类,读写配置文件</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;src\\re.properties&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">classfullpath</span> <span class="operator">=</span> properties.get(<span class="string">&quot;classfullpath&quot;</span>).toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> properties.get(<span class="string">&quot;method&quot;</span>).toString();</span><br><span class="line">        System.out.println(<span class="string">&quot;classfullpath = &quot;</span> + classfullpath);</span><br><span class="line">        System.out.println(<span class="string">&quot;method = &quot;</span> + method);</span><br><span class="line">        <span class="comment">//读取完后无法创建类</span></span><br><span class="line">        <span class="comment">//通过反射机制创建</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="2-快速入门"   >
          <a href="#2-快速入门" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-快速入门" class="headerlink" title="2.快速入门"></a>2.快速入门</h3>
      <p>衔接为什么会有反射的案例</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.question;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/25 20:35</span></span><br><span class="line"><span class="comment"> * 反射问题的引入</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionQuestion</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException &#123;</span><br><span class="line">        <span class="comment">//根据配置文件re.properties指定信息,创建Cat对象并调用方法</span></span><br><span class="line">        <span class="comment">//1.传统方式</span></span><br><span class="line">        <span class="comment">//Cat cat = new Cat();</span></span><br><span class="line">        <span class="comment">//cat.hi();</span></span><br><span class="line">        <span class="comment">//2.使用Properties类,读写配置文件</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;src\\re.properties&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">classfullpath</span> <span class="operator">=</span> properties.get(<span class="string">&quot;classfullpath&quot;</span>).toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> properties.get(<span class="string">&quot;method&quot;</span>).toString();</span><br><span class="line">        System.out.println(<span class="string">&quot;classfullpath = &quot;</span> + classfullpath);<span class="comment">//com.why.cat</span></span><br><span class="line">        System.out.println(<span class="string">&quot;method = &quot;</span> + method);<span class="comment">//hi</span></span><br><span class="line">        <span class="comment">//读取完后无法创建类</span></span><br><span class="line">        <span class="comment">//new classfullpath()</span></span><br><span class="line">        <span class="comment">//通过反射机制解决</span></span><br><span class="line">        <span class="comment">//1.加载类,返回一个Class类型的对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass</span> <span class="operator">=</span> Class.forName(classfullpath);</span><br><span class="line">        <span class="comment">//2.通过啊Class对象得到加载的类 com.why.Cat 的对象实例</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">        <span class="comment">//System.out.println(cat.getClass());//运行类型</span></span><br><span class="line">        <span class="comment">//3.通过 aClass 得到加载的类 com.why.Cat 的 method 的方法对象</span></span><br><span class="line">        <span class="comment">//即:在反射中,可以把方法视为对象(万物皆对象</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method1</span> <span class="operator">=</span> aClass.getMethod(method);</span><br><span class="line">        <span class="comment">//4.通过 method1 调用方法 : 即通过方法对象来实现调用方法</span></span><br><span class="line">        method1.invoke(o);<span class="comment">//传统方法是 对象.方法() , 反射机制 方法.invoke(对象)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="2-反射机制"   >
          <a href="#2-反射机制" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-反射机制" class="headerlink" title="2.反射机制"></a>2.反射机制</h2>
      
        <h3 id="1-反射原理图"   >
          <a href="#1-反射原理图" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-反射原理图" class="headerlink" title="1,反射原理图"></a>1,反射原理图</h3>
      <ol>
<li>反射机制允许程序在执行期借助于Reflection API取得任何类的内部信息(比如成员变量,构造器,成员方法等等),并能操作对象的属性及方法。反射在设计模式和框架底层都会用到</li>
<li>加载完类之后，在堆中就产生了一个Class类型的对象(一个类只有一个Class对象)，这个对象包含了类的完整结构信息。通过这个对象得到类的结构。这个对象就像一面镜子，透过这个镜子看到类的结构,所以，形象的称之为:反射</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210826021903501.png" alt="image-20210826021903501"></p>

        <h3 id="2-反射功能"   >
          <a href="#2-反射功能" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-反射功能" class="headerlink" title="2.反射功能"></a>2.反射功能</h3>
      <ol>
<li>在运行时判断任意一个对象所属的类</li>
<li>在运行时构造任意一个类的对象</li>
<li>在运行时得到任意一个类所具有的成员变量和方法</li>
<li>在运行时调用任意一个对象的成员变量和方法</li>
<li>生成动态代理</li>
</ol>

        <h3 id="3-反射相关类"   >
          <a href="#3-反射相关类" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-反射相关类" class="headerlink" title="3.反射相关类"></a>3.反射相关类</h3>
      <ol>
<li><p>java.lang.Class:代表一个类，Class对象表示某个类加载后在堆中的对象</p>
</li>
<li><p>java.lang.reflect.Method:代表类的方法,Method对象表示某个类的方法</p>
</li>
<li><p>java.lang.reflect.Field:代表类的成员变量,Field对象表示某个类的成员变量</p>
<p><code>getField()</code>不能得到私有的属性,会报错</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">&quot;main&quot;</span> java.lang.NoSuchFieldException: name</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>java.lang.reflect.Constructor:代表类的构造方法,Constructor对象表示构造器</p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/26 3:07</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Reflection01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">//2.使用Properties类,读写配置文件</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;src\\re.properties&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">classfullpath</span> <span class="operator">=</span> properties.get(<span class="string">&quot;classfullpath&quot;</span>).toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> properties.get(<span class="string">&quot;method&quot;</span>).toString();</span><br><span class="line">        System.out.println(<span class="string">&quot;classfullpath = &quot;</span> + classfullpath);</span><br><span class="line">        System.out.println(<span class="string">&quot;method = &quot;</span> + method);</span><br><span class="line">        <span class="comment">//读取完后无法创建类</span></span><br><span class="line"><span class="comment">//        new classfullpath()</span></span><br><span class="line">        <span class="comment">//通过反射机制解决</span></span><br><span class="line">        <span class="comment">//1.加载类,返回一个Class类型的对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass</span> <span class="operator">=</span> Class.forName(classfullpath);</span><br><span class="line">        <span class="comment">//2.通过啊Class对象得到加载的类 com.why.Cat 的对象实例</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">        <span class="comment">//System.out.println(cat.getClass());//运行类型</span></span><br><span class="line">        <span class="comment">//3.通过 aClass 得到加载的类 com.why.Cat 的 method 的方法对象</span></span><br><span class="line">        <span class="comment">//即:在反射中,可以把方法视为对象(万物皆对象</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method1</span> <span class="operator">=</span> aClass.getMethod(method);</span><br><span class="line">        <span class="comment">//4.通过 method1 调用方法 : 即通过方法对象来实现调用方法</span></span><br><span class="line">        method1.invoke(o);<span class="comment">//传统方法是 对象.方法() , 反射机制 方法.invoke(对象)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//得到name字段</span></span><br><span class="line">        <span class="comment">//getField不能得到私有的属性</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">ageField</span> <span class="operator">=</span> aClass.getField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">        System.out.println(ageField.get(o));<span class="comment">//传统写法 对象.成员变量 , 反射: 成员变量.get(对象)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//()中可以指定构造器参数类型,没有则返回无参构造器</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> aClass.getConstructor();</span><br><span class="line">        System.out.println(constructor);</span><br><span class="line">        <span class="comment">//这里传入的String.class 即 String的Class对象</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor1</span> <span class="operator">=</span> aClass.getConstructor(String.class);</span><br><span class="line">        System.out.println(constructor1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="4-反射优缺点"   >
          <a href="#4-反射优缺点" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-反射优缺点" class="headerlink" title="4.反射优缺点"></a>4.反射优缺点</h3>
      <p>优点:可以动态的创建和使用对象(也是框架底层核心),使用灵活,没有反射机制,框架技术就失去底层支撑</p>
<p>缺点:使用反射基本是解释执行,对执行速度有影响</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.Cat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/26 11:39</span></span><br><span class="line"><span class="comment"> * 测试发射调用的性能,以及优化</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Reflection02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, InvocationTargetException, InstantiationException, NoSuchMethodException, IllegalAccessException &#123;</span><br><span class="line">        m1();</span><br><span class="line">        m2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//传统方法调用hi</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; <span class="number">900000000</span> ; i++)&#123;</span><br><span class="line">            cat.hi();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;m1调用hi 耗时 : &quot;</span> + (end - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//反射机制调用hi</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, InvocationTargetException, NoSuchMethodException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.Cat&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> aClass.getMethod(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; <span class="number">900000000</span> ; i++)&#123;</span><br><span class="line">            method.invoke(o);<span class="comment">//反射调用方法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;m2调用hi 耗时 : &quot;</span> + (end - start));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m1调用hi 耗时 : 3</span><br><span class="line">m2调用hi 耗时 : 1918</span><br></pre></td></tr></table></div></figure>

<p>可以看出传统方法调用的速度比反射调用方法的速度要快上不少</p>

        <h3 id="5-反射调用优化"   >
          <a href="#5-反射调用优化" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-反射调用优化" class="headerlink" title="5.反射调用优化"></a>5.反射调用优化</h3>
      <p>反射调用优化-关闭访问检查</p>
<ol>
<li>Method和Field、Constructor对象都有setAccessible()方法</li>
<li>setAccessible作用是启动和禁用访问安全检查的开关</li>
<li>参数值为true表示反射的对象在使用时取消访问检查,提高反射的效率。参数值为false则表示反射的对象执行访问检查</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.Cat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/26 11:39</span></span><br><span class="line"><span class="comment"> * 测试发射调用的性能,以及优化</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Reflection02</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, InvocationTargetException, InstantiationException, NoSuchMethodException, IllegalAccessException &#123;</span><br><span class="line">        m1();</span><br><span class="line">        m2();</span><br><span class="line">        m3();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//传统方法调用hi</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; <span class="number">900000000</span> ; i++)&#123;</span><br><span class="line">            cat.hi();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;m1调用hi 耗时 : &quot;</span> + (end - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//反射机制调用hi</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, InvocationTargetException, NoSuchMethodException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.Cat&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> aClass.getMethod(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; <span class="number">900000000</span> ; i++)&#123;</span><br><span class="line">            method.invoke(o);<span class="comment">//反射调用方法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;m2调用hi 耗时 : &quot;</span> + (end - start));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//反射调用优化 : 关闭访问检测</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m3</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, InvocationTargetException, NoSuchMethodException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.Cat&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> aClass.getMethod(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">        method.setAccessible(<span class="literal">true</span>);<span class="comment">//在反射调用方法时,取消访问检查</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; <span class="number">900000000</span> ; i++)&#123;</span><br><span class="line">            method.invoke(o);<span class="comment">//反射调用方法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;m2调用hi 耗时 : &quot;</span> + (end - start));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m1调用hi 耗时 : 3</span><br><span class="line">m2调用hi 耗时 : 1993</span><br><span class="line">m2调用hi 耗时 : 1515</span><br></pre></td></tr></table></div></figure>

<p>只能提高一点性能</p>

        <h2 id="3-Class类"   >
          <a href="#3-Class类" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Class类" class="headerlink" title="3.Class类"></a>3.Class类</h2>
      
        <h3 id="1-Class类分析"   >
          <a href="#1-Class类分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Class类分析" class="headerlink" title="1.Class类分析"></a>1.Class类分析</h3>
      <ol>
<li><p>Class也是类，因此也继承Object类</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210826121233654.png" alt="image-20210826121233654"></p>
</li>
<li><p>Class类对象不是new出来的，而是系统创建的</p>
<p>通过类加载器中的ClassLoader中的<code>loadClass()</code>生成</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Class&lt;?&gt; loadClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">    <span class="keyword">return</span> loadClass(name, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>对于某个类的Class类对象，在内存中只有一份，因为类只加载一次,在堆内存中只有一份</p>
</li>
<li><p>每个类的实例都会记得自己是由哪个 Class 实例所生成</p>
<p>所以可以通过 对象.class 获取其 Class 实例</p>
</li>
<li><p>通过Class可以完整地得到一个类的完整结构,通过一系列API</p>
</li>
<li><p>Class对象是存放在堆的</p>
</li>
<li><p>类的字节码二进制数据，是放在方法区的，有的地方称为类的元数据(包括方法代码,变量名，方法名,访问权限等等)<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.zhihu.com/question/38496907" >https://www.zhihu.com/question/38496907</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210826122647557.png" alt="image-20210826122647557"></p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.class_;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/26 12:10</span></span><br><span class="line"><span class="comment"> * 梳理Class类的特点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Class01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//1.Class也是类，因此也继承Object类</span></span><br><span class="line">        <span class="comment">//Class</span></span><br><span class="line">        <span class="comment">//2.Class类对象不是new出来的，而是系统创建的</span></span><br><span class="line">        <span class="comment">//1)传统new对象</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            ClassLoader类</span></span><br><span class="line"><span class="comment">            public Class&lt;?&gt; loadClass(String name) throws ClassNotFoundException &#123;</span></span><br><span class="line"><span class="comment">                return loadClass(name, false);</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"><span class="comment">//        Cat cat = new Cat();</span></span><br><span class="line">        <span class="comment">//2)反射方式 一个类只加载一次</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass1</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.Cat&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass2</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.Cat&quot;</span>);</span><br><span class="line">        <span class="comment">//3.对于某个类的Class类对象，在内存中只有一份，因为类只加载一次</span></span><br><span class="line">        System.out.println(aClass1.hashCode());</span><br><span class="line">        System.out.println(aClass2.hashCode());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.每个类的实例都会记得自己是由哪Class 实例所生成</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="2-Class类常用方法"   >
          <a href="#2-Class类常用方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Class类常用方法" class="headerlink" title="2.Class类常用方法"></a>2.Class类常用方法</h3>
      <p>Class02.java</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.class_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.Car;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/26 14:28</span></span><br><span class="line"><span class="comment"> * Class类的常用方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Class02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">classAllPath</span> <span class="operator">=</span> <span class="string">&quot;com.why.Car&quot;</span>;</span><br><span class="line">        <span class="comment">//1.获取到Car类 对应的 Class 对象</span></span><br><span class="line">        <span class="comment">//&lt;?&gt; 表示不确定的Java类型 泛型</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(classAllPath);</span><br><span class="line">        <span class="comment">//2.输出aClass</span></span><br><span class="line">        System.out.println(aClass);<span class="comment">//显示 aClass 对象 , 是属于哪个类的对象 --&gt; com.why.Car</span></span><br><span class="line">        System.out.println(aClass.getClass()); <span class="comment">//输出 aClass 运行类型 java.lang.Class</span></span><br><span class="line">        <span class="comment">//3.得到包名</span></span><br><span class="line">        System.out.println(aClass.getPackage().getName());<span class="comment">//包名</span></span><br><span class="line">        <span class="comment">//4.得到全类名</span></span><br><span class="line">        System.out.println(aClass.getName());</span><br><span class="line">        <span class="comment">//5.通过aClass创建对象实例</span></span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> (Car) aClass.newInstance();</span><br><span class="line">        System.out.println(car); <span class="comment">//car.toString()</span></span><br><span class="line">        <span class="comment">//6.通过反射获取属性(私有属性会报错,需要单独解决) brand</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">brand</span> <span class="operator">=</span> aClass.getField(<span class="string">&quot;brand&quot;</span>);</span><br><span class="line">        System.out.println(brand.get(car));<span class="comment">//宝马</span></span><br><span class="line">        <span class="comment">//7.通过反射给属性赋值</span></span><br><span class="line">        brand.set(car,<span class="string">&quot;奔驰&quot;</span>);</span><br><span class="line">        System.out.println(brand.get(car));</span><br><span class="line">        <span class="comment">//8.遍历得到所有属性</span></span><br><span class="line">        System.out.println(<span class="string">&quot;所有字段属性&quot;</span>);</span><br><span class="line">        Field[] fields = aClass.getFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            System.out.println(field.get(car));<span class="comment">//名称</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-获取Class类对象的六种方式"   >
          <a href="#3-获取Class类对象的六种方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-获取Class类对象的六种方式" class="headerlink" title="3.获取Class类对象的六种方式"></a>3.获取Class类对象的六种方式</h3>
      <ol>
<li><p>前提:已知一个类的全类名，且该类在类路径下，可通过Class类的静态方法forName()获取，可能抛出ClassNotFoundException, </p>
<p>实例:Class cls1 &#x3D;Class.forName( “java.lang.Cat”);<br>应用场景:多用于配置文件,读取类全路径,加载类.</p>
</li>
<li><p>前提:若已知具体的类，通过类的class获取，该方式最为安全可靠,程序性能最高</p>
<p>实例: Class cls2 &#x3D; Cat.class;<br>应用场景:多用于参数传递，比如通过反射得到对应构造器对象.</p>
</li>
<li><p>前提:已知某个类的实例，调用该实例的getClass()方法获取Class对象，实例:<br>Class class&#x3D;对象.getClass(0);<br>应用场景:通过创建好的对象,获取Class对象.</p>
</li>
<li><p>类加载器<br>ClassLoader cl &#x3D;对象.getClass().getClassLoaderO;</p>
<p>Class clazz4 &#x3D;cl.loadClass(“类的全类名”);</p>
</li>
<li><p>基本数据(int, charlboolean,float,double,byte,long,short)按如下方式得到Class类对象<br>Class cls &#x3D;基本数据类型.class</p>
</li>
<li><p>基本数据类型对应的包装类,可以通过.TYPE得到Class类对象<br>Class cls &#x3D;包装类.TYPE</p>
</li>
</ol>
<p>三个阶段:</p>
<ol>
<li>代码阶段&#x2F;编译阶段: Class.forName()</li>
<li>编译成字节码文件后通过 类加载器 加载时的阶段: 通过类加载器得到Class对象</li>
<li>Class类阶段(加载阶段) : 类.class</li>
<li>Runtime运行阶段 : 对象.getClass()</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.class_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.why.Car;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/27 18:51</span></span><br><span class="line"><span class="comment"> * 演示得到Class对象的各种方式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetClass_</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//1.Class.forName</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">classAllPath</span> <span class="operator">=</span> <span class="string">&quot;com.why.Car&quot;</span>; <span class="comment">//一般通过配置文件读取到包名</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(classAllPath);</span><br><span class="line">        System.out.println(aClass);</span><br><span class="line">        <span class="comment">//2.类名.class 应用场景:多用于参数传递，比如通过反射得到对应构造器对象</span></span><br><span class="line">        System.out.println(String.class);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass1</span> <span class="operator">=</span> Car.class;</span><br><span class="line">        System.out.println(aClass1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.对象.getClass() 应用场景:有对象实例</span></span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass2</span> <span class="operator">=</span> car.getClass();</span><br><span class="line">        System.out.println(aClass2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.通过类加载器来获取类的Class对象 (4种类加载器)</span></span><br><span class="line">        <span class="comment">//1)得到类加载器 Car</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> car.getClass().getClassLoader();</span><br><span class="line">        <span class="comment">//2)通过类加载器得到Class对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">aClass3</span> <span class="operator">=</span> classLoader.loadClass(classAllPath);</span><br><span class="line">        System.out.println(aClass3);</span><br><span class="line">        System.out.println(classLoader);</span><br><span class="line">        System.out.println(aClass.hashCode());</span><br><span class="line">        System.out.println(aClass1.hashCode());</span><br><span class="line">        System.out.println(aClass2.hashCode());</span><br><span class="line">        System.out.println(aClass3.hashCode());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.基本数据类型</span></span><br><span class="line">        Class&lt;Integer&gt; integerClass = <span class="type">int</span>.class;</span><br><span class="line">        System.out.println(integerClass);<span class="comment">//输出仍然为int,其中包括自动装箱/拆箱过程</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.包装类</span></span><br><span class="line">        Class&lt;Integer&gt; type = Integer.TYPE;</span><br><span class="line">        System.out.println(type);</span><br><span class="line"></span><br><span class="line">        System.out.println(integerClass.hashCode());</span><br><span class="line">        System.out.println(type.hashCode());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="4-拥有Class对象的类型"   >
          <a href="#4-拥有Class对象的类型" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-拥有Class对象的类型" class="headerlink" title="4.拥有Class对象的类型"></a>4.拥有Class对象的类型</h3>
      <ol>
<li>外部类,成员内部类,静态内部类,局部内部类,匿名内部类</li>
<li>interface:接口</li>
<li>数组</li>
<li>enum:枚举</li>
<li>annotation:注解</li>
<li>基本数据类型</li>
<li>void</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.class_;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/27 19:25</span></span><br><span class="line"><span class="comment"> * 演示哪些类型有Class对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AllTypeClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Class&lt;String&gt; cls1 = String.class;<span class="comment">//外部类</span></span><br><span class="line">        Class&lt;Serializable&gt; cls2 = Serializable.class;<span class="comment">//接口</span></span><br><span class="line">        Class&lt;Integer[]&gt; cls3 = Integer[].class;<span class="comment">//数组</span></span><br><span class="line">        Class&lt;<span class="type">float</span>[][]&gt; cls4 = <span class="type">float</span>[][].class;<span class="comment">//二维数组</span></span><br><span class="line">        Class&lt;Deprecated&gt; cls5 = Deprecated.class;<span class="comment">//注解</span></span><br><span class="line">        Class&lt;Thread.State&gt; cls6 = Thread.State.class;<span class="comment">//枚举</span></span><br><span class="line">        Class&lt;Long&gt; cls7 = <span class="type">long</span>.class;<span class="comment">//基本数据类型</span></span><br><span class="line">        Class&lt;Void&gt; cls8 = <span class="keyword">void</span>.class;<span class="comment">//void</span></span><br><span class="line">        Class&lt;Class&gt; cls9 = Class.class;<span class="comment">//Class类 外部类</span></span><br><span class="line"></span><br><span class="line">        System.out.println(cls1);</span><br><span class="line">        System.out.println(cls2);</span><br><span class="line">        System.out.println(cls3);</span><br><span class="line">        System.out.println(cls4);</span><br><span class="line">        System.out.println(cls5);</span><br><span class="line">        System.out.println(cls6);</span><br><span class="line">        System.out.println(cls7);</span><br><span class="line">        System.out.println(cls8);</span><br><span class="line">        System.out.println(cls9);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="4-类加载"   >
          <a href="#4-类加载" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-类加载" class="headerlink" title="4.类加载"></a>4.类加载</h2>
      
        <h3 id="1-动态和静态加载"   >
          <a href="#1-动态和静态加载" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-动态和静态加载" class="headerlink" title="1.动态和静态加载"></a>1.动态和静态加载</h3>
      <p>基本说明<br>反射机制是java实现动态语言的关键，也就是通过反射实现类动态加载。</p>
<ol>
<li><p>静态加载:编译时加载相关的类,如果没有则报错,依赖性太强</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoad_</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">		<span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">		System.out.print(<span class="string">&quot;请输入key:&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">		<span class="keyword">switch</span>(key)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;1&quot;</span> :</span><br><span class="line">				<span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();<span class="comment">//静态加载</span></span><br><span class="line">				dog.cry();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;2&quot;</span> :</span><br><span class="line">				System.out.println(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				System.out.println(<span class="string">&quot;do nothing&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>使用 javac 编译该.java文件则会报错</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210827221746450.png" alt="image-20210827221746450"></p>
<p>此为静态加载</p>
</li>
<li><p>动态加载:运行时加载需要的类,如果运行时不用该类,即使不存在该类,编译也不报错,只有在使用到该类时才会报错,降低了依赖性</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoad_</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		<span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">		System.out.print(<span class="string">&quot;请输入key:&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">		<span class="keyword">switch</span>(key)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;1&quot;</span> :</span><br><span class="line">				<span class="comment">//Dog dog = new Dog();//静态加载,依赖性很强</span></span><br><span class="line">				<span class="comment">//dog.cry();</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;2&quot;</span> :</span><br><span class="line">				<span class="comment">//反射 -&gt; 动态加载</span></span><br><span class="line">				<span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;Person&quot;</span>);<span class="comment">//加载Person类[动态加载]</span></span><br><span class="line">				<span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">				<span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> cls.getMethod(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">				m.invoke(o);</span><br><span class="line">				System.out.println(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				System.out.println(<span class="string">&quot;do nothing&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>使用反射进行类的调用时,则不会报错,可以编译通过</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210827222146768.png" alt="image-20210827222146768"></p>
</li>
<li><p>编写Dog类,不编写Person类</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoad_</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		<span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">		System.out.print(<span class="string">&quot;请输入key:&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">		<span class="keyword">switch</span>(key)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;1&quot;</span> :</span><br><span class="line">				<span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();<span class="comment">//静态加载,依赖性很强</span></span><br><span class="line">				dog.cry();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;2&quot;</span> :</span><br><span class="line">				<span class="comment">//反射 -&gt; 动态加载</span></span><br><span class="line">				<span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;Person&quot;</span>);<span class="comment">//加载Person类[动态加载]</span></span><br><span class="line">				<span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">				<span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> cls.getMethod(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">				m.invoke(o);</span><br><span class="line">				System.out.println(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				System.out.println(<span class="string">&quot;do nothing&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Dog类是静态加载,需要编写Dog类</span></span><br><span class="line"><span class="comment">//而Person类是动态加载,所以不用编写也可以编译成功,只有当动态加载到该类时才会报错</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cry</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;cry&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">javac ClassLoad_.java</span><br><span class="line">注: ClassLoad_.java使用了未经检查或不安全的操作。</span><br><span class="line">注: 有关详细信息, 请使用 -Xlint:unchecked 重新编译。</span><br><span class="line"></span><br><span class="line">java ClassLoad_</span><br><span class="line">请输入key:1</span><br><span class="line">cry</span><br><span class="line"></span><br><span class="line">java ClassLoad_</span><br><span class="line">请输入key:2</span><br><span class="line">Exception <span class="keyword">in</span> thread <span class="string">&quot;main&quot;</span> java.lang.ClassNotFoundException: Person</span><br><span class="line">        at java.net.URLClassLoader.findClass(URLClassLoader.java:382)</span><br><span class="line">        at java.lang.ClassLoader.loadClass(ClassLoader.java:418)</span><br><span class="line">        at sun.misc.Launcher<span class="variable">$AppClassLoader</span>.loadClass(Launcher.java:355)</span><br><span class="line">        at java.lang.ClassLoader.loadClass(ClassLoader.java:351)</span><br><span class="line">        at java.lang.Class.forName0(Native Method)</span><br><span class="line">        at java.lang.Class.forName(Class.java:264)</span><br><span class="line">        at ClassLoad_.main(ClassLoad_.java:15)</span><br></pre></td></tr></table></div></figure>

<p>添加上Person类后,则不会报错</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoad_</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">		<span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">		System.out.print(<span class="string">&quot;请输入key:&quot;</span>);</span><br><span class="line">		<span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">		<span class="keyword">switch</span>(key)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;1&quot;</span> :</span><br><span class="line">				<span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();<span class="comment">//静态加载,依赖性很强</span></span><br><span class="line">				dog.cry();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&quot;2&quot;</span> :</span><br><span class="line">				<span class="comment">//反射 -&gt; 动态加载</span></span><br><span class="line">				<span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;Person&quot;</span>);<span class="comment">//加载Person类[动态加载]</span></span><br><span class="line">				<span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">				<span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> cls.getMethod(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">				m.invoke(o);</span><br><span class="line">				System.out.println(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				System.out.println(<span class="string">&quot;do nothing&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Dog类是静态加载,需要编写Dog类</span></span><br><span class="line"><span class="comment">//而Person类是动态加载,所以不用编写也可以编译成功,只有当动态加载到该类时才会报错</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cry</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;cry&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;hi&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">D:\ASoftware\ForIDEA\JavaSE\Java_Reflection\src\com\why\reflection\class_&gt;javac ClassLoad_.java</span><br><span class="line">注: ClassLoad_.java使用了未经检查或不安全的操作。</span><br><span class="line">注: 有关详细信息, 请使用 -Xlint:unchecked 重新编译。</span><br><span class="line"></span><br><span class="line">D:\ASoftware\ForIDEA\JavaSE\Java_Reflection\src\com\why\reflection\class_&gt;java ClassLoad_</span><br><span class="line">请输入key:1</span><br><span class="line">cry</span><br><span class="line"></span><br><span class="line">D:\ASoftware\ForIDEA\JavaSE\Java_Reflection\src\com\why\reflection\class_&gt;java ClassLoad_</span><br><span class="line">请输入key:2</span><br><span class="line">hi</span><br><span class="line">ok</span><br></pre></td></tr></table></div></figure></li>
</ol>
<p>类加载时机</p>
<ol>
<li>当创建对象时(new) –&gt; 静态加载</li>
<li>当子类被加载时,分类也加载 –&gt; 静态加载</li>
<li>调用类中的静态成员时 –&gt; 静态加载</li>
<li>通过反射 –&gt; 动态加载</li>
</ol>

        <h3 id="2-类加载流程图"   >
          <a href="#2-类加载流程图" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-类加载流程图" class="headerlink" title="2.类加载流程图"></a>2.类加载流程图</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210827231819852.png" alt="image-20210827231819852"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210827232000680.png" alt="image-20210827232000680"></p>
<ul>
<li>验证阶段:对文件进行安全校验(文件格式是否正确,元数据是否正确,字节码是否正确,符合引用是否正确)</li>
<li>准备阶段:给静态变量分配内存,完成默认初始化(针对静态变量)</li>
<li>解析阶段:虚拟机把常量池中的符号引用替换为直接引用</li>
</ul>
<p>前两个阶段是 JVM 完成,初始化阶段是程序员定义控制的代码</p>
<p>初始化针对静态成员,即属于类的成员</p>

        <h3 id="3-类加载的五个阶段"   >
          <a href="#3-类加载的五个阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-类加载的五个阶段" class="headerlink" title="3.类加载的五个阶段"></a>3.类加载的五个阶段</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210827232252431.png" alt="image-20210827232252431"></p>

        <h4 id="1-加载阶段"   >
          <a href="#1-加载阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-加载阶段" class="headerlink" title="1.加载阶段"></a>1.加载阶段</h4>
      <p>JVM在该阶段的主要目的是将字节码从不同的数据源（可能是class文件、也可能是jar包，甚至网络)转化为&#x3D;&#x3D;二进制字节流加载到内存&#x3D;&#x3D;中，并生成一个代表该类的 java.lang.Class 对象</p>
<p>即将某个类的字节码二进制数据加载到方法区,同时生成一个Class对象</p>

        <h4 id="2-验证阶段"   >
          <a href="#2-验证阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-验证阶段" class="headerlink" title="2.验证阶段"></a>2.验证阶段</h4>
      <ol>
<li><p>目的是为了确保Class文件的字节流中包含的信息符合当前虚拟机的要求，并且不会危害虚拟机自身的安全。</p>
<p><code>SecurityManager</code></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210827232926859.png" alt="image-20210827232926859"></p>
</li>
<li><p>包括:文件格式验证(是否以魔数 oxcafebabe 开头)、元数据验证、字节码验证和符号引用验证[举例说明]</p>
<p>查看编译后的.class文件</p>
</li>
<li><p>可以考虑使用-Xverify:none参数来关闭大部分的类验证措施,缩短虚拟机类加载的时间。</p>
</li>
</ol>

        <h4 id="3-准备阶段"   >
          <a href="#3-准备阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-准备阶段" class="headerlink" title="3.准备阶段"></a>3.准备阶段</h4>
      <ol>
<li>JVM会在该阶段对静态变量，分配内存并初始化（对应数据类型的默认初始值，如0、OL、null、false等）。这些变量所使用的内存都将在方法区中进行分配(根据jdk版本的不同,有些会把静态的变量放在堆中 Class 对象)</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">    <span class="comment">//属性-成员变量-字段</span></span><br><span class="line">    <span class="comment">//类加载的连接阶段-准备 属性是如何处理</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> <span class="number">10</span>;<span class="comment">//n1 是实例属性,不是静态变量,因此在准备阶段,是不会分内存</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">n2</span> <span class="operator">=</span> <span class="number">20</span>;<span class="comment">//n2 是静态变量,分配内存 n2 是默认初始化 0 ,而不是20</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">n3</span> <span class="operator">=</span> <span class="number">30</span>;<span class="comment">//n3 是static final 是一个常量,他和静态变量不一样,会一次性的分配,因为一旦赋值就不变化,n3 = 30</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="4-解析阶段"   >
          <a href="#4-解析阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-解析阶段" class="headerlink" title="4.解析阶段"></a>4.解析阶段</h4>
      <ol>
<li>虚拟机将常量池内的符号引用替换为直接引用的过程</li>
</ol>
<p>符号引用,是一个相对的关系如</p>
<p>①对应A,②对应B,①引用②,当解析后到内存了,则会变为A的地址引用B的地址</p>

        <h4 id="5-初始化阶段"   >
          <a href="#5-初始化阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-初始化阶段" class="headerlink" title="5.初始化阶段"></a>5.初始化阶段</h4>
      <ol>
<li><p>到初始化阶段，才真正开始执行类中定义的Java程序代码，此阶段是执行<clinit>()方法的过程。</p>
</li>
<li><p><clinit>0)方法是由编译器按语句在源文件中出现的顺序，依次自动收集类中的所有&#x3D;&#x3D;静态变量&#x3D;&#x3D;的赋值动作和&#x3D;&#x3D;静态代码块&#x3D;&#x3D;中的语句,并进行合并。[举例说明ClassLoad03.java]</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.classload_;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 0:50</span></span><br><span class="line"><span class="comment"> * 类加载初始化阶段</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoad03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//分析</span></span><br><span class="line">        <span class="comment">//1.加载阶段加载B类,生成B的class对象</span></span><br><span class="line">        <span class="comment">//2.链接阶段 num = 0</span></span><br><span class="line">        <span class="comment">//3.初始化阶段</span></span><br><span class="line">        <span class="comment">//依次自动收集类中的所有==静态变量==的赋值动作和==静态代码块==中的语句,并进行合并</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            clinit()&#123;</span></span><br><span class="line"><span class="comment">                System.out.println(&quot;B 静态代码块被执行&quot;);</span></span><br><span class="line"><span class="comment">                //num = 300;</span></span><br><span class="line"><span class="comment">                num = 100;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//4.执行构造器 输出&quot;B 构造器被执行&quot;</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">B</span>();</span><br><span class="line">        System.out.println(B.num);<span class="comment">//100,如果直接使用类的静态属性,也会导致类的加载</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B 静态代码块被执行&quot;</span>);</span><br><span class="line">        num = <span class="number">300</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">B</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B 构造器被执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>
</li>
<li><p>虚拟机会保证一个类的<clinit>()方法在多线程环境中被正确地加锁、同步，如果多个线程同时去初始化一个类，那么只会有一个线程去执行这个类的<clinit>(方法，其他线程都需要阻塞等待,直到活动线程执行<clinit>()方法完毕[debug源码]</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载类的时候,有同步机制控制</span></span><br><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="type">boolean</span> resolve)</span><br><span class="line">    <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//正因为有这个机制,才能保证某个类在内存中只存在一个类对象Class</span></span><br><span class="line">    <span class="keyword">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h3 id="4-获取类结构信息"   >
          <a href="#4-获取类结构信息" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-获取类结构信息" class="headerlink" title="4.获取类结构信息"></a>4.获取类结构信息</h3>
      <p>当我们得打哦某个类的Class对象,可以根据相应的api获取其类的信息</p>

        <h4 id="1-Class类"   >
          <a href="#1-Class类" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Class类" class="headerlink" title="1.Class类"></a>1.Class类</h4>
      <ol>
<li>getName:获取全类名</li>
<li>getSimpleName:获取简单类名</li>
<li>getFields:获取所有public修饰的属性，包含本类以及父类的</li>
<li>getDeclaredFields:获取本类中所有属性</li>
<li>getMethods:获取所有public修饰的方法，包含本类以及父类的</li>
<li>getDeclaredMethods:获取本类中所有方法</li>
<li>getConstructors: 获取本类所有public修饰的构造器</li>
<li>getDeclaredConstructors:获取本类中所有构造器</li>
<li>getPackage:以Package形式返回包信息</li>
<li>getSuperClass:以Class形式返回父类信息</li>
<li>getlnterfaces:以Class形式返回接口信息</li>
<li>getAnnotations:以Annotation[]形式返回注解信息</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 15:22</span></span><br><span class="line"><span class="comment"> * 演示如何通过反射获取类的结构信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionUtils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//第一组方法API</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">api_01</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//得到Class对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">personCls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.reflection.Person&quot;</span>);</span><br><span class="line"><span class="comment">//        1. getName:获取全类名</span></span><br><span class="line">        System.out.println(personCls.getName());</span><br><span class="line"><span class="comment">//        2. getSimpleName:获取简单类名</span></span><br><span class="line">        System.out.println(personCls.getSimpleName());</span><br><span class="line"><span class="comment">//        3. getFields:获取所有public修饰的属性，包含本类以及父类的</span></span><br><span class="line">        Field[] fields = personCls.getFields();<span class="comment">//只能得到public修饰的属性</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类及父类的公有属性:&quot;</span> + field);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        4. getDeclaredFields:获取本类中所有属性</span></span><br><span class="line">        Field[] declaredFields = personCls.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field declaredField : declaredFields) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类所有属性:&quot;</span> + declaredField);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        5. getMethods:获取所有public修饰的方法，包含本类以及父类的</span></span><br><span class="line">        Method[] methods = personCls.getMethods();</span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类及父类的公有属性:&quot;</span> + method.getName());</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        6. getDeclaredMethods:获取本类中所有方法</span></span><br><span class="line">        Method[] declaredMethods = personCls.getDeclaredMethods();</span><br><span class="line">        <span class="keyword">for</span> (Method declaredMethod : declaredMethods) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类所有方法:&quot;</span> + declaredMethod);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        7. getConstructors: 获取本类所有public修饰的构造器</span></span><br><span class="line">        Constructor[] constructors = personCls.getConstructors();</span><br><span class="line">        <span class="keyword">for</span> (Constructor constructor : constructors) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类的公有构造器:&quot;</span> + constructor);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        8.  getDeclaredConstructors:获取本类中所有构造器</span></span><br><span class="line">        Constructor[] declaredConstructors = personCls.getDeclaredConstructors();</span><br><span class="line">        <span class="keyword">for</span> (Constructor declaredConstructor : declaredConstructors) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类所有构造器:&quot;</span> + declaredConstructor);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        9. getPackage:以Package形式返回包信息</span></span><br><span class="line">        System.out.println(personCls.getPackage());</span><br><span class="line"><span class="comment">//        10. getSuperClass:以Class形式返回父类信息</span></span><br><span class="line">        System.out.println(<span class="string">&quot;父类的Class对象&quot;</span>+personCls.getSuperclass());</span><br><span class="line"><span class="comment">//        11. getlnterfaces:以Class形式返回接口信息</span></span><br><span class="line">        Class[] interfaces = personCls.getInterfaces();</span><br><span class="line">        <span class="keyword">for</span> (Class anInterface : interfaces) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;接口信息:&quot;</span>+anInterface);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        12. getAnnotations:以Annotation[]形式返回注解信息</span></span><br><span class="line">        Annotation[] annotations = personCls.getAnnotations();</span><br><span class="line">        <span class="keyword">for</span> (Annotation annotation : annotations) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;注解信息:&quot;</span>+annotation);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">    <span class="comment">//属性</span></span><br><span class="line">    <span class="keyword">public</span> String hobby;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">h1</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IA</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IB</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Deprecated</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">extends</span> <span class="title class_">A</span> <span class="keyword">implements</span> <span class="title class_">IA</span>,IB&#123;</span><br><span class="line">    <span class="comment">//属性</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> age;</span><br><span class="line">    String job;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> sal;</span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Person</span><span class="params">(String name,<span class="type">int</span> age)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">m3</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">m4</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="2-Field类"   >
          <a href="#2-Field类" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Field类" class="headerlink" title="2.Field类"></a>2.Field类</h4>
      <ol>
<li>getModifiers: 以int形式返回修饰符[说明:默认修饰符是0,public是1,private是2， protected是4,static是8, final是16]</li>
<li>getType:以Class形式返回类型</li>
<li>getName:返回属性名</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">api_02</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//得到Class对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">personCls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.reflection.Person&quot;</span>);</span><br><span class="line"><span class="comment">//        getDeclaredFields:获取本类中所有属性</span></span><br><span class="line">        <span class="comment">//说明:默认修饰符是0,public是1,private是2，protected是4,static是8, final是16</span></span><br><span class="line">        Field[] declaredFields = personCls.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field declaredField : declaredFields) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类所有属性:&quot;</span> + declaredField.getName() + <span class="string">&quot;,该属性的修饰符值:&quot;</span> + declaredField.getModifiers()</span><br><span class="line">            +<span class="string">&quot;,该属性的类型=&quot;</span> + declaredField.getType());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="3-Method类"   >
          <a href="#3-Method类" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Method类" class="headerlink" title="3.Method类"></a>3.Method类</h4>
      <ol>
<li>getModifiers:以int形式返回修饰符<br>[说明:默认修饰符是0，public 是1，private是2， protected是4,static是8, final是16]</li>
<li>getReturnType:以Class形式获取返回类型</li>
<li>getName:返回方法名</li>
<li>getParameterTypes:以Class返回参数类型数组</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">api_03</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//得到Class对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">personCls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.reflection.Person&quot;</span>);</span><br><span class="line"><span class="comment">//        getDeclaredMethods:获取本类中所有方法</span></span><br><span class="line">        <span class="comment">//[说明:默认修饰符是0，public 是1，private是2， protected是4,static是8, final是16]</span></span><br><span class="line">        Method[] declaredMethods = personCls.getDeclaredMethods();</span><br><span class="line">        <span class="keyword">for</span> (Method declaredMethod : declaredMethods) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类所有方法:&quot;</span> + declaredMethod.getName()</span><br><span class="line">            +<span class="string">&quot;,该方法的返回值:&quot;</span>+ declaredMethod.getReturnType()</span><br><span class="line">            +<span class="string">&quot;,该方法的访问修饰符值:&quot;</span>+declaredMethod.getModifiers());</span><br><span class="line">            <span class="keyword">for</span> (Class&lt;?&gt; parameterType : declaredMethod.getParameterTypes()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;该方法的参数:&quot;</span>+parameterType);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>




        <h4 id="4-Constructor类"   >
          <a href="#4-Constructor类" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Constructor类" class="headerlink" title="4.Constructor类"></a>4.Constructor类</h4>
      <ol>
<li>getModifiers: 以int形式返回修饰符</li>
<li>getName:返回构造器名(全类名)</li>
<li>getParameterTypes:以class[返回参数类型数组</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">api_04</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//得到Class对象</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">personCls</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.why.reflection.Person&quot;</span>);</span><br><span class="line"><span class="comment">//        getDeclaredConstructors:获取本类中所有构造器</span></span><br><span class="line">        Constructor[] declaredConstructors = personCls.getDeclaredConstructors();</span><br><span class="line">        <span class="keyword">for</span> (Constructor declaredConstructor : declaredConstructors) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;本类所有构造器:&quot;</span> + declaredConstructor.getName()</span><br><span class="line">            +<span class="string">&quot;,该对象表示的可执行文件的Java语言modifiers:&quot;</span> + declaredConstructor.getModifiers());</span><br><span class="line">            <span class="keyword">for</span> (Class parameterType : declaredConstructor.getParameterTypes()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;该构造器的形参:&quot;</span>+parameterType);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="5-反射操作"   >
          <a href="#5-反射操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-反射操作" class="headerlink" title="5.反射操作"></a>5.反射操作</h2>
      
        <h3 id="1-反射创建对象"   >
          <a href="#1-反射创建对象" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-反射创建对象" class="headerlink" title="1.反射创建对象"></a>1.反射创建对象</h3>
      <ol>
<li>方式一:调用类中的public修饰的无参构造器</li>
<li>方式二:调用类中的指定构造器</li>
<li>Class类相关方法<ul>
<li>newlnstance:调用类中的无参构造器,获取对应类的对象</li>
<li>getConstructor(Class…clazz):根据参数列表，获取对应的公共构造器对象</li>
<li>getDecalaredConstructor(Class..clazz):根据参数列表，获取对应的构造器对象</li>
</ul>
</li>
<li>Constructor类相关方法<ul>
<li>setAccessible:暴破</li>
<li>newlnstance(Obiect…obi):调用构造器</li>
</ul>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 22:37</span></span><br><span class="line"><span class="comment"> * 通过反射机制创建实例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionInstance</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException &#123;</span><br><span class="line">        <span class="comment">//1.先获取到User类的Class对象</span></span><br><span class="line">        Class&lt;?&gt; userClass = Class.forName(<span class="string">&quot;com.why.reflection.User&quot;</span>);</span><br><span class="line">        <span class="comment">//2.通过public的无参构造器创建实例</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> userClass.newInstance();</span><br><span class="line">        System.out.println(o);</span><br><span class="line">        <span class="comment">//3.通过public的有参构造器创建实例</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            constructor对象就是</span></span><br><span class="line"><span class="comment">            public User(String name)&#123;</span></span><br><span class="line"><span class="comment">                this.name = name;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//1)先得到对应构造器</span></span><br><span class="line">        Constructor&lt;?&gt; constructor = userClass.getConstructor(String.class);</span><br><span class="line">        <span class="comment">//2)创建实例,并传入实参</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">hhh</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot;hhh&quot;</span>);</span><br><span class="line">        System.out.println(hhh);</span><br><span class="line">        <span class="comment">//4.通过private的有参构造器创建实例</span></span><br><span class="line">        <span class="comment">//1)先得到private的构造器对象</span></span><br><span class="line">        Constructor&lt;?&gt; declaredConstructor = userClass.getDeclaredConstructor(<span class="type">int</span>.class, String.class);</span><br><span class="line">        <span class="comment">//暴破[暴力破解],使用反射可以反问private构造器/方法/属性</span></span><br><span class="line">        declaredConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">nihao</span> <span class="operator">=</span> declaredConstructor.newInstance(<span class="number">20</span>, <span class="string">&quot;nihao&quot;</span>);</span><br><span class="line">        System.out.println(nihao);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;why&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">User</span><span class="params">(<span class="type">int</span> age,String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>




        <h3 id="2-反射操作属性"   >
          <a href="#2-反射操作属性" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-反射操作属性" class="headerlink" title="2.反射操作属性"></a>2.反射操作属性</h3>
      <ol>
<li>根据属性名获取Field对象<br>Field f &#x3D;clazz对象.getDeclaredField(属性名);</li>
<li>暴破:f.setAccessible(true);&#x2F;&#x2F;f是Field</li>
<li>访问<ul>
<li>f.set(o,值);</li>
<li>syso(f.get(o));</li>
</ul>
</li>
<li>如果是静态属性，则set和get中的参数o，可以写成null</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 22:59</span></span><br><span class="line"><span class="comment"> * 反射操作属性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionField</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IllegalAccessException, InstantiationException, ClassNotFoundException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="comment">//1.得到Student类对应Class对象</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.why.reflection.Student&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建对象</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();<span class="comment">//o的运行类型是Student</span></span><br><span class="line">        System.out.println(o.getClass());<span class="comment">//Student</span></span><br><span class="line">        <span class="comment">//3.使用反射得到age属性</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">age</span> <span class="operator">=</span> aClass.getField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">        age.set(o,<span class="number">88</span>);<span class="comment">//通过反射操作属性</span></span><br><span class="line">        System.out.println(o);</span><br><span class="line">        System.out.println(age.get(o));</span><br><span class="line">        <span class="comment">//4.使用反射得到name属性</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">name</span> <span class="operator">=</span> aClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="comment">//对name进行暴破,可以操作private属性</span></span><br><span class="line">        name.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//        name.set(o,&quot;why&quot;);</span></span><br><span class="line">        name.set(<span class="literal">null</span>,<span class="string">&quot;hhh&quot;</span>);<span class="comment">//因为name</span></span><br><span class="line">        System.out.println(o);</span><br><span class="line"><span class="comment">//        System.out.println(name.get(o));</span></span><br><span class="line">        System.out.println(name.get(<span class="literal">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;,name=&quot;</span> + name +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-反射操作方法"   >
          <a href="#3-反射操作方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-反射操作方法" class="headerlink" title="3.反射操作方法"></a>3.反射操作方法</h3>
      <ol>
<li><p>根据方法名和参数列表获取Method方法对象: </p>
<p>Method m &#x3D;clazz.getDeclaredMethod(方法名，XX.class);</p>
</li>
<li><p>获取对象:Object o&#x3D;clazz.newlnstance();</p>
</li>
<li><p>暴破:m.setAccessible(true);</p>
</li>
<li><p>访问:Object returnValue &#x3D; m.invoke(o,实参列表);</p>
</li>
<li><p>注意:如果是静态方法，则invoke的参数o，可以写成null!</p>
</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 23:24</span></span><br><span class="line"><span class="comment"> * 反射操作方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectionMethods</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123;</span><br><span class="line">        <span class="comment">//1.得到Boss的Class对象</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.why.reflection.Boss&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建实例</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aClass.newInstance();</span><br><span class="line">        <span class="comment">//3.调用public的hi方法</span></span><br><span class="line"><span class="comment">//        Method hi = aClass.getMethod(&quot;hi&quot;,String.class);</span></span><br><span class="line">        <span class="comment">//1)得到hi方法对象</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">hi</span> <span class="operator">=</span> aClass.getDeclaredMethod(<span class="string">&quot;hi&quot;</span>,String.class);</span><br><span class="line">        <span class="comment">//2)调用</span></span><br><span class="line">        hi.invoke(o,<span class="string">&quot;why&quot;</span>);</span><br><span class="line">        <span class="comment">//4.调用private static方法</span></span><br><span class="line">        <span class="comment">//1)得到say方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">say</span> <span class="operator">=</span> aClass.getDeclaredMethod(<span class="string">&quot;say&quot;</span>, <span class="type">int</span>.class, String.class, <span class="type">char</span>.class);</span><br><span class="line">        <span class="comment">//2)爆破调用</span></span><br><span class="line">        say.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//3)调用 static 所以可以不用传入其实例</span></span><br><span class="line">        System.out.println(say.invoke(o, <span class="number">1</span>, <span class="string">&quot;why&quot;</span>, <span class="string">&#x27;c&#x27;</span>));</span><br><span class="line">        System.out.println(say.invoke(<span class="literal">null</span>, <span class="number">2</span>, <span class="string">&quot;why&quot;</span>, <span class="string">&#x27;c&#x27;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在反射中,如有返回值,统一返回Object,但是其运行类型和方法定义的返回类型一致</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Boss</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Boss</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">say</span><span class="params">(<span class="type">int</span> n,String s,<span class="type">char</span> c)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n + <span class="string">&quot; &quot;</span> + s + <span class="string">&quot; &quot;</span> + c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">(String s)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hi &quot;</span> + s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="6-练习"   >
          <a href="#6-练习" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-练习" class="headerlink" title="6.练习"></a>6.练习</h2>
      
        <h3 id="练习1"   >
          <a href="#练习1" class="heading-link"><i class="fas fa-link"></i></a><a href="#练习1" class="headerlink" title="练习1"></a>练习1</h3>
      <p>通过反射修改私有成员变量 com.hspedu.homework Homework01.java</p>
<ol>
<li>定义PrivateTest类，有私有name属性,并且属性值为hellokitty</li>
<li>提供getName的公有方法</li>
<li>创建PrivateTest的类，利用Class类得到私有的name属性，修改私有的name属性值，并调用getName()的方法打印name属性值</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PrivateTest</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;hellokitty&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.homework;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 23:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Homework01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IllegalAccessException, InstantiationException, NoSuchFieldException, InvocationTargetException, NoSuchMethodException &#123;</span><br><span class="line">        <span class="comment">//1.得到PrivateTest类对应的Class对象</span></span><br><span class="line">        Class&lt;PrivateTest&gt; privateTestClass = PrivateTest.class;</span><br><span class="line">        <span class="comment">//2.创建对象实例</span></span><br><span class="line">        <span class="type">PrivateTest</span> <span class="variable">privateTest</span> <span class="operator">=</span> privateTestClass.newInstance();</span><br><span class="line">        <span class="comment">//3.得到getName()方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">getName</span> <span class="operator">=</span> privateTestClass.getDeclaredMethod(<span class="string">&quot;getName&quot;</span>);</span><br><span class="line">        System.out.println(getName.invoke(privateTest));</span><br><span class="line">        <span class="comment">//3.得到name属性</span></span><br><span class="line">        <span class="type">Field</span> <span class="variable">name</span> <span class="operator">=</span> privateTestClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        name.set(privateTest,<span class="string">&quot;hhh&quot;</span>);</span><br><span class="line">        System.out.println(getName.invoke(privateTest));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PrivateTest</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;hellokitty&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="练习2"   >
          <a href="#练习2" class="heading-link"><i class="fas fa-link"></i></a><a href="#练习2" class="headerlink" title="练习2"></a>练习2</h3>
      <p>利用反射和File完成以下功能Homework02.java</p>
<ol>
<li><p>利用Class类的forName方法得到File类的class对象</p>
</li>
<li><p>在控制台打印File类的所有构造器</p>
</li>
<li><p>通过newlnstance的方法创建File对象，并创建E:Imynew.txt文件</p>
<p>提示:创建文件的正常写法如下:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;d:l laa.txt&quot;</span>);</span><br><span class="line">file.createNewFile();</span><br></pre></td></tr></table></div></figure></li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.reflection.homework;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/28 23:53</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Homework02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException &#123;</span><br><span class="line">        <span class="comment">//1.得到File的Class对象</span></span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.io.File&quot;</span>);</span><br><span class="line">        <span class="comment">//2.得到File的所有构造器</span></span><br><span class="line">        Constructor&lt;?&gt;[] declaredConstructors = aClass.getDeclaredConstructors();</span><br><span class="line">        <span class="keyword">for</span> (Constructor&lt;?&gt; declaredConstructor : declaredConstructors) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;File类构造器:&quot;</span> + declaredConstructor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.得到File的构造器,并创建对象</span></span><br><span class="line">        Constructor&lt;?&gt; declaredConstructor = aClass.getDeclaredConstructor(String.class);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> declaredConstructor.newInstance(<span class="string">&quot;D:\\myNew.txt&quot;</span>);<span class="comment">//创建File对象</span></span><br><span class="line">        System.out.println(o.getClass());<span class="comment">//file的运行类型就是File</span></span><br><span class="line">        <span class="comment">//4.得到File的createNewFile方法</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">createNewFile</span> <span class="operator">=</span> aClass.getDeclaredMethod(<span class="string">&quot;createNewFile&quot;</span>);</span><br><span class="line">        createNewFile.invoke(o);</span><br><span class="line">        System.out.println(<span class="string">&quot;创建文件成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="7-代理"   >
          <a href="#7-代理" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-代理" class="headerlink" title="7.代理"></a>7.代理</h2>
      <p>原理:</p>
<p>使用一个代理将对象包装起来,然后用该代理对象取代原始对象。任何对原始对象的调用都要通过代理。代理对象决定是否以及何时将方法调用转到原始对象上。</p>

        <h3 id="1-静态代理示例"   >
          <a href="#1-静态代理示例" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-静态代理示例" class="headerlink" title="1.静态代理示例"></a>1.静态代理示例</h3>
      <p>静态代理的特征是代理类和目标对象的类都是在编译期间确定下来，不利于程序的扩展。同时，每一个代理类只能为一个接口服务，这样一来程序开发中必然产生过多的代理。最好可以通过一个代理类完成全部的代理功能。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/9/8 17:54</span></span><br><span class="line"><span class="comment"> * 静态代理举例</span></span><br><span class="line"><span class="comment"> * 代理类与被代理类在编译期间就已确定</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StaticProxyTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//被代理对象</span></span><br><span class="line">        <span class="type">ClothFactory</span> <span class="variable">nikeClothFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NikeClothFactory</span>();</span><br><span class="line">        <span class="comment">//代理对象</span></span><br><span class="line">        <span class="type">ClothFactory</span> <span class="variable">proxyClothFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyClothFactory</span>(nikeClothFactory);</span><br><span class="line"></span><br><span class="line">        proxyClothFactory.produceCloth();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ClothFactory</span>&#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">produceCloth</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//代理类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProxyClothFactory</span> <span class="keyword">implements</span> <span class="title class_">ClothFactory</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ClothFactory factory;<span class="comment">//用被代理对象进行实例化</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ProxyClothFactory</span><span class="params">(ClothFactory factory)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">produceCloth</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;代理工厂做一些准备工作&quot;</span>);</span><br><span class="line">        factory.produceCloth();</span><br><span class="line">        System.out.println(<span class="string">&quot;代理工厂做后续收尾工作&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NikeClothFactory</span> <span class="keyword">implements</span> <span class="title class_">ClothFactory</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">produceCloth</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Nick工厂生产一批衣服&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="2-动态代理"   >
          <a href="#2-动态代理" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-动态代理" class="headerlink" title="2.动态代理"></a>2.动态代理</h3>
      <p>动态代理是指客户通过代理类来调用其它对象的方法，并且是在程序运行时根据需要动态创建目标类的代理对象。<br>动态代理使用场合:</p>
<ul>
<li>调试 </li>
<li>远程方法调用</li>
</ul>
<p>●动态代理相比于静态代理的优点:<br>抽象角色中（接口）声明的所有方法都被转移到调用处理器一个集中的方法中处理，这样，我们可以更加灵活和统一的处理众多的方法。</p>
<p>示例:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/9/8 19:45</span></span><br><span class="line"><span class="comment"> * 动态代理举例</span></span><br><span class="line"><span class="comment"> * 问题一:如何根据加载到内存中的被代理类,动态的创建一个代理类及其对象</span></span><br><span class="line"><span class="comment"> * 问题二:当通过代理类的对象调用方法时,如何动态的去调用被代理类中的同名方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SuperMan</span> <span class="variable">superMan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SuperMan</span>();</span><br><span class="line">        <span class="type">Human</span> <span class="variable">proxyInstance</span> <span class="operator">=</span> (Human) proxyFactory.getProxyInstance(superMan);</span><br><span class="line">        proxyInstance.eat(<span class="string">&quot;beef&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">belief</span> <span class="operator">=</span> proxyInstance.getBelief();</span><br><span class="line">        System.out.println(belief);</span><br><span class="line"></span><br><span class="line">        <span class="type">ClothFactory</span> <span class="variable">proxyInstance1</span> <span class="operator">=</span> (ClothFactory) proxyFactory.getProxyInstance(<span class="keyword">new</span> <span class="title class_">NikeClothFactory</span>());</span><br><span class="line">        proxyInstance1.produceCloth();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Human</span>&#123;</span><br><span class="line">    String <span class="title function_">getBelief</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">(String food)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//被代理类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SuperMan</span> <span class="keyword">implements</span> <span class="title class_">Human</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getBelief</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I believe i can fly&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">(String food)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I like &quot;</span> + food);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span>&#123;</span><br><span class="line">    <span class="comment">//被代理类对象</span></span><br><span class="line">    <span class="keyword">private</span> Object obj;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">myInvocationHandler</span><span class="params">(Object obj)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.obj = obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当我们通过代理类的对象调用方法a时就会自动调用如下 invoke 方法</span></span><br><span class="line">    <span class="comment">//将被代理类要执行的方法a声明在invoke方法这种</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;日志,方法&quot;</span>+method.getName()+<span class="string">&quot;执行,被代理对象:&quot;</span>+obj.getClass());</span><br><span class="line">        <span class="keyword">if</span>(args != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Object arg : args) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;参数:&quot;</span>+arg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//被代理类对象方法调用的返回值作为该 invoke()方法的返回值返回</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> method.invoke(obj, args);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;日志,方法执行完毕&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> returnValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">proxyFactory</span>&#123;</span><br><span class="line">    <span class="comment">//调用方法返回代理对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getProxyInstance</span><span class="params">(Object obj)</span>&#123;<span class="comment">//obj:被代理类的对象</span></span><br><span class="line">        <span class="type">myInvocationHandler</span> <span class="variable">myInvocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">myInvocationHandler</span>(obj);</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(</span><br><span class="line">            obj.getClass().getClassLoader(), </span><br><span class="line">            obj.getClass().getInterfaces(),</span><br><span class="line">            myInvocationHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-动态代理与AOP"   >
          <a href="#3-动态代理与AOP" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-动态代理与AOP" class="headerlink" title="3.动态代理与AOP"></a>3.动态代理与AOP</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210909232538203.png" alt="image-20210909232538203"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210909232556751.png" alt="image-20210909232556751"></p>
<p>改进后的说明:代码段1、代码段2、代码段3和深色代码段分离开了，但代码段1、2、3又和一个特定的方法A耦合了!</p>
<p>最理想的效果是:代码块1、2、3既可以执行方法A，又无须在程序中以硬编码的方式直接调用深色代码的方法</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210909232714093.png" alt="image-20210909232714093"></p>

        <h1 id="Java-注解"   >
          <a href="#Java-注解" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-注解" class="headerlink" title="Java 注解"></a>Java 注解</h1>
      
        <h1 id="正则表达式"   >
          <a href="#正则表达式" class="heading-link"><i class="fas fa-link"></i></a><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1>
      
        <h2 id="1-快速入门"   >
          <a href="#1-快速入门" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-快速入门" class="headerlink" title="1.快速入门"></a>1.快速入门</h2>
      
        <h2 id="2-基本语法"   >
          <a href="#2-基本语法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-基本语法" class="headerlink" title="2.基本语法"></a>2.基本语法</h2>
      
        <h2 id="3-三个常用类"   >
          <a href="#3-三个常用类" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-三个常用类" class="headerlink" title="3.三个常用类"></a>3.三个常用类</h2>
      
        <h2 id="4-分组-捕获-反向引用"   >
          <a href="#4-分组-捕获-反向引用" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-分组-捕获-反向引用" class="headerlink" title="4.分组,捕获,反向引用"></a>4.分组,捕获,反向引用</h2>
      
        <h2 id="5-元字符"   >
          <a href="#5-元字符" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-元字符" class="headerlink" title="5.元字符"></a>5.元字符</h2>
      
        <h2 id="6-应用实例"   >
          <a href="#6-应用实例" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-应用实例" class="headerlink" title="6.应用实例"></a>6.应用实例</h2>
      
        <h1 id="Java-8-新特性"   >
          <a href="#Java-8-新特性" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-8-新特性" class="headerlink" title="Java 8 新特性"></a>Java 8 新特性</h1>
      <p>Java 8(又称为jdk 1.8)是Java语言开发的一个主要版本。Java 8是oracle公司于2014年3月发布，可以看成是自Java 5以来最具革命性的版本。Java 8为Java语言、编译器、类库、开发工具与JVM带来了大量新特性。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210911142616714.png" alt="image-20210911142616714"></p>
<ul>
<li>速度更快</li>
<li>代码更少(增加了新的语法: Lambda表达式)</li>
<li>强大的Stream API</li>
<li>便于并行</li>
<li>最大化减少空指针异常:Optional</li>
<li>Nashorn引擎，允许在JVM上运行JS应用</li>
</ul>
<p>并行流就是把一个内容分成多个数据块，并用不同的线程分别处理每个数据块的流。相比较串行的流，并行的流可以很大程度上提高程序的执行效率。<br>Java8中将并行进行了优化，我们可以很容易的对数据进行并行操作。Stream API可以声明性地通过parallel() 与 sequential()在并行流与顺序流之间进行切换。</p>

        <h2 id="1-Lambda表达式"   >
          <a href="#1-Lambda表达式" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Lambda表达式" class="headerlink" title="1.Lambda表达式"></a>1.Lambda表达式</h2>
      
        <h3 id="1-为什么要使用Lambda表达式"   >
          <a href="#1-为什么要使用Lambda表达式" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-为什么要使用Lambda表达式" class="headerlink" title="1.为什么要使用Lambda表达式"></a>1.为什么要使用Lambda表达式</h3>
      <p>Lambda是一个匿名函数，我们可以把 Lambda表达式理解为是一段可以传递的代码（将代码像数据一样进行传递）。使用它可以写出更简洁、更灵活的代码。作为一种更紧凑的代码风格，使Java的语言表达能力得到了提升。</p>
<p>示例:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.lambda;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Lambda表达式的使用举例</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Example1</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">r1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;我爱你&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        r1.run();</span><br><span class="line">        System.out.println(<span class="string">&quot;------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">r2</span> <span class="operator">=</span> ()-&gt;&#123;System.out.println(<span class="string">&quot;我爱你啊&quot;</span>);&#125;;</span><br><span class="line">        r2.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        Comparator&lt;Integer&gt; comparator = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> Integer.compare(o1,o2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">com1</span> <span class="operator">=</span> comparator.compare(<span class="number">12</span>,<span class="number">21</span>);</span><br><span class="line">        System.out.println(com1);</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">        <span class="comment">//Lambda表达式</span></span><br><span class="line">        Comparator&lt;Integer&gt; comparator2 = (o1,o2) -&gt; Integer.compare(o1,o2);</span><br><span class="line">        <span class="type">int</span> <span class="variable">com2</span> <span class="operator">=</span> comparator2.compare(<span class="number">32</span>,<span class="number">21</span>);</span><br><span class="line">        System.out.println(com2);</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">        <span class="comment">//方法引用</span></span><br><span class="line">        Comparator&lt;Integer&gt; comparator3 = Integer :: compare;</span><br><span class="line">        <span class="type">int</span> <span class="variable">com3</span> <span class="operator">=</span> comparator3.compare(<span class="number">12</span>,<span class="number">21</span>);</span><br><span class="line">        System.out.println(com3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>简化过程</p>
<p>外部类-&gt;静态内部类-&gt;局部内部类-&gt;匿名内部类-&gt;Lambda表达式</p>

        <h3 id="2-语法的使用"   >
          <a href="#2-语法的使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-语法的使用" class="headerlink" title="2.语法的使用"></a>2.语法的使用</h3>
      <p>Lambda表达式的本质:作为函数式接口的实例</p>
<ol>
<li><p>无参,无返回值</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Runnable</span> <span class="variable">r1</span> <span class="operator">=</span> () -&gt; &#123;System.out.println(<span class="string">&quot;Hello Lambda!&quot;</span>);&#125;;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>Lambda需要一个参数,但是没有返回值</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;String&gt; con = (String s) -&gt; &#123;System.out.println(s);&#125;;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>数据类型可以省略,因为可以由编译器推断得出,称为”类型推断”</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;String&gt; con = (s) -&gt; &#123;System.out.println(s);&#125;;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>Lambda若只需要一个参数时,小括号可以省略</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;String&gt; con = s -&gt; &#123;System.out.println(s);&#125;;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>Lambda需要两个或以上的参数,多条执行语句,并且可以有返回值</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; com2 = (o1,o2) -&gt; &#123;</span><br><span class="line">    System.out.println(o1);</span><br><span class="line">    System.out.println(o2);</span><br><span class="line">    <span class="keyword">return</span> o1.compareTo(o2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</li>
<li><p>当Lambda体只有一条语句时,return与大括号若有,可以省略</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; com2 = (o1,o2) -&gt; o1.compareTo(o2);</span><br></pre></td></tr></table></div></figure></li>
</ol>

        <h2 id="2-函数式-Functional-接口"   >
          <a href="#2-函数式-Functional-接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-函数式-Functional-接口" class="headerlink" title="2.函数式(Functional)接口"></a>2.函数式(Functional)接口</h2>
      <p>如果一个接口中,只声明了一个抽象方法,则此接口就称为函数式接口</p>
<p>可以添加<code>@FunctionalInterface</code></p>

        <h3 id="1-什么是函数式接口"   >
          <a href="#1-什么是函数式接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-什么是函数式接口" class="headerlink" title="1.什么是函数式接口"></a>1.什么是函数式接口</h3>
      <ul>
<li>只包含一个抽象方法的接口，称为函数式接口。</li>
<li>可以通过Lambg表达式来创建该接口的对象。（若Lambda表达式抛出一个受检异常(即:非运行时异常)，那么该异常需要在目标接口的抽象方法上进行声明）。</li>
<li>可以在一个接口上使用@Functionallnterface 注解，这样做可以检查它是否是一个函数式接口。同时 javadoc也会包含一条声明，说明这个接口是一个函数式接口。</li>
<li>在java.util.function包下定义了Java 8的丰富的函数式接口</li>
</ul>

        <h3 id="2-如何理解函数式接口"   >
          <a href="#2-如何理解函数式接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-如何理解函数式接口" class="headerlink" title="2.如何理解函数式接口"></a>2.如何理解函数式接口</h3>
      <ul>
<li>Java从诞生日起就是一直倡导“一切皆对象”I在Java里面面向对象(OOP)编程是一切。但是随着python、scala等语言的兴起和新技术的挑战，Java不得不做出调整以便支持更加广泛的技术要求，也即java不但可以支持OOP还可以支持OOF（面向函数编程)</li>
<li>在函数式编程语言当中，函数被当做一等公民对待。在将函数作为一等公民的编程语言中，Lambda表达式的类型是函数。但是在Java8中，有所不同。在Java8中，Lambda表达式是对象，而不是函数，它们必须依附于一类特别的对象类型——函数式接口。</li>
<li>简单的说，在Java8中，Lambda表达式就是一个函数式接口的实例。这就是Lambda表达式和函数式接口的关系。也就是说，只要一个对象是函数式接口的实例，那么该对象就可以用Lambda表达式来表示。</li>
<li>所以以前用匿名实现类表示的函数式接口–&gt;现在都可以用Lambda表达式来写。</li>
</ul>

        <h3 id="3-四大核心函数式接口"   >
          <a href="#3-四大核心函数式接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-四大核心函数式接口" class="headerlink" title="3.四大核心函数式接口"></a>3.四大核心函数式接口</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210913215516607.png" alt="image-20210913215516607"></p>
<p>其他接口</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210913221500969.png" alt="image-20210913221500969"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.lambda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Consumer;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Predicate;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> why</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/9/13 22:02</span></span><br><span class="line"><span class="comment"> * Java内置的4大核心函数式接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 消费型接口 Consumer</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 供给型接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 函数型接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 断定型接口 Predicate</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExampleForUse2</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        happyTime(<span class="number">100</span>,money-&gt; System.out.println(<span class="string">&quot;得到了&quot;</span>+money));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">happyTime</span><span class="params">(<span class="type">double</span> money, Consumer&lt;Double&gt; con)</span>&#123;</span><br><span class="line">        con.accept(money);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;a1&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;a2&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;a3&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;a4&quot;</span>);</span><br><span class="line">        List&lt;String&gt; strings = filterString(list, (s) -&gt; s.contains(<span class="string">&quot;1&quot;</span>));</span><br><span class="line">        <span class="keyword">for</span> (String string : strings) &#123;</span><br><span class="line">            System.out.println(string);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据给定的规则,过滤集合中的字符串,此规则由predicate的方法决定</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">filterString</span><span class="params">(List&lt;String&gt; list, Predicate&lt;String&gt; predicate)</span>&#123;</span><br><span class="line">        ArrayList&lt;String&gt; list1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String s : list) &#123;</span><br><span class="line">            <span class="keyword">if</span>(predicate.test(s))&#123;</span><br><span class="line">                list1.add(s);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h2 id="3-方法引用与构造器引用"   >
          <a href="#3-方法引用与构造器引用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-方法引用与构造器引用" class="headerlink" title="3.方法引用与构造器引用"></a>3.方法引用与构造器引用</h2>
      <p>方法引用</p>
<ul>
<li>使用时机:当要传递给Lambda体的操作，已经有实现的方法了，可以使用方法引用</li>
<li>方法引用可以看做是Lambda表达式深层次的表达。换句话说，方法引用就是Lambda表达式，也就是函数式接口的一个实例，通过方注的名字来指向一个方法，可以认为是Lambda表达式的一个语法糖。</li>
<li>方法引用使用的要求:实现接口的抽象方法的参数列表和返回值类型，必须与方法引用的方法的参数列表和返回值类型保持一致!</li>
<li>格式:使用操作符“::”将类(或对象)与方法名分隔开来。如下三种主要使用情况:<ul>
<li>对象::实例方法名</li>
<li>类:静态方法名</li>
<li>类::实例方法名</li>
</ul>
</li>
</ul>
<p>构造器引用:</p>
<ul>
<li>和方法引用类似，函数式接口的抽象方法的形参列表和构造器的形参列表一致。</li>
<li>抽象方法的返回值类型即为构造器所属的类的类型</li>
</ul>

        <h2 id="4-Stream-API"   >
          <a href="#4-Stream-API" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Stream-API" class="headerlink" title="4.Stream API"></a>4.Stream API</h2>
      
        <h3 id="1-概述-3"   >
          <a href="#1-概述-3" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-概述-3" class="headerlink" title="1.概述"></a>1.概述</h3>
      
        <h4 id="1-介绍-5"   >
          <a href="#1-介绍-5" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍-5" class="headerlink" title="1.介绍"></a>1.介绍</h4>
      <ul>
<li>Java8中有两大最为重要的改变。第一个是Lambda表达式;另外一个则是Stream API</li>
<li>Stream APl ( java.util.stream)把真正的函数式编程风格引入到Java中。这是目前为止对Java类库最好的补充，因为Stream API可以极大提供Java程序员的生产力，让程序员写出高效率、干净、简洁的代码。</li>
<li>Stream是 Java8中处理集合的关键抽象概念，它可以指定你希望对集合进行的操作，可以执行非常复杂的查找、过滤和映射数据等操作。使用Stream API对集合数据进行操作，就类似于使用SQL执行的数据库查询。也可以使用Stream API来并行执行操作。简言之，Stream API提供了一种高效且易于使用的处理数据的方式。</li>
</ul>

        <h4 id="2-为什么使用"   >
          <a href="#2-为什么使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-为什么使用" class="headerlink" title="2.为什么使用"></a>2.为什么使用</h4>
      <ul>
<li>实际开发中，项目中多数数据源都来自于Mysql，Oracle等。但现在数据源可以更多了，有MongDB， Radis等，而这些NoSQL的数据就需要Java层面去处理。</li>
<li>Stream和 Collection集合的区别:&#x3D;&#x3D;Collection是一种静态的内存数据结构，而Stream是有关计算的&#x3D;&#x3D;。前者是主要面向内存，存储在内存中，后者主要是面向CPU，通过CPU 实现计算。</li>
</ul>
<p>Stream是数据渠道，用于操作数据源（集合、数组等）所生成的元素序列。“集合讲的是数据，Stream讲的是计算</p>
<p>注意:</p>
<ul>
<li>stream自己不会存储元素</li>
<li>stream不会改变源对象。相反，他们会返回一个持有结果的新Stream</li>
<li>stream 操作是延迟执行的。这意味着他们会等到需要结果的时候才执行</li>
</ul>

        <h4 id="3-三个步骤"   >
          <a href="#3-三个步骤" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-三个步骤" class="headerlink" title="3.三个步骤"></a>3.三个步骤</h4>
      <ol>
<li><p>创建Stream</p>
<p>一个数据源(如:集合,数组),获取一个流</p>
</li>
<li><p>中间操作</p>
<p>一个中间操作键,对数据源的数据进行处理</p>
</li>
<li><p>终止操作(终端操作)</p>
<p>一旦执行终止操作,就执行中间操作链,并产生结果,之后,不会再被使用</p>
</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915132653769.png" alt="image-20210915132653769"></p>

        <h3 id="2-实例化"   >
          <a href="#2-实例化" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实例化" class="headerlink" title="2.实例化"></a>2.实例化</h3>
      
        <h4 id="1-集合"   >
          <a href="#1-集合" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-集合" class="headerlink" title="1.集合"></a>1.集合</h4>
      <p>Java8 中的 Collection接口被扩展，提供了两个获取流的方法:</p>
<ul>
<li>default Stream<E>stream():返回一个顺序流</li>
<li>default Stream<E> parallelStream():返回一个并行流</li>
</ul>

        <h4 id="2-数组"   >
          <a href="#2-数组" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-数组" class="headerlink" title="2.数组"></a>2.数组</h4>
      <p>Java8中的Arrays的静态方法stream()可以获取数组流:</p>
<ul>
<li>static <T> Stream<T> stream(TI array):返回一个流</li>
</ul>
<p>重载形式，能够处理对应基本类型的数组:</p>
<ul>
<li>public static IntStream stream(int[] array)</li>
<li>public static LongStream stream(long[] array)</li>
<li>public static DoubleStream stream(double[]array)</li>
</ul>

        <h4 id="3-Stream的of"   >
          <a href="#3-Stream的of" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Stream的of" class="headerlink" title="3.Stream的of()"></a>3.Stream的of()</h4>
      <p>可以调用Stream类静态方法 of(),通过显示值创建一个流。它可以接收任意数量的参数。</p>
<ul>
<li>public static<T> Stream<T> of(T… values):返回一个流</li>
</ul>

        <h4 id="4-创建无限流"   >
          <a href="#4-创建无限流" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-创建无限流" class="headerlink" title="4.创建无限流"></a>4.创建无限流</h4>
      <p>可以使用静态方法 Stream.iterate()和 Stream.generate().创建无限流。</p>
<ul>
<li>迭代<ul>
<li>public static<T> Stream<T> iterate(final T seed, final Unaryoperator<I>T)</li>
</ul>
</li>
<li>生成<ul>
<li>public static<T> Stream<T>generate(Supplier<T>s)</li>
</ul>
</li>
</ul>

        <h3 id="3-中间操作"   >
          <a href="#3-中间操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-中间操作" class="headerlink" title="3.中间操作"></a>3.中间操作</h3>
      <p>多个中间操作可以连接起来形成一个流水线，除非流水线上触发终止操作，否则中间操作不会执行任何的处理!而在终止操作时一次性全部处理,称为“惰性求值”。</p>

        <h4 id="1-筛选与切片"   >
          <a href="#1-筛选与切片" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-筛选与切片" class="headerlink" title="1.筛选与切片"></a>1.筛选与切片</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915134609272.png" alt="image-20210915134609272"></p>

        <h4 id="2-映射"   >
          <a href="#2-映射" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-映射" class="headerlink" title="2.映射"></a>2.映射</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915134805835.png" alt="image-20210915134805835"></p>

        <h4 id="3-排序"   >
          <a href="#3-排序" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-排序" class="headerlink" title="3.排序"></a>3.排序</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915134819634.png" alt="image-20210915134819634"></p>

        <h3 id="4-终止操作"   >
          <a href="#4-终止操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-终止操作" class="headerlink" title="4.终止操作"></a>4.终止操作</h3>
      <ul>
<li>终端操作会从流的流水线生成结果。其结果可以是任何不是流的值，例如:List、Integer，甚至是void</li>
<li>流进行了终止操作后，不能再次使用</li>
</ul>

        <h4 id="1-匹配与查找"   >
          <a href="#1-匹配与查找" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-匹配与查找" class="headerlink" title="1.匹配与查找"></a>1.匹配与查找</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915141445579.png" alt="image-20210915141445579"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915141513989.png" alt="image-20210915141513989"></p>

        <h4 id="2-归约"   >
          <a href="#2-归约" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-归约" class="headerlink" title="2.归约"></a>2.归约</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915141533157.png" alt="image-20210915141533157"></p>
<p>备注:map和reduce 的连接通常称为map-reduce模式，因Google用它来进行网络搜索而出名。</p>

        <h4 id="3-收集"   >
          <a href="#3-收集" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-收集" class="headerlink" title="3.收集"></a>3.收集</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915174715684.png" alt="image-20210915174715684"></p>
<p>Collector接口中方法的实现决定了如何对流执行收集的操作(如收集到List、Set.Map)。<br>另外，Collectors实用类提供了很多静态方法，可以方便地创建常见收集器实例，具体方法与实例如下表:</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210915174921138.png" alt="image-20210915174921138"></p>

        <h2 id="5-Optional类"   >
          <a href="#5-Optional类" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Optional类" class="headerlink" title="5.Optional类"></a>5.Optional类</h2>
      
        <h3 id="1-概述-4"   >
          <a href="#1-概述-4" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-概述-4" class="headerlink" title="1.概述"></a>1.概述</h3>
      <ul>
<li>到目前为止，臭名昭著的空指针异常是导致Java应用程序失败的最常见原因以前，为了解决空指针异常，Google公司著名的Guava项目引入了Optional类，Guava通过使用检查空值的方式来防止代码污染，它鼓励程序员写更干净的代码。受到Google Guava的启发，Optional类已经成为Java8类库的一部分。</li>
<li>Optional<T>类(java.util.Optional)是一个容器类，它可以保存类型T的值，代表这个值存在。或者仅仅保存null，表示这个值不存在。原来用null表示一个值不存在，现在 Optional可以更好的表达这个概念。并且可以避免空指针异常。</li>
<li>Optional类的Javadoc描述如下:这是一个可以为null的容器对象。如果值存在则isPresent()方法会返回true，调用get()方法会返回该对象。</li>
</ul>
<p>Optional提供很多有用的方法，这样我们就不用显式进行空值检测。</p>
<ul>
<li>创建Optional类对象的方法:<ul>
<li>Optional.of(T t):创建一个 Optional 实例，t必须非空;</li>
<li>Optional.empty():创建一个空的Optional实例</li>
<li>Optional.ofNullable(T t):t可以为null</li>
</ul>
</li>
<li>判断Optional容器中是否包含对象:<ul>
<li>boolean isPresent():判断是否包含对象</li>
<li>void ifPresent(Consumer&lt;? super T&gt; consumer):如果有值，就执行Consumer接口的实现代码，并且该值会作为参数传给它。</li>
</ul>
</li>
<li>获取Optional容器的对象:<ul>
<li>Tget():如果调用对象包含值，返回该值，否则抛异常</li>
<li>T orElse(T other):如果有值则将其返回，否则返回指定的other对象。</li>
<li>T orElseGet(Supplier&lt;? extends T&gt; other):如果有值则将其返回，否则返回由Supplier接口实现提供的对象。</li>
<li>T orElse Throw(Supplier&lt;? extends X&gt;exceptionSupplier):如果有值则将其返回，否则抛出由Supplier接口实现提供的异常。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.tOptional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OptionalTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Girl</span> <span class="variable">girl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Girl</span>();</span><br><span class="line">        <span class="comment">//girl = null;</span></span><br><span class="line">        <span class="comment">//of(T t),保证t非空</span></span><br><span class="line">        <span class="comment">//Optional&lt;Girl&gt; girl1 = Optional.of(girl);</span></span><br><span class="line">        <span class="comment">//ofNullable(T t),t可以为null</span></span><br><span class="line">        Optional&lt;Girl&gt; girl2 = Optional.ofNullable(girl);</span><br><span class="line">        System.out.println(girl2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h1 id="项目开发基本"   >
          <a href="#项目开发基本" class="heading-link"><i class="fas fa-link"></i></a><a href="#项目开发基本" class="headerlink" title="项目开发基本"></a>项目开发基本</h1>
      
        <h2 id="1-需求分析-1"   >
          <a href="#1-需求分析-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-需求分析-1" class="headerlink" title="1.需求分析"></a>1.需求分析</h2>
      <p>需求分析师(技术与行业)&#x3D;&gt;需求分析报告(白皮书)</p>

        <h2 id="2-设计阶段"   >
          <a href="#2-设计阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-设计阶段" class="headerlink" title="2.设计阶段"></a>2.设计阶段</h2>
      <p>架构师&#x2F;项目经理&#x3D;&gt;设计工作(UML类图,流程图,模块设计,数据库,架构),原型开发,组建团队</p>

        <h2 id="3-编码实现"   >
          <a href="#3-编码实现" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-编码实现" class="headerlink" title="3.编码实现"></a>3.编码实现</h2>
      <p>开发人员(程序员&#x2F;码农)&#x3D;&gt;完成模块功能,测试自己模块</p>

        <h2 id="4-测试阶段"   >
          <a href="#4-测试阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-测试阶段" class="headerlink" title="4.测试阶段"></a>4.测试阶段</h2>
      <p>测试工程师&#x3D;&gt;单元测试,测试用例,白盒测试,黑盒测试,集成测试</p>

        <h2 id="5-实施阶段"   >
          <a href="#5-实施阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-实施阶段" class="headerlink" title="5.实施阶段"></a>5.实施阶段</h2>
      <p>实施工程师(开发能力&#x2F;环境配置部署能力)&#x3D;&gt;项目正确部署到客户平台,并保证运行正常,身体好</p>

        <h2 id="6-维护阶段"   >
          <a href="#6-维护阶段" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-维护阶段" class="headerlink" title="6.维护阶段"></a>6.维护阶段</h2>
      <p>运行发现问题,解决缺陷问题,进行项目升级</p>

        <h2 id="7-github搜索"   >
          <a href="#7-github搜索" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-github搜索" class="headerlink" title="7.github搜索"></a>7.github搜索</h2>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210702221057179.png" alt="image-20210702221057179"></p>

        <h1 id="Java-JUC"   >
          <a href="#Java-JUC" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-JUC" class="headerlink" title="Java JUC"></a>Java JUC</h1>
      <p>(周阳)</p>

        <h2 id="1-线程基础"   >
          <a href="#1-线程基础" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-线程基础" class="headerlink" title="1.线程基础"></a>1.线程基础</h2>
      
        <h3 id="1-Java多线程相关概念"   >
          <a href="#1-Java多线程相关概念" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Java多线程相关概念" class="headerlink" title="1.Java多线程相关概念"></a>1.Java多线程相关概念</h3>
      
        <h4 id="1-进程"   >
          <a href="#1-进程" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-进程" class="headerlink" title="1.进程"></a>1.进程</h4>
      <p>是程序的⼀次执⾏，是系统进⾏资源分配和调度的独⽴单位，每⼀个进程都有它⾃⼰的内存空间和系统资源</p>
<p>进程（Process）是计算机中的程序关于某数据集合上的一次运行活动，是系统进行资源分配和调度的基本单位，是操作系统结构的基础。程序是指令、数据及其组织形式的描述，进程是程序的实体。</p>
<p><strong>进程具有的特征：</strong></p>
<ul>
<li><strong>动态性</strong>：进程是程序的一次执行过程，是临时的，有生命期的，是动态产生，动态消亡的</li>
<li><strong>并发性</strong>：任何进程都可以同其他进行一起并发执行</li>
<li><strong>独立性</strong>：进程是系统进行资源分配和调度的一个独立单位</li>
<li><strong>结构性</strong>：进程由程序，数据和进程控制块三部分组成</li>
</ul>
<p>我们经常使用windows系统，经常会看见.exe后缀的文件，双击这个.exe文件的时候，这个文件中的指令就会被系统加载，那么我们就能得到一个关于这个.exe程序的进程。进程是<strong>“活”</strong>的，或者说是正在被执行的。</p>

        <h4 id="2-线程-1"   >
          <a href="#2-线程-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-线程-1" class="headerlink" title="2.线程"></a>2.线程</h4>
      <p>在同⼀个进程内⼜可以执⾏多个任务，⽽这每⼀个任务我们就可以看做是⼀个线程 ⼀个进程会有1个或多个线程的</p>
<p>线程是轻量级的进程，是程序执行的最小单元，使用多线程而不是多进程去进行并发程序的设计，是因为线程间的切换和调度的成本远远小于进程。</p>
<p>Future接口(FutureTask实现类)定义了操作异步任务执行一些方法，如获取异步任务的执行结果、取消任务的执行、判断任务是否被取消、判断任务执行是否完毕等。<br>比如主线程让一个子线程去执行任务，子线程可能比较耗时，启动子线程开始执行任务后，<br>主线程就去做其他事情了，忙其它事情或者先执行完，过了一会才去获取子任务的执行结果或变更的任务状态。</p>

        <h4 id="3-进程与线程的一个简单解释"   >
          <a href="#3-进程与线程的一个简单解释" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-进程与线程的一个简单解释" class="headerlink" title="3.进程与线程的一个简单解释"></a>3.进程与线程的一个简单解释</h4>
      <p>进程（process）和线程（thread）是操作系统的基本概念，但是它们比较抽象，不容易掌握。</p>
<ol>
<li>计算机的核心是CPU，它承担了所有的计算任务。它就像一座工厂，时刻在运行。</li>
<li>假定工厂的电力有限，一次只能供给一个车间使用。也就是说，一个车间开工的时候，其他车间都必须停工。背后的含义就是，单个CPU一次只能运行一个任务。</li>
<li>进程就好比工厂的车间，它代表CPU所能处理的单个任务。任一时刻，CPU总是运行一个进程，其他进程处于非运行状态。</li>
<li>一个车间里，可以有很多工人。他们协同完成一个任务。</li>
<li>线程就好比车间里的工人。一个进程可以包括多个线程。</li>
<li>车间的空间是工人们共享的，比如许多房间是每个工人都可以进出的。这象征一个进程的内存空间是共享的，每个线程都可以使用这些共享内存。</li>
<li>可是，每间房间的大小不同，有些房间最多只能容纳一个人，比如厕所。里面有人的时候，其他人就不能进去了。这代表一个线程使用某些共享内存时，其他线程必须等它结束，才能使用这一块内存。</li>
<li>一个防止他人进入的简单方法，就是门口加一把锁。先到的人锁上门，后到的人看到上锁，就在门口排队，等锁打开再进去。这就叫”互斥锁”（Mutual exclusion，缩写 Mutex），防止多个线程同时读写某一块内存区域。</li>
<li>还有些房间，可以同时容纳n个人，比如厨房。也就是说，如果人数大于n，多出来的人只能在外面等着。这好比某些内存区域，只能供给固定数目的线程使用。</li>
<li>这时的解决方法，就是在门口挂n把钥匙。进去的人就取一把钥匙，出来时再把钥匙挂回原处。后到的人发现钥匙架空了，就知道必须在门口排队等着了。这种做法叫做”信号量”（Semaphore），用来保证多个线程不会互相冲突。</li>
<li>操作系统的设计，因此可以归结为三点： （1）以多进程形式，允许多个任务同时运行； （2）以多线程形式，允许单个任务分成不同的部分运行； （3）提供协调机制，一方面防止进程之间和线程之间产生冲突，另一方面允许进程之间和线程之间共享资源。</li>
</ol>

        <h4 id="4-管程"   >
          <a href="#4-管程" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-管程" class="headerlink" title="4.管程"></a>4.管程</h4>
      <p>Monitor(监视器)，也就是我们平时所说的锁</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Monitor其实是一种同步机制，他的义务是保证（同一时间）只有一个线程可以访问被保护的数据和代码。</span></span><br><span class="line"><span class="comment">// JVM中同步是基于进入和退出监视器对象(Monitor,管程对象)来实现的，每个对象实例都会有一个Monitor对象，</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (o)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,<span class="string">&quot;t1&quot;</span>).start();</span><br><span class="line"><span class="comment">// Monitor对象会和Java对象一同创建并销毁，它底层是由C++语言来实现的。</span></span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232236073.png" alt="image-20210904000040589"></p>

        <h4 id="5-Java线程状态"   >
          <a href="#5-Java线程状态" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Java线程状态" class="headerlink" title="5.Java线程状态"></a>5.Java线程状态</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Thread.State</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">State</span> &#123;</span><br><span class="line">    NEW,<span class="comment">//(新建)</span></span><br><span class="line">    RUNNABLE,<span class="comment">//（准备就绪）-&gt;ready run</span></span><br><span class="line">    BLOCKED,<span class="comment">//（阻塞）</span></span><br><span class="line">    WAITING,<span class="comment">//（不见不散）</span></span><br><span class="line">    TIMED_WAITING,<span class="comment">//（过时不候）</span></span><br><span class="line">    TERMINATED<span class="comment">//(终结)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>线程几个状态的介绍：</p>
<ul>
<li><strong>New</strong>：表示刚刚创建的线程，这种线程还没有开始执行</li>
<li><strong>RUNNABLE</strong>：运行状态，线程的start()方法调用后，线程会处于这种状态</li>
<li><strong>BLOCKED</strong>：阻塞状态。当线程在执行的过程中遇到了synchronized同步块，但这个同步块被其他线程已获取还未释放时，当前线程将进入阻塞状态，会暂停执行，直到获取到锁。当线程获取到锁之后，又会进入到运行状态（RUNNABLE）</li>
<li><strong>WAITING</strong>：等待状态。和<strong>TIME_WAITING</strong>都表示等待状态，区别是WAITING会进入一个无时间限制的等，而TIME_WAITING会进入一个有限的时间等待，那么等待的线程究竟在等什么呢？一般来说，WAITING的线程正式在等待一些特殊的事件，比如，通过wait()方法等待的线程在等待notify()方法，而通过join()方法等待的线程则会等待目标线程的终止。一旦等到期望的事件，线程就会再次进入RUNNABLE运行状态。</li>
<li><strong>TERMINATED</strong>：表示结束状态，线程执行完毕之后进入结束状态。</li>
</ul>
<p><strong>注意：从NEW状态出发后，线程不能在回到NEW状态，同理，处理为TERMINATED状态的线程也不能在回到RUNNABLE状态</strong></p>

        <h4 id="6-wait-x2F-sleep的区别"   >
          <a href="#6-wait-x2F-sleep的区别" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-wait-x2F-sleep的区别" class="headerlink" title="6.wait&#x2F;sleep的区别"></a>6.wait&#x2F;sleep的区别</h4>
      <p>功能都是当前线程暂停，有什么区别？</p>
<p>wait:等待,无锁 –&gt;放开手去睡，放开手里的锁</p>
<p>sleep:等待,有锁 –&gt; 握紧手去睡，醒了手里还有锁</p>

        <h3 id="2-线程的基本操作"   >
          <a href="#2-线程的基本操作" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-线程的基本操作" class="headerlink" title="2.线程的基本操作"></a>2.线程的基本操作</h3>
      
        <h4 id="1-新建线程"   >
          <a href="#1-新建线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-新建线程" class="headerlink" title="1.新建线程"></a>1.新建线程</h4>
      <p>新建线程只需要使用new关键字创建一个线程对象，然后调用它的start()启动线程即可。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread1</span>();</span><br><span class="line">t1.start();</span><br></pre></td></tr></table></div></figure>

<p>线程start()之后,会调用run()方法,start()会创建一个新的线程并让这个线程执行run()方法。</p>
<p><strong>注意</strong>:下面代码也能通过编译，也能正常执行。但是，却不能新建一个线程，而是在当前线程中调用run()方法，将run方法只是作为一个普通的方法调用。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread1</span>();</span><br><span class="line">thread1.run();</span><br></pre></td></tr></table></div></figure>

<p><strong>start方法是启动一个线程，run方法只会在垫钱线程中串行的执行run方法中的代码。</strong></p>
<p>默认情况下， 线程的run方法什么都没有，启动一个线程之后马上就结束了，所以必须重写run方法。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;            </span><br><span class="line">    <span class="meta">@Override</span>            </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;                				</span><br><span class="line">        System.out.println(<span class="string">&quot;hello,我是一个线程!&quot;</span>);   </span><br><span class="line">    &#125;        </span><br><span class="line">&#125;;</span><br><span class="line">thread1.start();</span><br></pre></td></tr></table></div></figure>

<p>上面是使用匿名内部类实现的，重写了Thread的run方法，并且打印了一条信息。<strong>我们可以通过继承Thread类，然后重写run方法，来自定义一个线程。</strong>但考虑java是单继承的，从扩展性上来说，我们实现一个接口来自定义一个线程更好一些，java中刚好提供了Runnable接口来自定义一个线程。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterfacepublic</span> </span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Runnable</span> &#123;    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>Thread类有一个非常重要的构造方法：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">Thread</span><span class="params">(Runnable target)</span></span><br></pre></td></tr></table></div></figure>

<p>Thread的run方法:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;       </span><br><span class="line">    <span class="keyword">if</span> (target != <span class="literal">null</span>) &#123;     </span><br><span class="line">        target.run();     </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>当我们启动线程的start方法之后，线程会执行run方法，run方法中会调用Thread构造方法传入的target的run方法。</p>
<p><strong>实现Runnable接口是比较常见的做法，也是推荐的做法。</strong></p>

        <h4 id="2-终止线程"   >
          <a href="#2-终止线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-终止线程" class="headerlink" title="2.终止线程"></a>2.终止线程</h4>
      <p>一般来说线程执行完毕就会结束，无需手动关闭。但是如果我们想关闭一个正在运行的线程，有什么方法呢？可以看一下Thread类中提供了一个stop()方法，调用这个方法，就可以立即将一个线程终止，非常方便。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                log.info(<span class="string">&quot;start&quot;</span>);</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">while</span> (flag) &#123;</span><br><span class="line">                    ;</span><br><span class="line">                &#125;</span><br><span class="line">                log.info(<span class="string">&quot;end&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        thread1.setName(<span class="string">&quot;thread1&quot;</span>);</span><br><span class="line">        thread1.start();</span><br><span class="line">        <span class="comment">//当前线程休眠1秒</span></span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//关闭线程thread1</span></span><br><span class="line">        thread1.stop();</span><br><span class="line">        <span class="comment">//输出线程thread1的状态</span></span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125;&quot;</span>, thread1.getState());</span><br><span class="line">        <span class="comment">//当前线程休眠1秒</span></span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//输出线程thread1的状态</span></span><br><span class="line">        log.info(<span class="string">&quot;&#123;&#125;&quot;</span>, thread1.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>运行代码输出:</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">18:02:15.312 [thread1] INFO com.itsoku.chat01.Demo01 - start</span><br><span class="line">18:02:16.311 [main] INFO com.itsoku.chat01.Demo01 - RUNNABLE</span><br><span class="line">18:02:17.313 [main] INFO com.itsoku.chat01.Demo01 - TERMINATED</span><br></pre></td></tr></table></div></figure>

<p>代码中有个死循环，调用stop方法之后，线程thread1的状态变为TERMINATED（结束状态），线程停止了。</p>
<p>我们使用idea或者eclipse的时候，会发现这个方法是一个废弃的方法，也就是说，在将来，jdk可能就会移除该方法。</p>
<p>stop方法为何会被废弃而不推荐使用？stop方法过于暴力，强制把正在执行的方法停止了。</p>
<p>大家是否遇到过这样的场景：<strong>电力系统需要维修，此时咱们正在写代码，维修人员直接将电源关闭了，代码还没保存的，是不是很崩溃，这种方式就像直接调用线程的stop方法类似。线程正在运行过程中，被强制结束了，可能会导致一些意想不到的后果。可以给大家发送一个通知，告诉大家保存一下手头的工作，将电脑关闭。</strong></p>

        <h4 id="3-线程中断"   >
          <a href="#3-线程中断" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-线程中断" class="headerlink" title="3.线程中断"></a>3.线程中断</h4>
      <p>在java中，线程中断是一种重要的线程写作机制，从表面上理解，中断就是让目标线程停止执行的意思，实际上并非完全如此。在上面中，我们已经详细讨论了stop方法停止线程的坏处，jdk中提供了更好的中断线程的方法。严格的说，线程中断并不会使线程立即退出，而是给线程发送一个通知，告知目标线程，有人希望你退出了！至于目标线程接收到通知之后如何处理，则完全由目标线程自己决定，这点很重要，如果中断后，线程立即无条件退出，我们又会到stop方法的老问题。</p>
<p>Thread提供了3个与线程中断有关的方法:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">interrupt</span><span class="params">()</span> <span class="comment">//中断线程</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isInterrupted</span><span class="params">()</span> <span class="comment">//判断线程是否被中断</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">interrupted</span><span class="params">()</span>  <span class="comment">//判断线程是否被中断，并清除当前中断状态</span></span><br></pre></td></tr></table></div></figure>

<p><strong>interrupt()<strong>方法是一个</strong>实例方法</strong>，它通知目标线程中断，也就是设置中断标志位为true，中断标志位表示当前线程已经被中断了。<strong>isInterrupted()<strong>方法也是一个</strong>实例方法</strong>，它判断当前线程是否被中断（通过检查中断标志位）。最后一个方法<strong>interrupted()<strong>是一个</strong>静态方法</strong>，返回boolean类型，也是用来判断当前线程是否被中断，但是同时会清除当前线程的中断标志位的状态。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.isInterrupted()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;我要退出了!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">thread1.setName(<span class="string">&quot;thread1&quot;</span>);</span><br><span class="line">thread1.start();</span><br><span class="line">TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">thread1.interrupt();</span><br></pre></td></tr></table></div></figure>

<p>上面代码中有个死循环，interrupt()方法被调用之后，线程的中断标志将被置为true，循环体中通过检查线程的中断标志是否为ture（<code>this.isInterrupted()</code>）来判断线程是否需要退出了。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">volatile</span> <span class="type">boolean</span> <span class="variable">isStop</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (isStop) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;我要退出了!&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    thread1.setName(<span class="string">&quot;thread1&quot;</span>);</span><br><span class="line">    thread1.start();</span><br><span class="line">    TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">    isStop = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>代码中通过一个变量isStop来控制线程是否停止。</p>
<p>通过变量控制和线程自带的interrupt方法来中断线程有什么区别呢？</p>
<p>如果一个线程调用了sleep方法，一直处于休眠状态，通过变量控制，还可以中断线程么？大家可以思考一下。</p>
<p>此时只能使用线程提供的interrupt方法来中断线程了。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="comment">//休眠100秒</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">100</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">&quot;我要退出了!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    thread1.setName(<span class="string">&quot;thread1&quot;</span>);</span><br><span class="line">    thread1.start();</span><br><span class="line">    TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">    thread1.interrupt();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>调用interrupt()方法之后，线程的sleep方法将会抛出<code>InterruptedException</code>异常。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">//休眠100秒</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.isInterrupted()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;我要退出了!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure>

<p>运行上面的代码，发现程序无法终止。因为在线程因为 <code>sleep()</code> <code>wait()</code>  <code>join()</code>引起阻塞时,如果调用了中断线程,则JVM会将线程中断标志重新置为 false , 并且抛出 <code>InterruptedException</code> 的异常,因此会陷入死循环</p>
<p> 代码需要改为：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">//休眠100秒</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                <span class="built_in">this</span>.interrupt(); <span class="comment">//在异常处编写interrupt() ,才能正常中断线程</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.isInterrupted()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;我要退出了!&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure>

<p>上面代码可以终止。</p>
<p><strong>注意：sleep方法由于中断而抛出异常之后，线程的中断标志会被清除（置为false），所以在异常中需要执行this.interrupt()方法，将中断标志位置为true</strong></p>

        <h4 id="4-等待-wait-与通知-notify"   >
          <a href="#4-等待-wait-与通知-notify" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-等待-wait-与通知-notify" class="headerlink" title="4.等待(wait)与通知(notify)"></a>4.等待(wait)与通知(notify)</h4>
      <p>为了支持多线程之间的协作，JDK提供了两个非常重要的方法：等待wait()方法和通知notify()方法。这2个方法并不是在Thread类中的，而是在Object类中定义的。这意味着所有的对象都可以调用者两个方法。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">wait</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">notify</span><span class="params">()</span>;</span><br></pre></td></tr></table></div></figure>

<p>当在一个对象实例上调用wait()方法后，当前线程就会在这个对象上等待。这是什么意思？比如在线程A中，调用了obj.wait()方法，那么线程A就会停止继续执行，转为等待状态。等待到什么时候结束呢？线程A会一直等到其他线程调用obj.notify()方法为止，这时，obj对象成为了多个线程之间的有效通信手段。</p>
<p>那么wait()方法和notify()方法是如何工作的呢？如图2.5展示了两者的工作过程。如果一个线程调用了object.wait()方法，那么它就会进出object对象的等待队列。这个队列中，可能会有多个线程，因为系统可能运行多个线程同时等待某一个对象。当object.notify()方法被调用时，它就会从这个队列中随机选择一个线程，并将其唤醒。这里希望大家注意一下，这个选择是不公平的，并不是先等待线程就会优先被选择，这个选择完全是随机的。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237707.png" alt="f950f73b-52a6-4ecd-a8cb-5422bcd3a44e"></p>
<p>除notify()方法外，Object独享还有一个nofiyAll()方法，它和notify()方法的功能类似，不同的是，它会唤醒在这个等待队列中所有等待的线程，而不是随机选择一个。</p>
<p>这里强调一点，Object.wait()方法并不能随便调用。它必须包含在对应的synchronize语句汇总，无论是wait()方法或者notify()方法都需要首先获取目标独享的一个监视器。图2.6显示了wait()方法和nofiy()方法的工作流程细节。其中T1和T2表示两个线程。T1在正确执行wait()方法钱，必须获得object对象的监视器。而wait()方法在执行后，会释放这个监视器。这样做的目的是使其他等待在object对象上的线程不至于因为T1的休眠而全部无法正常执行。</p>
<p>线程T2在notify()方法调用前，也必须获得object对象的监视器。所幸，此时T1已经释放了这个监视器，因此，T2可以顺利获得object对象的监视器。接着，T2执行了notify()方法尝试唤醒一个等待线程，这里假设唤醒了T1。T1在被唤醒后，要做的第一件事并不是执行后续代码，而是要尝试重新获得object对象的监视器，而这个监视器也正是T1在wait()方法执行前所持有的那个。如果暂时无法获得，则T1还必须等待这个监视器。当监视器顺利获得后，T1才可以在真正意义上继续执行。</p>
<p>举个例子:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo06</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;:T1 start!&quot;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(System.currentTimeMillis() + <span class="string">&quot;:T1 wait for object&quot;</span>);</span><br><span class="line">                    object.wait();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;:T1 end!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T2</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;:T2 start，notify one thread! &quot;</span>);</span><br><span class="line">                object.notify();</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;:T2 end!&quot;</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">T1</span>().start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">T2</span>().start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>运行结果:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1562934497212</span>:T1 start!</span><br><span class="line"><span class="number">1562934497212</span>:T1 wait <span class="keyword">for</span> object</span><br><span class="line"><span class="number">1562934497212</span>:T2 start，notify one thread!</span><br><span class="line"><span class="number">1562934497212</span>:T2 end!</span><br><span class="line"><span class="number">1562934499213</span>:T1 end!</span><br></pre></td></tr></table></div></figure>

<p>注意下打印结果，T2调用notify方法之后，T1并不能立即继续执行，而是要等待T2释放objec投递锁之后，T1重新成功获取锁后，才能继续执行。因此最后2行日志相差了2秒（因为T2调用notify方法后休眠了2秒）。</p>
<p><strong>注意：Object.wait()方法和Thread.sleep()方法都可以让现场等待若干时间。除wait()方法可以被唤醒外，另外一个主要的区别就是wait()方法会释放目标对象的锁，而Thread.sleep()方法不会释放锁。</strong></p>
<p>再给大家讲解一下wait()，notify()，notifyAll()，加深一下理解：</p>
<p>可以这么理解，obj对象上有2个队列，如图1，<strong>q1：等待队列，q2：准备获取锁的队列</strong>；两个队列都为空。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237021.png" alt="5f1e0099-c802-4e79-803a-a5117e6666ff"></p>
<p><strong>obj.wait()过程：</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronize(obj)&#123;</span><br><span class="line">    obj.wait();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>假如有3个线程，t1、t2、t3同时执行上面代码，t1、t2、t3会进入q2队列，如图2，进入q2的队列的这些线程才有资格去争抢obj的锁，假设t1争抢到了，那么t2、t3机型在q2中等待着获取锁，t1进入代码块执行wait()方法，此时t1会进入q1队列，然后系统会通知q2队列中的t2、t3去争抢obj的锁，抢到之后过程如t1的过程。最后t1、t2、t3都进入了q1队列，如图3。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237276.png" alt="6c5eec72-3303-40a5-b70d-6e24ba12d2de"></p>
<p>上面过程之后，又来了线程t4执行了notify()方法，如下：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronize(obj)&#123;</span><br><span class="line">    obj.notify();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>t4会获取到obj的锁，然后执行notify()方法，系统会从q1队列中随机取一个线程，将其加入到q2队列，假如t2运气比较好，被随机到了，然后t2进入了q2队列，如图4，进入q2的队列的锁才有资格争抢obj的锁，t4线程执行完毕之后，会释放obj的锁，此时队列q2中的t2会获取到obj的锁，然后继续执行，执行完毕之后，q1中包含t1、t3，q2队列为空，如图5</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237811.png" alt="fbf3b798-65f7-4b90-a614-66854fcce5fa"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronize(obj)&#123;</span><br><span class="line">    obj.notifyAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>2.调用obj.wait()方法，当前线程会加入队列queue1，然后会释放obj对象的锁</p>
<p>t5会获取到obj的锁，然后执行notifyAll()方法，系统会将队列q1中的线程都移到q2中，如图6，t5线程执行完毕之后，会释放obj的锁，此时队列q2中的t1、t3会争抢obj的锁，争抢到的继续执行，未增强到的带锁释放之后，系统会通知q2中的线程继续争抢索，然后继续执行，最后两个队列中都为空了。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237171.png" alt="9e648015-c445-4e84-bd8c-a53a380cbd7f"></p>

        <h4 id="5-挂起（suspend）和继续执行（resume）线程"   >
          <a href="#5-挂起（suspend）和继续执行（resume）线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-挂起（suspend）和继续执行（resume）线程" class="headerlink" title="5.挂起（suspend）和继续执行（resume）线程"></a>5.挂起（suspend）和继续执行（resume）线程</h4>
      <p>Thread类中还有2个方法，即**线程挂起(suspend)**和**继续执行(resume)**，这2个操作是一对相反的操作，被挂起的线程，必须要等到resume()方法操作后，才能继续执行。系统中已经标注着2个方法过时了，不推荐使用。</p>
<p>系统不推荐使用suspend()方法去挂起线程是因为suspend()方法导致线程暂停的同时，并不会释放任何锁资源。此时，其他任何线程想要访问被它占用的锁时，都会被牵连，导致无法正常运行（如图2.7所示）。直到在对应的线程上进行了resume()方法操作，被挂起的线程才能继续，从而其他所有阻塞在相关锁上的线程也可以继续执行。但是，如果resume()方法操作意外地在suspend()方法前就被执行了，那么被挂起的线程可能很难有机会被继续执行了。并且，更严重的是：它所占用的锁不会被释放，因此可能会导致整个系统工作不正常。而且，对于被挂起的线程，从它线程的状态上看，居然还是<strong>Runnable</strong>状态，这也会影响我们队系统当前状态的判断。</p>
<p>例子：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo07</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T1</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;in &quot;</span> + <span class="built_in">this</span>.getName());</span><br><span class="line">                Thread.currentThread().suspend();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T1</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T1</span>(<span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">        <span class="type">T1</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T1</span>(<span class="string">&quot;t2&quot;</span>);</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.resume();</span><br><span class="line">        t2.resume();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>运行代码输出:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">in t1</span><br><span class="line">in t2</span><br></pre></td></tr></table></div></figure>

<p>我们会发现程序不会结束，线程t2被挂起了，导致程序无法结束，使用jstack命令查看线程堆栈信息可以看到：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;t2&quot;</span> #<span class="number">13</span> prio=<span class="number">5</span> os_prio=<span class="number">0</span> tid=<span class="number">0x000000002796c000</span> nid=<span class="number">0xa3c</span> runnable [<span class="number">0x000000002867f000</span>]</span><br><span class="line">   java.lang.Thread.State: RUNNABLE</span><br><span class="line">        at java.lang.Thread.suspend0(Native Method)</span><br><span class="line">        at java.lang.Thread.suspend(Thread.java:<span class="number">1029</span>)</span><br><span class="line">        at com.itsoku.chat01.Demo07$T1.run(Demo07.java:<span class="number">20</span>)</span><br><span class="line">        - locked &lt;<span class="number">0x0000000717372fc0</span>&gt; (a java.lang.Object)</span><br></pre></td></tr></table></div></figure>

<p>发现t2线程在<strong>suspend0</strong>处被挂起了，t2的状态竟然还是RUNNABLE状态，线程明明被挂起了，状态还是运行中容易导致我们队当前系统进行误判，代码中已经调用resume()方法了，但是由于时间先后顺序的缘故，resume并没有生效，这导致了t2永远滴被挂起了，并且永远占用了object的锁，这对于系统来说可能是致命的。</p>

        <h4 id="6-等待线程结束（join）和谦让（yeild）"   >
          <a href="#6-等待线程结束（join）和谦让（yeild）" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-等待线程结束（join）和谦让（yeild）" class="headerlink" title="6.等待线程结束（join）和谦让（yeild）"></a>6.等待线程结束（join）和谦让（yeild）</h4>
      <p>很多时候，一个线程的输入可能非常依赖于另外一个或者多个线程的输出，此时，这个线程就需要等待依赖的线程执行完毕，才能继续执行。jdk提供了join()操作来实现这个功能。如下所示，显示了2个join()方法：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">join</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">join</span><span class="params">(<span class="type">long</span> millis)</span> <span class="keyword">throws</span> InterruptedException;</span><br></pre></td></tr></table></div></figure>

<p>第1个方法表示无限等待，它会一直只是当前线程。知道目标线程执行完毕。</p>
<p>第2个方法有个参数，用于指定等待时间，如果超过了给定的时间目标线程还在执行，当前线程也会停止等待，而继续往下执行。</p>
<p>比如：线程T1需要等待T2、T3完成之后才能继续执行，那么在T1线程中需要分别调用T2和T3的join()方法。</p>
<p>上个示例：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo08</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T1</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(System.currentTimeMillis() + <span class="string">&quot;,start &quot;</span> + <span class="built_in">this</span>.getName());</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                num++;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">200</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(System.currentTimeMillis() + <span class="string">&quot;,end &quot;</span> + <span class="built_in">this</span>.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T1</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T1</span>(<span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        System.out.println(System.currentTimeMillis() + <span class="string">&quot;,num = &quot;</span> + num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>执行结果:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1562939889129</span>,start t1</span><br><span class="line"><span class="number">1562939891134</span>,end t1</span><br><span class="line"><span class="number">1562939891134</span>,num = <span class="number">10</span></span><br></pre></td></tr></table></div></figure>

<p>num的结果为10，1、3行的时间戳相差2秒左右，说明主线程等待t1完成之后才继续执行的。</p>
<p>看一下jdk1.8中Thread.join()方法的实现：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">join</span><span class="params">(<span class="type">long</span> millis)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">base</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">long</span> <span class="variable">now</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (millis &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;timeout value is negative&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (millis == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (isAlive()) &#123;</span><br><span class="line">            wait(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (isAlive()) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">delay</span> <span class="operator">=</span> millis - now;</span><br><span class="line">            <span class="keyword">if</span> (delay &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            wait(delay);</span><br><span class="line">            now = System.currentTimeMillis() - base;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>从join的代码中可以看出，在被等待的线程上使用了synchronize，调用了它的wait()方法，线程最后执行完毕之后，<strong>系统会自动调用它的notifyAll()方法</strong>，唤醒所有在此线程上等待的其他线程。</p>
<p><strong>注意：被等待的线程执行完毕之后，系统自动会调用该线程的notifyAll()方法。所以一般情况下，我们不要去在线程对象上使用wait()、notify()、notifyAll()方法。</strong></p>
<p>另外一个方法是**Thread.yield()**，他的定义如下：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">yield</span><span class="params">()</span>;</span><br></pre></td></tr></table></div></figure>

<p>yield是谦让的意思，这是一个静态方法，一旦执行，它会让当前线程出让CPU，但需要注意的是，出让CPU并不是说不让当前线程执行了，当前线程在出让CPU后，还会进行CPU资源的争夺，但是能否再抢到CPU的执行权就不一定了。因此，对Thread.yield()方法的调用好像就是在说：我已经完成了一些主要的工作，我可以休息一下了，可以让CPU给其他线程一些工作机会了。</p>
<p>如果觉得一个线程不太重要，或者优先级比较低，而又担心此线程会过多的占用CPU资源，那么可以在适当的时候调用一下Thread.yield()方法，给与其他线程更多的机会。</p>

        <h4 id="7、总结"   >
          <a href="#7、总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#7、总结" class="headerlink" title="7、总结"></a>7、总结</h4>
      <ol>
<li>创建线程的2中方式：继承Thread类；实现Runnable接口</li>
<li>启动线程：调用线程的start()方法</li>
<li>终止线程：调用线程的stop()方法，方法已过时，建议不要使用</li>
<li>线程中断相关的方法：调用线程<strong>实例interrupt()方法</strong>将中断标志置为true；使用**线程实例方法isInterrupted()<strong>获取中断标志；调用</strong>Thread的静态方法interrupted()**获取线程是否被中断，此方法调用之后会清除中断标志（将中断标志置为false了）</li>
<li>wait、notify、notifyAll方法，这块比较难理解，可以回过头去再理理</li>
<li>线程挂起使用**线程实例方法suspend()<strong>，恢复线程使用</strong>线程实例方法resume()**，这2个方法都过时了，不建议使用</li>
<li>等待线程结束：调用<strong>线程实例方法join()</strong></li>
<li>出让cpu资源：调用<strong>线程静态方法yeild()</strong></li>
</ol>

        <h3 id="3-为什么线程重要"   >
          <a href="#3-为什么线程重要" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-为什么线程重要" class="headerlink" title="3.为什么线程重要?"></a>3.为什么线程重要?</h3>
      <ol>
<li><p>硬件方面 - 摩尔定律失效</p>
<p>摩尔定律： 它是由英特尔创始人之一Gordon Moore(戈登·摩尔)提出来的。其内容为： 当价格不变时，集成电路上可容纳的元器件的数目约每隔18-24个月便会增加一倍，性能也将提升一倍。 换言之，每一美元所能买到的电脑性能，将每隔18-24个月翻一倍以上。这一定律揭示了信息技术进步的速度。</p>
<p>可是从2003年开始CPU主频已经不再翻倍，而是采用多核而不是更快的主频。</p>
<p>摩尔定律失效。在主频不再提高且核数在不断增加的情况下，要想让程序更快就要用到并行或并发编程。</p>
</li>
<li><p>软件方面</p>
<p>高并发系统，异步+回调等生产需求</p>
</li>
</ol>

        <h3 id="4-start一个线程"   >
          <a href="#4-start一个线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-start一个线程" class="headerlink" title="4.start一个线程"></a>4.start一个线程</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java线程理解以及openjdk中的实现</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">start0</span><span class="params">()</span>;</span><br><span class="line"><span class="comment">// Java语言本身底层就是C++语言</span></span><br></pre></td></tr></table></div></figure>

<blockquote>
<p>OpenJDK源码网址:<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://openjdk.java.net/" >http://openjdk.java.net/</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>openjdk8\hotspot\src\share\vm\runtime</p>
</blockquote>
<p><strong>更加底层的C++源码解读</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openjdk8\jdk\src\share\<span class="keyword">native</span>\java\lang   thread.c</span><br><span class="line">java线程是通过start的方法启动执行的，主要内容在<span class="keyword">native</span>方法start0中，Openjdk的写JNI一般是一一对应的，Thread.java对应的就是Thread.c start0其实就是JVM_StartThread。此时查看源代码可以看到在jvm.h中找到了声明，jvm.cpp中有实现</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237387.png" alt="image-20210903235656449"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openjdk8\hotspot\src\share\vm\prims  jvm.cpp</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237005.png" alt="image-20210903235812379"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237042.png" alt="image-20210903235817486"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openjdk8\hotspot\src\share\vm\runtime  thread.cpp</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232237193.png" alt="image-20210903235840971"></p>

        <h3 id="5-用户线程与守护线程"   >
          <a href="#5-用户线程与守护线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-用户线程与守护线程" class="headerlink" title="5.用户线程与守护线程"></a>5.用户线程与守护线程</h3>
      <p>Java线程分为用户线程和守护线程，线程的daemon属性为true表示是守护线程，false表示是用户线程</p>

        <h4 id="1-守护线程"   >
          <a href="#1-守护线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-守护线程" class="headerlink" title="1.守护线程"></a>1.守护线程</h4>
      <p>是一种特殊的线程，在后台默默地完成一些系统性的服务，比如垃圾回收线程</p>
<p>为用户线程服务,如果程序运行中除了守护线程以外已经全部结束,则程序会停止运行</p>

        <h4 id="2-用户线程"   >
          <a href="#2-用户线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-用户线程" class="headerlink" title="2.用户线程"></a>2.用户线程</h4>
      <p>是系统的工作线程，它会完成这个程序需要完成的业务操作</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DaemonDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t 开始运行，&quot;</span> + (Thread.currentThread().isDaemon() ? <span class="string">&quot;守护线程&quot;</span> : <span class="string">&quot;用户线程&quot;</span>));</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;t1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//线程的daemon属性为true表示是守护线程，false表示是用户线程</span></span><br><span class="line">        t1.setDaemon(<span class="literal">true</span>);</span><br><span class="line">        t1.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3秒钟后主线程再运行</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;----------main线程运行完毕&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="3-重点"   >
          <a href="#3-重点" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-重点" class="headerlink" title="3.重点"></a>3.重点</h4>
      <p>当程序中所有用户线程执行完毕之后，不管守护线程是否结束，系统都会自动退出</p>
<p>如果用户线程全部结束了，意味着程序需要完成的业务操作已经结束了，系统可以退出了。所以当系统只剩下守护进程的时候，java虚拟机会自动退出</p>
<p>设置守护线程，需要在<strong>start()方法</strong>之前进行,否则会报异常</p>

        <h3 id="6-获得多线程的方法"   >
          <a href="#6-获得多线程的方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-获得多线程的方法" class="headerlink" title="6.获得多线程的方法"></a>6.获得多线程的方法</h3>
      <ul>
<li><p>传统</p>
<p>继承Thread类</p>
<p>实现runnable接口</p>
</li>
<li><p>Java5以后</p>
<p>实现callable接口</p>
<p>Java线程池获得</p>
</li>
</ul>

        <h3 id="7-Callable接口"   >
          <a href="#7-Callable接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-Callable接口" class="headerlink" title="7.Callable接口"></a>7.Callable接口</h3>
      
        <h4 id="1-与runnable对比"   >
          <a href="#1-与runnable对比" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-与runnable对比" class="headerlink" title="1.与runnable对比"></a>1.与runnable对比</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建新类MyThread实现runnable接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line"> </span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 新类MyThread2实现callable接口</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyThread2</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;Integer&gt;&#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> Integer <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">200</span>;</span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 面试题:callable接口与runnable接口的区别？</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 答：（1）是否有返回值</span></span><br><span class="line"><span class="comment">//     （2）是否抛异常</span></span><br><span class="line"><span class="comment">//    （3）落地方法不一样，一个是run，一个是call</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-使用-1"   >
          <a href="#2-使用-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-使用-1" class="headerlink" title="2.使用"></a>2.使用</h4>
      <p>不可以直接替换runnable，因为：thread类的构造方法根本没有Callable</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232238420.png" alt="image"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232238674.png" alt="image"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232238957.png" alt="image"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">  <span class="type">FutureTask</span> <span class="variable">futureTask</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FutureTask</span>(<span class="keyword">new</span> <span class="title class_">MyThread2</span>());</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask,<span class="string">&quot;AA&quot;</span>).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232238800.png" alt="image"></p>
<p>运行成功后通过 <code>get</code> 获取返回值</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">  <span class="type">FutureTask</span> <span class="variable">futureTask</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FutureTask</span>(<span class="keyword">new</span> <span class="title class_">MyThread2</span>());</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask,<span class="string">&quot;AA&quot;</span>).start();</span><br><span class="line">  System.out.println(futureTask.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="2-线程池"   >
          <a href="#2-线程池" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-线程池" class="headerlink" title="2.线程池"></a>2.线程池</h2>
      
        <h3 id="1-什么是线程池"   >
          <a href="#1-什么是线程池" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-什么是线程池" class="headerlink" title="1.什么是线程池"></a>1.什么是线程池</h3>
      <p>大家用jdbc操作过数据库应该知道，操作数据库需要和数据库建立连接，拿到连接之后才能操作数据库，用完之后销毁。数据库连接的创建和销毁其实是比较耗时的，真正和业务相关的操作耗时是比较短的。每个数据库操作之前都需要创建连接，为了提升系统性能，后来出现了数据库连接池，系统启动的时候，先创建很多连接放在池子里面，使用的时候，直接从连接池中获取一个，使用完毕之后返回到池子里面，继续给其他需要者使用，这其中就省去创建连接的时间，从而提升了系统整体的性能。</p>
<p>线程池和数据库连接池的原理也差不多，创建线程去处理业务，可能创建线程的时间比处理业务的时间还长一些，如果系统能够提前为我们创建好线程，我们需要的时候直接拿来使用，用完之后不是直接将其关闭，而是将其返回到线程中中，给其他需要这使用，这样直接节省了创建和销毁的时间，提升了系统的性能。</p>
<p>简单的说，在使用了线程池之后，创建线程变成了从线程池中获取一个空闲的线程，然后使用，关闭线程变成了将线程归还到线程池。</p>

        <h3 id="2-为什么用线程池"   >
          <a href="#2-为什么用线程池" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-为什么用线程池" class="headerlink" title="2.为什么用线程池"></a>2.为什么用线程池</h3>
      <p>线程池的优势：</p>
<p> 线程池做的工作主要是控制运行的线程数量，处理过程中将任务放入队列，然后在线程创建后启动这些任务，如果线程数量超过了最大数量，超出数量的线程排队等候，等其他线程执行完毕，再从队列中取出任务来执行。</p>
<p>它的主要特点为：<strong>线程复用;控制最大并发数;管理线程。</strong></p>
<p>第一：降低资源消耗。通过重复利用已创建的线程降低线程创建和销毁造成的销耗。</p>
<p>第二：提高响应速度。当任务到达时，任务可以不需要等待线程创建就能立即执行。</p>
<p>第三：提高线程的可管理性。线程是稀缺资源，如果无限制的创建，不仅会销耗系统资源，还会降低系统的稳定性，使用线程池可以进行统一的分配，调优和监控</p>

        <h3 id="3-线程池的使用"   >
          <a href="#3-线程池的使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-线程池的使用" class="headerlink" title="3.线程池的使用"></a>3.线程池的使用</h3>
      
        <h4 id="1-Executors-newFixedThreadPool-int"   >
          <a href="#1-Executors-newFixedThreadPool-int" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Executors-newFixedThreadPool-int" class="headerlink" title="1.Executors.newFixedThreadPool(int)"></a>1.Executors.newFixedThreadPool(int)</h4>
      <p> newFixedThreadPool创建的线程池corePoolSize和maximumPoolSize值是相等的，它使用的是LinkedBlockingQueue执行长期任务性能好，创建一个线程池，一池有N个固定的线程，有固定线程数的线程</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newFixedThreadPool</span><span class="params">(<span class="type">int</span> nThreads)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(nThreads, nThreads,</span><br><span class="line">                                  <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="2-Executors-newSingleThreadExecutor"   >
          <a href="#2-Executors-newSingleThreadExecutor" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Executors-newSingleThreadExecutor" class="headerlink" title="2.Executors.newSingleThreadExecutor()"></a>2.Executors.newSingleThreadExecutor()</h4>
      <p>newSingleThreadExecutor 创建的线程池corePoolSize和maximumPoolSize值都是1，它使用的是LinkedBlockingQueue一个任务一个任务的执行，一池一线程</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newSingleThreadExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FinalizableDelegatedExecutorService</span></span><br><span class="line">        (<span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                                <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="3-Executors-newCachedThreadPool"   >
          <a href="#3-Executors-newCachedThreadPool" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Executors-newCachedThreadPool" class="headerlink" title="3.Executors.newCachedThreadPool()"></a>3.Executors.newCachedThreadPool()</h4>
      <p>newCachedThreadPool创建的线程池将corePoolSize设置为0，将maximumPoolSize设置为Integer.MAX_VALUE，它使用的是SynchronousQueue，也就是说来了任务就创建线程运行，当线程空闲超过60秒，就销毁线程。</p>
<p>执行很多短期异步任务，线程池根据需要创建新线程，但在先前构建的线程可用时将重用它们。可扩容，遇强则强</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newCachedThreadPool</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                  <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                  <span class="keyword">new</span> <span class="title class_">SynchronousQueue</span>&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 线程池</span></span><br><span class="line"><span class="comment"> * Arrays</span></span><br><span class="line"><span class="comment"> * Collections</span></span><br><span class="line"><span class="comment"> * Executors</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyThreadPoolDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//List list = new ArrayList();</span></span><br><span class="line">        <span class="comment">//List list = Arrays.asList(&quot;a&quot;,&quot;b&quot;);</span></span><br><span class="line">        <span class="comment">//固定数的线程池，一池五线程</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//       ExecutorService threadPool =  Executors.newFixedThreadPool(5); //一个银行网点，5个受理业务的窗口</span></span><br><span class="line"><span class="comment">//       ExecutorService threadPool =  Executors.newSingleThreadExecutor(); //一个银行网点，1个受理业务的窗口</span></span><br><span class="line">       <span class="type">ExecutorService</span> <span class="variable">threadPool</span> <span class="operator">=</span>  Executors.newCachedThreadPool(); <span class="comment">//一个银行网点，可扩展受理业务的窗口</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//10个顾客请求</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;=<span class="number">10</span>; i++) &#123;</span><br><span class="line">                threadPool.execute(()-&gt;&#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t 办理业务&quot;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            threadPool.shutdown();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="4-ThreadPoolExecutor底层原理"   >
          <a href="#4-ThreadPoolExecutor底层原理" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-ThreadPoolExecutor底层原理" class="headerlink" title="4.ThreadPoolExecutor底层原理"></a>4.ThreadPoolExecutor底层原理</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232241307.png" alt="fdae3766-9607-424f-8f77-ba9a14583e8e"></p>
<p><strong>举个例子，加深理解：</strong></p>
<p>咱们作为开发者，上面都有开发主管，主管下面带领几个小弟干活，CTO给主管授权说，你可以招聘5个小弟干活，新来任务，如果小弟还不到吴哥，立即去招聘一个来干这个新来的任务，当5个小弟都招来了，再来任务之后，将任务记录到一个表格中，表格中最多记录100个，小弟们会主动去表格中获取任务执行，如果5个小弟都在干活，并且表格中也记录满了，那你可以将小弟扩充到20个，如果20个小弟都在干活，并且存放任务的表也满了，产品经理再来任务后，是直接拒绝，还是让产品自己干，这个由你自己决定，小弟们都尽心尽力在干活，任务都被处理完了，突然公司业绩下滑，几个员工没事干，打酱油，为了节约成本，CTO主管把小弟控制到5人，其他15个人直接被干掉了。所以作为小弟们，别让自己闲着，多干活。</p>
<p><strong>原理：</strong>先找几个人干活，大家都忙于干活，任务太多可以排期，排期的任务太多了，再招一些人来干活，最后干活的和排期都达到上层领导要求的上限了，那需要采取一些其他策略进行处理了。对于长时间不干活的人，考虑将其开掉，节约资源和成本。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232241551.png" alt="image"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">int</span> maximumPoolSize,</span></span><br><span class="line"><span class="params">                          <span class="type">long</span> keepAliveTime,</span></span><br><span class="line"><span class="params">                          TimeUnit unit,</span></span><br><span class="line"><span class="params">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class="line"><span class="params">                          ThreadFactory threadFactory,</span></span><br><span class="line"><span class="params">                          RejectedExecutionHandler handler)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (corePoolSize &lt; <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt;= <span class="number">0</span> ||</span><br><span class="line">        maximumPoolSize &lt; corePoolSize ||</span><br><span class="line">        keepAliveTime &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">    <span class="keyword">if</span> (workQueue == <span class="literal">null</span> || threadFactory == <span class="literal">null</span> || handler == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    <span class="built_in">this</span>.corePoolSize = corePoolSize;</span><br><span class="line">    <span class="built_in">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class="line">    <span class="built_in">this</span>.workQueue = workQueue;</span><br><span class="line">    <span class="built_in">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class="line">    <span class="built_in">this</span>.threadFactory = threadFactory;</span><br><span class="line">    <span class="built_in">this</span>.handler = handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<ol>
<li>corePoolSize：核心线程大小，当提交一个任务到线程池时，线程池会创建一个线程来执行任务，即使有其他空闲线程可以处理任务也会创新线程，等到工作的线程数大于核心线程数时就不会在创建了。如果调用了线程池的<code>prestartAllCoreThreads</code>方法，线程池会提前把核心线程都创造好，并启动</li>
<li>maximumPoolSize：线程池允许创建的最大线程数，此值必须大于等于1。如果队列满了，并且以创建的线程数小于最大线程数，则线程池会再创建新的线程执行任务。如果我们使用了无界队列，那么所有的任务会加入队列，这个参数就没有什么效果了</li>
<li>keepAliveTime：多余的空闲线程的存活时间,当前池中线程数量超过corePoolSize时，当空闲时间,达到keepAliveTime时，多余线程会被销毁直到只剩下corePoolSize个线程为止，如果任务很多，并且每个任务的执行时间比较短，避免线程重复创建和回收，可以调大这个时间，提高线程的利用率</li>
<li>unit：keepAliveTIme的时间单位，可以选择的单位有天、小时、分钟、毫秒、微妙、千分之一毫秒和纳秒。类型是一个枚举<code>java.util.concurrent.TimeUnit</code>，这个枚举也经常使用</li>
<li>workQueue：任务队列，被提交但尚未被执行的任务，用于缓存待处理任务的阻塞队列</li>
<li>threadFactory：表示生成线程池中工作线程的线程工厂，用于创建线程，一般默认的即可，可以通过线程工厂给每个创建出来的线程设置更有意义的名字</li>
<li>handler：拒绝策略，表示当队列满了，并且工作线程大于等于线程池的最大线程数（maximumPoolSize）时如何来拒绝请求执行的runnable的策略</li>
</ol>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232241422.png" alt="image"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240551.png" alt="image"></p>
<p><strong>调用线程池的execute方法处理任务，执行execute方法的过程：</strong></p>
<ol>
<li>判断线程池中运行的线程数是否小于corepoolsize，是：则创建新的线程来处理任务，否：执行下一步</li>
<li>试图将任务添加到workQueue指定的队列中，如果无法添加到队列，进入下一步</li>
<li>判断线程池中运行的线程数是否小于<code>maximumPoolSize</code>，是：则新增线程处理当前传入的任务，否：将任务传递给<code>handler</code>对象<code>rejectedExecution</code>方法处理</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、在创建了线程池后，开始等待请求。</span><br><span class="line"><span class="number">2</span>、当调用execute()方法添加一个请求任务时，线程池会做出如下判断：</span><br><span class="line">  <span class="number">2.1</span>如果正在运行的线程数量小于corePoolSize，那么马上创建线程运行这个任务；</span><br><span class="line">  <span class="number">2.2</span>如果正在运行的线程数量大于或等于corePoolSize，那么将这个任务放入队列；</span><br><span class="line">  <span class="number">2.3</span>如果这个时候队列满了且正在运行的线程数量还小于maximumPoolSize，那么还是要创建非核心线程立刻运行这个任务；</span><br><span class="line">  <span class="number">2.4</span>如果队列满了且正在运行的线程数量大于或等于maximumPoolSize，那么线程池会启动饱和拒绝策略来执行。</span><br><span class="line"><span class="number">3</span>、当一个线程完成任务时，它会从队列中取下一个任务来执行。</span><br><span class="line"><span class="number">4</span>、当一个线程无事可做超过一定的时间（keepAliveTime）时，线程会判断：</span><br><span class="line">    如果当前运行的线程数大于corePoolSize，那么这个线程就被停掉。</span><br><span class="line">    所以线程池的所有任务完成后，它最终会收缩到corePoolSize的大小。</span><br></pre></td></tr></table></div></figure>


        <h3 id="5-拒绝策略-如何合理设置参数"   >
          <a href="#5-拒绝策略-如何合理设置参数" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-拒绝策略-如何合理设置参数" class="headerlink" title="5.拒绝策略,如何合理设置参数"></a>5.拒绝策略,如何合理设置参数</h3>
      
        <h4 id="1-线程池的拒绝策略"   >
          <a href="#1-线程池的拒绝策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-线程池的拒绝策略" class="headerlink" title="1.线程池的拒绝策略"></a>1.线程池的拒绝策略</h4>
      <p> 等待队列已经排满了，再也塞不下新任务了，同时，线程池中的max线程也达到了，无法继续为新任务服务。这个是时候我们就需要拒绝策略机制合理的处理这个问题。</p>

        <h4 id="2-JDK内置的拒绝策略"   >
          <a href="#2-JDK内置的拒绝策略" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-JDK内置的拒绝策略" class="headerlink" title="2.JDK内置的拒绝策略"></a>2.JDK内置的拒绝策略</h4>
      <p>AbortPolicy(默认)：直接抛出RejectedExecutionException异常阻止系统正常运行</p>
<p>CallerRunsPolicy：“调用者运行”一种调节机制，该策略既不会抛弃任务，也不会抛出异常，而是将某些任务回退到调用者，从而降低新任务的流量。</p>
<p>DiscardOldestPolicy：抛弃队列中等待最久的任务，然后把当前任务加入队列中尝试再次提交当前任务。</p>
<p>DiscardPolicy：该策略默默地丢弃无法处理的任务，不予任何处理也不抛出异常。如果允许任务丢失，这是最好的一种策略。</p>
<p><strong>以上内置拒绝策略均实现了RejectedExecutionHandle接口</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        String name;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Task</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;处理&quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">5</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Task&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">executor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>,</span><br><span class="line">                <span class="number">1</span>,</span><br><span class="line">                <span class="number">60L</span>,</span><br><span class="line">                TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;Runnable&gt;(<span class="number">1</span>),</span><br><span class="line">                Executors.defaultThreadFactory(),</span><br><span class="line">                (r, executors) -&gt; &#123;</span><br><span class="line">                    <span class="comment">//自定义饱和策略</span></span><br><span class="line">                    <span class="comment">//记录一下无法处理的任务</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;无法处理的任务：&quot;</span> + r.toString());</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            executor.execute(<span class="keyword">new</span> <span class="title class_">Task</span>(<span class="string">&quot;任务-&quot;</span> + i));</span><br><span class="line">        &#125;</span><br><span class="line">        executor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">无法处理的任务：Task&#123;name=<span class="string">&#x27;任务-2&#x27;</span>&#125;</span><br><span class="line">无法处理的任务：Task&#123;name=<span class="string">&#x27;任务-3&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">1</span>处理任务-<span class="number">0</span></span><br><span class="line">无法处理的任务：Task&#123;name=<span class="string">&#x27;任务-4&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">1</span>处理任务-<span class="number">1</span></span><br></pre></td></tr></table></div></figure>

<p>输出结果中可以看到有3个任务进入了饱和策略中，记录了任务的日志，对于无法处理多任务，我们最好能够记录一下，让开发人员能够知道。任务进入了饱和策略，说明线程池的配置可能不是太合理，或者机器的性能有限，需要做一些优化调整。</p>

        <h4 id="3-生产中合理设置参数"   >
          <a href="#3-生产中合理设置参数" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-生产中合理设置参数" class="headerlink" title="3.生产中合理设置参数"></a>3.生产中合理设置参数</h4>
      <p>要想合理的配置线程池，需要先分析任务的特性，可以从以下几个角度分析：</p>
<ul>
<li>任务的性质：CPU密集型任务、IO密集型任务和混合型任务</li>
<li>任务的优先级：高、中、低</li>
<li>任务的执行时间：长、中、短</li>
<li>任务的依赖性：是否依赖其他的系统资源，如数据库连接。</li>
</ul>
<p>性质不同任务可以用不同规模的线程池分开处理。CPU密集型任务应该尽可能小的线程，如配置cpu数量+1个线程的线程池。由于IO密集型任务并不是一直在执行任务，不能让cpu闲着，则应配置尽可能多的线程，如：cup数量*2。混合型的任务，如果可以拆分，将其拆分成一个CPU密集型任务和一个IO密集型任务，只要这2个任务执行的时间相差不是太大，那么分解后执行的吞吐量将高于串行执行的吞吐量。可以通过<code>Runtime.getRuntime().availableProcessors()</code>方法获取cpu数量。优先级不同任务可以对线程池采用优先级队列来处理，让优先级高的先执行。</p>
<p>使用队列的时候建议使用有界队列，有界队列增加了系统的稳定性，如果采用无解队列，任务太多的时候可能导致系统OOM，直接让系统宕机。</p>
<p>线程池汇总线程大小对系统的性能有一定的影响，我们的目标是希望系统能够发挥最好的性能，过多或者过小的线程数量无法有消息的使用机器的性能。咋Java Concurrency inPractice书中给出了估算线程池大小的公式：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Ncpu = CUP的数量</span><br><span class="line">Ucpu = 目标CPU的使用率，<span class="number">0</span>&lt;=Ucpu&lt;=<span class="number">1</span></span><br><span class="line">W/C = 等待时间与计算时间的比例</span><br><span class="line">为保存处理器达到期望的使用率，最有的线程池的大小等于：</span><br><span class="line">Nthreads = Ncpu × Ucpu × (<span class="number">1</span>+W/C)</span><br></pre></td></tr></table></div></figure>


        <h5 id="1-CPU密集型"   >
          <a href="#1-CPU密集型" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-CPU密集型" class="headerlink" title="1.CPU密集型"></a>1.CPU密集型</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查看CPU核数</span></span><br><span class="line">System. out .println(Runtime. getRuntime ().availableProcessors());</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240682.png" alt="image-20220329145519183"></p>

        <h5 id="2-IO密集型"   >
          <a href="#2-IO密集型" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-IO密集型" class="headerlink" title="2.IO密集型"></a>2.IO密集型</h5>
      <p>由于IO密集型任务线程并不是一直在执行任务，则应配置尽可能多的线程，如<strong>CPU核数 * 2</strong> </p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240992.png" alt="image-20220329145652545"></p>
<p>看公司业务是CPU密集型还是IO密集型的，这两种不一样，来决定线程池线程数的最佳合理配置数。</p>

        <h3 id="6-在工作中单一的-x2F-固定数的-x2F-可变的三种创建线程池的方法哪个用的多？-坑"   >
          <a href="#6-在工作中单一的-x2F-固定数的-x2F-可变的三种创建线程池的方法哪个用的多？-坑" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-在工作中单一的-x2F-固定数的-x2F-可变的三种创建线程池的方法哪个用的多？-坑" class="headerlink" title="6.在工作中单一的&#x2F;固定数的&#x2F;可变的三种创建线程池的方法哪个用的多？(坑)"></a>6.在工作中单一的&#x2F;固定数的&#x2F;可变的三种创建线程池的方法哪个用的多？(坑)</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240022.png" alt="image"></p>

        <h3 id="7-自定义线程"   >
          <a href="#7-自定义线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-自定义线程" class="headerlink" title="7.自定义线程"></a>7.自定义线程</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 线程池</span></span><br><span class="line"><span class="comment"> * Arrays</span></span><br><span class="line"><span class="comment"> * Collections</span></span><br><span class="line"><span class="comment"> * Executors</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyThreadPoolDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">threadPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">                <span class="number">2</span>,</span><br><span class="line">                <span class="number">5</span>,</span><br><span class="line">                <span class="number">2L</span>,</span><br><span class="line">                TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;Runnable&gt;(<span class="number">3</span>),</span><br><span class="line">                Executors.defaultThreadFactory(),</span><br><span class="line">                <span class="comment">//new ThreadPoolExecutor.AbortPolicy()</span></span><br><span class="line">                <span class="comment">//new ThreadPoolExecutor.CallerRunsPolicy()</span></span><br><span class="line">                <span class="comment">//new ThreadPoolExecutor.DiscardOldestPolicy()</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.DiscardPolicy()</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//10个顾客请求</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">                threadPool.execute(() -&gt; &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t 办理业务&quot;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            threadPool.shutdown();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">threadPool</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//List list = new ArrayList();</span></span><br><span class="line">        <span class="comment">//List list = Arrays.asList(&quot;a&quot;,&quot;b&quot;);</span></span><br><span class="line">        <span class="comment">//固定数的线程池，一池五线程</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//       ExecutorService threadPool =  Executors.newFixedThreadPool(5); //一个银行网点，5个受理业务的窗口</span></span><br><span class="line"><span class="comment">//       ExecutorService threadPool =  Executors.newSingleThreadExecutor(); //一个银行网点，1个受理业务的窗口</span></span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">threadPool</span> <span class="operator">=</span> Executors.newCachedThreadPool(); <span class="comment">//一个银行网点，可扩展受理业务的窗口</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//10个顾客请求</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">                threadPool.execute(() -&gt; &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t 办理业务&quot;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            threadPool.shutdown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="8-线程池中的2个关闭方法"   >
          <a href="#8-线程池中的2个关闭方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-线程池中的2个关闭方法" class="headerlink" title="8.线程池中的2个关闭方法"></a>8.线程池中的2个关闭方法</h3>
      <p>线程池提供了2个关闭方法：<code>shutdown</code>和<code>shutdownNow</code>，当调用者两个方法之后，线程池会遍历内部的工作线程，然后调用每个工作线程的interrrupt方法给线程发送中断信号，内部如果无法响应中断信号的可能永远无法终止，所以如果内部有无线循环的，最好在循环内部检测一下线程的中断信号，合理的退出。调用者两个方法中任意一个，线程池的<code>isShutdown</code>方法就会返回true，当所有的任务线程都关闭之后，才表示线程池关闭成功，这时调用<code>isTerminaed</code>方法会返回true。</p>
<p>调用<code>shutdown</code>方法之后，线程池将不再接口新任务，内部会将所有已提交的任务处理完毕，处理完毕之后，工作线程自动退出。</p>
<p>而调用<code>shutdownNow</code>方法后，线程池会将还未处理的（在队里等待处理的任务）任务移除，将正在处理中的处理完毕之后，工作线程自动退出。</p>
<p>至于调用哪个方法来关闭线程，应该由提交到线程池的任务特性决定，多数情况下调用<code>shutdown</code>方法来关闭线程池，如果任务不一定要执行完，则可以调用<code>shutdownNow</code>方法。</p>

        <h3 id="9-BlockingQueue阻塞队列"   >
          <a href="#9-BlockingQueue阻塞队列" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-BlockingQueue阻塞队列" class="headerlink" title="9.BlockingQueue阻塞队列"></a>9.BlockingQueue阻塞队列</h3>
      
        <h4 id="1-栈与队列"   >
          <a href="#1-栈与队列" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-栈与队列" class="headerlink" title="1.栈与队列"></a>1.栈与队列</h4>
      <p>栈：先进后出，后进先出</p>
<p>队列：先进先出</p>

        <h4 id="2-阻塞队列"   >
          <a href="#2-阻塞队列" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-阻塞队列" class="headerlink" title="2.阻塞队列"></a>2.阻塞队列</h4>
      <p>阻塞：必须要阻塞&#x2F;不得不阻塞</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240324.png" alt="image"></p>
<p>线程1往阻塞队列里添加元素，线程2从阻塞队列里移除元素</p>
<p>当队列是空的，从队列中获取元素的操作将会被阻塞</p>
<p>当队列是满的，从队列中添加元素的操作将会被阻塞</p>
<p>试图从空的队列中获取元素的线程将会被阻塞，直到其他线程往空的队列插入新的元素</p>
<p>试图向已满的队列中添加新元素的线程将会被阻塞，直到其他线程从队列中移除一个或多个元素或者完全清空，使队列变得空闲起来并后续新增</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240085.png" alt="image"></p>

        <h4 id="3-种类分析"   >
          <a href="#3-种类分析" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-种类分析" class="headerlink" title="3.种类分析"></a>3.种类分析</h4>
      <p><strong>ArrayBlockingQueue</strong>：是一个基于数组结构的有界阻塞队列，此队列按照先进先出原则对元素进行排序</p>
<p><strong>LinkedBlockingQueue</strong>：由链表结构组成的有界（但大小默认值为integer.MAX_VALUE）阻塞队列，此队列按照先进先出排序元素，吞吐量通常要高于ArrayBlockingQueue。静态工厂方法<code>Executors.newFixedThreadPool</code>使用了这个队列。</p>
<p>PriorityBlockingQueue：支持优先级排序的无界阻塞队列。</p>
<p>DelayQueue：使用优先级队列实现的延迟无界阻塞队列。</p>
<p><strong>SynchronousQueue</strong>：不存储元素的阻塞队列，也即单个元素的队列,每个插入操作必须等到另外一个线程调用移除操作，否则插入操作一直处理阻塞状态，吞吐量通常要高于LinkedBlockingQueue，静态工厂方法<code>Executors.newCachedThreadPool</code>使用这个队列</p>
<p>LinkedTransferQueue：由链表组成的无界阻塞队列。</p>
<p>LinkedBlockingDeque：由链表组成的双向阻塞队列。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> Executors.newCachedThreadPool();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="type">String</span> <span class="variable">taskName</span> <span class="operator">=</span> <span class="string">&quot;任务&quot;</span> + j;</span><br><span class="line">            executor.execute(() -&gt; &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;处理&quot;</span> + taskName);</span><br><span class="line">                <span class="comment">//模拟任务内部处理耗时</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        executor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>代码中使用<code>Executors.newCachedThreadPool()</code>创建线程池，看一下的源码：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title function_">newCachedThreadPool</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                      <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                      <span class="keyword">new</span> <span class="title class_">SynchronousQueue</span>&lt;Runnable&gt;());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>

<p>从输出中可以看出，系统创建了50个线程处理任务，代码中使用了<code>SynchronousQueue</code>同步队列，这种队列比较特殊，放入元素必须要有另外一个线程去获取这个元素，否则放入元素会失败或者一直阻塞在那里直到有线程取走，示例中任务处理休眠了指定的时间，导致已创建的工作线程都忙于处理任务，所以新来任务之后，将任务丢入同步队列会失败，丢入队列失败之后，会尝试新建线程处理任务。使用上面的方式创建线程池需要注意，如果需要处理的任务比较耗时，会导致新来的任务都会创建新的线程进行处理，可能会导致创建非常多的线程，最终耗尽系统资源，触发OOM。</p>
<p><strong>PriorityBlockingQueue优先级队列的线程池</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>, Comparable&lt;Task&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> i;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Task</span><span class="params">(<span class="type">int</span> i, String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.i = i;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;处理&quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Task o)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.compare(o.i, <span class="built_in">this</span>.i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">PriorityBlockingQueue</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">taskName</span> <span class="operator">=</span> <span class="string">&quot;任务&quot;</span> + i;</span><br><span class="line">            executor.execute(<span class="keyword">new</span> <span class="title class_">Task</span>(i, taskName));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">100</span>; i &gt;= <span class="number">90</span>; i--) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">taskName</span> <span class="operator">=</span> <span class="string">&quot;任务&quot;</span> + i;</span><br><span class="line">            executor.execute(<span class="keyword">new</span> <span class="title class_">Task</span>(i, taskName));</span><br><span class="line">        &#125;</span><br><span class="line">        executor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>输出中，除了第一个任务，其他任务按照优先级高低按顺序处理。原因在于：创建线程池的时候使用了优先级队列，进入队列中的任务会进行排序，任务的先后顺序由Task中的i变量决定。向<code>PriorityBlockingQueue</code>加入元素的时候，内部会调用代码中Task的<code>compareTo</code>方法决定元素的先后顺序。</p>

        <h4 id="4-BlockQueue核心方法"   >
          <a href="#4-BlockQueue核心方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-BlockQueue核心方法" class="headerlink" title="4.BlockQueue核心方法"></a>4.BlockQueue核心方法</h4>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232240563.png" alt="image"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.BlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 阻塞队列</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BlockingQueueDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        List list = new ArrayList();</span></span><br><span class="line"></span><br><span class="line">        BlockingQueue&lt;String&gt; blockingQueue = <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//第一组</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.add(&quot;a&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.add(&quot;b&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.add(&quot;c&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.element());</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(blockingQueue.add(&quot;x&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.remove());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.remove());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.remove());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.remove());</span></span><br><span class="line"><span class="comment">//    第二组</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.offer(&quot;a&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.offer(&quot;b&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.offer(&quot;c&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.offer(&quot;x&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.poll());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.poll());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.poll());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.poll());</span></span><br><span class="line"><span class="comment">//    第三组        </span></span><br><span class="line"><span class="comment">//         blockingQueue.put(&quot;a&quot;);</span></span><br><span class="line"><span class="comment">//         blockingQueue.put(&quot;b&quot;);</span></span><br><span class="line"><span class="comment">//         blockingQueue.put(&quot;c&quot;);</span></span><br><span class="line"><span class="comment">//         //blockingQueue.put(&quot;x&quot;);</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.take());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.take());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.take());</span></span><br><span class="line"><span class="comment">//        System.out.println(blockingQueue.take());</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">//    第四组        </span></span><br><span class="line">        System.out.println(blockingQueue.offer(<span class="string">&quot;a&quot;</span>));</span><br><span class="line">        System.out.println(blockingQueue.offer(<span class="string">&quot;b&quot;</span>));</span><br><span class="line">        System.out.println(blockingQueue.offer(<span class="string">&quot;c&quot;</span>));</span><br><span class="line">        System.out.println(blockingQueue.offer(<span class="string">&quot;a&quot;</span>,<span class="number">3L</span>, TimeUnit.SECONDS));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="10-扩展线程池"   >
          <a href="#10-扩展线程池" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-扩展线程池" class="headerlink" title="10.扩展线程池"></a>10.扩展线程池</h3>
      <p>虽然jdk提供了<code>ThreadPoolExecutor</code>这个高性能线程池，但是如果我们自己想在这个线程池上面做一些扩展，比如，监控每个任务执行的开始时间，结束时间，或者一些其他自定义的功能，我们应该怎么办？</p>
<p>这个jdk已经帮我们想到了，<code>ThreadPoolExecutor</code>内部提供了几个方法<code>beforeExecute</code>、<code>afterExecute</code>、<code>terminated</code>，可以由开发人员自己去这些方法。看一下线程池内部的源码：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    beforeExecute(wt, task);<span class="comment">//任务执行之前调用的方法</span></span><br><span class="line">    <span class="type">Throwable</span> <span class="variable">thrown</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        task.run();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RuntimeException x) &#123;</span><br><span class="line">        thrown = x;</span><br><span class="line">        <span class="keyword">throw</span> x;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Error x) &#123;</span><br><span class="line">        thrown = x;</span><br><span class="line">        <span class="keyword">throw</span> x;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable x) &#123;</span><br><span class="line">        thrown = x;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(x);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        afterExecute(task, thrown);<span class="comment">//任务执行完毕之后调用的方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    task = <span class="literal">null</span>;</span><br><span class="line">    w.completedTasks++;</span><br><span class="line">    w.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>beforeExecute：任务执行之前调用的方法，有2个参数，第1个参数是执行任务的线程，第2个参数是任务</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">beforeExecute</span><span class="params">(Thread t, Runnable r)</span> &#123; &#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>afterExecute：任务执行完成之后调用的方法，2个参数，第1个参数表示任务，第2个参数表示任务执行时的异常信息，如果无异常，第二个参数为null</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterExecute</span><span class="params">(Runnable r, Throwable t)</span> &#123; &#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>terminated：线程池最终关闭之后调用的方法。所有的工作线程都退出了，最终线程池会退出，退出时调用该方法</strong></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo6</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        String name;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Task</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;处理&quot;</span> + <span class="built_in">this</span>.name);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Task&#123;&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                    <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">executor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">10</span>,</span><br><span class="line">                <span class="number">10</span>,</span><br><span class="line">                <span class="number">60L</span>,</span><br><span class="line">                TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;Runnable&gt;(<span class="number">1</span>),</span><br><span class="line">                Executors.defaultThreadFactory(),</span><br><span class="line">                (r, executors) -&gt; &#123;</span><br><span class="line">                    <span class="comment">//自定义饱和策略</span></span><br><span class="line">                    <span class="comment">//记录一下无法处理的任务</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;无法处理的任务：&quot;</span> + r.toString());</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">beforeExecute</span><span class="params">(Thread t, Runnable r)</span> &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;,&quot;</span> + t.getName() + <span class="string">&quot;,开始执行任务:&quot;</span> + r.toString());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterExecute</span><span class="params">(Runnable r, Throwable t)</span> &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;,&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;,任务:&quot;</span> + r.toString() + <span class="string">&quot;，执行完毕!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">terminated</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;,&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;，关闭线程池!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            executor.execute(<span class="keyword">new</span> <span class="title class_">Task</span>(<span class="string">&quot;任务-&quot;</span> + i));</span><br><span class="line">        &#125;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">        executor.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1564324574847</span>,pool-<span class="number">1</span>-thread-<span class="number">1</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-0&#x27;</span>&#125;</span><br><span class="line"><span class="number">1564324574850</span>,pool-<span class="number">1</span>-thread-<span class="number">3</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-2&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">3</span>处理任务-<span class="number">2</span></span><br><span class="line"><span class="number">1564324574849</span>,pool-<span class="number">1</span>-thread-<span class="number">2</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-1&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">2</span>处理任务-<span class="number">1</span></span><br><span class="line"><span class="number">1564324574848</span>,pool-<span class="number">1</span>-thread-<span class="number">5</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-4&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">5</span>处理任务-<span class="number">4</span></span><br><span class="line"><span class="number">1564324574848</span>,pool-<span class="number">1</span>-thread-<span class="number">4</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-3&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">4</span>处理任务-<span class="number">3</span></span><br><span class="line"><span class="number">1564324574850</span>,pool-<span class="number">1</span>-thread-<span class="number">7</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-6&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">7</span>处理任务-<span class="number">6</span></span><br><span class="line"><span class="number">1564324574850</span>,pool-<span class="number">1</span>-thread-<span class="number">6</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-5&#x27;</span>&#125;</span><br><span class="line"><span class="number">1564324574851</span>,pool-<span class="number">1</span>-thread-<span class="number">8</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-7&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">8</span>处理任务-<span class="number">7</span></span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">1</span>处理任务-<span class="number">0</span></span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">6</span>处理任务-<span class="number">5</span></span><br><span class="line"><span class="number">1564324574851</span>,pool-<span class="number">1</span>-thread-<span class="number">10</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-9&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">10</span>处理任务-<span class="number">9</span></span><br><span class="line"><span class="number">1564324574852</span>,pool-<span class="number">1</span>-thread-<span class="number">9</span>,开始执行任务:Task&#123;name=<span class="string">&#x27;任务-8&#x27;</span>&#125;</span><br><span class="line">pool-<span class="number">1</span>-thread-<span class="number">9</span>处理任务-<span class="number">8</span></span><br><span class="line"><span class="number">1564324576851</span>,pool-<span class="number">1</span>-thread-<span class="number">2</span>,任务:Task&#123;name=<span class="string">&#x27;任务-1&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576851</span>,pool-<span class="number">1</span>-thread-<span class="number">3</span>,任务:Task&#123;name=<span class="string">&#x27;任务-2&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576852</span>,pool-<span class="number">1</span>-thread-<span class="number">1</span>,任务:Task&#123;name=<span class="string">&#x27;任务-0&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576852</span>,pool-<span class="number">1</span>-thread-<span class="number">4</span>,任务:Task&#123;name=<span class="string">&#x27;任务-3&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576852</span>,pool-<span class="number">1</span>-thread-<span class="number">8</span>,任务:Task&#123;name=<span class="string">&#x27;任务-7&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576852</span>,pool-<span class="number">1</span>-thread-<span class="number">7</span>,任务:Task&#123;name=<span class="string">&#x27;任务-6&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576852</span>,pool-<span class="number">1</span>-thread-<span class="number">5</span>,任务:Task&#123;name=<span class="string">&#x27;任务-4&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576853</span>,pool-<span class="number">1</span>-thread-<span class="number">6</span>,任务:Task&#123;name=<span class="string">&#x27;任务-5&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576853</span>,pool-<span class="number">1</span>-thread-<span class="number">10</span>,任务:Task&#123;name=<span class="string">&#x27;任务-9&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576853</span>,pool-<span class="number">1</span>-thread-<span class="number">9</span>,任务:Task&#123;name=<span class="string">&#x27;任务-8&#x27;</span>&#125;，执行完毕!</span><br><span class="line"><span class="number">1564324576853</span>,pool-<span class="number">1</span>-thread-<span class="number">9</span>，关闭线程池!</span><br></pre></td></tr></table></div></figure>

<p>从输出结果中可以看到，每个需要执行的任务打印了3行日志，执行前由线程池的<code>beforeExecute</code>打印，执行时会调用任务的<code>run</code>方法，任务执行完毕之后，会调用线程池的<code>afterExecute</code>方法，从每个任务的首尾2条日志中可以看到每个任务耗时2秒左右。线程池最终关闭之后调用了<code>terminated</code>方法。</p>

        <h2 id="3-CompletableFuture"   >
          <a href="#3-CompletableFuture" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-CompletableFuture" class="headerlink" title="3.CompletableFuture"></a>3.CompletableFuture</h2>
      
        <h3 id="1-Future和Callable接口"   >
          <a href="#1-Future和Callable接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Future和Callable接口" class="headerlink" title="1.Future和Callable接口"></a>1.Future和Callable接口</h3>
      <p>Future 接口可以为主线程开一个分支任务,为主线程处理费时费力的复杂业务</p>
<p>Future接口定义了操作异步任务执行一些方法，如获取异步任务的执行结果、取消任务的执行、判断任务是否被取消、判断任务执行是否完毕等。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242557.png" alt="image-20210904000352470"></p>
<p>Callable接口中定义了需要有返回的任务需要实现的方法</p>
<p>比如主线程让一个子线程去执行任务，子线程可能比较耗时，启动子线程开始执行任务后，主线程就去做其他事情了，过了一会才去获取子任务的执行结果。</p>

        <h3 id="2-FutureTask开始"   >
          <a href="#2-FutureTask开始" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-FutureTask开始" class="headerlink" title="2.FutureTask开始"></a>2.FutureTask开始</h3>
      <p>Future接口相关架构</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242314.png" alt="img"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242521.png" alt="image-20210904000529226"></p>
<p>缺点:</p>
<ul>
<li><p>get()阻塞 一旦调用get()方法，不管是否计算完成都会导致阻塞</p>
</li>
<li><p>isDone()轮询</p>
<p>轮询的方式会耗费无谓的CPU资源，而且也不见得能及时地得到计算结果.</p>
<p>如果想要异步获取结果,通常都会以轮询的方式去获取结果 尽量不要阻塞</p>
<p>不见不散 – 过时不候 – 轮询</p>
</li>
</ul>
<p>对于获取结果不是很友好,要么轮询,要么阻塞</p>
<p>code1:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException, TimeoutException&#123;</span><br><span class="line">        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----come in FutureTask&quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">3</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">            <span class="keyword">return</span> ThreadLocalRandom.current().nextInt(<span class="number">100</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask,<span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3秒钟后才出来结果，还没有计算你提前来拿(只要一调用get方法，对于结果就是不见不散，会导致阻塞)</span></span><br><span class="line">        <span class="comment">//System.out.println(Thread.currentThread().getName()+&quot;\t&quot;+futureTask.get());</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3秒钟后才出来结果，我只想等待1秒钟，过时不候</span></span><br><span class="line">        System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+futureTask.get(<span class="number">1L</span>,TimeUnit.SECONDS));</span><br><span class="line"></span><br><span class="line">        System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot; run... here&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>code2:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----come in FutureTask&quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">3</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>+ ThreadLocalRandom.current().nextInt(<span class="number">100</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask,<span class="string">&quot;t1&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot;线程完成任务&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 用于阻塞式获取结果,如果想要异步获取结果,通常都会以轮询的方式去获取结果</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(futureTask.isDone())&#123;</span><br><span class="line">                System.out.println(futureTask.get());</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-对Future的改进"   >
          <a href="#3-对Future的改进" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-对Future的改进" class="headerlink" title="3.对Future的改进"></a>3.对Future的改进</h3>
      <p>对于真正的异步处理,希望可以通过传入回调函数,在Future结束时自动调用该回调函数,这样就不用等待结果</p>
<p>原本的Future通过阻塞获取结果以及轮询获取结果,一个与异步编程的设计理念相违背,一个则会耗费资源</p>

        <h4 id="1-类-CompletableFuture"   >
          <a href="#1-类-CompletableFuture" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-类-CompletableFuture" class="headerlink" title="1.类 CompletableFuture"></a>1.类 CompletableFuture</h4>
      <p>提供了一种观察者模式类似的机制,可以让任务执行完成后通知监听的一方</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242667.png" alt="image-20210904001054865"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242184.png" alt="image-20210904001102892"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242604.png" alt="image-20210904001143180"></p>

        <h4 id="2-接口CompletionStage"   >
          <a href="#2-接口CompletionStage" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-接口CompletionStage" class="headerlink" title="2.接口CompletionStage"></a>2.接口CompletionStage</h4>
      <ul>
<li><p>CompletionStage代表异步计算过程中的某一个阶段，一个阶段完成以后可能会触发另外一个阶段</p>
</li>
<li><p>一个阶段的计算执行可以是一个Function, Consumer或者Runnable。比如: </p>
<p><code>stage.thenApply(x -&gt; square(x).thenAccept(-&gt; System.out.print(x)).thenRun(( -&gt;system.out.printIn())</code></p>
</li>
<li><p>一个阶段的执行可能是被单个阶段的完成触发，也可能是由多个阶段一起触发</p>
</li>
</ul>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242268.png" alt="image-20210904001214909"></p>
<p>代表异步计算过程中的某一个阶段，一个阶段完成以后可能会触发另外一个阶段，有些类似Linux系统的管道分隔符传参数</p>

        <h3 id="4-核心的四个静态方法"   >
          <a href="#4-核心的四个静态方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-核心的四个静态方法" class="headerlink" title="4.核心的四个静态方法"></a>4.核心的四个静态方法</h3>
      
        <h4 id="1-runAsync-无返回值"   >
          <a href="#1-runAsync-无返回值" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-runAsync-无返回值" class="headerlink" title="1.runAsync 无返回值"></a>1.runAsync 无返回值</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> CompletableFuture&lt;Void&gt; <span class="title function_">runAsync</span><span class="params">(Runnable runnable)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> CompletableFuture&lt;Void&gt; <span class="title function_">runAsync</span><span class="params">(Runnable runnable,Executor executor)</span>  </span><br></pre></td></tr></table></div></figure>


        <h4 id="2-supplyAsync-有-返回值"   >
          <a href="#2-supplyAsync-有-返回值" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-supplyAsync-有-返回值" class="headerlink" title="2.supplyAsync 有 返回值"></a>2.supplyAsync 有 返回值</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;U&gt; CompletableFuture&lt;U&gt; <span class="title function_">supplyAsync</span><span class="params">(Supplier&lt;U&gt; supplier)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;U&gt; CompletableFuture&lt;U&gt; <span class="title function_">supplyAsync</span><span class="params">(Supplier&lt;U&gt; supplier,Executor executor)</span></span><br></pre></td></tr></table></div></figure>

<p>上述Executor executor参数说明</p>
<p>没有指定Executor的方法，直接使用默认的ForkJoinPool.commonPool() 作为它的线程池执行异步代码。</p>
<p>如果指定线程池，则使用我们自定义的或者特别指定的线程池执行异步代码</p>

        <h4 id="3-Code-无-返回值"   >
          <a href="#3-Code-无-返回值" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Code-无-返回值" class="headerlink" title="3.Code 无 返回值"></a>3.Code 无 返回值</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo3</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Void&gt; future = CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot;-----come in&quot;</span>);</span><br><span class="line">            <span class="comment">//暂停几秒钟线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">1</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----task is over&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(future.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\202206232242719.png" alt="image-20210904001511947"></p>

        <h4 id="4-Code-有-返回值"   >
          <a href="#4-Code-有-返回值" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Code-有-返回值" class="headerlink" title="4.Code 有 返回值"></a>4.Code 有 返回值</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo3</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;-----come in&quot;</span>);</span><br><span class="line">            <span class="comment">//暂停几秒钟线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ThreadLocalRandom.current().nextInt(<span class="number">100</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(completableFuture.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="5-Code-减少阻塞和轮询"   >
          <a href="#5-Code-减少阻塞和轮询" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Code-减少阻塞和轮询" class="headerlink" title="5.Code 减少阻塞和轮询"></a>5.Code 减少阻塞和轮询</h4>
      <p>从Java8开始引入了CompletableFuture，它是Future的功能增强版，可以传入回调对象，当异步任务完成或者发生异常时，自动调用回调对象的回调方法</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo3</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;-----come in&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">10</span>);</span><br><span class="line">            <span class="comment">//暂停几秒钟线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123; </span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>); </span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; </span><br><span class="line">                e.printStackTrace(); </span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----计算结束耗时1秒钟，result： &quot;</span>+result);</span><br><span class="line">            <span class="keyword">if</span>(result &gt; <span class="number">6</span>)&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;).whenComplete((v,e) -&gt;&#123;</span><br><span class="line">            <span class="keyword">if</span>(e == <span class="literal">null</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;-----result: &quot;</span>+v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).exceptionally(e -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----exception: &quot;</span>+e.getCause()+<span class="string">&quot;\t&quot;</span>+e.getMessage());</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">44</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:暂停3秒钟线程</span></span><br><span class="line">        <span class="keyword">try</span> &#123; </span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; </span><br><span class="line">            e.printStackTrace(); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="6-CompletableFuture的优点"   >
          <a href="#6-CompletableFuture的优点" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-CompletableFuture的优点" class="headerlink" title="6.CompletableFuture的优点"></a>6.CompletableFuture的优点</h4>
      <p>异步任务结束时，会自动回调某个对象的方法；</p>
<p>异步任务出错时，会自动回调某个对象的方法；</p>
<p>主线程设置好回调后，不再关心异步任务的执行，异步任务之间可以顺序执行</p>

        <h3 id="5-Join和链式语法"   >
          <a href="#5-Join和链式语法" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Join和链式语法" class="headerlink" title="5.Join和链式语法"></a>5.Join和链式语法</h3>
      <p>函数式接口:</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220705143519346.png" alt="image-20220705143519346"></p>
<p>get会抛出异常，join不需要</p>

        <h3 id="6-案例精讲-从电商网站的比价需求说开去"   >
          <a href="#6-案例精讲-从电商网站的比价需求说开去" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-案例精讲-从电商网站的比价需求说开去" class="headerlink" title="6.案例精讲-从电商网站的比价需求说开去"></a>6.案例精讲-从电商网站的比价需求说开去</h3>
      <ol>
<li><p>需求说明<br>1.1同一款产品，同时搜索出同款产品在各大电商平台的售价;<br>1.2同一款产品，同时搜索出本产品在同一个电商平台下，各个入驻卖家售价是多少</p>
</li>
<li><p>输出返回:<br>出来结果希望是同款产品的在不同地方的价格清单列表，返回一个<code>List&lt;String&gt;</code></p>
<p>《mysql》in jd price is 88.05<br>《mysql》in dangdang price is 86.11</p>
<p>《mysql》in taobao price is 90.43</p>
</li>
<li><p>解决方案,比对同一个商品在各个平台上的价格，要求获得一个清单列表</p>
</li>
</ol>
<p>切记，功能→性能</p>
<p> 经常出现在等待某条 SQL 执行完成后，再继续执行下一条 SQL ，而这两条 SQL 本身是并无关系的，可以同时进行执行的。我们希望能够两条 SQL 同时进行处理，而不是等待其中的某一条 SQL 完成后，再继续下一条。同理， 对于分布式微服务的调用，按照实际业务，如果是无关联step by step的业务，可以尝试是否可以多箭齐发，同时调用。我们去比同一个商品在各个平台上的价格，要求获得一个清单列表， </p>
<ol>
<li>step by step，按部就班，查完京东查淘宝，查完淘宝查天猫…….</li>
<li>all in，万箭齐发，一口气多线程异步任务同时查询。。。。 。</li>
</ol>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CompletableFuture;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadLocalRandom;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">T1</span>&#123;</span><br><span class="line">    <span class="keyword">static</span> List&lt;NetMall&gt; list = Arrays.asList(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;jd&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;tmall&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;pdd&quot;</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;mi&quot;</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">findPriceSync</span><span class="params">(List&lt;NetMall&gt; list,String productName)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> list.stream().map(mall -&gt; String.format(productName+<span class="string">&quot; %s price is %.2f&quot;</span>,mall.getNetMallName(),mall.getPriceByName(productName))).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">findPriceASync</span><span class="params">(List&lt;NetMall&gt; list,String productName)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> list.stream().map(mall -&gt; CompletableFuture.supplyAsync(() -&gt; String.format(productName + <span class="string">&quot; %s price is %.2f&quot;</span>, mall.getNetMallName(), mall.getPriceByName(productName)))).collect(Collectors.toList()).stream().map(CompletableFuture::join).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        List&lt;String&gt; list1 = findPriceSync(list, <span class="string">&quot;thinking in java&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String element : list1) &#123;</span><br><span class="line">            System.out.println(element);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;----costTime: &quot;</span>+(endTime - startTime) +<span class="string">&quot; 毫秒&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        List&lt;String&gt; list2 = findPriceASync(list, <span class="string">&quot;thinking in java&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String element : list2) &#123;</span><br><span class="line">            System.out.println(element);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;----costTime: &quot;</span>+(endTime2 - startTime2) +<span class="string">&quot; 毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NetMall</span>&#123;</span><br><span class="line">    <span class="meta">@Getter</span></span><br><span class="line">    <span class="keyword">private</span> String netMallName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NetMall</span><span class="params">(String netMallName)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.netMallName = netMallName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getPriceByName</span><span class="params">(String productName)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> calcPrice(productName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="title function_">calcPrice</span><span class="params">(String productName)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">1</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">        <span class="keyword">return</span> ThreadLocalRandom.current().nextDouble() + productName.charAt(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="7-CompletableFuture常用方法"   >
          <a href="#7-CompletableFuture常用方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-CompletableFuture常用方法" class="headerlink" title="7.CompletableFuture常用方法"></a>7.CompletableFuture常用方法</h3>
      
        <h4 id="1-获取结果和触发计算"   >
          <a href="#1-获取结果和触发计算" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-获取结果和触发计算" class="headerlink" title="1.获取结果和触发计算"></a>1.获取结果和触发计算</h4>
      <p>获取结果</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不见不散</span></span><br><span class="line"><span class="keyword">public</span> T <span class="title function_">get</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 过时不候</span></span><br><span class="line"><span class="keyword">public</span> T <span class="title function_">get</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> T <span class="title function_">join</span><span class="params">()</span>; <span class="comment">//与get一致,不用抛出异常</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 没有计算完成的情况下，给我一个替代结果 </span></span><br><span class="line"><span class="comment">// 立即获取结果不阻塞 计算完，返回计算完成后的结果  没算完，返回设定的valueIfAbsent值</span></span><br><span class="line"><span class="keyword">public</span> T <span class="title function_">getNow</span><span class="params">(T valueIfAbsent)</span>;</span><br><span class="line">  </span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo2</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">1</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">533</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//去掉注释上面计算没有完成，返回444</span></span><br><span class="line">        <span class="comment">//开启注释上满计算完成，返回计算结果</span></span><br><span class="line">        <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">2</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(completableFuture.getNow(<span class="number">444</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> T <span class="title function_">join</span><span class="params">()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo2</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;abc&quot;</span>).thenApply(r -&gt; r + <span class="string">&quot;123&quot;</span>).join());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>主动触发计算</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 是否打断get方法立即返回括号值</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">complete</span><span class="params">(T value)</span></span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo4</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123; </span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>); </span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; </span><br><span class="line">                e.printStackTrace(); </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">533</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//注释掉暂停线程，get还没有算完只能返回complete方法设置的444；暂停2秒钟线程，异步线程能够计算完成返回get</span></span><br><span class="line">        <span class="keyword">try</span> &#123; </span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">2</span>); </span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; </span><br><span class="line">            e.printStackTrace(); </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//当调用CompletableFuture.get()被阻塞的时候,complete方法就是结束阻塞并get()获取设置的complete里面的值.</span></span><br><span class="line">        System.out.println(completableFuture.complete(<span class="number">444</span>)+<span class="string">&quot;\t&quot;</span>+completableFuture.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></div></figure>


        <h4 id="2-对计算结果进行处理"   >
          <a href="#2-对计算结果进行处理" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-对计算结果进行处理" class="headerlink" title="2.对计算结果进行处理"></a>2.对计算结果进行处理</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计算结果存在依赖关系，这两个线程串行化</span></span><br><span class="line"><span class="comment">// 由于存在依赖关系(当前步错，不走下一步)，当前步骤有异常的话就叫停。</span></span><br><span class="line">thenApply</span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo4</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        <span class="comment">//当一个线程依赖另一个线程时用 thenApply 方法来把这两个线程串行化,</span></span><br><span class="line">        CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            <span class="comment">//暂停几秒钟线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">1</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;111&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1024</span>;</span><br><span class="line">        &#125;).thenApply(f -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;222&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> f + <span class="number">1</span>;</span><br><span class="line">        &#125;).thenApply(f -&gt; &#123;</span><br><span class="line">            <span class="comment">//int age = 10/0; // 异常情况：那步出错就停在那步。</span></span><br><span class="line">            System.out.println(<span class="string">&quot;333&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> f + <span class="number">1</span>;</span><br><span class="line">        &#125;).whenCompleteAsync((v,e) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;*****v: &quot;</span>+v);</span><br><span class="line">        &#125;).exceptionally(e -&gt; &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    	System.out.println(<span class="string">&quot;-----主线程结束，END&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:</span></span><br><span class="line">        <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">2</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">	&#125;   </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></div></figure>

<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">handle</span><br><span class="line"><span class="comment">// 有异常也可以往下一步走，根据带的异常参数可以进一步处理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo4</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        <span class="comment">//当一个线程依赖另一个线程时用 handle 方法来把这两个线程串行化,</span></span><br><span class="line">        <span class="comment">// 异常情况：有异常也可以往下一步走，根据带的异常参数可以进一步处理</span></span><br><span class="line">        CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            <span class="comment">//暂停几秒钟线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">1</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;111&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1024</span>;</span><br><span class="line">        &#125;).handle((f,e) -&gt; &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">age</span> <span class="operator">=</span> <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;222&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> f + <span class="number">1</span>;</span><br><span class="line">        &#125;).handle((f,e) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;333&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> f + <span class="number">1</span>;</span><br><span class="line">        &#125;).whenCompleteAsync((v,e) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;*****v: &quot;</span>+v);</span><br><span class="line">        &#125;).exceptionally(e -&gt; &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-----主线程结束，END&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:</span></span><br><span class="line">        <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">2</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></div></figure>

<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707093232698.png" alt="image-20220707093232698"></p>

        <h4 id="3-对计算结果进行消费"   >
          <a href="#3-对计算结果进行消费" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-对计算结果进行消费" class="headerlink" title="3.对计算结果进行消费"></a>3.对计算结果进行消费</h4>
      <p>接收任务的处理结果，并消费处理，无返回结果</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thenAccept</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">    CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;).thenApply(f -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> f + <span class="number">2</span>;</span><br><span class="line">    &#125;).thenApply(f -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> f + <span class="number">3</span>;</span><br><span class="line">    &#125;).thenApply(f -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> f + <span class="number">4</span>;</span><br><span class="line">    &#125;).thenAccept(r -&gt; System.out.println(r));</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></div></figure>

<p>Code之任务之间的顺序执行</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">thenRun</span><br><span class="line"><span class="title function_">thenRun</span><span class="params">(Runnable runnable)</span></span><br><span class="line"><span class="comment">// 任务 A 执行完执行 B，并且 B 不需要 A 的结果</span></span><br><span class="line">    </span><br><span class="line">thenAccept</span><br><span class="line"><span class="title function_">thenAccept</span><span class="params">(Consumer action)</span></span><br><span class="line"><span class="comment">// 任务 A 执行完执行 B，B 需要 A 的结果，但是任务 B 无返回值</span></span><br><span class="line">  </span><br><span class="line">thenApply</span><br><span class="line"><span class="title function_">thenApply</span><span class="params">(Function fn)</span></span><br><span class="line"><span class="comment">// 任务 A 执行完执行 B，B 需要 A 的结果，同时任务 B 有返回值</span></span><br><span class="line"> </span><br><span class="line">System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenRun(() -&gt; &#123;&#125;).join());</span><br><span class="line">System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenAccept(resultA -&gt; &#123;&#125;).join());</span><br><span class="line">System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenApply(resultA -&gt; resultA + <span class="string">&quot; resultB&quot;</span>).join());</span><br></pre></td></tr></table></div></figure>


        <h4 id="4-对计算速度进行选用"   >
          <a href="#4-对计算速度进行选用" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-对计算速度进行选用" class="headerlink" title="4.对计算速度进行选用"></a>4.对计算速度进行选用</h4>
      <p>谁快用谁</p>
<p>applyToEither</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo5</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture1 = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in &quot;</span>);</span><br><span class="line">            <span class="comment">//暂停几秒钟线程</span></span><br><span class="line">            <span class="keyword">try</span> &#123; </span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">2</span>); </span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; </span><br><span class="line">                e.printStackTrace(); </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture2 = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in &quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123; </span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">1</span>); </span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace(); </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        CompletableFuture&lt;Integer&gt; thenCombineResult = completableFuture1.applyToEither(completableFuture2,f -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> f + <span class="number">1</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + thenCombineResult.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="5-对计算结果进行合并"   >
          <a href="#5-对计算结果进行合并" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-对计算结果进行合并" class="headerlink" title="5.对计算结果进行合并"></a>5.对计算结果进行合并</h4>
      <p>两个CompletionStage任务都完成后，最终能把两个任务的结果一起交给thenCombine 来处理</p>
<p>先完成的先等着，等待其它分支任务</p>
<p>thenCombine</p>
<p>code标准版，好理解先拆分</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo2</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture1 = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        CompletableFuture&lt;Integer&gt; completableFuture2 = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        CompletableFuture&lt;Integer&gt; thenCombineResult = completableFuture1.thenCombine(completableFuture2, (x, y) -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> x + y;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        System.out.println(thenCombineResult.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>code表达式</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo6</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException&#123;</span><br><span class="line">        CompletableFuture&lt;Integer&gt; thenCombineResult = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 1&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">        &#125;).thenCombine(CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125;), (x,y) -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 3&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> x + y;</span><br><span class="line">        &#125;).thenCombine(CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 4&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">30</span>;</span><br><span class="line">        &#125;),(a,b) -&gt; &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 5&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> a + b;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(<span class="string">&quot;-----主线程结束，END&quot;</span>);</span><br><span class="line">        System.out.println(thenCombineResult.get());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:</span></span><br><span class="line">        <span class="keyword">try</span> &#123; </span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">10</span>); </span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace(); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="6-Async说明"   >
          <a href="#6-Async说明" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-Async说明" class="headerlink" title="6.Async说明"></a>6.Async说明</h4>
      <ol>
<li><p>没有传入自定义线程池，都用默认线程池ForkJoinPool;</p>
</li>
<li><p>传入了一个自定义线程池</p>
<p>如果你执行第一个任务的时候，传入了一个自定义线程池:</p>
<p>调用thenRun方法执行第二个任务时，则第二个任务和第一个任务是共用同一个线程池。</p>
<p>调用thenRunAsync执行第二个任务时，则第一个任务使用的是你自己传入的线程池，第二个任务使用的是ForkJoin线程池</p>
</li>
<li><p>备注<br>有可能处理太快，系统优化切换原则，直接使用main线程处理<br>其它如: thenAccept和thenAcceptAsync，thenApply和thenApplyAsync等，它们之间的区别也是同理</p>
</li>
</ol>

        <h4 id="7-异步编排-重"   >
          <a href="#7-异步编排-重" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-异步编排-重" class="headerlink" title="7.异步编排(重)"></a>7.异步编排(重)</h4>
      
        <h5 id="1-创建异步对象"   >
          <a href="#1-创建异步对象" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-创建异步对象" class="headerlink" title="1.创建异步对象"></a>1.创建异步对象</h5>
      <p>CompletableFuture 提供了四个静态方法来创建一个异步操作</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212210111364.png" alt="image-20220212210111364"></p>
<ol>
<li>runXxxx 都是没有返回结果的，supplyXxx 都是可以获取返回结果的</li>
<li>可以传入自定义的线程池，否则就用默认的线程池</li>
</ol>

        <h5 id="2-计算完成时回调方法"   >
          <a href="#2-计算完成时回调方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-计算完成时回调方法" class="headerlink" title="2.计算完成时回调方法"></a>2.计算完成时回调方法</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212210159447.png" alt="image-20220212210159447"></p>
<p>whenComplete 可以处理正常和异常的计算结果，exceptionally 处理异常情况。 </p>
<p>whenComplete 和 whenCompleteAsync 的区别： </p>
<ul>
<li>whenComplete：是执行当前任务的线程执行继续执行 whenComplete 的任务。 </li>
<li>whenCompleteAsync：是执行把 whenCompleteAsync 这个任务继续提交给线程池 来进行执行。</li>
</ul>
<p>方法不以 Async 结尾，意味着 Action 使用相同的线程执行，而 Async 可能会使用其他线程执行（如果是使用相同的线程池，也可能会被同一个线程选中执行）</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureDemo</span> &#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123; </span><br><span class="line">        <span class="type">CompletableFuture</span> <span class="variable">future</span> <span class="operator">=</span> CompletableFuture.supplyAsync(<span class="keyword">new</span> <span class="title class_">Supplier</span>&lt;Object&gt;() &#123; </span><br><span class="line">            <span class="meta">@Override</span> </span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">()</span> &#123; </span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t completableFuture&quot;</span>); </span><br><span class="line">                <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">10</span> / <span class="number">0</span>; </span><br><span class="line">                <span class="keyword">return</span> <span class="number">1024</span>; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;).whenComplete(<span class="keyword">new</span> <span class="title class_">BiConsumer</span>&lt;Object, Throwable&gt;() &#123; </span><br><span class="line">            <span class="meta">@Override</span> </span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(Object o, Throwable throwable)</span> &#123; </span><br><span class="line">                System.out.println(<span class="string">&quot;-------o=&quot;</span> + o.toString()); </span><br><span class="line">                System.out.println(<span class="string">&quot;-------throwable=&quot;</span> + throwable); </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).exceptionally(<span class="keyword">new</span> <span class="title class_">Function</span>&lt;Throwable, Object&gt;() &#123; </span><br><span class="line">            <span class="meta">@Override</span> </span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">apply</span><span class="params">(Throwable throwable)</span> &#123; </span><br><span class="line">                System.out.println(<span class="string">&quot;throwable=&quot;</span> + throwable); </span><br><span class="line">                <span class="keyword">return</span> <span class="number">6666</span>; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;); </span><br><span class="line">        System.out.println(future.get()); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h5 id="3-handle方法"   >
          <a href="#3-handle方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-handle方法" class="headerlink" title="3.handle方法"></a>3.handle方法</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212210732502.png" alt="image-20220212210732502"></p>
<p>和 complete 一样，可对结果做最后的处理（可处理异常），可改变返回值</p>

        <h5 id="4-线程串行化方法"   >
          <a href="#4-线程串行化方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-线程串行化方法" class="headerlink" title="4.线程串行化方法"></a>4.线程串行化方法</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212210759798.png" alt="image-20220212210759798"></p>
<ul>
<li><p>thenApply 方法：当一个线程依赖另一个线程时，获取上一个任务返回的结果，并返回当前 任务的返回值。  </p>
</li>
<li><p>thenAccept 方法：消费处理结果。接收任务的处理结果，并消费处理，无返回结果。 </p>
</li>
<li><p>thenRun 方法：只要上面的任务执行完成，就开始执行 thenRun，只是处理完任务后，执行 </p>
<p>thenRun 的后续操作:</p>
<p>带有 Async 默认是异步执行的。同之前。 </p>
<p>以上都要前置任务成功完成。 </p>
<p>Function&lt;? super T,? extends U&gt; </p>
<ul>
<li>T：上一个任务返回结果的类型</li>
<li>U：当前任务的返回值类型</li>
</ul>
</li>
</ul>

        <h5 id="5-两任务组合-都要完成"   >
          <a href="#5-两任务组合-都要完成" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-两任务组合-都要完成" class="headerlink" title="5.两任务组合-都要完成"></a>5.两任务组合-都要完成</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212211106879.png" alt="image-20220212211106879"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212211115418.png" alt="image-20220212211115418"></p>
<p>两个任务必须都完成，触发该任务。 </p>
<ul>
<li>thenCombine：组合两个 future，获取两个 future 的返回结果，并返回当前任务的返回值 </li>
<li>thenAcceptBoth：组合两个 future，获取两个 future 任务的返回结果，然后处理任务，没有 返回值。 </li>
<li>runAfterBoth：组合两个 future，不需要获取 future 的结果，只需两个 future 处理完任务后， 处理该任务。</li>
</ul>

        <h5 id="6-两任务组合-一个完成"   >
          <a href="#6-两任务组合-一个完成" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-两任务组合-一个完成" class="headerlink" title="6.两任务组合-一个完成"></a>6.两任务组合-一个完成</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212211445932.png" alt="image-20220212211445932"></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212211453984.png" alt="image-20220212211453984"></p>
<p>当两个任务中，任意一个 future 任务完成的时候，执行任务。 </p>
<ul>
<li>applyToEither：两个任务有一个执行完成，获取它的返回值，处理任务并有新的返回值。 </li>
<li>acceptEither：两个任务有一个执行完成，获取它的返回值，处理任务，没有新的返回值。 </li>
<li>runAfterEither：两个任务有一个执行完成，不需要获取 future 的结果，处理任务，也没有返 回值</li>
</ul>

        <h5 id="7-多任务组合"   >
          <a href="#7-多任务组合" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-多任务组合" class="headerlink" title="7.多任务组合"></a>7.多任务组合</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220212211526127.png" alt="image-20220212211526127"></p>
<ul>
<li>allOf：等待所有任务完成 </li>
<li>anyOf：只要有一个任务完成</li>
</ul>

        <h3 id="8-分支合并框架"   >
          <a href="#8-分支合并框架" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-分支合并框架" class="headerlink" title="8.分支合并框架"></a>8.分支合并框架</h3>
      <p>Fork：把一个复杂任务进行分拆，大事化小</p>
<p>Join：把分拆任务的结果进行合并</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707131836777.png" alt="image-20220707131836777"></p>

        <h4 id="1-相关类"   >
          <a href="#1-相关类" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-相关类" class="headerlink" title="1.相关类"></a>1.相关类</h4>
      
        <h5 id="1-ForkJoinPool"   >
          <a href="#1-ForkJoinPool" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-ForkJoinPool" class="headerlink" title="1.ForkJoinPool"></a>1.ForkJoinPool</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707131713076.png" alt="image-20220707131713076"></p>

        <h5 id="2-ForkJoinTask"   >
          <a href="#2-ForkJoinTask" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ForkJoinTask" class="headerlink" title="2.ForkJoinTask"></a>2.ForkJoinTask</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707131743961.png" alt="image-20220707131743961"></p>

        <h5 id="3-RecursiveTask"   >
          <a href="#3-RecursiveTask" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-RecursiveTask" class="headerlink" title="3.RecursiveTask"></a>3.RecursiveTask</h5>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707131750532.png" alt="image-20220707131750532"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归任务：继承后可以实现递归(自己调自己)调用的任务</span></span><br><span class="line"> <span class="keyword">class</span> <span class="title class_">Fibonacci</span> <span class="keyword">extends</span> <span class="title class_">RecursiveTask</span>&lt;Integer&gt; &#123;</span><br><span class="line">   <span class="keyword">final</span> <span class="type">int</span> n;</span><br><span class="line">   Fibonacci(<span class="type">int</span> n) &#123; <span class="built_in">this</span>.n = n; &#125;</span><br><span class="line">   Integer <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (n &lt;= <span class="number">1</span>)</span><br><span class="line">       <span class="keyword">return</span> n;</span><br><span class="line">     <span class="type">Fibonacci</span> <span class="variable">f1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fibonacci</span>(n - <span class="number">1</span>);</span><br><span class="line">     f1.fork();</span><br><span class="line">     <span class="type">Fibonacci</span> <span class="variable">f2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Fibonacci</span>(n - <span class="number">2</span>);</span><br><span class="line">     <span class="keyword">return</span> f2.compute() + f1.join();</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-示例-1"   >
          <a href="#2-示例-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-示例-1" class="headerlink" title="2.示例"></a>2.示例</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutionException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ForkJoinPool;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ForkJoinTask;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.RecursiveTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyTask</span> <span class="keyword">extends</span> <span class="title class_">RecursiveTask</span>&lt;Integer&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">ADJUST_VALUE</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> begin;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> end;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> result;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyTask</span><span class="params">(<span class="type">int</span> begin, <span class="type">int</span> end)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.begin = begin;</span><br><span class="line">        <span class="built_in">this</span>.end = end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Integer <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>((end - begin)&lt;=ADJUST_VALUE)&#123;</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span>begin;i &lt;= end;i++)&#123;</span><br><span class="line">                result = result + i;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">middle</span> <span class="operator">=</span> (begin + end)/<span class="number">2</span>;</span><br><span class="line">            <span class="type">MyTask</span> <span class="variable">task01</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyTask</span>(begin,middle);</span><br><span class="line">            <span class="type">MyTask</span> <span class="variable">task02</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyTask</span>(middle+<span class="number">1</span>,end);</span><br><span class="line">            task01.fork();</span><br><span class="line">            task02.fork();</span><br><span class="line">            result =  task01.join() + task02.join();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分支合并例子</span></span><br><span class="line"><span class="comment"> * ForkJoinPool</span></span><br><span class="line"><span class="comment"> * ForkJoinTask</span></span><br><span class="line"><span class="comment"> * RecursiveTask</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ForkJoinDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">MyTask</span> <span class="variable">myTask</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyTask</span>(<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="type">ForkJoinPool</span> <span class="variable">forkJoinPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ForkJoinPool</span>();</span><br><span class="line">        ForkJoinTask&lt;Integer&gt; forkJoinTask = forkJoinPool.submit(myTask);</span><br><span class="line"></span><br><span class="line">        System.out.println(forkJoinTask.get());</span><br><span class="line"></span><br><span class="line">        forkJoinPool.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="4-Java-“锁”事"   >
          <a href="#4-Java-“锁”事" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Java-“锁”事" class="headerlink" title="4.Java “锁”事"></a>4.Java “锁”事</h2>
      
        <h3 id="1-Lock"   >
          <a href="#1-Lock" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Lock" class="headerlink" title="1.Lock"></a>1.Lock</h3>
      <p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707132357417.png" alt="image-20220707132357417"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lock implementations provide more extensive locking operations than can be obtained using synchronized methods and statements. They allow more flexible structuring, may have quite different properties, and may support multiple associated Condition objects.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 锁实现提供了比使用同步方法和语句可以获得的更广泛的锁操作。它们允许更灵活的结构，可能具有非常不同的属性，并且可能支持多个关联的条件对象</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="2-Synchronized与Lock的区别"   >
          <a href="#2-Synchronized与Lock的区别" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Synchronized与Lock的区别" class="headerlink" title="2.Synchronized与Lock的区别"></a>2.Synchronized与Lock的区别</h3>
      <ol>
<li>首先synchronized是java内置关键字，在jvm层面，Lock是个java类；</li>
<li>synchronized无法判断是否获取锁的状态，Lock可以判断是否获取到锁；</li>
<li>synchronized会自动释放锁(a 线程执行完同步代码会释放锁 ；b 线程执行过程中发生异常会释放锁)，Lock需在finally中手工释放锁（unlock()方法释放锁），否则容易造成线程死锁；</li>
<li>用synchronized关键字的两个线程1和线程2，如果当前线程1获得锁，线程2线程等待。如果线程1阻塞，线程2则会一直等待下去，而Lock锁就不一定会等待下去，如果尝试获取不到锁，线程可以不用一直等待就结束了；</li>
<li>synchronized的锁可重入、不可中断、非公平，而Lock锁可重入、可判断、可公平（两者皆可）</li>
<li>Lock锁适合大量同步的代码的同步问题，synchronized锁适合代码少量的同步问题。</li>
</ol>

        <h3 id="3-synchronized"   >
          <a href="#3-synchronized" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-synchronized" class="headerlink" title="3.synchronized"></a>3.synchronized</h3>
      <ol>
<li>修饰实例方法，作用于当前实例，进入同步代码前需要先获取实例的锁</li>
<li>修饰静态方法，作用于类的Class对象，进入修饰的静态方法前需要先获取类的Class对象的锁</li>
<li>修饰代码块，需要指定加锁对象(记做lockobj)，在进入同步代码块前需要先获取lockobj的锁</li>
</ol>

        <h4 id="1-synchronized作用于实例对象"   >
          <a href="#1-synchronized作用于实例对象" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-synchronized作用于实例对象" class="headerlink" title="1.synchronized作用于实例对象"></a>1.synchronized作用于实例对象</h4>
      <p>所谓实例对象锁就是用synchronized修饰实例对象的实例方法，注意是<strong>实例方法</strong>，不是<strong>静态方法</strong>，如：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        num++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Demo2 demo2;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T</span><span class="params">(Demo2 demo2)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.demo2 = demo2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">                <span class="built_in">this</span>.demo2.add();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">Demo2</span> <span class="variable">demo2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo2</span>();</span><br><span class="line">        <span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(demo2);</span><br><span class="line">        <span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(demo2);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        System.out.println(demo2.num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>main()方法中创建了一个对象demo2和2个线程t1、t2，t1、t2中调用demo2的add()方法10000次，add()方法中执行了num++，num++实际上是分3步，获取num，然后将num+1，然后将结果赋值给num，如果t2在t1读取num和num+1之间获取了num的值，那么t1和t2会读取到同样的值，然后执行num++，两次操作之后num是相同的值，最终和期望的结果不一致，造成了线程安全失败，因此我们对add方法加了synchronized来保证线程安全。</p>
<p>注意：m1()方法是实例方法，两个线程操作m1()时，需要先获取demo2的锁，没有获取到锁的，将等待，直到其他线程释放锁为止。</p>
<p>synchronize作用于实例方法需要注意：</p>
<ol>
<li>实例方法上加synchronized，线程安全的前提是，多个线程操作的是<strong>同一个实例</strong>，如果多个线程作用于不同的实例，那么线程安全是无法保证的</li>
<li>同一个实例的多个实例方法上有synchronized，这些方法都是互斥的，同一时间只允许一个线程操作<strong>同一个实例的其中的一个synchronized方法</strong></li>
</ol>

        <h4 id="2-synchronized作用于静态方法"   >
          <a href="#2-synchronized作用于静态方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-synchronized作用于静态方法" class="headerlink" title="2.synchronized作用于静态方法"></a>2.synchronized作用于静态方法</h4>
      <p>当synchronized作用于静态方法时，锁的对象就是当前类的Class对象。如：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            Demo3.m1();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T1</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T1</span>();</span><br><span class="line">        <span class="type">T1</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T1</span>();</span><br><span class="line">        <span class="type">T1</span> <span class="variable">t3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T1</span>();</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">        <span class="comment">//等待3个线程结束打印num</span></span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        t3.join();</span><br><span class="line">        System.out.println(Demo3.num);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 打印结果：</span></span><br><span class="line"><span class="comment">         * 30000</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>上面代码打印30000，和期望结果一致。m1()方法是静态方法，有synchronized修饰，锁用于与Demo3.class对象，和下面的写法类似：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (Demo4.class) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h4 id="3-synchronized同步代码块"   >
          <a href="#3-synchronized同步代码块" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-synchronized同步代码块" class="headerlink" title="3.synchronized同步代码块"></a>3.synchronized同步代码块</h4>
      <p>除了使用关键字修饰实例方法和静态方法外，还可以使用同步代码块，在某些情况下，我们编写的方法体可能比较大，同时存在一些比较耗时的操作，而需要同步的代码又只有一小部分，如果直接对整个方法进行同步操作，可能会得不偿失，此时我们可以使用同步代码块的方式对需要同步的代码进行包裹，这样就无需对整个方法进行同步操作了，同步代码块的使用示例如下：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo5</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">Demo5</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo5</span>();</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//省略其他耗时操作....</span></span><br><span class="line">        <span class="comment">//使用同步代码块对变量i进行同步操作,锁对象为instance</span></span><br><span class="line">        <span class="keyword">synchronized</span> (instance) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">10000</span>; j++) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(instance);</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(instance);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        System.out.println(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>从代码看出，将synchronized作用于一个给定的实例对象instance，即当前实例对象就是锁对象，每次当线程进入synchronized包裹的代码块时就会要求当前线程持有instance实例对象锁，如果当前有其他线程正持有该对象锁，那么新到的线程就必须等待，这样也就保证了每次只有一个线程执行i++;操作。当然除了instance作为对象外，我们还可以使用this对象(代表当前实例)或者当前类的class对象作为锁，如下代码：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//this,当前实例对象锁</span></span><br><span class="line"><span class="keyword">synchronized</span>(<span class="built_in">this</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">1000000</span>;j++)&#123;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//class对象锁</span></span><br><span class="line"><span class="keyword">synchronized</span>(Demo5.class)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">1000000</span>;j++)&#123;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>分析代码是否互斥的方法，先找出synchronized作用的对象是谁，如果多个线程操作的方法中synchronized作用的锁对象一样，那么这些线程同时异步执行这些方法就是互斥的。如下代码:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo6</span> &#123;</span><br><span class="line">    <span class="comment">//作用于当前类的实例对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//作用于当前类的实例对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">m2</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//作用于当前类的实例对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">m3</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//作用于当前类Class对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">m4</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//作用于当前类Class对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m5</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (Demo6.class) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">        Demo6 demo6;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T</span><span class="params">(Demo6 demo6)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.demo6 = demo6;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>.run();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Demo6</span> <span class="variable">d1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo6</span>();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            d1.m1();</span><br><span class="line">        &#125;);</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            d1.m2();</span><br><span class="line">        &#125;);</span><br><span class="line">        t2.start();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            d1.m2();</span><br><span class="line">        &#125;);</span><br><span class="line">        t3.start();</span><br><span class="line">        <span class="type">Demo6</span> <span class="variable">d2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Demo6</span>();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            d2.m2();</span><br><span class="line">        &#125;);</span><br><span class="line">        t4.start();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t5</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            Demo6.m4();</span><br><span class="line">        &#125;);</span><br><span class="line">        t5.start();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t6</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            Demo6.m5();</span><br><span class="line">        &#125;);</span><br><span class="line">        t6.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


<p>分析上面代码：</p>
<ol>
<li>线程t1、t2、t3中调用的方法都需要获取d1的锁，所以他们是互斥的</li>
<li>t1&#x2F;t2&#x2F;t3这3个线程和t4不互斥，他们可以同时运行，因为前面三个线程依赖于d1的锁，t4依赖于d2的锁</li>
<li>t5、t6都作用于当前类的Class对象锁，所以这两个线程是互斥的，和其他几个线程不互斥</li>
</ol>

        <h3 id="4-ReentrantLock"   >
          <a href="#4-ReentrantLock" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-ReentrantLock" class="headerlink" title="4.ReentrantLock"></a>4.ReentrantLock</h3>
      <p>ReentrantLock是Lock的默认实现，在聊ReentranLock之前，我们需要先弄清楚一些概念：</p>
<ol>
<li>可重入锁：可重入锁是指同一个线程可以多次获得同一把锁；ReentrantLock和关键字Synchronized都是可重入锁</li>
<li>可中断锁：可中断锁时子线程在获取锁的过程中，是否可以相应线程中断操作。synchronized是不可中断的，ReentrantLock是可中断的</li>
<li>公平锁和非公平锁：公平锁是指多个线程尝试获取同一把锁的时候，获取锁的顺序按照线程到达的先后顺序获取，而不是随机插队的方式获取。synchronized是非公平锁，而ReentrantLock是两种都可以实现，不过默认是非公平锁</li>
</ol>

        <h4 id="1-synchronized的局限性"   >
          <a href="#1-synchronized的局限性" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-synchronized的局限性" class="headerlink" title="1.synchronized的局限性"></a>1.synchronized的局限性</h4>
      <p>synchronized是java内置的关键字，它提供了一种独占的加锁方式。synchronized的获取和释放锁由jvm实现，用户不需要显示的释放锁，非常方便，然而synchronized也有一定的局限性，例如：</p>
<ol>
<li>当线程尝试获取锁的时候，如果获取不到锁会一直阻塞，这个阻塞的过程，用户无法控制</li>
<li>如果获取锁的线程进入休眠或者阻塞，除非当前线程异常，否则其他线程尝试获取锁必须一直等待</li>
</ol>
<p>JDK1.5之后发布，加入了Doug Lea实现的java.util.concurrent包。包内提供了Lock类，用来提供更多扩展的加锁功能。Lock弥补了synchronized的局限，提供了更加细粒度的加锁功能。</p>

        <h4 id="2-ReentrantLock基本使用"   >
          <a href="#2-ReentrantLock基本使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ReentrantLock基本使用" class="headerlink" title="2.ReentrantLock基本使用"></a>2.ReentrantLock基本使用</h4>
      <p>我们使用3个线程来对一个共享变量++操作，先使用<strong>synchronized</strong>实现，然后使用<strong>ReentrantLock</strong>实现。</p>
<p><strong>synchronized方式</strong>：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        num++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">                Demo2.add();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        <span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        <span class="type">T</span> <span class="variable">t3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        t3.join();</span><br><span class="line">        System.out.println(Demo2.num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>ReentrantLock方式</strong>：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            num++;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++) &#123;</span><br><span class="line">                Demo3.add();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        <span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        <span class="type">T</span> <span class="variable">t3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>();</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line">        t3.join();</span><br><span class="line">        System.out.println(Demo3.num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p><strong>ReentrantLock的使用过程：</strong></p>
<ol>
<li><strong>创建锁：ReentrantLock lock &#x3D; new ReentrantLock();</strong></li>
<li><strong>获取锁：lock.lock()</strong></li>
<li><strong>释放锁：lock.unlock();</strong></li>
</ol>
<p>对比上面的代码，与关键字synchronized相比，ReentrantLock锁有明显的操作过程，开发人员必须手动的指定何时加锁，何时释放锁，正是因为这样手动控制，ReentrantLock对逻辑控制的灵活度要远远胜于关键字synchronized，上面代码需要注意**lock.unlock()**一定要放在finally中，否则，若程序出现了异常，锁没有释放，那么其他线程就再也没有机会获取这个锁了。</p>

        <h4 id="3-ReentrantLock获取锁的过程是可中断的"   >
          <a href="#3-ReentrantLock获取锁的过程是可中断的" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-ReentrantLock获取锁的过程是可中断的" class="headerlink" title="3.ReentrantLock获取锁的过程是可中断的"></a>3.ReentrantLock获取锁的过程是可中断的</h4>
      <p>对于synchronized关键字，如果一个线程在等待获取锁，最终只有2种结果：</p>
<ol>
<li>要么获取到锁然后继续后面的操作</li>
<li>要么一直等待，直到其他线程释放锁为止</li>
</ol>
<p>而ReentrantLock提供了另外一种可能，就是在等待获取锁的过程中（<strong>发起获取锁请求到还未获取到锁这段时间内</strong>）是可以被中断的，也就是说在等待锁的过程中，程序可以根据需要取消获取锁的请求。有些使用这个操作是非常有必要的。比如：你和好朋友越好一起去打球，如果你等了半小时朋友还没到，突然你接到一个电话，朋友由于突发状况，不能来了，那么你一定达到回府。中断操作正是提供了一套类似的机制，如果一个线程正在等待获取锁，那么它依然可以收到一个通知，被告知无需等待，可以停止工作了。</p>
<p>示例代码：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo6</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ReentrantLock</span> <span class="variable">lock1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ReentrantLock</span> <span class="variable">lock2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="type">int</span> lock;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T</span><span class="params">(String name, <span class="type">int</span> lock)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">            <span class="built_in">this</span>.lock = lock;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.lock == <span class="number">1</span>) &#123;</span><br><span class="line">                    lock1.lockInterruptibly();</span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">                    lock2.lockInterruptibly();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    lock2.lockInterruptibly();</span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">                    lock1.lockInterruptibly();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;中断标志:&quot;</span> + <span class="built_in">this</span>.isInterrupted());</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (lock1.isHeldByCurrentThread()) &#123;</span><br><span class="line">                    lock1.unlock();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (lock2.isHeldByCurrentThread()) &#123;</span><br><span class="line">                    lock2.unlock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t1&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t2&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>先运行一下上面代码，发现程序无法结束，使用jstack查看线程堆栈信息，发现2个线程死锁了。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Found one Java-level deadlock:</span><br><span class="line">=============================</span><br><span class="line"><span class="string">&quot;t2&quot;</span>:</span><br><span class="line">  waiting <span class="keyword">for</span> ownable synchronizer <span class="number">0x0000000717380c20</span>, (a java.util.concurrent.locks.ReentrantLock$NonfairSync),</span><br><span class="line">  which is held by <span class="string">&quot;t1&quot;</span></span><br><span class="line"><span class="string">&quot;t1&quot;</span>:</span><br><span class="line">  waiting <span class="keyword">for</span> ownable synchronizer <span class="number">0x0000000717380c50</span>, (a java.util.concurrent.locks.ReentrantLock$NonfairSync),</span><br><span class="line">  which is held by <span class="string">&quot;t2</span></span><br></pre></td></tr></table></div></figure>

<p>lock1被线程t1占用，lock2被线程t2占用，线程t1在等待获取lock2，线程t2在等待获取lock1，都在相互等待获取对方持有的锁，最终产生了死锁，如果是在synchronized关键字情况下发生了死锁现象，程序是无法结束的。</p>
<p>我们对上面代码改造一下，线程t2一直无法获取到lock1，那么等待5秒之后，我们中断获取锁的操作。主要修改一下main方法，如下:</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t1&quot;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t2&quot;</span>, <span class="number">2</span>);</span><br><span class="line">t1.start();</span><br><span class="line">t2.start();</span><br><span class="line">TimeUnit.SECONDS.sleep(<span class="number">5</span>);</span><br><span class="line">t2.interrupt();</span><br></pre></td></tr></table></div></figure>

<p>新增了2行代码<code>TimeUnit.SECONDS.sleep(5);t2.interrupt();</code>，程序可以结束了，运行结果：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java.lang.InterruptedException</span><br><span class="line">    at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireInterruptibly(AbstractQueuedSynchronizer.java:<span class="number">898</span>)</span><br><span class="line">    at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireInterruptibly(AbstractQueuedSynchronizer.java:<span class="number">1222</span>)</span><br><span class="line">    at java.util.concurrent.locks.ReentrantLock.lockInterruptibly(ReentrantLock.java:<span class="number">335</span>)</span><br><span class="line">    at com.itsoku.chat06.Demo6$T.run(Demo6.java:<span class="number">31</span>)</span><br><span class="line">中断标志:<span class="literal">false</span></span><br></pre></td></tr></table></div></figure>

<p>从上面信息中可以看出，代码的31行触发了异常，<strong>中断标志输出：false</strong></p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20220707164449078.png" alt="image-20220707164449078"></p>
<p>t2在31行一直获取不到lock1的锁，主线程中等待了5秒之后，t2线程调用了<code>interrupt()</code>方法，将线程的中断标志置为true，此时31行会触发<code>InterruptedException</code>异常，然后线程t2可以继续向下执行，释放了lock2的锁，然后线程t1可以正常获取锁，程序得以继续进行。线程发送中断信号触发InterruptedException异常之后，中断标志将被清空。</p>
<p>关于获取锁的过程中被中断，注意几点:</p>
<ol>
<li><strong>ReentrankLock中必须使用实例方法<code>lockInterruptibly()</code>获取锁时，在线程调用interrupt()方法之后，才会引发<code>InterruptedException</code>异常</strong></li>
<li><strong>线程调用interrupt()之后，线程的中断标志会被置为true</strong></li>
<li><strong>触发InterruptedException异常之后，线程的中断标志会被清空，即置为false</strong></li>
<li><strong>所以当线程调用interrupt()引发InterruptedException异常，中断标志的变化是:false-&gt;true-&gt;false</strong></li>
</ol>

        <h4 id="4-ReentrantLock锁申请等待限时"   >
          <a href="#4-ReentrantLock锁申请等待限时" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-ReentrantLock锁申请等待限时" class="headerlink" title="4.ReentrantLock锁申请等待限时"></a>4.ReentrantLock锁申请等待限时</h4>
      <p>申请锁等待限时是什么意思？一般情况下，获取锁的时间我们是不知道的，synchronized关键字获取锁的过程中，只能等待其他线程把锁释放之后才能够有机会获取到锁。所以获取锁的时间有长有短。如果获取锁的时间能够设置超时时间，那就非常好了。</p>
<p>ReentrantLock刚好提供了这样功能，给我们提供了获取锁限时等待的方法<code>tryLock()</code>，可以选择传入时间参数，表示等待指定的时间，无参则表示立即返回锁申请的结果：true表示获取锁成功，false表示获取锁失败。</p>
<p><strong>tryLock无参方法</strong></p>
<p>看一下源码中tryLock方法：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">tryLock</span><span class="params">()</span></span><br></pre></td></tr></table></div></figure>

<p>返回boolean类型的值，此方法会立即返回，结果表示获取锁是否成功，示例：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo8</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ReentrantLock</span> <span class="variable">lock1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;:&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;开始获取锁!&quot;</span>);</span><br><span class="line">                <span class="comment">//获取锁超时时间设置为3秒，3秒内是否能否获取锁都会返回</span></span><br><span class="line">                <span class="keyword">if</span> (lock1.tryLock()) &#123;</span><br><span class="line">                    System.out.println(System.currentTimeMillis() + <span class="string">&quot;:&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;获取到了锁!&quot;</span>);</span><br><span class="line">                    <span class="comment">//获取到锁之后，休眠5秒</span></span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">5</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(System.currentTimeMillis() + <span class="string">&quot;:&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;未能获取到锁!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (lock1.isHeldByCurrentThread()) &#123;</span><br><span class="line">                    lock1.unlock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        <span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>代码中获取锁成功之后，休眠5秒，会导致另外一个线程获取锁失败，运行代码，输出：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1563356291081</span>:t2开始获取锁!</span><br><span class="line"><span class="number">1563356291081</span>:t2获取到了锁!</span><br><span class="line"><span class="number">1563356291081</span>:t1开始获取锁!</span><br><span class="line"><span class="number">1563356291081</span>:t1未能获取到锁!</span><br></pre></td></tr></table></div></figure>

<p><strong>tryLock有参方法</strong></p>
<p>可以明确设置获取锁的超时时间，该方法签名：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">tryLock</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span> <span class="keyword">throws</span> InterruptedException</span><br></pre></td></tr></table></div></figure>

<p>该方法在指定的时间内不管是否可以获取锁，都会返回结果，返回true，表示获取锁成功，返回false表示获取失败。此方法有2个参数，第一个参数是时间类型，是一个枚举，可以表示时、分、秒、毫秒等待，使用比较方便，第1个参数表示在时间类型上的时间长短。此方法在执行的过程中，如果调用了线程的中断interrupt()方法，会触发InterruptedException异常。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo7</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">ReentrantLock</span> <span class="variable">lock1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">T</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">T</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">super</span>(name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(System.currentTimeMillis() + <span class="string">&quot;:&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;开始获取锁!&quot;</span>);</span><br><span class="line">                <span class="comment">//获取锁超时时间设置为3秒，3秒内是否能否获取锁都会返回</span></span><br><span class="line">                <span class="keyword">if</span> (lock1.tryLock(<span class="number">3</span>, TimeUnit.SECONDS)) &#123;</span><br><span class="line">                    System.out.println(System.currentTimeMillis() + <span class="string">&quot;:&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;获取到了锁!&quot;</span>);</span><br><span class="line">                    <span class="comment">//获取到锁之后，休眠5秒</span></span><br><span class="line">                    TimeUnit.SECONDS.sleep(<span class="number">5</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(System.currentTimeMillis() + <span class="string">&quot;:&quot;</span> + <span class="built_in">this</span>.getName() + <span class="string">&quot;未能获取到锁!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (lock1.isHeldByCurrentThread()) &#123;</span><br><span class="line">                    lock1.unlock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t1&quot;</span>);</span><br><span class="line">        <span class="type">T</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">T</span>(<span class="string">&quot;t2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>程序中调用了ReentrantLock的实例方法<code>tryLock(3, TimeUnit.SECONDS)</code>，表示获取锁的超时时间是3秒，3秒后不管是否能否获取锁，该方法都会有返回值，获取到锁之后，内部休眠了5秒，会导致另外一个线程获取锁失败。</p>
<p>运行程序，输出：</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1563355512901</span>:t2开始获取锁!</span><br><span class="line"><span class="number">1563355512901</span>:t1开始获取锁!</span><br><span class="line"><span class="number">1563355512902</span>:t2获取到了锁!</span><br><span class="line"><span class="number">1563355515904</span>:t1未能获取到锁!</span><br></pre></td></tr></table></div></figure>

<p>输出结果中分析，t2获取到锁了，然后休眠了5秒，t1获取锁失败，t1打印了2条信息，时间相差3秒左右。</p>
<p><strong>关于tryLock()方法和tryLock(long timeout, TimeUnit unit)方法，说明一下：</strong></p>
<ol>
<li>都会返回boolean值，结果表示获取锁是否成功</li>
<li>tryLock()方法，不管是否获取成功，都会立即返回；而有参的tryLock方法会尝试在指定的时间内去获取锁，中间会阻塞的现象，在指定的时间之后会不管是否能够获取锁都会返回结果</li>
<li>tryLock()方法不会响应线程的中断方法；而有参的tryLock方法会响应线程的中断方法，而触发<code>InterruptedException</code>异常，这个从2个方法的声明上可以可以看出来</li>
</ol>

        <h4 id="5-ReentrantLock其他常用的方法"   >
          <a href="#5-ReentrantLock其他常用的方法" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-ReentrantLock其他常用的方法" class="headerlink" title="5.ReentrantLock其他常用的方法"></a>5.ReentrantLock其他常用的方法</h4>
      <ol>
<li>isHeldByCurrentThread：实例方法，判断当前线程是否持有ReentrantLock的锁，上面代码中有使用过。</li>
</ol>
<p><strong>获取锁的4种方法对比</strong></p>
<div class="table-container"><table>
<thead>
<tr>
<th>获取锁的方法</th>
<th>是否立即响应(不会阻塞)</th>
<th>是否响应中断</th>
</tr>
</thead>
<tbody><tr>
<td>lock()</td>
<td>×</td>
<td>×</td>
</tr>
<tr>
<td>lockInterruptibly()</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td>tryLock()</td>
<td>√</td>
<td>×</td>
</tr>
<tr>
<td>tryLock(long timeout, TimeUnit unit)</td>
<td>×</td>
<td>√</td>
</tr>
</tbody></table></div>

        <h4 id="6-总结"   >
          <a href="#6-总结" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-总结" class="headerlink" title="6.总结"></a>6.总结</h4>
      <ol>
<li>ReentrantLock可以实现公平锁和非公平锁</li>
<li>ReentrantLock默认实现的是非公平锁</li>
<li>ReentrantLock的获取锁和释放锁必须成对出现，锁了几次，也要释放几次</li>
<li>释放锁的操作必须放在finally中执行</li>
<li>lockInterruptibly()实例方法可以相应线程的中断方法，调用线程的interrupt()方法时，lockInterruptibly()方法会触发<code>InterruptedException</code>异常</li>
<li>关于<code>InterruptedException</code>异常说一下，看到方法声明上带有 <code>throws InterruptedException</code>，表示该方法可以相应线程中断，调用线程的interrupt()方法时，这些方法会触发<code>InterruptedException</code>异常，触发InterruptedException时，线程的中断中断状态会被清除。所以如果程序由于调用<code>interrupt()</code>方法而触发<code>InterruptedException</code>异常，线程的标志由默认的false变为ture，然后又变为false</li>
<li>实例方法tryLock()会尝试获取锁，会立即返回，返回值表示是否获取成功</li>
<li>实例方法tryLock(long timeout, TimeUnit unit)会在指定的时间内尝试获取锁，指定的时间内是否能够获取锁，都会返回，返回值表示是否获取锁成功，该方法会响应线程的中断</li>
</ol>

        <h3 id="5-悲观锁"   >
          <a href="#5-悲观锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-悲观锁" class="headerlink" title="5.悲观锁"></a>5.悲观锁</h3>
      
        <h3 id="6-乐观锁"   >
          <a href="#6-乐观锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-乐观锁" class="headerlink" title="6.乐观锁"></a>6.乐观锁</h3>
      
        <h3 id="7-八锁案例"   >
          <a href="#7-八锁案例" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-八锁案例" class="headerlink" title="7.八锁案例"></a>7.八锁案例</h3>
      
        <h3 id="8-公平锁和非公平锁"   >
          <a href="#8-公平锁和非公平锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-公平锁和非公平锁" class="headerlink" title="8.公平锁和非公平锁"></a>8.公平锁和非公平锁</h3>
      
        <h3 id="9-可重入锁"   >
          <a href="#9-可重入锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-可重入锁" class="headerlink" title="9.可重入锁"></a>9.可重入锁</h3>
      
        <h3 id="10-死锁"   >
          <a href="#10-死锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-死锁" class="headerlink" title="10.死锁"></a>10.死锁</h3>
      
        <h2 id="5-线程间通信"   >
          <a href="#5-线程间通信" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-线程间通信" class="headerlink" title="5.线程间通信"></a>5.线程间通信</h2>
      
        <h2 id="6-LockSupport与线程中断"   >
          <a href="#6-LockSupport与线程中断" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-LockSupport与线程中断" class="headerlink" title="6.LockSupport与线程中断"></a>6.LockSupport与线程中断</h2>
      
        <h2 id="7-集合不安全"   >
          <a href="#7-集合不安全" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-集合不安全" class="headerlink" title="7.集合不安全"></a>7.集合不安全</h2>
      
        <h2 id="8-JUC强大的辅助类"   >
          <a href="#8-JUC强大的辅助类" class="heading-link"><i class="fas fa-link"></i></a><a href="#8-JUC强大的辅助类" class="headerlink" title="8.JUC强大的辅助类"></a>8.JUC强大的辅助类</h2>
      
        <h2 id="9-Java内存模型之JMM"   >
          <a href="#9-Java内存模型之JMM" class="heading-link"><i class="fas fa-link"></i></a><a href="#9-Java内存模型之JMM" class="headerlink" title="9.Java内存模型之JMM"></a>9.Java内存模型之JMM</h2>
      
        <h2 id="10-Volatile与Java内存模型"   >
          <a href="#10-Volatile与Java内存模型" class="heading-link"><i class="fas fa-link"></i></a><a href="#10-Volatile与Java内存模型" class="headerlink" title="10.Volatile与Java内存模型"></a>10.Volatile与Java内存模型</h2>
      
        <h2 id="11-CAS"   >
          <a href="#11-CAS" class="heading-link"><i class="fas fa-link"></i></a><a href="#11-CAS" class="headerlink" title="11.CAS"></a>11.CAS</h2>
      
        <h2 id="12-原子操作类之18罗汉增强"   >
          <a href="#12-原子操作类之18罗汉增强" class="heading-link"><i class="fas fa-link"></i></a><a href="#12-原子操作类之18罗汉增强" class="headerlink" title="12.原子操作类之18罗汉增强"></a>12.原子操作类之18罗汉增强</h2>
      
        <h2 id="13-ThreadLocal-InheritableThreadLocal"   >
          <a href="#13-ThreadLocal-InheritableThreadLocal" class="heading-link"><i class="fas fa-link"></i></a><a href="#13-ThreadLocal-InheritableThreadLocal" class="headerlink" title="13.ThreadLocal,InheritableThreadLocal"></a>13.ThreadLocal,InheritableThreadLocal</h2>
      
        <h2 id="14-Java对象内存布局和对象头"   >
          <a href="#14-Java对象内存布局和对象头" class="heading-link"><i class="fas fa-link"></i></a><a href="#14-Java对象内存布局和对象头" class="headerlink" title="14.Java对象内存布局和对象头"></a>14.Java对象内存布局和对象头</h2>
      
        <h2 id="15-Synchronized与锁升级"   >
          <a href="#15-Synchronized与锁升级" class="heading-link"><i class="fas fa-link"></i></a><a href="#15-Synchronized与锁升级" class="headerlink" title="15.Synchronized与锁升级"></a>15.Synchronized与锁升级</h2>
      
        <h2 id="16-AbstractQueuedSynchronizer之AQS"   >
          <a href="#16-AbstractQueuedSynchronizer之AQS" class="heading-link"><i class="fas fa-link"></i></a><a href="#16-AbstractQueuedSynchronizer之AQS" class="headerlink" title="16.AbstractQueuedSynchronizer之AQS"></a>16.AbstractQueuedSynchronizer之AQS</h2>
      
        <h2 id="17-ReentrantLock、ReentrantReadWriteLock、StampedLock"   >
          <a href="#17-ReentrantLock、ReentrantReadWriteLock、StampedLock" class="heading-link"><i class="fas fa-link"></i></a><a href="#17-ReentrantLock、ReentrantReadWriteLock、StampedLock" class="headerlink" title="17.ReentrantLock、ReentrantReadWriteLock、StampedLock"></a>17.ReentrantLock、ReentrantReadWriteLock、StampedLock</h2>
      
        <h1 id="Java-JUC-旧"   >
          <a href="#Java-JUC-旧" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-JUC-旧" class="headerlink" title="Java JUC(旧)"></a>Java JUC(旧)</h1>
      <hr>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210529195100675.png" alt="image-20210529195100675"></p>
<ul>
<li><a href="java/util/concurrent/package-frame.html">java.util.concurrent</a> :并发</li>
<li><a href="java/util/concurrent/atomic/package-frame.html">java.util.concurrent.atomic</a> :原子性</li>
<li><a href="java/util/concurrent/locks/package-frame.html">java.util.concurrent.locks</a> :锁</li>
<li><a href="java/util/function/package-frame.html">java.util.function</a> :函数</li>
</ul>

        <h2 id="1-创建多线程"   >
          <a href="#1-创建多线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-创建多线程" class="headerlink" title="1.创建多线程"></a>1.创建多线程</h2>
      
        <h3 id="1-继承Thread类"   >
          <a href="#1-继承Thread类" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-继承Thread类" class="headerlink" title="1.继承Thread类"></a>1.继承Thread类</h3>
      <ul>
<li>重写run方法，直接start</li>
</ul>

        <h3 id="2-实现Runnable接口"   >
          <a href="#2-实现Runnable接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-实现Runnable接口" class="headerlink" title="2.实现Runnable接口"></a>2.实现Runnable接口</h3>
      <ul>
<li>重写run方法，丢进new Thread().start()</li>
</ul>

        <h3 id="3-实现callable接口"   >
          <a href="#3-实现callable接口" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-实现callable接口" class="headerlink" title="3.实现callable接口"></a>3.实现callable接口</h3>
      <ul>
<li><p>submit()</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210101235951470.png" alt="image-20210101235951470"></p>
</li>
<li><p>futureTask</p>
<ul>
<li>具有返回值</li>
</ul>
</li>
</ul>

        <h3 id="4-线程池-创建多线程的一种方式"   >
          <a href="#4-线程池-创建多线程的一种方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-线程池-创建多线程的一种方式" class="headerlink" title="4.线程池(创建多线程的一种方式)"></a>4.线程池(创建多线程的一种方式)</h3>
      <ul>
<li><p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210102000020662.png" alt="image-20210102000020662"></p>
</li>
<li><p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210101235930869.png" alt="image-20210101235930869"></p>
</li>
</ul>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210529205820363.png" alt="image-20210529205820363"></p>

        <h2 id="2-程序-进程与线程"   >
          <a href="#2-程序-进程与线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-程序-进程与线程" class="headerlink" title="2.程序,进程与线程"></a>2.程序,进程与线程</h2>
      <p><strong>程序</strong>是含有指令和数据的⽂件，被存储在磁盘或其他的数据存储设备中，也就是说程序是静态的代码。</p>
<p><strong>进程</strong>是程序的⼀次执⾏过程，是系统运⾏程序的基本单位，因此进程是动态的。系统运⾏⼀个程序即是⼀个进程从创建，运⾏到消亡的过程。简单来说，⼀个进程就是⼀个执⾏中的程序，它在计算机中⼀个指令接着⼀个指令地执⾏着，同时，每个进程还占有某些系统资源如 CPU 时间，内存空间，⽂件，输⼊输出设备的使⽤权等等。换句话说，当程序在执⾏时，将会被操作系统载⼊内存中。 线程是进程划分成的更⼩的运⾏单位。线程和进程最⼤的不同在于基本上各进程是独⽴的，⽽各线程则不⼀定，因为同⼀进程中的线程极有可能会相互影响。从另⼀⻆度来说，进程属于操作系统的范畴，主要是同⼀段时间内，可以同时执⾏⼀个以上的程序，⽽线程则是在同⼀程序内⼏乎同时执⾏⼀个以上的程序段。</p>
<p><strong>线程</strong>与进程相似，但线程是⼀个⽐进程更⼩的执⾏单位。⼀个进程在其执⾏的过程中可以产⽣多个线程。与进程不同的是同类的多个线程共享同⼀块内存空间和⼀组系统资源，所以系统在产⽣⼀个线程，或是在各个线程之间作切换⼯作时，负担要⽐进程⼩得多，也正因为如此，线程也被称为轻量级程。</p>

        <h3 id="1-Java无法开启线程"   >
          <a href="#1-Java无法开启线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Java无法开启线程" class="headerlink" title="1.Java无法开启线程"></a>1.Java无法开启线程</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * This method is not invoked for the main method thread or &quot;system&quot;</span></span><br><span class="line"><span class="comment">         * group threads created/set up by the VM. Any new functionality added</span></span><br><span class="line"><span class="comment">         * to this method in the future may have to also be added to the VM.</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * A zero status value corresponds to state &quot;NEW&quot;.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (threadStatus != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalThreadStateException</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Notify the group that this thread is about to be started</span></span><br><span class="line"><span class="comment">         * so that it can be added to the group&#x27;s list of threads</span></span><br><span class="line"><span class="comment">         * and the group&#x27;s unstarted count can be decremented. */</span></span><br><span class="line">        group.add(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">started</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            start0();</span><br><span class="line">            started = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!started) &#123;</span><br><span class="line">                    group.threadStartFailed(<span class="built_in">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable ignore) &#123;</span><br><span class="line">                <span class="comment">/* do nothing. If start0 threw a Throwable then</span></span><br><span class="line"><span class="comment">                  it will be passed up the call stack */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//本地方法,调用底层,Java无法直接操作硬件</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">start0</span><span class="params">()</span>;</span><br></pre></td></tr></table></div></figure>


        <h3 id="2-并发与并行"   >
          <a href="#2-并发与并行" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-并发与并行" class="headerlink" title="2.并发与并行"></a>2.并发与并行</h3>
      <p><strong>并发：</strong> 同⼀时间段，多个任务都在执⾏ (单位时间内不⼀定同时执⾏)；交替执行</p>
<p>CPU单核,交替执行多条线程</p>
<p><strong>并⾏：</strong> 单位时间内，多个任务同时执⾏。</p>
<p>CPU多核,可以多个线程同时执行;线程池</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//        new Thread().start();</span></span><br><span class="line">        <span class="comment">//获取CPU核数</span></span><br><span class="line">        <span class="comment">//CPU 密集型, IO密集型</span></span><br><span class="line">        System.out.println(Runtime.getRuntime().availableProcessors());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="3-为什么要使⽤多线程"   >
          <a href="#3-为什么要使⽤多线程" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-为什么要使⽤多线程" class="headerlink" title="3.为什么要使⽤多线程"></a>3.为什么要使⽤多线程</h3>
      <p>先从总体上来说：</p>
<p><strong>从计算机底层来说：</strong> 线程可以⽐作是轻量级的进程，是程序执⾏的最⼩单位,线程间的切换和调度的成本远远⼩于进程。另外，多核 CPU 时代意味着多个线程可以同时运⾏，这减少了线程上下⽂切换的开销。</p>
<p><strong>从当代互联⽹发展趋势来说：</strong> 现在的系统动不动就要求百万级甚⾄千万级的并发量，⽽多线程并发编程正是开发⾼并发系统的基础，利⽤好多线程机制可以⼤⼤提⾼系统整体的并发能⼒以及性能。</p>
<p>深⼊到计算机底层来探讨：</p>
<p><strong>单核时代：</strong> <strong>在单核时代多线程主要是为了提⾼ CPU 和 IO 设备的综合利⽤率</strong>。举个例⼦：当只有⼀个线程的时候会导致 CPU 计算时，IO 设备空闲；进⾏ IO 操作时，CPU 空闲。我们可以简单地说这两者的利⽤率⽬前都是 50%左右。但是当有两个线程的时候就不⼀样了，当⼀个线程执⾏ CPU 计算时，另外⼀个线程可以进⾏ IO 操作，这样两个的利⽤率就可以在理想情况下达到100%了。</p>
<p><strong>多核时代:</strong> 多核时代多线程主要是为了提⾼ CPU 利⽤率。举个例⼦：假如我们要计算⼀个复杂的任务，我们只⽤⼀个线程的话，CPU 只会⼀个 CPU 核⼼被利⽤到，⽽创建多个线程就可以让多个 CPU 核⼼被利⽤到，这样就提⾼了 CPU 的利⽤率。</p>

        <h3 id="4-使⽤多线程可能带来的问题"   >
          <a href="#4-使⽤多线程可能带来的问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-使⽤多线程可能带来的问题" class="headerlink" title="4.使⽤多线程可能带来的问题"></a>4.使⽤多线程可能带来的问题</h3>
      <p>并发编程的⽬的就是为了能提⾼程序的执⾏效率提⾼程序运⾏速度，但是并发编程并不总是能提⾼程序运⾏速度的，⽽且并发编程可能会遇到很多问题，⽐如：内存泄漏、上下⽂切换、死锁还有受限于硬件和软件的资源闲置问题。</p>

        <h3 id="5-线程的⽣命周期和状态"   >
          <a href="#5-线程的⽣命周期和状态" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-线程的⽣命周期和状态" class="headerlink" title="5.线程的⽣命周期和状态"></a>5.线程的⽣命周期和状态</h3>
      <p>Java 线程在运⾏的⽣命周期中的指定时刻只可能处于下⾯ 6 种不同状态的其中⼀个状态（图源《Java并发编程艺术》4.1.4 节）。</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210530152434688.png" alt="image-20210530152434688"></p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">State</span> &#123;</span><br><span class="line">    	<span class="comment">//构建,创建</span></span><br><span class="line">        NEW,</span><br><span class="line">    	<span class="comment">//运行</span></span><br><span class="line">        RUNNABLE,</span><br><span class="line"> 		<span class="comment">//阻塞</span></span><br><span class="line">        BLOCKED,</span><br><span class="line">		<span class="comment">//等待状态,等待其他线程</span></span><br><span class="line">        WAITING,</span><br><span class="line">		<span class="comment">//超时等待,不同于waitting,在指定的时间呃自行返回</span></span><br><span class="line">        TIMED_WAITING,</span><br><span class="line">		<span class="comment">//终止状态</span></span><br><span class="line">        TERMINATED;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></div></figure>

<p>线程在⽣命周期中并不是固定处于某⼀个状态⽽是随着代码的执⾏在不同状态之间切换。Java 线程状态变迁如下图所示（图源《Java 并发编程艺术》4.1.4 节）：</p>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210530152526574.png" alt="image-20210530152526574"></p>
<p>由上图可以看出：线程创建之后它将处于 <strong>NEW(新建)</strong> 状态,调⽤start() ⽅法后开始运⾏,线程这时候处于 <strong>READY(可运⾏)</strong> 状态。可运⾏状态的线程获得了 CPU 时间⽚（timeslice）后就处于<strong>RUNNING(运⾏)</strong> 状态。</p>
<blockquote>
<p>操作系统隐藏 Java 虚拟机（JVM）中的 RUNNABLE 和 RUNNING 状态，它只能看到 RUNNABLE 状态（图源：HowToDoInJava：Java Thread Life Cycle and Thread States），所以 Java 系统⼀般将这两个状态统称为 <strong>RUNNABLE(运⾏中)</strong> 状态 。</p>
</blockquote>
<p><img src="D:\ASoftWare\blog\source_posts\Java-SE\image-20210530152716492.png" alt="image-20210530152716492"></p>
<p>当线程执⾏ wait() ⽅法之后，线程进⼊ <strong>WAITING(等待)</strong> 状态。进⼊等待状态的线程需要依靠其他线程的通知才能够返回到运⾏状态，⽽ <strong>TIME_WAITING(超时等待)</strong> 状态相当于在等待状态的基础上增加了超时限制，⽐如通过**sleep(long millis)<strong>⽅法或</strong>wait(long millis)**⽅法可以将 Java线程置于 TIMED WAITING 状态。当超时时间到达后 Java 线程将会返回到 RUNNABLE 状态。当线程调⽤同步⽅法时，在没有获取到锁的情况下，线程将会进⼊到 <strong>BLOCKED(阻塞)</strong> 状态。线程在执⾏Runnable 的 run() ⽅法之后将会进⼊到 <strong>TERMINATED(终⽌)</strong> 状态。</p>

        <h3 id="6-Wait与Sleep的区别和共同点"   >
          <a href="#6-Wait与Sleep的区别和共同点" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-Wait与Sleep的区别和共同点" class="headerlink" title="6.Wait与Sleep的区别和共同点"></a>6.Wait与Sleep的区别和共同点</h3>
      <ul>
<li>两者最主要的区别在于：<strong>sleep</strong> <strong>⽅法没有释放锁，⽽</strong> <strong>wait</strong> <strong>⽅法释放了锁</strong> 。</li>
<li>两者都可以暂停线程的执⾏。</li>
<li>Wait 通常被⽤于线程间交互&#x2F;通信，sleep 通常被⽤于暂停执⾏。</li>
<li>wait() ⽅法被调⽤后，线程不会⾃动苏醒，需要别的线程调⽤同⼀个对象上的 notify() 或者notifyAll() ⽅法。sleep() ⽅法执⾏完成后，线程会⾃动苏醒。或者可以使⽤ wait(longtimeout)超时后线程会⾃动苏醒。</li>
</ul>
<p>sleep可以在任何地方使用</p>
<p>wait在同步代码块中</p>

        <h2 id="3-锁"   >
          <a href="#3-锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-锁" class="headerlink" title="3.锁"></a>3.锁</h2>
      
        <h3 id="1-synchronized锁"   >
          <a href="#1-synchronized锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-synchronized锁" class="headerlink" title="1.synchronized锁"></a>1.synchronized锁</h3>
      
        <h4 id="1-介绍-6"   >
          <a href="#1-介绍-6" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-介绍-6" class="headerlink" title="1.介绍"></a>1.介绍</h4>
      <p>synchronized关键字解决的是多个线程之间访问资源的同步性，synchronized关键字可以保证被它修饰的⽅法或者代码块在任意时刻只能有⼀个线程执⾏。</p>
<p>另外，在 Java 早期版本中，synchronized属于重量级锁，效率低下，因为监视器锁（monitor）是依赖于底层的操作系统的 Mutex Lock 来实现的，Java 的线程是映射到操作系统的原⽣线程之上的。如果要挂起或者唤醒⼀个线程，都需要操作系统帮忙完成，⽽操作系统实现线程之间的切换时需要从⽤户态转换到内核态，这个状态之间的转换需要相对⽐᫾⻓的时间，时间成本相对᫾⾼，这也是为什么早期的 synchronized 效率低的原因。庆幸的是在 Java 6 之后 Java 官⽅对从 JVM 层⾯对synchronized较⼤优化，所以现在的 synchronized 锁效率也优化得很不错了。JDK1.6对锁的实现引⼊了⼤量的优化，如⾃旋锁、适应性⾃旋锁、锁消除、锁粗化、偏向锁、轻量级锁等技术来减少锁操作的开销。</p>

        <h4 id="2-售票例子"   >
          <a href="#2-售票例子" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-售票例子" class="headerlink" title="2.售票例子"></a>2.售票例子</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SaleTicket01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//并发: 多个线程操作同一个资源类</span></span><br><span class="line">        Ticket ticket=<span class="keyword">new</span> <span class="title class_">Ticket</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Runnable 函数式接口 , jdk1.8 lambda表达式 ()-&gt;&#123;&#125;</span></span><br><span class="line"><span class="comment">//        new Thread(new Runnable() &#123;</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public void run() &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125;).start();</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">60</span>; i++) &#123;</span><br><span class="line">                ticket.sale();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;a&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">60</span>; i++) &#123;</span><br><span class="line">                ticket.sale();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;b&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">60</span>; i++) &#123;</span><br><span class="line">                ticket.sale();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;c&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//资源类OOP</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ticket</span>&#123;</span><br><span class="line">    <span class="comment">//属性与方法</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> number=<span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//卖票的方式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">sale</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(number&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;卖出了第&quot;</span>+(number--)+<span class="string">&quot;票,剩余:&quot;</span>+number);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        else&#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(&quot;已售完&quot;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="3-三种使用方式"   >
          <a href="#3-三种使用方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-三种使用方式" class="headerlink" title="3.三种使用方式"></a>3.三种使用方式</h4>
      <p><strong>修饰实例⽅法:</strong> 作⽤于当前对象实例加锁，进⼊同步代码前要获得当前对象实例的锁</p>
<p><strong>修饰静态⽅法:</strong> 也就是给当前类加锁，会作⽤于类的所有对象实例，因为静态成员不属于任何⼀个实例对象，是类成员（ static 表明这是该类的⼀个静态资源，不管new了多少个对象，只有⼀份）。所以如果⼀个线程A调⽤⼀个实例对象的⾮静态 synchronized ⽅法，⽽线程B需要调⽤这个实例对象所属类的静态 synchronized ⽅法，是允许的，不会发⽣互斥现象，<strong>因为访问静态synchronized⽅法占⽤的锁是当前类的锁，⽽访问⾮静态synchronized⽅法占⽤的锁是当前实例对象锁</strong>。</p>
<p><strong>修饰代码块:</strong> 指定加锁对象，对给定对象加锁，进⼊同步代码库前要获得给定对象的锁。</p>
<p><strong>总结：</strong> synchronized 关键字加到 static 静态⽅法和 synchronized(class)代码块上都是是给 Class类上锁。synchronized 关键字加到实例⽅法上是给对象实例上锁。尽量不要使⽤synchronized(String a) 因为JVM中，字符串常量池具有缓存功能！</p>

        <h3 id="2-lock"   >
          <a href="#2-lock" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-lock" class="headerlink" title="2.lock"></a>2.lock</h3>
      
        <h4 id="1-ReentrantLock"   >
          <a href="#1-ReentrantLock" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-ReentrantLock" class="headerlink" title="1.ReentrantLock"></a>1.ReentrantLock</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Creates an instance of &#123;<span class="doctag">@code</span> ReentrantLock&#125;.</span></span><br><span class="line"><span class="comment"> * This is equivalent to using &#123;<span class="doctag">@code</span> ReentrantLock(false)&#125;.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ReentrantLock</span><span class="params">()</span> &#123;</span><br><span class="line">    sync = <span class="keyword">new</span> <span class="title class_">NonfairSync</span>();<span class="comment">//非公平锁</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Creates an instance of &#123;<span class="doctag">@code</span> ReentrantLock&#125; with the</span></span><br><span class="line"><span class="comment"> * given fairness policy.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fair &#123;<span class="doctag">@code</span> true&#125; if this lock should use a fair ordering policy</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ReentrantLock</span><span class="params">(<span class="type">boolean</span> fair)</span> &#123;</span><br><span class="line">    sync = fair ? <span class="keyword">new</span> <span class="title class_">FairSync</span>() : <span class="keyword">new</span> <span class="title class_">NonfairSync</span>(); <span class="comment">//布尔值 真为公平锁,否则为非公平锁</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>公平锁: 先来后到	非抢占先来先服务</p>
<p>非公平锁:可以插队(默认) 即抢占调度</p>

        <h4 id="2-ReadLock"   >
          <a href="#2-ReadLock" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-ReadLock" class="headerlink" title="2.ReadLock"></a>2.ReadLock</h4>
      
        <h4 id="3-WriteLock"   >
          <a href="#3-WriteLock" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-WriteLock" class="headerlink" title="3.WriteLock"></a>3.WriteLock</h4>
      
        <h4 id="4-Synchronized与Lock的区别"   >
          <a href="#4-Synchronized与Lock的区别" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-Synchronized与Lock的区别" class="headerlink" title="4.Synchronized与Lock的区别"></a>4.Synchronized与Lock的区别</h4>
      <ol>
<li>Synchronized为内置的Java关键字,Lock是一个Java类</li>
<li>Synchronized无法判断获取锁的状态,Lock可以判断是否取到了锁</li>
<li>Synchronized会自动释放锁,Lock必须要手动释放锁,如果不释放,死锁</li>
<li>Synchronized线程1(获得锁),线程2(等待),Lock锁不一定会等待下去</li>
<li>Synchronized可重入锁,不可中断,非公平;Lock,可重入锁,可判断(中断),非公平(自己定义设置)</li>
<li>Synchronized适合少量的代码同步问题,Lock适合大量的同步代码</li>
</ol>
<p><strong>①</strong> <strong>两者都是可重⼊锁</strong></p>
<p>两者都是可重⼊锁。“可重⼊锁”概念是：⾃⼰可以再次获取⾃⼰的内部锁。⽐如⼀个线程获得了某个对象的锁，此时这个对象锁还没有释放，当其再次想要获取这个对象的锁的时候还是可以获取的，如果不可锁重⼊的话，就会造成死锁。同⼀个线程每次获取锁，锁的计数器都⾃增1，所以要等到锁的计数器下降为0时才能释放锁。</p>
<p><strong>② synchronized</strong> <strong>依赖于</strong> <strong>JVM</strong> <strong>⽽</strong> <strong>ReentrantLock</strong> <strong>依赖于</strong> <strong>API</strong></p>
<p>synchronized 是依赖于 JVM 实现的，前⾯我们也讲到了 虚拟机团队在 JDK1.6 为 synchronized 关键字进⾏了很多优化，但是这些优化都是在虚拟机层⾯实现的，并没有直接暴露给我们。ReentrantLock 是 JDK 层⾯实现的（也就是 API 层⾯，需要 lock() 和 unlock() ⽅法配合try&#x2F;finally 语句块来完成），所以我们可以通过查看它的源代码，来看它是如何实现的。</p>
<p><strong>③ ReentrantLock</strong> <strong>⽐</strong> <strong>synchronized</strong> <strong>增加了⼀些⾼级功能</strong></p>
<p>相⽐synchronized，ReentrantLock增加了⼀些⾼级功能。主要来说主要有三点：<strong>①等待可中断；</strong> <strong>②可实现公平锁；</strong> <strong>③可实现选择性通知（锁可以绑定多个条件）</strong></p>
<ul>
<li><strong>ReentrantLock提供了⼀种能够中断等待锁的线程的机制</strong>，通过lock.lockInterruptibly()来实现这个机制。也就是说正在等待的线程可以选择放弃等待，改为处理其他事情。</li>
<li><strong>ReentrantLock可以指定是公平锁还是⾮公平锁</strong>。<strong>⽽synchronized只能是⾮公平锁。所谓的公平</strong> 锁就是先等待的线程先获得锁。ReentrantLock默认情况是⾮公平的，可以通过 ReentrantLock类的<code>ReentrantLock(boolean fair)</code>构造⽅法来制定是否是公平的。</li>
<li>synchronized关键字与wait()和notify()&#x2F;notifyAll()⽅法相结合可以实现等待&#x2F;通知机制，ReentrantLock类当然也可以实现，但是需要借助于Condition接⼝与newCondition() ⽅法。Condition是JDK1.5之后才有的，它具有很好的灵活性，⽐如可以实现多路通知功能也就是在⼀个Lock对象中可以创建多个Condition实例（即对象监视器），<strong>线程对象可以注册在指定的Condition中，从⽽可以有选择性的进⾏线程通知，在调度线程上更加灵活。 在使⽤notify()&#x2F;notifyAll()⽅法进⾏通知时，被通知的线程是由JVM选择的，⽤ReentrantLock类结合Condition实例可以实现*“选择性通知”</strong> ，这个功能⾮常重要，⽽且是Condition接⼝默认提供的。⽽synchronized关键字就相当于整个Lock对象中只有⼀个Condition实例，所有的线程都注册在它⼀个身上。如果执⾏notifyAll()⽅法的话就会通知所有处于等待状态的线程这样会造成很⼤的效率问题，⽽Condition实例的signalAll()⽅法 只会唤醒注册在该Condition实例中的所有等待线程。如果你想使⽤上述功能，那么选择ReentrantLock是⼀个不错的选择。</li>
</ul>
<p><strong>④</strong> <strong>性能已不是选择标准</strong></p>

        <h4 id="5-Condition"   >
          <a href="#5-Condition" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Condition" class="headerlink" title="5.Condition"></a>5.Condition</h4>
      
        <h5 id="1-创建"   >
          <a href="#1-创建" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-创建" class="headerlink" title="1.创建"></a>1.创建</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"><span class="type">Condition</span> <span class="variable">condition</span> <span class="operator">=</span> lock.newCondition(); <span class="comment">//通过lock的newCondition来获得Condition对象</span></span><br><span class="line">condition.await(); <span class="comment">//导致当前线程等到发信号或interrupted</span></span><br><span class="line">condition.signal()    </span><br></pre></td></tr></table></div></figure>


        <h5 id="2-方法使用"   >
          <a href="#2-方法使用" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-方法使用" class="headerlink" title="2.方法使用"></a>2.方法使用</h5>
      <div class="table-container"><table>
<thead>
<tr>
<th>Modifier and Type</th>
<th>Method and Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>void</code></td>
<td><code>await()</code>  导致当前线程等到发信号或 <a href="../../../../java/lang/Thread.html#interrupt--">interrupted</a> 。</td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code>await(long time,  TimeUnit unit)</code>  使当前线程等待直到发出信号或中断，或指定的等待时间过去。</td>
</tr>
<tr>
<td><code>long</code></td>
<td><code>awaitNanos(long nanosTimeout)</code>  使当前线程等待直到发出信号或中断，或指定的等待时间过去。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>awaitUninterruptibly()</code>  使当前线程等待直到发出信号。</td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code>awaitUntil(Date deadline)</code>  使当前线程等待直到发出信号或中断，或者指定的最后期限过去。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>signal()</code>  唤醒一个等待线程。</td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>signalAll()</code>  唤醒所有等待线程。</td>
</tr>
</tbody></table></div>

        <h5 id="3-精准通知-个人觉得没啥用"   >
          <a href="#3-精准通知-个人觉得没啥用" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-精准通知-个人觉得没啥用" class="headerlink" title="3.精准通知(个人觉得没啥用)"></a>3.精准通知(个人觉得没啥用)</h5>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.ProducerConsumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Condition;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Lock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"><span class="comment">//A执行后调用B,B执行后调用C,C执行完后调用A</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConditionMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Data3</span> <span class="variable">data3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Data3</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data3.printA();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data3.printB();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;B&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data3.printC();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;C&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data3.printD();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;D&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data3</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">condition1</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">condition2</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">condition3</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">condition4</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//1 -&gt; A,2 -&gt; B,3 -&gt; C</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printA</span><span class="params">()</span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (number==<span class="number">0</span>)&#123;</span><br><span class="line">                condition1.await();</span><br><span class="line">            &#125;</span><br><span class="line">            number--;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line"></span><br><span class="line">            condition2.signal();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printB</span><span class="params">()</span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (number!=<span class="number">0</span>)&#123;</span><br><span class="line">                condition2.await();</span><br><span class="line">            &#125;</span><br><span class="line">            number++;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line"></span><br><span class="line">            condition3.signal();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printC</span><span class="params">()</span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (number==<span class="number">0</span>)&#123;</span><br><span class="line">                condition3.await();</span><br><span class="line">            &#125;</span><br><span class="line">            number--;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line"></span><br><span class="line">            condition4.signal();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printD</span><span class="params">()</span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (number!=<span class="number">0</span>)&#123;</span><br><span class="line">                condition4.await();</span><br><span class="line">            &#125;</span><br><span class="line">            number++;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line"></span><br><span class="line">            condition1.signal();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//class Data3&#123;</span></span><br><span class="line"><span class="comment">//    private Lock lock = new ReentrantLock();</span></span><br><span class="line"><span class="comment">//    private Condition condition1 = lock.newCondition();</span></span><br><span class="line"><span class="comment">//    private Condition condition2 = lock.newCondition();</span></span><br><span class="line"><span class="comment">//    private Condition condition3 = lock.newCondition();</span></span><br><span class="line"><span class="comment">//    private int number = 1; //1 -&gt; A,2 -&gt; B,3 -&gt; C</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    public void printA()&#123;</span></span><br><span class="line"><span class="comment">//        lock.lock();</span></span><br><span class="line"><span class="comment">//        try &#123;</span></span><br><span class="line"><span class="comment">//            while (number!=1)&#123;</span></span><br><span class="line"><span class="comment">//                condition1.await();</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//            System.out.println(Thread.currentThread().getName()+&quot;=&quot;+number);</span></span><br><span class="line"><span class="comment">//            number=2;</span></span><br><span class="line"><span class="comment">//            condition2.signal();</span></span><br><span class="line"><span class="comment">//        &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="comment">//            e.printStackTrace();</span></span><br><span class="line"><span class="comment">//        &#125; finally &#123;</span></span><br><span class="line"><span class="comment">//            lock.unlock();</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    public void printB()&#123;</span></span><br><span class="line"><span class="comment">//        lock.lock();</span></span><br><span class="line"><span class="comment">//        try &#123;</span></span><br><span class="line"><span class="comment">//            while (number!=2)&#123;</span></span><br><span class="line"><span class="comment">//                condition2.await();</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//            System.out.println(Thread.currentThread().getName()+&quot;=&quot;+number);</span></span><br><span class="line"><span class="comment">//            number=3;</span></span><br><span class="line"><span class="comment">//            condition3.signal();</span></span><br><span class="line"><span class="comment">//        &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="comment">//            e.printStackTrace();</span></span><br><span class="line"><span class="comment">//        &#125; finally &#123;</span></span><br><span class="line"><span class="comment">//            lock.unlock();</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    public void printC()&#123;</span></span><br><span class="line"><span class="comment">//        lock.lock();</span></span><br><span class="line"><span class="comment">//        try &#123;</span></span><br><span class="line"><span class="comment">//            while (number!=3)&#123;</span></span><br><span class="line"><span class="comment">//                condition3.await();</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//            System.out.println(Thread.currentThread().getName()+&quot;=&quot;+number);</span></span><br><span class="line"><span class="comment">//            number=1;</span></span><br><span class="line"><span class="comment">//            condition1.signal();</span></span><br><span class="line"><span class="comment">//        &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="comment">//            e.printStackTrace();</span></span><br><span class="line"><span class="comment">//        &#125; finally &#123;</span></span><br><span class="line"><span class="comment">//            lock.unlock();</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="3-生产者消费者问题"   >
          <a href="#3-生产者消费者问题" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-生产者消费者问题" class="headerlink" title="3.生产者消费者问题"></a>3.生产者消费者问题</h3>
      
        <h4 id="1-Synchronized-wait-notify"   >
          <a href="#1-Synchronized-wait-notify" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-Synchronized-wait-notify" class="headerlink" title="1,Synchronized wait notify"></a>1,Synchronized wait notify</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.ProducerConsumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Data</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Data</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.increment();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.decrement();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;B&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.increment();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;C&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.decrement();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;D&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//+1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (number!=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//等待</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                wait();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        number++;</span><br><span class="line">        System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line">        <span class="comment">//通知 +1完毕</span></span><br><span class="line">        notify();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//-1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">decrement</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(number==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//等待</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                wait();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        number--;</span><br><span class="line">        System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line">        <span class="comment">//通知 -1 完毕</span></span><br><span class="line">        notify();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h5 id="虚假唤醒"   >
          <a href="#虚假唤醒" class="heading-link"><i class="fas fa-link"></i></a><a href="#虚假唤醒" class="headerlink" title="虚假唤醒"></a>虚假唤醒</h5>
      <p>由于使用if的时候,在被唤醒后,会直接做下面的事情,所以会产生错误</p>

        <h4 id="2-JUC-Lock"   >
          <a href="#2-JUC-Lock" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-JUC-Lock" class="headerlink" title="2.JUC Lock"></a>2.JUC Lock</h4>
      <p>Lock + Condition的await与signal</p>
<ul>
<li><code>Condition</code>因素出<code>Object</code>监视器方法（ <a href="../../../../java/lang/Object.html#wait--"><code>wait</code></a> ,<a href="../../../../java/lang/Object.html#notify--"><code>notify</code></a>和<a href="../../../../java/lang/Object.html#notifyAll--"><code>notifyAll</code></a>  ）成不同的对象，以得到具有多个等待集的每个对象，通过将它们与使用任意的组合的效果<a href="../../../../java/util/concurrent/locks/Lock.html"><code>Lock</code>个</a>实现。  <code>Lock</code>替换<code>synchronized</code>方法和语句的使用，  <code>Condition</code>取代了对象监视器方法的使用。</li>
</ul>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.ProducerConsumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Condition;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Lock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JUCMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Data2</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Data2</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.increment();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.decrement();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;B&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.increment();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;C&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                data.decrement();</span><br><span class="line">            &#125;&#125;,<span class="string">&quot;D&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data2</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">    <span class="type">Condition</span> <span class="variable">condition</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//+1</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">increment</span><span class="params">()</span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (number!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//等待</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    condition.await();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            number++;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line">            condition.signalAll();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//通知 +1完毕</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//-1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decrement</span><span class="params">()</span>&#123;</span><br><span class="line">        lock.lock();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">while</span>(number==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//等待</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    condition.await();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            number--;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;=&quot;</span>+number);</span><br><span class="line">            <span class="comment">//通知 -1 完毕</span></span><br><span class="line">            condition.signalAll();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="4-八锁现象-理解锁的对象-即使用的方式"   >
          <a href="#4-八锁现象-理解锁的对象-即使用的方式" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-八锁现象-理解锁的对象-即使用的方式" class="headerlink" title="4.八锁现象(理解锁的对象,即使用的方式)"></a>4.八锁现象(理解锁的对象,即使用的方式)</h3>
      <p>锁住对象,或者Class</p>
<p>只需理解锁的究竟是谁</p>
<p><strong>修饰实例⽅法:</strong> 作⽤于当前对象实例加锁，进⼊同步代码前要获得当前对象实例的锁</p>
<p><strong>修饰静态⽅法:</strong> 也就是给当前类加锁，会作⽤于类的所有对象实例，因为静态成员不属于任何⼀个实例对象，是类成员（ static 表明这是该类的⼀个静态资源，不管new了多少个对象，只有⼀份）。所以如果⼀个线程A调⽤⼀个实例对象的⾮静态 synchronized ⽅法，⽽线程B需要调⽤这个实例对象所属类的静态 synchronized ⽅法，是允许的，不会发⽣互斥现象，<strong>因为访问静态synchronized⽅法占⽤的锁是当前类的锁，⽽访问⾮静态synchronized⽅法占⽤的锁是当前实例对象锁</strong>。</p>
<p><strong>修饰代码块:</strong> 指定加锁对象，对给定对象加锁，进⼊同步代码库前要获得给定对象的锁。</p>
<p><strong>总结：</strong> synchronized 关键字加到 static 静态⽅法和 synchronized(class)代码块上都是是给 Class类上锁。synchronized 关键字加到实例⽅法上是给对象实例上锁。尽量不要使⽤synchronized(String a) 因为JVM中，字符串常量池具有缓存功能！</p>
<p>而给Class类上锁与给对象实例上锁是互不相干的,也就是说我锁住了Class的类,不影响对实例中的实例方法的调用(不会被锁住),反之锁住实例,也不会对类方法的调用有影响.</p>

        <h2 id="4-集合类与Map不安全"   >
          <a href="#4-集合类与Map不安全" class="heading-link"><i class="fas fa-link"></i></a><a href="#4-集合类与Map不安全" class="headerlink" title="4.集合类与Map不安全"></a>4.集合类与Map不安全</h2>
      
        <h3 id="1-List"   >
          <a href="#1-List" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-List" class="headerlink" title="1.List"></a>1.List</h3>
      
        <h4 id="1-实现"   >
          <a href="#1-实现" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-实现" class="headerlink" title="1.实现"></a>1.实现</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.unsafe.tList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">concurrent_List</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span>  <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">                list.add(UUID.randomUUID().toString().substring(<span class="number">0</span>,<span class="number">5</span>));</span><br><span class="line">                System.out.println(list);</span><br><span class="line">            &#125;,String.valueOf(i)).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="2-会报出异常"   >
          <a href="#2-会报出异常" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-会报出异常" class="headerlink" title="2.会报出异常"></a>2.会报出异常</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;2&quot;</span> Exception in thread <span class="string">&quot;7&quot;</span> Exception in thread <span class="string">&quot;8&quot;</span> java.util.ConcurrentModificationException</span><br><span class="line">	at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:<span class="number">911</span>)</span><br><span class="line">	at java.util.ArrayList$Itr.next(ArrayList.java:<span class="number">861</span>)</span><br><span class="line">	at java.util.AbstractCollection.toString(AbstractCollection.java:<span class="number">461</span>)</span><br><span class="line">	at java.lang.String.valueOf(String.java:<span class="number">2994</span>)</span><br><span class="line">	at java.io.PrintStream.println(PrintStream.java:<span class="number">821</span>)</span><br><span class="line">	at com.why.unsafe.tList.concurrent_List.lambda$main$<span class="number">0</span>(concurrent_List.java:<span class="number">13</span>)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:<span class="number">748</span>)</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h4 id="3-解决"   >
          <a href="#3-解决" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-解决" class="headerlink" title="3.解决"></a>3.解决</h4>
      <ol>
<li><p>使用Vector</p>
</li>
<li><p>使用Collections.Synchronized(new ArrayList&lt;&gt;());</p>
</li>
<li><p>使用 CopyOnWriteArrayList&lt;&gt;();</p>
<p>CopyOnwrite 写入时复制COW 计算机程序设计领域的一种优化策略;多个线程调用的时候,list,读取的时候,固定的,写入(覆盖),在写入的时候避免覆盖;造成数据问题</p>
</li>
<li><p>CopyOn</p>
</li>
</ol>

        <h3 id="2-Set"   >
          <a href="#2-Set" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-Set" class="headerlink" title="2.Set"></a>2.Set</h3>
      <p>与List同理</p>

        <h3 id="3-Map"   >
          <a href="#3-Map" class="heading-link"><i class="fas fa-link"></i></a><a href="#3-Map" class="headerlink" title="3.Map"></a>3.Map</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.unsafe.tMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">concurrent_Map</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//        Set&lt;String&gt; set = Collections.synchronizedSet(new HashSet&lt;&gt;());</span></span><br><span class="line"><span class="comment">//        Map&lt;String,String&gt; map = new HashMap&lt;&gt;();</span></span><br><span class="line"><span class="comment">//        Map&lt;String,String&gt; map = Collections.synchronizedMap(new HashMap&lt;&gt;());</span></span><br><span class="line">        Map&lt;String,String&gt; map = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">                map.put(Thread.currentThread().getName(),UUID.randomUUID().toString().substring(<span class="number">0</span>,<span class="number">5</span>));</span><br><span class="line">                System.out.println(map);</span><br><span class="line">            &#125;,String.valueOf(i)).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="5-Callable"   >
          <a href="#5-Callable" class="heading-link"><i class="fas fa-link"></i></a><a href="#5-Callable" class="headerlink" title="5.Callable"></a>5.Callable</h2>
      
        <h3 id="1-特点-2"   >
          <a href="#1-特点-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#1-特点-2" class="headerlink" title="1.特点"></a>1.特点</h3>
      <ol>
<li>可以有返回值</li>
<li>可以抛出异常</li>
<li>方法不同</li>
</ol>
<ul>
<li><p>返回结果并可能引发异常的任务。实现者定义一个没有参数的单一方法，称为<code>call</code> 。</p>
<p><code>Callable</code>接口类似于<a href="../../../java/lang/Runnable.html"><code>Runnable</code></a>  ，因为它们都是为其实例可能由另一个线程执行的类设计的。 然而，A  <code>Runnable</code>不返回结果，也不能抛出被检查的异常。 </p>
<p>该<a href="../../../java/util/concurrent/Executors.html"><code>Executors</code></a>类包含的实用方法，从其他普通形式转换为<code>Callable</code>类。</p>
</li>
</ul>

        <h3 id="2-使用-2"   >
          <a href="#2-使用-2" class="heading-link"><i class="fas fa-link"></i></a><a href="#2-使用-2" class="headerlink" title="2.使用"></a>2.使用</h3>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.myCallable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutionException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.FutureTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CallableTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">//        new Thread(new MyThread()).start();</span></span><br><span class="line">        <span class="type">MyThread</span> <span class="variable">myThread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyThread</span>();</span><br><span class="line">        <span class="type">FutureTask</span> <span class="variable">futureTask</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FutureTask</span>(myThread);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask,<span class="string">&quot;A&quot;</span>).start();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> futureTask.get();</span><br><span class="line">            System.out.println(o);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//class MyThread implements Runnable&#123;</span></span><br><span class="line"><span class="comment">//    public void run()&#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;call&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h2 id="6-常用辅助类"   >
          <a href="#6-常用辅助类" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-常用辅助类" class="headerlink" title="6.常用辅助类"></a>6.常用辅助类</h2>
      
        <h3 id="6-1CountDownLatch"   >
          <a href="#6-1CountDownLatch" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-1CountDownLatch" class="headerlink" title="6.1CountDownLatch"></a>6.1CountDownLatch</h3>
      <p>允许一个或多个线程等待直到在其他线程中执行的一组操作完成的同步辅助。</p>
<p>A <code>CountDownLatch</code>用给定的<em>计数</em>初始化。 <a href="../../../java/util/concurrent/CountDownLatch.html#await--"><code>await</code></a>方法阻塞，直到由于<a href="../../../java/util/concurrent/CountDownLatch.html#countDown--"><code>countDown()</code></a>方法的<a href="../../../java/util/concurrent/CountDownLatch.html#countDown--">调用</a>而导致当前计数达到零，之后所有等待线程被释放，并且任何后续的<code>await</code>  <a href="../../../java/util/concurrent/CountDownLatch.html#await--">调用立即</a>返回。  这是一个一次性的现象 - 计数无法重置。 如果您需要重置计数的版本，请考虑使用<a href="../../../java/util/concurrent/CyclicBarrier.html"><code>CyclicBarrier</code></a>  。 </p>
<p>A <code>CountDownLatch</code>是一种通用的同步工具，可用于多种用途。  一个<code>CountDownLatch</code>为一个计数的CountDownLatch用作一个简单的开&#x2F;关锁存器，或者门：所有线程调用<a href="../../../java/util/concurrent/CountDownLatch.html#await--"><code>await</code></a>在门口等待，直到被调用<a href="../../../java/util/concurrent/CountDownLatch.html#countDown--"><code>countDown()</code></a>的线程打开。  一个<code>CountDownLatch</code>初始化<em>N</em>可以用来做一个线程等待，直到<em>N个</em>线程完成某项操作，或某些动作已经完成N次。 </p>
<p><code>CountDownLatch</code>一个有用的属性是，它不要求调用<code>countDown</code>线程等待计数到达零之前继续，它只是阻止任何线程通过<a href="../../../java/util/concurrent/CountDownLatch.html#await--"><code>await</code></a>  ，直到所有线程可以通过。</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.utilsTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CountDownLatchDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="comment">//倒计时,总数是6,必须要执行任务的数量</span></span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">countDownLatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">&quot;Go out&quot;</span>);</span><br><span class="line">                countDownLatch.countDown();</span><br><span class="line">            &#125;,String.valueOf(i)).start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        countDownLatch.await();<span class="comment">//等待计数器归零后向下执行</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Close Door&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="6-2CyclicBarrier"   >
          <a href="#6-2CyclicBarrier" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-2CyclicBarrier" class="headerlink" title="6.2CyclicBarrier"></a>6.2CyclicBarrier</h3>
      <p>允许一组线程全部等待彼此达到共同屏障点的同步辅助。循环阻塞在涉及固定大小的线程方的程序中很有用，这些线程必须偶尔等待彼此。屏障被称为<em>循环</em>  ，因为它可以在等待的线程被释放之后重新使用。</p>
<p>A <code>CyclicBarrier</code>支持一个可选的<a href="../../../java/lang/Runnable.html"><code>Runnable</code></a>命令，每个屏障点运行一次，在派对中的最后一个线程到达之后，但在任何线程释放之前。  在任何一方继续进行之前，此<em>屏障操作</em>对更新共享状态很有用。 </p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.why.utilsTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.BrokenBarrierException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CyclicBarrier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CyclicBarrierDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">CyclicBarrier</span> <span class="variable">cyclicBarrier</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CyclicBarrier</span>(<span class="number">7</span>,()-&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+temp); <span class="comment">//Java 8 之后，在匿名类或 Lambda 表达式中访问的局部变量，如果不是 final 类型的话，编译器自动加上 final 修饰符，即Java8新特性：effectively final。</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    cyclicBarrier.await(); <span class="comment">//+1</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (BrokenBarrierException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="6-3Semaphore"   >
          <a href="#6-3Semaphore" class="heading-link"><i class="fas fa-link"></i></a><a href="#6-3Semaphore" class="headerlink" title="6.3Semaphore"></a>6.3Semaphore</h3>
      <p>一个计数信号量。在概念上，信号量维持一组许可证。如果有必要，每个<a href="../../../java/util/concurrent/Semaphore.html#acquire--"><code>acquire()</code>都会</a>阻塞，直到许可证可用，然后才能使用它。每个<a href="../../../java/util/concurrent/Semaphore.html#release--"><code>release()</code></a>添加许可证，潜在地释放阻塞获取方。但是，没有使用实际的许可证对象;<code>Semaphore</code>只保留可用数量的计数，并相应地执行。</p>
<p>信号量通常用于限制线程数，而不是访问某些（物理或逻辑）资源。  例如，这是一个使用信号量来控制对一个项目池的访问的类： </p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Pool</span> &#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX_AVAILABLE</span> <span class="operator">=</span> <span class="number">100</span>; </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Semaphore</span> <span class="variable">available</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Semaphore</span>(MAX_AVAILABLE, <span class="literal">true</span>); </span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getItem</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123; </span><br><span class="line">        available.acquire(); </span><br><span class="line">        <span class="keyword">return</span> getNextAvailableItem(); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">putItem</span><span class="params">(Object x)</span> &#123; </span><br><span class="line">        <span class="keyword">if</span> (markAsUnused(x)) </span><br><span class="line">            available.release(); </span><br><span class="line">    &#125; <span class="comment">// Not a particularly efficient data structure; just for demo protected Object[] items = ... whatever kinds of items being managed </span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span>[] used = <span class="keyword">new</span> <span class="title class_">boolean</span>[MAX_AVAILABLE]; </span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">synchronized</span> Object <span class="title function_">getNextAvailableItem</span><span class="params">()</span> &#123; </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; MAX_AVAILABLE; ++i) &#123; </span><br><span class="line">            <span class="keyword">if</span> (!used[i]) &#123; </span><br><span class="line">                used[i] = <span class="literal">true</span>; </span><br><span class="line">                <span class="keyword">return</span> items[i]; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// not reached </span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">markAsUnused</span><span class="params">(Object item)</span> &#123; </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; MAX_AVAILABLE; ++i) &#123; </span><br><span class="line">            <span class="keyword">if</span> (item == items[i]) &#123; </span><br><span class="line">                <span class="keyword">if</span> (used[i]) &#123; </span><br><span class="line">                    used[i] = <span class="literal">false</span>; <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">                &#125; </span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></div></figure>

<p>在获得项目之前，每个线程必须从信号量获取许可证，以确保某个项目可用。  当线程完成该项目后，它将返回到池中，并将许可证返回到信号量，允许另一个线程获取该项目。 请注意，当<a href="../../../java/util/concurrent/Semaphore.html#acquire--">调用<code>acquire()</code></a>时，不会保持同步锁定，因为这将阻止某个项目返回到池中。  信号量封装了限制对池的访问所需的同步，与保持池本身一致性所需的任何同步分开。 </p>
<p>信号量被初始化为一个，并且被使用，使得它只有至多一个允许可用，可以用作互斥锁。  这通常被称为<em>二进制信号量</em> ，因为它只有两个状态：一个许可证可用，或零个许可证可用。  当以这种方式使用时，二进制信号量具有属性（与许多<a href="../../../java/util/concurrent/locks/Lock.html"><code>Lock</code></a>实现不同），“锁”可以由除所有者之外的线程释放（因为信号量没有所有权概念）。  这在某些专门的上下文中是有用的，例如死锁恢复。 </p>
<p>此类的构造函数可选择接受<em>公平</em>参数。  当设置为false时，此类不会保证线程获取许可的顺序。 特别是，  <em>闯入</em>是允许的，也就是说，一个线程调用<a href="../../../java/util/concurrent/Semaphore.html#acquire--"><code>acquire()</code></a>可以提前已经等待线程分配的许可证-在等待线程队列的头部逻辑新的线程将自己。  当公平设置为真时，信号量保证调用<a href="../../../java/util/concurrent/Semaphore.html#acquire--"><code>acquire</code></a>方法的线程被选择以按照它们调用这些方法的顺序获得许可（先进先出;  FIFO）。 请注意，FIFO排序必须适用于这些方法中的特定内部执行点。  因此，一个线程可以在另一个线程之前调用<code>acquire</code>  ，但是在另一个线程之后到达排序点，并且类似地从方法返回。 另请注意， <a href="../../../java/util/concurrent/Semaphore.html#tryAcquire--">未定义的<code>tryAcquire</code></a>方法不符合公平性设置，但将采取任何可用的许可证。 </p>
<p>通常，用于控制资源访问的信号量应该被公平地初始化，以确保线程没有被访问资源。  当使用信号量进行其他类型的同步控制时，非正常排序的吞吐量优势往往超过公平性。 </p>
<p>本课程还提供了方便的方法， <a href="../../../java/util/concurrent/Semaphore.html#acquire-int-">一次<code>acquire</code></a>和<a href="../../../java/util/concurrent/Semaphore.html#release-int-"><code>release</code></a>多个许可证。  当没有公平地使用这些方法时，请注意增加无限期延期的风险。 </p>
<p>内存一致性效应：在另一个线程中<a href="package-summary.html#MemoryVisibility">成功</a>执行“获取”方法（如<code>acquire()</code>之前，调用“释放”方法之前的线程中的操作，例如<code>release()</code>  <a href="package-summary.html#MemoryVisibility"><em>happen-before</em></a>  。 </p>

        <h2 id="7-读写锁"   >
          <a href="#7-读写锁" class="heading-link"><i class="fas fa-link"></i></a><a href="#7-读写锁" class="headerlink" title="7.读写锁"></a>7.读写锁</h2>
      
        <h3 id="ReadWriteLock"   >
          <a href="#ReadWriteLock" class="heading-link"><i class="fas fa-link"></i></a><a href="#ReadWriteLock" class="headerlink" title="ReadWriteLock"></a>ReadWriteLock</h3>
      <p>A <code>ReadWriteLock</code>维护一对关联的<a href="../../../../java/util/concurrent/locks/Lock.html"><code>locks</code></a>  ，一个用于只读操作，一个用于写入。<a href="../../../../java/util/concurrent/locks/ReadWriteLock.html#readLock--"><code>read  lock</code></a>可以由多个阅读器线程同时进行，只要没有作者。<a href="../../../../java/util/concurrent/locks/ReadWriteLock.html#writeLock--"><code>write  lock</code></a>是独家的。</p>
<p>所有<code>ReadWriteLock</code>实现必须保证的存储器同步效应<code>writeLock</code>操作（如在指定<a href="../../../../java/util/concurrent/locks/Lock.html"><code>Lock</code></a>接口）也保持相对于所述相关联的<code>readLock</code>  。 也就是说，一个线程成功获取读锁定将会看到在之前发布的写锁定所做的所有更新。 </p>
<p>读写锁允许访问共享数据时的并发性高于互斥锁所允许的并发性。 它利用了这样一个事实：一次只有一个线程（  <em>写入</em>线程）可以修改共享数据，在许多情况下，任何数量的线程都可以同时读取数据（因此<em>读取器</em>线程）。  从理论上讲，通过使用读写锁允许的并发性增加将导致性能改进超过使用互斥锁。  实际上，并发性的增加只能在多处理器上完全实现，然后只有在共享数据的访问模式是合适的时才可以。 </p>
<p>读写锁是否会提高使用互斥锁的性能取决于数据被读取的频率与被修改的频率相比，读取和写入操作的持续时间以及数据的争用 -  即是，将尝试同时读取或写入数据的线程数。  例如，最初填充数据的集合，然后经常被修改的频繁搜索（例如某种目录）是使用读写锁的理想候选。  然而，如果更新变得频繁，那么数据的大部分时间将被专门锁定，并且并发性增加很少。  此外，如果读取操作太短，则读写锁定实现（其本身比互斥锁更复杂）的开销可以支配执行成本，特别是因为许多读写锁定实现仍将序列化所有线程通过小部分代码。  最终，只有剖析和测量将确定使用读写锁是否适合您的应用程序。 </p>
<p>虽然读写锁的基本操作是直接的，但是执行必须做出许多策略决策，这可能会影响给定应用程序中读写锁定的有效性。  这些政策的例子包括： </p>
<ul>
<li>在写入器释放写入锁定时，确定在读取器和写入器都在等待时是否授予读取锁定或写入锁定。  作家偏好是常见的，因为写作预计会很短，很少见。  读者喜好不常见，因为如果读者经常和长期的预期，写作可能导致漫长的延迟。 公平的或“按顺序”的实现也是可能的。 </li>
<li>确定在读卡器处于活动状态并且写入器正在等待时请求读取锁定的读取器是否被授予读取锁定。  读者的偏好可以无限期地拖延作者，而对作者的偏好可以减少并发的潜力。 </li>
<li>确定锁是否可重入：一个具有写锁的线程是否可以重新获取？ 持有写锁可以获取读锁吗？  读锁本身是否可重入？ </li>
<li>写入锁可以降级到读锁，而不允许插入写者？ 读锁可以升级到写锁，优先于其他等待读者或作者吗？</li>
</ul>
<p>在评估应用程序的给定实现的适用性时，应考虑所有这些问题。</p>

        <h2 id="并行"   >
          <a href="#并行" class="heading-link"><i class="fas fa-link"></i></a><a href="#并行" class="headerlink" title="并行"></a>并行</h2>
      <ul>
<li><p>synchronized锁</p>
</li>
<li><p>死锁</p>
</li>
<li><p>lock锁</p>
</li>
<li><p>CopyOnWriteArrayList(实现了lock的安全类)</p>
</li>
<li><p>生产者消费者问题</p>
<ul>
<li><p>管程法</p>
<p>设计一个类，用于写产品的类型与其的操作(如购买与进货),</p>
<p>并将一个资源给生产者和消费者，完成run方法，并用synchronized锁，进行wait方法和notify()or(notifyAll())方法唤醒等待方法。</p>
</li>
</ul>
</li>
<li><p>信号灯法</p>
<p>用于两种状态，</p>
<p>如拍摄电视，拍摄成功后，由观众去观看。</p>
<p>flag记录是否完成拍摄。拍摄成功后用flag记录，并通知观众观看（notify或者notifyAll），否则观众wait()</p>
</li>
</ul>

        <h2 id="静态代理"   >
          <a href="#静态代理" class="heading-link"><i class="fas fa-link"></i></a><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h2>
      <ul>
<li><p>主体为你，由别人代理完成事情，如Runnable接口启动线程时，将实现Runnable接口的类丢进Thread()中</p>
<p>如new Thread(new ***).start();</p>
<p>***实现了Runnable接口。</p>
</li>
</ul>

        <h2 id="安全"   >
          <a href="#安全" class="heading-link"><i class="fas fa-link"></i></a><a href="#安全" class="headerlink" title="安全"></a>安全</h2>
      <ul>
<li>同步代码块</li>
<li>同步方法</li>
<li>锁</li>
</ul>

        <h2 id="Lambda表达式"   >
          <a href="#Lambda表达式" class="heading-link"><i class="fas fa-link"></i></a><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h2>
      <ul>
<li><p>函数式接口，只有一个</p>
</li>
<li><p>简化过程</p>
<p>外部类-&gt;静态内部类-&gt;局部内部类-&gt;匿名内部类-&gt;Lambda表达式</p>
</li>
<li><p>简化要素</p>
<ul>
<li>参数要么都带类型，要么都不带，多个参数应当加括号</li>
<li>如果只有一句话可以省略{}，否则是代码块W</li>
</ul>
</li>
</ul>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">theShow</span> &#123;</span><br><span class="line">    <span class="comment">//3.静态内部类</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Like2</span> <span class="keyword">implements</span> <span class="title class_">ILike</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lambda</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;i like lambda2&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        ILike like=<span class="keyword">new</span> <span class="title class_">Like</span>();</span><br><span class="line">        like.lambda();</span><br><span class="line">        like=<span class="keyword">new</span> <span class="title class_">Like2</span>();</span><br><span class="line">        like.lambda();</span><br><span class="line">        <span class="comment">//4.局部内部类</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Like3</span> <span class="keyword">implements</span> <span class="title class_">ILike</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lambda</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;i like lambda3&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        like=<span class="keyword">new</span> <span class="title class_">Like3</span>();</span><br><span class="line">        like.lambda();</span><br><span class="line">        <span class="comment">//5.匿名内部类</span></span><br><span class="line">        like=<span class="keyword">new</span> <span class="title class_">ILike</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lambda</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;i like lambda4&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        like.lambda();</span><br><span class="line">        <span class="comment">//6.用lambda简化</span></span><br><span class="line">        like=()-&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;i like lambda5&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        like.lambda();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.定义一个函数式接口</span></span><br><span class="line"><span class="keyword">interface</span>  <span class="title class_">ILike</span>&#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">lambda</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.实现类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Like</span> <span class="keyword">implements</span> <span class="title class_">ILike</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lambda</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;i like lambda1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="面"   >
          <a href="#面" class="heading-link"><i class="fas fa-link"></i></a><a href="#面" class="headerlink" title="面"></a>面</h2>
      <p>单例模式</p>
<p>排序算法</p>
<p>生产者和消费者</p>
<p>死锁</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="http://example.com">John Doe</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="http://example.com/2022/07/12/Java-SE/">http://example.com/2022/07/12/Java-SE/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><nav class="post-paginator paginator"><div class="paginator-next"><a class="paginator-next__link" href="/2022/07/12/hello-world/"><span class="paginator-prev__text">Hello World</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Java-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">
          1.Java 前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%B0%B1%E4%B8%9A%E6%96%B9%E5%90%91"><span class="toc-number">1.1.</span> <span class="toc-text">
          1.就业方向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%BC%80%E5%8F%91%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.</span> <span class="toc-text">
          2.开发场景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SSM%E7%AD%89%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.1.</span> <span class="toc-text">
          1.SSM等场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E5%8D%93%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.2.</span> <span class="toc-text">
          2.安卓场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%A7%E6%95%B0%E6%8D%AE-Hadoop"><span class="toc-number">1.2.3.</span> <span class="toc-text">
          3.大数据-Hadoop</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F"><span class="toc-number">1.3.</span> <span class="toc-text">
          3.应用领域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">
          1.企业级应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%89%E5%8D%93%E5%B9%B3%E5%8F%B0%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">
          2.安卓平台应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%A7%BB%E5%8A%A8%E9%A2%86%E5%9F%9F%E5%BA%94%E7%94%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">
          3.移动领域应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Java-%E6%A6%82%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">
          2.Java 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8E%86%E5%8F%B2"><span class="toc-number">2.1.</span> <span class="toc-text">
          1.历史</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.1.1.</span> <span class="toc-text">
          1.什么是程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Java%E8%AF%9E%E7%94%9F"><span class="toc-number">2.1.2.</span> <span class="toc-text">
          2.Java诞生</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Java-%E7%89%88%E6%9C%AC"><span class="toc-number">2.1.3.</span> <span class="toc-text">
          3.Java 版本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9"><span class="toc-number">2.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6%E5%8F%8A%E8%BF%90%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">2.3.</span> <span class="toc-text">
          3.运行机制及运行过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Java%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6-Java%E8%99%9A%E6%8B%9F%E6%9C%BA-JVM-Java-virtual-machine"><span class="toc-number">2.3.1.</span> <span class="toc-text">
          1.Java核心机制-Java虚拟机[JVM Java virtual machine]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JDK-amp-JRE"><span class="toc-number">2.3.2.</span> <span class="toc-text">
          2.JDK&amp;JRE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-JDK%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">
          1.JDK介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-JRE%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">
          2.JRE基本介绍</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-JDK-amp-JRE-amp-JVM%E5%85%B3%E7%B3%BB"><span class="toc-number">2.3.3.</span> <span class="toc-text">
          3.JDK&amp;JRE&amp;JVM关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">2.4.</span> <span class="toc-text">
          4.Java开发环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-JDK%E5%AE%89%E8%A3%85"><span class="toc-number">2.4.1.</span> <span class="toc-text">
          1.JDK安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AEPath"><span class="toc-number">2.4.2.</span> <span class="toc-text">
          2.配置Path</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Java%E5%BC%80%E5%8F%91%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">2.5.</span> <span class="toc-text">
          5.Java开发快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Java%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90"><span class="toc-number">2.5.1.</span> <span class="toc-text">
          1.Java执行流程分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BC%96%E8%AF%91"><span class="toc-number">2.5.2.</span> <span class="toc-text">
          2.什么是编译</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%90%E8%A1%8C"><span class="toc-number">2.5.3.</span> <span class="toc-text">
          3.什么是运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%BC%80%E5%8F%91%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E7%BB%86%E8%8A%82%E8%AF%B4%E6%98%8E"><span class="toc-number">2.5.4.</span> <span class="toc-text">
          4.开发注意事项和细节说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95-%E4%BB%85%E5%81%9A%E5%8F%82%E8%80%83"><span class="toc-number">2.5.5.</span> <span class="toc-text">
          5.学习方法(仅做参考)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="toc-number">2.5.6.</span> <span class="toc-text">
          6.转义字符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%98%93%E7%8A%AF%E9%94%99%E8%AF%AF"><span class="toc-number">2.5.7.</span> <span class="toc-text">
          7.易犯错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%B3%A8%E9%87%8A"><span class="toc-number">2.5.8.</span> <span class="toc-text">
          8.注释</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8D%95%E8%A1%8C%E6%B3%A8%E9%87%8A"><span class="toc-number">2.5.8.1.</span> <span class="toc-text">
          1.单行注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%A4%9A%E8%A1%8C%E6%B3%A8%E9%87%8A"><span class="toc-number">2.5.8.2.</span> <span class="toc-text">
          2.多行注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%96%87%E6%A1%A3%E6%B3%A8%E9%87%8A"><span class="toc-number">2.5.8.3.</span> <span class="toc-text">
          3.文档注释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-Java%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">2.5.9.</span> <span class="toc-text">
          9.Java代码规范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-DOS"><span class="toc-number">2.6.</span> <span class="toc-text">
          6.DOS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">2.6.1.</span> <span class="toc-text">
          1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84-%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-number">2.6.2.</span> <span class="toc-text">
          2.相对路径,绝对路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4"><span class="toc-number">2.6.3.</span> <span class="toc-text">
          2.常用指令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%8F%98%E9%87%8F"><span class="toc-number">3.</span> <span class="toc-text">
          3.变量</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8F%98%E9%87%8F%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.1.</span> <span class="toc-text">
          1.变量介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%98%E9%87%8F%E5%8E%9F%E7%90%86"><span class="toc-number">3.1.1.</span> <span class="toc-text">
          1.变量原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%98%E9%87%8F%E6%A6%82%E5%BF%B5"><span class="toc-number">3.1.2.</span> <span class="toc-text">
          2.变量概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%98%E9%87%8F%E7%BB%86%E8%8A%82"><span class="toc-number">3.1.3.</span> <span class="toc-text">
          3.变量细节</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8F%B7%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">
          2.+号的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.</span> <span class="toc-text">
          3.数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.1.</span> <span class="toc-text">
          1.整数类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B4%E5%9E%8B%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">
          1.整型使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%95%B4%E5%9E%8B%E7%BB%86%E8%8A%82"><span class="toc-number">3.3.1.2.</span> <span class="toc-text">
          2.整型细节</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%B5%AE%E7%82%B9%E6%95%B0"><span class="toc-number">3.3.2.</span> <span class="toc-text">
          2.浮点数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B5%AE%E7%82%B9%E6%95%B0%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">
          1.浮点数使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%B5%AE%E7%82%B9%E6%95%B0%E7%BB%86%E8%8A%82"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">
          2.浮点数细节</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B-char"><span class="toc-number">3.3.3.</span> <span class="toc-text">
          3.字符类型(char)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E5%9E%8B%E4%BD%BF%E7%94%A8"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">
          1.字符型使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AD%97%E7%AC%A6%E5%9E%8B%E7%BB%86%E8%8A%82"><span class="toc-number">3.3.3.2.</span> <span class="toc-text">
          2.字符型细节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%9C%AC%E8%B4%A8"><span class="toc-number">3.3.3.3.</span> <span class="toc-text">
          3.字符型本质</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8Bboolean"><span class="toc-number">3.3.4.</span> <span class="toc-text">
          4.布尔类型boolean</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BC%96%E7%A0%81"><span class="toc-number">3.4.</span> <span class="toc-text">
          4.编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-ASCII"><span class="toc-number">3.4.1.</span> <span class="toc-text">
          1.ASCII</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Unicode"><span class="toc-number">3.4.2.</span> <span class="toc-text">
          2.Unicode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-UTF-8"><span class="toc-number">3.4.3.</span> <span class="toc-text">
          3.UTF-8</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.5.</span> <span class="toc-text">
          5.数据类型转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%87%AA%E5%8A%A8%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.5.1.</span> <span class="toc-text">
          1.自动类型转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.5.2.</span> <span class="toc-text">
          2.强制类型转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8CString%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.5.3.</span> <span class="toc-text">
          3.基本数据类型和String类型的转换</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.</span> <span class="toc-text">
          4.运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.1.</span> <span class="toc-text">
          1.运算符介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.2.</span> <span class="toc-text">
          2.算术运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.3.</span> <span class="toc-text">
          3.关系运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.4.</span> <span class="toc-text">
          4.逻辑运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%9F%AD%E8%B7%AF%E4%B8%8E-%E4%B8%8E-%E9%80%BB%E8%BE%91%E4%B8%8E"><span class="toc-number">4.4.1.</span> <span class="toc-text">
          1.短路与 与 逻辑与</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%9F%AD%E8%B7%AF%E6%88%96-%E4%B8%8E-%E9%80%BB%E8%BE%91%E6%88%96"><span class="toc-number">4.4.2.</span> <span class="toc-text">
          2.短路或 与 逻辑或</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%96%E5%8F%8D"><span class="toc-number">4.4.3.</span> <span class="toc-text">
          3.取反</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.5.</span> <span class="toc-text">
          5.赋值运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">4.6.</span> <span class="toc-text">
          6.三元运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">4.7.</span> <span class="toc-text">
          7.运算符优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%A0%87%E8%AF%86%E7%AC%A6"><span class="toc-number">4.8.</span> <span class="toc-text">
          8.标识符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">4.9.</span> <span class="toc-text">
          9.关键字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E5%8E%9F%E7%A0%81-%E5%8F%8D%E7%A0%81-%E8%A1%A5%E7%A0%81"><span class="toc-number">4.10.</span> <span class="toc-text">
          10.原码,反码,补码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84-%E8%B7%B3%E8%BF%87"><span class="toc-number">5.</span> <span class="toc-text">
          5.控制结构(跳过)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.1.</span> <span class="toc-text">
          1.顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%88%86%E6%94%AF-if-else-switch"><span class="toc-number">5.2.</span> <span class="toc-text">
          2.分支(if else switch)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%BE%AA%E7%8E%AF-for-while-do-while"><span class="toc-number">5.3.</span> <span class="toc-text">
          3.循环(for while do-while)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-break"><span class="toc-number">5.4.</span> <span class="toc-text">
          4.break</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-continue"><span class="toc-number">5.5.</span> <span class="toc-text">
          5.continue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-return"><span class="toc-number">5.6.</span> <span class="toc-text">
          6.return</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E6%95%B0%E7%BB%84-%E6%8E%92%E5%BA%8F-%E6%9F%A5%E6%89%BE"><span class="toc-number">6.</span> <span class="toc-text">
          6.数组,排序,查找</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-Java-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B-%E9%AB%98%E7%BA%A7"><span class="toc-number">7.</span> <span class="toc-text">
          10.Java 面向对象编程(高级)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%B1%BB%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E6%96%B9%E6%B3%95"><span class="toc-number">7.1.</span> <span class="toc-text">
          1.类变量和类方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%8F%90%E5%87%BA%E9%97%AE%E9%A2%98"><span class="toc-number">7.1.1.</span> <span class="toc-text">
          1.提出问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B1%BB%E5%8F%98%E9%87%8F%E5%85%A5%E9%97%A8"><span class="toc-number">7.1.2.</span> <span class="toc-text">
          2.类变量入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%B1%BB%E5%8F%98%E9%87%8F%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80"><span class="toc-number">7.1.3.</span> <span class="toc-text">
          3.类变量内存布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BB%80%E4%B9%88%E6%98%AF%E7%B1%BB%E5%8F%98%E9%87%8F"><span class="toc-number">7.1.4.</span> <span class="toc-text">
          4.什么是类变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%90%86%E8%A7%A3main%E6%96%B9%E6%B3%95%E8%AF%AD%E6%B3%95"><span class="toc-number">7.2.</span> <span class="toc-text">
          2.理解main方法语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BB%A3%E7%A0%81%E5%9D%97"><span class="toc-number">7.3.</span> <span class="toc-text">
          3.代码块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%8D%95%E4%BE%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.4.</span> <span class="toc-text">
          4.单例设计模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-final%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">7.5.</span> <span class="toc-text">
          5.final关键字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%8A%BD%E8%B1%A1%E7%B1%BB"><span class="toc-number">7.6.</span> <span class="toc-text">
          6.抽象类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%8E%A5%E5%8F%A3"><span class="toc-number">7.7.</span> <span class="toc-text">
          7.接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%86%85%E9%83%A8%E7%B1%BB"><span class="toc-number">7.8.</span> <span class="toc-text">
          8.内部类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.8.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%86%E7%B1%BB"><span class="toc-number">7.8.2.</span> <span class="toc-text">
          2.分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B1%80%E9%83%A8%E5%86%85%E9%83%A8%E7%B1%BB"><span class="toc-number">7.8.3.</span> <span class="toc-text">
          3.局部内部类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%8C%BF%E5%90%8D%E5%86%85%E9%83%A8%E7%B1%BB"><span class="toc-number">7.8.4.</span> <span class="toc-text">
          4.匿名内部类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9C%AC%E8%B4%A8"><span class="toc-number">7.8.4.1.</span> <span class="toc-text">
          1.本质</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8"><span class="toc-number">7.8.4.2.</span> <span class="toc-text">
          2.使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%BB%86%E8%8A%82"><span class="toc-number">7.8.4.3.</span> <span class="toc-text">
          3.细节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%AE%9E%E8%B7%B5"><span class="toc-number">7.8.4.4.</span> <span class="toc-text">
          4.实践</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%88%90%E5%91%98%E5%86%85%E9%83%A8%E7%B1%BB"><span class="toc-number">7.8.5.</span> <span class="toc-text">
          5.成员内部类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E9%9D%99%E6%80%81%E5%86%85%E9%83%A8%E7%B1%BB"><span class="toc-number">7.8.6.</span> <span class="toc-text">
          6.静态内部类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E9%9B%86%E5%90%88"><span class="toc-number">8.</span> <span class="toc-text">
          Java 集合</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E7%BB%84%E4%B8%8E%E9%9B%86%E5%90%88%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">8.1.</span> <span class="toc-text">
          1.数组与集合的比较</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">8.1.1.</span> <span class="toc-text">
          数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88"><span class="toc-number">8.1.2.</span> <span class="toc-text">
          集合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%9B%86%E5%90%88%E4%BD%93%E7%B3%BB%E6%A1%86%E6%9E%B6"><span class="toc-number">8.2.</span> <span class="toc-text">
          2.集合体系框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Collection"><span class="toc-number">8.3.</span> <span class="toc-text">
          3.Collection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0"><span class="toc-number">8.3.1.</span> <span class="toc-text">
          1.概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">8.3.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Collection%E9%81%8D%E5%8E%86"><span class="toc-number">8.3.3.</span> <span class="toc-text">
          3.Collection遍历</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Iterator"><span class="toc-number">8.3.3.1.</span> <span class="toc-text">
          1.Iterator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%A2%9E%E5%BC%BAfor%E5%BE%AA%E7%8E%AF"><span class="toc-number">8.3.3.2.</span> <span class="toc-text">
          2.增强for循环</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-List"><span class="toc-number">8.3.4.</span> <span class="toc-text">
          4.List</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">8.3.4.1.</span> <span class="toc-text">
          1.常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%81%8D%E5%8E%86"><span class="toc-number">8.3.4.2.</span> <span class="toc-text">
          2.遍历</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8Iterator"><span class="toc-number">8.3.4.2.1.</span> <span class="toc-text">
          1.使用Iterator</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8%E5%A2%9E%E5%BC%BAfor"><span class="toc-number">8.3.4.2.2.</span> <span class="toc-text">
          2.使用增强for</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8%E6%99%AE%E9%80%9Afor"><span class="toc-number">8.3.4.2.3.</span> <span class="toc-text">
          3.使用普通for</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-ArrayList"><span class="toc-number">8.3.4.3.</span> <span class="toc-text">
          3.ArrayList</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%89%B9%E7%82%B9"><span class="toc-number">8.3.4.3.1.</span> <span class="toc-text">
          1.特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">8.3.4.3.2.</span> <span class="toc-text">
          2.源码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6"><span class="toc-number">8.3.4.3.2.1.</span> <span class="toc-text">
          1.扩容机制</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%80%BB%E7%BB%93"><span class="toc-number">8.3.4.3.3.</span> <span class="toc-text">
          3.总结</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-LinkedList"><span class="toc-number">8.3.4.4.</span> <span class="toc-text">
          4.LinkedList</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%89%B9%E7%82%B9-1"><span class="toc-number">8.3.4.4.1.</span> <span class="toc-text">
          1.特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E4%B8%8EArrayList%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">8.3.4.4.2.</span> <span class="toc-text">
          2.与ArrayList的比较</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">8.3.4.4.3.</span> <span class="toc-text">
          3.源码分析</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Vector"><span class="toc-number">8.3.4.5.</span> <span class="toc-text">
          5.Vector</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D-1"><span class="toc-number">8.3.4.5.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E4%B8%8EArrayList%E6%AF%94%E8%BE%83"><span class="toc-number">8.3.4.5.2.</span> <span class="toc-text">
          2.与ArrayList比较</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-1"><span class="toc-number">8.3.4.5.3.</span> <span class="toc-text">
          3.源码分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Set"><span class="toc-number">8.3.5.</span> <span class="toc-text">
          5.Set</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0-1"><span class="toc-number">8.3.5.1.</span> <span class="toc-text">
          1.概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-1"><span class="toc-number">8.3.5.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%81%8D%E5%8E%86"><span class="toc-number">8.3.5.3.</span> <span class="toc-text">
          3.遍历</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-HashSet"><span class="toc-number">8.3.5.4.</span> <span class="toc-text">
          4.HashSet</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E"><span class="toc-number">8.3.5.4.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-1"><span class="toc-number">8.3.5.4.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-2"><span class="toc-number">8.3.5.4.3.</span> <span class="toc-text">
          3.源码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="toc-number">8.3.5.4.3.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-add%E6%96%B9%E6%B3%95"><span class="toc-number">8.3.5.4.3.2.</span> <span class="toc-text">
          2.add方法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E6%89%A9%E5%AE%B9%E8%AF%B4%E6%98%8E"><span class="toc-number">8.3.5.4.3.3.</span> <span class="toc-text">
          3.扩容说明</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93"><span class="toc-number">8.3.5.4.4.</span> <span class="toc-text">
          4.总结</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-LinkedHashSet"><span class="toc-number">8.3.5.5.</span> <span class="toc-text">
          5.LinkedHashSet</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-1"><span class="toc-number">8.3.5.5.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-2"><span class="toc-number">8.3.5.5.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81"><span class="toc-number">8.3.5.5.3.</span> <span class="toc-text">
          3.源码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93-1"><span class="toc-number">8.3.5.5.4.</span> <span class="toc-text">
          4.总结</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-TreeSet"><span class="toc-number">8.3.5.6.</span> <span class="toc-text">
          6.TreeSet</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-2"><span class="toc-number">8.3.5.6.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-3"><span class="toc-number">8.3.5.6.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81-1"><span class="toc-number">8.3.5.6.3.</span> <span class="toc-text">
          3.源码</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-number">8.3.5.6.3.1.</span> <span class="toc-text">
          1.构造器</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-add%E6%96%B9%E6%B3%95-1"><span class="toc-number">8.3.5.6.3.2.</span> <span class="toc-text">
          2.add方法</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E4%BD%BF%E7%94%A8"><span class="toc-number">8.3.5.6.4.</span> <span class="toc-text">
          4.使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E6%80%BB%E7%BB%93"><span class="toc-number">8.3.5.6.5.</span> <span class="toc-text">
          5.总结</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Map"><span class="toc-number">8.4.</span> <span class="toc-text">
          4.Map</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-3"><span class="toc-number">8.4.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-4"><span class="toc-number">8.4.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">8.4.3.</span> <span class="toc-text">
          3.常用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Map%E9%81%8D%E5%8E%86%E6%96%B9%E5%BC%8F-%E5%85%AD%E7%A7%8D"><span class="toc-number">8.4.4.</span> <span class="toc-text">
          4.Map遍历方式(六种)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-HashMap"><span class="toc-number">8.4.5.</span> <span class="toc-text">
          5.HashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-4"><span class="toc-number">8.4.5.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-5"><span class="toc-number">8.4.5.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81-2"><span class="toc-number">8.4.5.3.</span> <span class="toc-text">
          3.源码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6-1"><span class="toc-number">8.4.5.3.1.</span> <span class="toc-text">
          1.扩容机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-put%E6%96%B9%E6%B3%95"><span class="toc-number">8.4.5.3.2.</span> <span class="toc-text">
          2.put方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-resize%E6%96%B9%E6%B3%95"><span class="toc-number">8.4.5.3.3.</span> <span class="toc-text">
          3.resize方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E6%A0%91%E5%8C%96treeifyBin"><span class="toc-number">8.4.5.3.4.</span> <span class="toc-text">
          4.树化treeifyBin</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93-2"><span class="toc-number">8.4.5.4.</span> <span class="toc-text">
          4.总结</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%BA%95%E5%B1%82%E6%9C%BA%E5%88%B6"><span class="toc-number">8.4.5.4.1.</span> <span class="toc-text">
          1.底层机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%AF%B4%E6%98%8E"><span class="toc-number">8.4.5.4.2.</span> <span class="toc-text">
          2.说明:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-HashTable"><span class="toc-number">8.4.6.</span> <span class="toc-text">
          6.HashTable</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-5"><span class="toc-number">8.4.6.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-6"><span class="toc-number">8.4.6.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81-3"><span class="toc-number">8.4.6.3.</span> <span class="toc-text">
          3.源码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0"><span class="toc-number">8.4.6.3.1.</span> <span class="toc-text">
          1.构造</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-put%E6%96%B9%E6%B3%95-1"><span class="toc-number">8.4.6.3.2.</span> <span class="toc-text">
          2.put方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%89%A9%E5%AE%B9"><span class="toc-number">8.4.6.3.3.</span> <span class="toc-text">
          3.扩容</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93-3"><span class="toc-number">8.4.6.4.</span> <span class="toc-text">
          4.总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%B8%8EHashMap%E6%AF%94%E8%BE%83"><span class="toc-number">8.4.6.5.</span> <span class="toc-text">
          5.与HashMap比较</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Properties"><span class="toc-number">8.4.7.</span> <span class="toc-text">
          7.Properties</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-6"><span class="toc-number">8.4.7.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-7"><span class="toc-number">8.4.7.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81-%E6%97%A0"><span class="toc-number">8.4.7.3.</span> <span class="toc-text">
          3.源码(无)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93-4"><span class="toc-number">8.4.7.4.</span> <span class="toc-text">
          4.总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-TreeMap"><span class="toc-number">8.4.8.</span> <span class="toc-text">
          8.TreeMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-7"><span class="toc-number">8.4.8.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-8"><span class="toc-number">8.4.8.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81-4"><span class="toc-number">8.4.8.3.</span> <span class="toc-text">
          3.源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93-5"><span class="toc-number">8.4.8.4.</span> <span class="toc-text">
          4.总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LinkedHashMap"><span class="toc-number">8.4.9.</span> <span class="toc-text">
          LinkedHashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-8"><span class="toc-number">8.4.9.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%89%B9%E7%82%B9-9"><span class="toc-number">8.4.9.2.</span> <span class="toc-text">
          2.特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%BA%90%E7%A0%81-5"><span class="toc-number">8.4.9.3.</span> <span class="toc-text">
          3.源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%80%BB%E7%BB%93-6"><span class="toc-number">8.4.9.4.</span> <span class="toc-text">
          4.总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%9B%86%E5%90%88%E6%80%BB%E7%BB%93"><span class="toc-number">8.5.</span> <span class="toc-text">
          5.集合总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Collections"><span class="toc-number">8.6.</span> <span class="toc-text">
          6.Collections</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D-2"><span class="toc-number">8.6.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%93%8D%E4%BD%9C"><span class="toc-number">8.6.2.</span> <span class="toc-text">
          2.操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%8E%92%E5%BA%8F%E6%93%8D%E4%BD%9C-%E5%9D%87%E4%B8%BAstatic%E6%96%B9%E6%B3%95"><span class="toc-number">8.6.2.1.</span> <span class="toc-text">
          1.排序操作:(均为static方法)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E6%89%BE%E3%80%81%E6%9B%BF%E6%8D%A2"><span class="toc-number">8.6.2.2.</span> <span class="toc-text">
          2.查找、替换</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-IO%E6%B5%81"><span class="toc-number">9.</span> <span class="toc-text">
          Java IO流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%96%87%E4%BB%B6"><span class="toc-number">9.1.</span> <span class="toc-text">
          1.文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%96%87%E4%BB%B6"><span class="toc-number">9.1.1.</span> <span class="toc-text">
          1.什么是文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E6%B5%81"><span class="toc-number">9.1.2.</span> <span class="toc-text">
          2.文件流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">9.1.3.</span> <span class="toc-text">
          3.文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA"><span class="toc-number">9.1.3.1.</span> <span class="toc-text">
          1.文件创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96"><span class="toc-number">9.1.3.2.</span> <span class="toc-text">
          2.文件信息获取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E4%B8%8E%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4"><span class="toc-number">9.1.3.3.</span> <span class="toc-text">
          3.目录操作与文件删除</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-IO%E6%B5%81%E5%8E%9F%E7%90%86%E5%8F%8A%E6%B5%81%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">9.2.</span> <span class="toc-text">
          2.IO流原理及流的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-IO%E6%B5%81%E5%8E%9F%E7%90%86"><span class="toc-number">9.2.1.</span> <span class="toc-text">
          1.IO流原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%B5%81%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">9.2.2.</span> <span class="toc-text">
          2.流的分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%8A%82%E7%82%B9%E6%B5%81%E5%92%8C%E5%A4%84%E7%90%86%E6%B5%81-%E5%8C%85%E8%A3%85%E6%B5%81"><span class="toc-number">9.3.</span> <span class="toc-text">
          3.节点流和处理流(包装流)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D-3"><span class="toc-number">9.3.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%8A%82%E7%82%B9%E6%B5%81%E4%B8%8E%E5%A4%84%E7%90%86%E6%B5%81%E5%9B%BE%E8%BF%B0"><span class="toc-number">9.3.2.</span> <span class="toc-text">
          2.节点流与处理流图述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%8A%82%E7%82%B9%E6%B5%81%E5%92%8C%E5%A4%84%E7%90%86%E6%B5%81%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB%E4%B8%8E%E5%8A%9F%E8%83%BD"><span class="toc-number">9.3.3.</span> <span class="toc-text">
          3.节点流和处理流的区别和联系与功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%BE%93%E5%85%A5%E6%B5%81"><span class="toc-number">9.4.</span> <span class="toc-text">
          4.输入流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-InputStream-%E5%AD%97%E8%8A%82"><span class="toc-number">9.4.1.</span> <span class="toc-text">
          1.InputStream(字节)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-FileInputStream-%E6%96%87%E4%BB%B6%E8%BE%93%E5%85%A5%E6%B5%81"><span class="toc-number">9.4.1.1.</span> <span class="toc-text">
          1.FileInputStream(文件输入流)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-1"><span class="toc-number">9.4.1.1.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-2"><span class="toc-number">9.4.1.1.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">9.4.1.1.3.</span> <span class="toc-text">
          3.示例</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#read"><span class="toc-number">9.4.1.1.3.1.</span> <span class="toc-text">
          read</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-BufferedInputStream-%E7%BC%93%E5%86%B2%E5%AD%97%E8%8A%82%E8%BE%93%E5%85%A5%E6%B5%81"><span class="toc-number">9.4.1.2.</span> <span class="toc-text">
          2.BufferedInputStream(缓冲字节输入流)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-2"><span class="toc-number">9.4.1.2.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-3"><span class="toc-number">9.4.1.2.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-1"><span class="toc-number">9.4.1.2.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-ObjectInputStream-%E5%AF%B9%E8%B1%A1%E5%AD%97%E8%8A%82%E8%BE%93%E5%85%A5%E6%B5%81"><span class="toc-number">9.4.1.3.</span> <span class="toc-text">
          3.ObjectInputStream(对象字节输入流)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-3"><span class="toc-number">9.4.1.3.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-4"><span class="toc-number">9.4.1.3.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-2"><span class="toc-number">9.4.1.3.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Reader-%E5%AD%97%E7%AC%A6"><span class="toc-number">9.4.2.</span> <span class="toc-text">
          2.Reader(字符)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-FileReader"><span class="toc-number">9.4.2.1.</span> <span class="toc-text">
          1.FileReader</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-4"><span class="toc-number">9.4.2.1.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-5"><span class="toc-number">9.4.2.1.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-3"><span class="toc-number">9.4.2.1.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-BufferedReader"><span class="toc-number">9.4.2.2.</span> <span class="toc-text">
          2.BufferedReader</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-5"><span class="toc-number">9.4.2.2.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-6"><span class="toc-number">9.4.2.2.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-4"><span class="toc-number">9.4.2.2.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-InputStreamReader"><span class="toc-number">9.4.2.3.</span> <span class="toc-text">
          3.InputStreamReader</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-6"><span class="toc-number">9.4.2.3.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-7"><span class="toc-number">9.4.2.3.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-5"><span class="toc-number">9.4.2.3.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%BE%93%E5%87%BA%E6%B5%81"><span class="toc-number">9.5.</span> <span class="toc-text">
          5.输出流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-OutputStream-%E5%AD%97%E8%8A%82"><span class="toc-number">9.5.1.</span> <span class="toc-text">
          1.OutputStream(字节)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-FileOutputStream"><span class="toc-number">9.5.1.1.</span> <span class="toc-text">
          1.FileOutputStream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-7"><span class="toc-number">9.5.1.1.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-8"><span class="toc-number">9.5.1.1.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-6"><span class="toc-number">9.5.1.1.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-BufferedOutputStream"><span class="toc-number">9.5.1.2.</span> <span class="toc-text">
          2.BufferedOutputStream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-8"><span class="toc-number">9.5.1.2.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-9"><span class="toc-number">9.5.1.2.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-7"><span class="toc-number">9.5.1.2.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-ObjectOutputStream"><span class="toc-number">9.5.1.3.</span> <span class="toc-text">
          3.ObjectOutputStream</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-9"><span class="toc-number">9.5.1.3.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-10"><span class="toc-number">9.5.1.3.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-8"><span class="toc-number">9.5.1.3.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Writer-%E5%AD%97%E7%AC%A6"><span class="toc-number">9.5.2.</span> <span class="toc-text">
          2.Writer(字符)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-FileWriter"><span class="toc-number">9.5.2.1.</span> <span class="toc-text">
          1.FileWriter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-10"><span class="toc-number">9.5.2.1.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-11"><span class="toc-number">9.5.2.1.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-9"><span class="toc-number">9.5.2.1.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-BufferedWriter"><span class="toc-number">9.5.2.2.</span> <span class="toc-text">
          2.BufferedWriter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-11"><span class="toc-number">9.5.2.2.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-12"><span class="toc-number">9.5.2.2.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-10"><span class="toc-number">9.5.2.2.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-OutputStreamWriter"><span class="toc-number">9.5.2.3.</span> <span class="toc-text">
          3.OutputStreamWriter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95-12"><span class="toc-number">9.5.2.3.1.</span> <span class="toc-text">
          1.构造方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-13"><span class="toc-number">9.5.2.3.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%A4%BA%E4%BE%8B-11"><span class="toc-number">9.5.2.3.3.</span> <span class="toc-text">
          3.示例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Properties%E7%B1%BB"><span class="toc-number">9.6.</span> <span class="toc-text">
          6.Properties类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="toc-number">9.7.</span> <span class="toc-text">
          7.综合示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%96%87%E4%BB%B6%E6%B5%81"><span class="toc-number">9.7.1.</span> <span class="toc-text">
          1.文件流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-FileInputStream%E5%92%8CFileOutputStream"><span class="toc-number">9.7.1.1.</span> <span class="toc-text">
          1.FileInputStream和FileOutputStream</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-FileReader%E5%92%8CFileWriter"><span class="toc-number">9.7.1.2.</span> <span class="toc-text">
          2.FileReader和FileWriter</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BC%93%E5%86%B2%E6%B5%81"><span class="toc-number">9.7.2.</span> <span class="toc-text">
          2.缓冲流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#BufferedInputStream%E4%B8%8EBufferedOutputStream"><span class="toc-number">9.7.2.1.</span> <span class="toc-text">
          BufferedInputStream与BufferedOutputStream</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BufferedWriter%E4%B8%8EBufferedReader"><span class="toc-number">9.7.2.2.</span> <span class="toc-text">
          BufferedWriter与BufferedReader</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%B9%E8%B1%A1%E5%A4%84%E7%90%86%E6%B5%81"><span class="toc-number">9.7.3.</span> <span class="toc-text">
          3.对象处理流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">9.7.3.1.</span> <span class="toc-text">
          序列化和反序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">9.7.3.2.</span> <span class="toc-text">
          注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%B5%81"><span class="toc-number">9.7.4.</span> <span class="toc-text">
          4.标准输入输出流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%BD%AC%E6%8D%A2%E6%B5%81"><span class="toc-number">9.7.5.</span> <span class="toc-text">
          5.转换流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8E%9F%E5%9B%A0"><span class="toc-number">9.7.5.1.</span> <span class="toc-text">
          1.原因</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-InputStreamReader-amp-OutputStreamWriter%E4%BB%8B%E7%BB%8D"><span class="toc-number">9.7.5.2.</span> <span class="toc-text">
          2.InputStreamReader&amp;OutputStreamWriter介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-InputStreamReader-1"><span class="toc-number">9.7.5.3.</span> <span class="toc-text">
          3.InputStreamReader</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E5%BC%8F"><span class="toc-number">9.7.5.3.1.</span> <span class="toc-text">
          1.构造方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-14"><span class="toc-number">9.7.5.3.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%AE%9E%E4%BE%8B"><span class="toc-number">9.7.5.3.3.</span> <span class="toc-text">
          3.实例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-OutputStreamWriter"><span class="toc-number">9.7.5.4.</span> <span class="toc-text">
          4.OutputStreamWriter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%9E%84%E9%80%A0%E6%96%B9%E5%BC%8F-1"><span class="toc-number">9.7.5.4.1.</span> <span class="toc-text">
          1.构造方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-15"><span class="toc-number">9.7.5.4.2.</span> <span class="toc-text">
          2.常用方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">9.7.5.4.3.</span> <span class="toc-text">
          3.实例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%89%93%E5%8D%B0%E6%B5%81"><span class="toc-number">9.7.6.</span> <span class="toc-text">
          6.打印流</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-PrintStream-%E5%AD%97%E8%8A%82%E6%B5%81"><span class="toc-number">9.7.6.1.</span> <span class="toc-text">
          1.PrintStream(字节流)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-PrintWriter-%E5%AD%97%E7%AC%A6%E6%B5%81"><span class="toc-number">9.7.6.2.</span> <span class="toc-text">
          2.PrintWriter(字符流)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Properties%E7%B1%BB%E8%AF%BB%E5%8F%96"><span class="toc-number">9.7.7.</span> <span class="toc-text">
          7.Properties类读取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BC%A0%E7%BB%9F%E5%AE%9E%E7%8E%B0"><span class="toc-number">9.7.7.1.</span> <span class="toc-text">
          1.传统实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Properties%E7%B1%BB"><span class="toc-number">9.7.7.2.</span> <span class="toc-text">
          2.Properties类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D-4"><span class="toc-number">9.7.7.2.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-16"><span class="toc-number">9.7.7.2.2.</span> <span class="toc-text">
          2.常用方法</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-Thread-%E5%9F%BA%E7%A1%80"><span class="toc-number">10.</span> <span class="toc-text">
          Java Thread(基础)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">10.1.</span> <span class="toc-text">
          1.基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%BA%BF%E7%A8%8B"><span class="toc-number">10.2.</span> <span class="toc-text">
          2.线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%96%B9%E5%BC%8F"><span class="toc-number">10.2.1.</span> <span class="toc-text">
          1.创建线程基本方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BB%A7%E6%89%BFThread%E7%B1%BB-%E9%87%8D%E5%86%99run%E6%96%B9%E6%B3%95"><span class="toc-number">10.2.1.1.</span> <span class="toc-text">
          1.继承Thread类,重写run方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-9"><span class="toc-number">10.2.1.1.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%AE%9E%E4%BE%8B"><span class="toc-number">10.2.1.1.2.</span> <span class="toc-text">
          2.实例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%9E%E7%8E%B0Runnable%E6%8E%A5%E5%8F%A3-%E9%87%8D%E5%86%99run%E6%96%B9%E6%B3%95"><span class="toc-number">10.2.1.2.</span> <span class="toc-text">
          2.实现Runnable接口,重写run方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-10"><span class="toc-number">10.2.1.2.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">10.2.1.2.2.</span> <span class="toc-text">
          2.实例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%9C%BA%E5%88%B6"><span class="toc-number">10.2.2.</span> <span class="toc-text">
          2.多线程机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AFstart"><span class="toc-number">10.2.3.</span> <span class="toc-text">
          3.为什么是start</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E4%B8%83%E5%A4%A7%E7%8A%B6%E6%80%81"><span class="toc-number">10.3.</span> <span class="toc-text">
          线程七大状态</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E5%9B%BE"><span class="toc-number">10.3.1.</span> <span class="toc-text">
          1.线程状态转换图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%9E%E4%BE%8B-2"><span class="toc-number">10.3.2.</span> <span class="toc-text">
          2.实例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B"><span class="toc-number">11.</span> <span class="toc-text">
          Java 网络编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BD%91%E7%BB%9C%E6%A6%82%E5%BF%B5"><span class="toc-number">11.1.</span> <span class="toc-text">
          1.网络概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1"><span class="toc-number">11.1.1.</span> <span class="toc-text">
          1.网络通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BD%91%E7%BB%9C"><span class="toc-number">11.1.2.</span> <span class="toc-text">
          2.网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-IP%E5%9C%B0%E5%9D%80"><span class="toc-number">11.1.3.</span> <span class="toc-text">
          3.IP地址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ip%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB"><span class="toc-number">11.1.3.1.</span> <span class="toc-text">
          ip地址分类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9F%9F%E5%90%8D"><span class="toc-number">11.1.4.</span> <span class="toc-text">
          4.域名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="toc-number">11.1.5.</span> <span class="toc-text">
          5.端口号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE"><span class="toc-number">11.1.6.</span> <span class="toc-text">
          6.网络通信协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-TCP%E4%B8%8EUDP"><span class="toc-number">11.1.7.</span> <span class="toc-text">
          7.TCP与UDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-InetAddress%E7%B1%BB"><span class="toc-number">11.1.8.</span> <span class="toc-text">
          8.InetAddress类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%9B%B8%E5%85%B3%E6%96%B9%E6%B3%95"><span class="toc-number">11.1.8.1.</span> <span class="toc-text">
          1.相关方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%A4%BA%E4%BE%8B"><span class="toc-number">11.1.8.2.</span> <span class="toc-text">
          2.示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-Socket"><span class="toc-number">11.1.9.</span> <span class="toc-text">
          9.Socket</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">11.1.9.1.</span> <span class="toc-text">
          1.基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-TCP%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E7%BC%96%E7%A8%8B"><span class="toc-number">11.1.9.2.</span> <span class="toc-text">
          2.TCP网络通信编程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-UDP%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E7%BC%96%E7%A8%8B"><span class="toc-number">11.1.9.3.</span> <span class="toc-text">
          3.UDP网络通信编程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-TCP%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E7%BC%96%E7%A8%8B-1"><span class="toc-number">11.2.</span> <span class="toc-text">
          2.TCP网络通信编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AE%9E%E4%BE%8B1-%E5%AD%97%E8%8A%82%E6%B5%81"><span class="toc-number">11.2.1.</span> <span class="toc-text">
          1.实例1(字节流)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%9E%E4%BE%8B2-%E5%AD%97%E8%8A%82%E6%B5%81"><span class="toc-number">11.2.2.</span> <span class="toc-text">
          2.实例2(字节流)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%9E%E4%BE%8B3-%E5%AD%97%E7%AC%A6%E6%B5%81"><span class="toc-number">11.2.3.</span> <span class="toc-text">
          3.实例3(字符流)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AE%9E%E4%BE%8B4-%E7%BD%91%E7%BB%9C%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="toc-number">11.2.4.</span> <span class="toc-text">
          4.实例4(网络上传文件)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-netstat-%E6%8C%87%E4%BB%A4"><span class="toc-number">11.2.5.</span> <span class="toc-text">
          5.netstat 指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AF%B4%E6%98%8E"><span class="toc-number">11.2.6.</span> <span class="toc-text">
          6.说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-UDP%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E7%BC%96%E7%A8%8B-1"><span class="toc-number">11.3.</span> <span class="toc-text">
          3.UDP网络通信编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%AF%B4%E6%98%8E-11"><span class="toc-number">11.3.1.</span> <span class="toc-text">
          1.说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">11.3.2.</span> <span class="toc-text">
          2.基本流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%9E%E4%BE%8B1"><span class="toc-number">11.3.3.</span> <span class="toc-text">
          3.实例1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BB%83%E4%B9%A0"><span class="toc-number">11.4.</span> <span class="toc-text">
          4.练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">11.4.1.</span> <span class="toc-text">
          1.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">11.4.2.</span> <span class="toc-text">
          2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">11.4.3.</span> <span class="toc-text">
          3.下载文件的应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Java%E5%A4%9A%E7%94%A8%E6%88%B7%E9%80%9A%E4%BF%A1%E7%B3%BB%E7%BB%9F"><span class="toc-number">11.5.</span> <span class="toc-text">
          5.Java多用户通信系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">11.5.1.</span> <span class="toc-text">
          1.需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90"><span class="toc-number">11.5.2.</span> <span class="toc-text">
          2.系统分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-QQ%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-number">11.5.3.</span> <span class="toc-text">
          3.QQ用户登录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">11.5.3.1.</span> <span class="toc-text">
          1.客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%AF%BB%E5%8F%96%E8%BE%93%E5%85%A5%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-number">11.5.3.1.1.</span> <span class="toc-text">
          1.读取输入工具类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%8F%9C%E5%8D%95"><span class="toc-number">11.5.3.1.2.</span> <span class="toc-text">
          2.菜单</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C"><span class="toc-number">11.5.3.1.3.</span> <span class="toc-text">
          3.登录注册</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E7%BA%BF%E7%A8%8B%E6%8C%81%E6%9C%89socket"><span class="toc-number">11.5.3.1.4.</span> <span class="toc-text">
          4.线程持有socket</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E7%AE%A1%E7%90%86%E7%BA%BF%E7%A8%8B"><span class="toc-number">11.5.3.1.5.</span> <span class="toc-text">
          5.管理线程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">11.5.3.2.</span> <span class="toc-text">
          2.服务端</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3-%E7%AD%89%E5%BE%85%E8%BF%9E%E6%8E%A5"><span class="toc-number">11.5.3.2.1.</span> <span class="toc-text">
          1.监听端口,等待连接</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E9%AA%8C%E8%AF%81%E6%88%90%E5%8A%9F-%E7%BA%BF%E7%A8%8B%E6%8C%81%E6%9C%89socket"><span class="toc-number">11.5.3.2.2.</span> <span class="toc-text">
          2.验证成功,线程持有socket</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%AE%A1%E7%90%86%E7%BA%BF%E7%A8%8B"><span class="toc-number">11.5.3.2.3.</span> <span class="toc-text">
          3.管理线程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8B%89%E5%8F%96%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7"><span class="toc-number">11.5.4.</span> <span class="toc-text">
          4.拉取在线用户</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8F%91%E9%80%81%E8%8E%B7%E5%BE%97%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8%E7%9A%84%E8%AF%B7%E6%B1%82-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">11.5.4.1.</span> <span class="toc-text">
          1.发送获得在线用户列表的请求(客户端)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%BF%94%E5%9B%9E%E7%9B%B8%E5%BA%94%E4%BF%A1%E6%81%AF-%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">11.5.4.2.</span> <span class="toc-text">
          2.返回相应信息(服务端)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%97%A0%E5%BC%82%E5%B8%B8%E9%80%80%E5%87%BA%E7%B3%BB%E7%BB%9F"><span class="toc-number">11.5.5.</span> <span class="toc-text">
          5.无异常退出系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%80%9D%E8%B7%AF"><span class="toc-number">11.5.5.1.</span> <span class="toc-text">
          1.思路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="toc-number">11.5.5.2.</span> <span class="toc-text">
          2.客户端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="toc-number">11.5.5.3.</span> <span class="toc-text">
          3.服务端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%A7%81%E8%81%8A"><span class="toc-number">11.5.6.</span> <span class="toc-text">
          6.私聊</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-number">11.5.6.1.</span> <span class="toc-text">
          1.思路分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">11.5.6.2.</span> <span class="toc-text">
          2.客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">11.5.6.3.</span> <span class="toc-text">
          3.服务端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E7%BE%A4%E5%8F%91"><span class="toc-number">11.5.7.</span> <span class="toc-text">
          7.群发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%A2%E6%88%B7%E7%AB%AF-1"><span class="toc-number">11.5.7.1.</span> <span class="toc-text">
          1.客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9C%8D%E5%8A%A1%E7%AB%AF-1"><span class="toc-number">11.5.7.2.</span> <span class="toc-text">
          2.服务端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%8F%91%E6%96%87%E4%BB%B6"><span class="toc-number">11.5.8.</span> <span class="toc-text">
          8.发文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90-1"><span class="toc-number">11.5.8.1.</span> <span class="toc-text">
          1.思路分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%A2%E6%88%B7%E7%AB%AF-1"><span class="toc-number">11.5.8.2.</span> <span class="toc-text">
          2.客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9C%8D%E5%8A%A1%E7%AB%AF-1"><span class="toc-number">11.5.8.3.</span> <span class="toc-text">
          3.服务端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%8E%A8%E9%80%81%E6%96%B0%E9%97%BB"><span class="toc-number">11.5.9.</span> <span class="toc-text">
          9.服务端推送新闻</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90-2"><span class="toc-number">11.5.9.1.</span> <span class="toc-text">
          1.思路分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%A2%E6%88%B7%E7%AB%AF-2"><span class="toc-number">11.5.9.2.</span> <span class="toc-text">
          2.客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9C%8D%E5%8A%A1%E7%AB%AF-2"><span class="toc-number">11.5.9.3.</span> <span class="toc-text">
          3.服务端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%A6%BB%E7%BA%BF%E7%95%99%E8%A8%80%E5%92%8C%E5%8F%91%E6%96%87%E4%BB%B6"><span class="toc-number">11.5.10.</span> <span class="toc-text">
          10.离线留言和发文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90-3"><span class="toc-number">11.5.10.1.</span> <span class="toc-text">
          1.思路分析</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E5%8F%8D%E5%B0%84"><span class="toc-number">12.</span> <span class="toc-text">
          Java 反射</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0-2"><span class="toc-number">12.1.</span> <span class="toc-text">
          1.概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%9C%89%E5%8F%8D%E5%B0%84"><span class="toc-number">12.1.1.</span> <span class="toc-text">
          1.为什么有反射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">12.1.2.</span> <span class="toc-text">
          2.快速入门</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6"><span class="toc-number">12.2.</span> <span class="toc-text">
          2.反射机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%8D%E5%B0%84%E5%8E%9F%E7%90%86%E5%9B%BE"><span class="toc-number">12.2.1.</span> <span class="toc-text">
          1,反射原理图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%8D%E5%B0%84%E5%8A%9F%E8%83%BD"><span class="toc-number">12.2.2.</span> <span class="toc-text">
          2.反射功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%8D%E5%B0%84%E7%9B%B8%E5%85%B3%E7%B1%BB"><span class="toc-number">12.2.3.</span> <span class="toc-text">
          3.反射相关类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%8F%8D%E5%B0%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">12.2.4.</span> <span class="toc-text">
          4.反射优缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%8F%8D%E5%B0%84%E8%B0%83%E7%94%A8%E4%BC%98%E5%8C%96"><span class="toc-number">12.2.5.</span> <span class="toc-text">
          5.反射调用优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Class%E7%B1%BB"><span class="toc-number">12.3.</span> <span class="toc-text">
          3.Class类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Class%E7%B1%BB%E5%88%86%E6%9E%90"><span class="toc-number">12.3.1.</span> <span class="toc-text">
          1.Class类分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Class%E7%B1%BB%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">12.3.2.</span> <span class="toc-text">
          2.Class类常用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%8E%B7%E5%8F%96Class%E7%B1%BB%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%AD%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">12.3.3.</span> <span class="toc-text">
          3.获取Class类对象的六种方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8B%A5%E6%9C%89Class%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">12.3.4.</span> <span class="toc-text">
          4.拥有Class对象的类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%B1%BB%E5%8A%A0%E8%BD%BD"><span class="toc-number">12.4.</span> <span class="toc-text">
          4.类加载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8A%A8%E6%80%81%E5%92%8C%E9%9D%99%E6%80%81%E5%8A%A0%E8%BD%BD"><span class="toc-number">12.4.1.</span> <span class="toc-text">
          1.动态和静态加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">12.4.2.</span> <span class="toc-text">
          2.类加载流程图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E7%9A%84%E4%BA%94%E4%B8%AA%E9%98%B6%E6%AE%B5"><span class="toc-number">12.4.3.</span> <span class="toc-text">
          3.类加载的五个阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8A%A0%E8%BD%BD%E9%98%B6%E6%AE%B5"><span class="toc-number">12.4.3.1.</span> <span class="toc-text">
          1.加载阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%AA%8C%E8%AF%81%E9%98%B6%E6%AE%B5"><span class="toc-number">12.4.3.2.</span> <span class="toc-text">
          2.验证阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5"><span class="toc-number">12.4.3.3.</span> <span class="toc-text">
          3.准备阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%A7%A3%E6%9E%90%E9%98%B6%E6%AE%B5"><span class="toc-number">12.4.3.4.</span> <span class="toc-text">
          4.解析阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%98%B6%E6%AE%B5"><span class="toc-number">12.4.3.5.</span> <span class="toc-text">
          5.初始化阶段</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%8E%B7%E5%8F%96%E7%B1%BB%E7%BB%93%E6%9E%84%E4%BF%A1%E6%81%AF"><span class="toc-number">12.4.4.</span> <span class="toc-text">
          4.获取类结构信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Class%E7%B1%BB"><span class="toc-number">12.4.4.1.</span> <span class="toc-text">
          1.Class类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Field%E7%B1%BB"><span class="toc-number">12.4.4.2.</span> <span class="toc-text">
          2.Field类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Method%E7%B1%BB"><span class="toc-number">12.4.4.3.</span> <span class="toc-text">
          3.Method类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Constructor%E7%B1%BB"><span class="toc-number">12.4.4.4.</span> <span class="toc-text">
          4.Constructor类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%8F%8D%E5%B0%84%E6%93%8D%E4%BD%9C"><span class="toc-number">12.5.</span> <span class="toc-text">
          5.反射操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%8D%E5%B0%84%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">12.5.1.</span> <span class="toc-text">
          1.反射创建对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%8D%E5%B0%84%E6%93%8D%E4%BD%9C%E5%B1%9E%E6%80%A7"><span class="toc-number">12.5.2.</span> <span class="toc-text">
          2.反射操作属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%8D%E5%B0%84%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95"><span class="toc-number">12.5.3.</span> <span class="toc-text">
          3.反射操作方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E7%BB%83%E4%B9%A0"><span class="toc-number">12.6.</span> <span class="toc-text">
          6.练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A01"><span class="toc-number">12.6.1.</span> <span class="toc-text">
          练习1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A02"><span class="toc-number">12.6.2.</span> <span class="toc-text">
          练习2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E4%BB%A3%E7%90%86"><span class="toc-number">12.7.</span> <span class="toc-text">
          7.代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86%E7%A4%BA%E4%BE%8B"><span class="toc-number">12.7.1.</span> <span class="toc-text">
          1.静态代理示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">12.7.2.</span> <span class="toc-text">
          2.动态代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E4%B8%8EAOP"><span class="toc-number">12.7.3.</span> <span class="toc-text">
          3.动态代理与AOP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-%E6%B3%A8%E8%A7%A3"><span class="toc-number">13.</span> <span class="toc-text">
          Java 注解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">14.</span> <span class="toc-text">
          正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">14.1.</span> <span class="toc-text">
          1.快速入门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">14.2.</span> <span class="toc-text">
          2.基本语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%B8%89%E4%B8%AA%E5%B8%B8%E7%94%A8%E7%B1%BB"><span class="toc-number">14.3.</span> <span class="toc-text">
          3.三个常用类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%86%E7%BB%84-%E6%8D%95%E8%8E%B7-%E5%8F%8D%E5%90%91%E5%BC%95%E7%94%A8"><span class="toc-number">14.4.</span> <span class="toc-text">
          4.分组,捕获,反向引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%85%83%E5%AD%97%E7%AC%A6"><span class="toc-number">14.5.</span> <span class="toc-text">
          5.元字符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="toc-number">14.6.</span> <span class="toc-text">
          6.应用实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-8-%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-number">15.</span> <span class="toc-text">
          Java 8 新特性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">15.1.</span> <span class="toc-text">
          1.Lambda表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">15.1.1.</span> <span class="toc-text">
          1.为什么要使用Lambda表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AF%AD%E6%B3%95%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">15.1.2.</span> <span class="toc-text">
          2.语法的使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%87%BD%E6%95%B0%E5%BC%8F-Functional-%E6%8E%A5%E5%8F%A3"><span class="toc-number">15.2.</span> <span class="toc-text">
          2.函数式(Functional)接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="toc-number">15.2.1.</span> <span class="toc-text">
          1.什么是函数式接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="toc-number">15.2.2.</span> <span class="toc-text">
          2.如何理解函数式接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%9B%9B%E5%A4%A7%E6%A0%B8%E5%BF%83%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="toc-number">15.2.3.</span> <span class="toc-text">
          3.四大核心函数式接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8%E4%B8%8E%E6%9E%84%E9%80%A0%E5%99%A8%E5%BC%95%E7%94%A8"><span class="toc-number">15.3.</span> <span class="toc-text">
          3.方法引用与构造器引用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Stream-API"><span class="toc-number">15.4.</span> <span class="toc-text">
          4.Stream API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0-3"><span class="toc-number">15.4.1.</span> <span class="toc-text">
          1.概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D-5"><span class="toc-number">15.4.1.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8"><span class="toc-number">15.4.1.2.</span> <span class="toc-text">
          2.为什么使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%89%E4%B8%AA%E6%AD%A5%E9%AA%A4"><span class="toc-number">15.4.1.3.</span> <span class="toc-text">
          3.三个步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">15.4.2.</span> <span class="toc-text">
          2.实例化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%9B%86%E5%90%88"><span class="toc-number">15.4.2.1.</span> <span class="toc-text">
          1.集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%95%B0%E7%BB%84"><span class="toc-number">15.4.2.2.</span> <span class="toc-text">
          2.数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Stream%E7%9A%84of"><span class="toc-number">15.4.2.3.</span> <span class="toc-text">
          3.Stream的of()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E6%97%A0%E9%99%90%E6%B5%81"><span class="toc-number">15.4.2.4.</span> <span class="toc-text">
          4.创建无限流</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%AD%E9%97%B4%E6%93%8D%E4%BD%9C"><span class="toc-number">15.4.3.</span> <span class="toc-text">
          3.中间操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AD%9B%E9%80%89%E4%B8%8E%E5%88%87%E7%89%87"><span class="toc-number">15.4.3.1.</span> <span class="toc-text">
          1.筛选与切片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%98%A0%E5%B0%84"><span class="toc-number">15.4.3.2.</span> <span class="toc-text">
          2.映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%8E%92%E5%BA%8F"><span class="toc-number">15.4.3.3.</span> <span class="toc-text">
          3.排序</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BB%88%E6%AD%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">15.4.4.</span> <span class="toc-text">
          4.终止操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8C%B9%E9%85%8D%E4%B8%8E%E6%9F%A5%E6%89%BE"><span class="toc-number">15.4.4.1.</span> <span class="toc-text">
          1.匹配与查找</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%BD%92%E7%BA%A6"><span class="toc-number">15.4.4.2.</span> <span class="toc-text">
          2.归约</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%94%B6%E9%9B%86"><span class="toc-number">15.4.4.3.</span> <span class="toc-text">
          3.收集</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Optional%E7%B1%BB"><span class="toc-number">15.5.</span> <span class="toc-text">
          5.Optional类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0-4"><span class="toc-number">15.5.1.</span> <span class="toc-text">
          1.概述</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%9F%BA%E6%9C%AC"><span class="toc-number">16.</span> <span class="toc-text">
          项目开发基本</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-1"><span class="toc-number">16.1.</span> <span class="toc-text">
          1.需求分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%AE%BE%E8%AE%A1%E9%98%B6%E6%AE%B5"><span class="toc-number">16.2.</span> <span class="toc-text">
          2.设计阶段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">16.3.</span> <span class="toc-text">
          3.编码实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%B5%8B%E8%AF%95%E9%98%B6%E6%AE%B5"><span class="toc-number">16.4.</span> <span class="toc-text">
          4.测试阶段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%AE%9E%E6%96%BD%E9%98%B6%E6%AE%B5"><span class="toc-number">16.5.</span> <span class="toc-text">
          5.实施阶段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E7%BB%B4%E6%8A%A4%E9%98%B6%E6%AE%B5"><span class="toc-number">16.6.</span> <span class="toc-text">
          6.维护阶段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-github%E6%90%9C%E7%B4%A2"><span class="toc-number">16.7.</span> <span class="toc-text">
          7.github搜索</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-JUC"><span class="toc-number">17.</span> <span class="toc-text">
          Java JUC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80"><span class="toc-number">17.1.</span> <span class="toc-text">
          1.线程基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-number">17.1.1.</span> <span class="toc-text">
          1.Java多线程相关概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%BF%9B%E7%A8%8B"><span class="toc-number">17.1.1.1.</span> <span class="toc-text">
          1.进程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%BA%BF%E7%A8%8B-1"><span class="toc-number">17.1.1.2.</span> <span class="toc-text">
          2.线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E8%A7%A3%E9%87%8A"><span class="toc-number">17.1.1.3.</span> <span class="toc-text">
          3.进程与线程的一个简单解释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%AE%A1%E7%A8%8B"><span class="toc-number">17.1.1.4.</span> <span class="toc-text">
          4.管程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Java%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81"><span class="toc-number">17.1.1.5.</span> <span class="toc-text">
          5.Java线程状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-wait-x2F-sleep%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">17.1.1.6.</span> <span class="toc-text">
          6.wait&#x2F;sleep的区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">17.1.2.</span> <span class="toc-text">
          2.线程的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%96%B0%E5%BB%BA%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.2.1.</span> <span class="toc-text">
          1.新建线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%BB%88%E6%AD%A2%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.2.2.</span> <span class="toc-text">
          2.终止线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%BA%BF%E7%A8%8B%E4%B8%AD%E6%96%AD"><span class="toc-number">17.1.2.3.</span> <span class="toc-text">
          3.线程中断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%AD%89%E5%BE%85-wait-%E4%B8%8E%E9%80%9A%E7%9F%A5-notify"><span class="toc-number">17.1.2.4.</span> <span class="toc-text">
          4.等待(wait)与通知(notify)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%8C%82%E8%B5%B7%EF%BC%88suspend%EF%BC%89%E5%92%8C%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%EF%BC%88resume%EF%BC%89%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.2.5.</span> <span class="toc-text">
          5.挂起（suspend）和继续执行（resume）线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E7%AD%89%E5%BE%85%E7%BA%BF%E7%A8%8B%E7%BB%93%E6%9D%9F%EF%BC%88join%EF%BC%89%E5%92%8C%E8%B0%A6%E8%AE%A9%EF%BC%88yeild%EF%BC%89"><span class="toc-number">17.1.2.6.</span> <span class="toc-text">
          6.等待线程结束（join）和谦让（yeild）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">17.1.2.7.</span> <span class="toc-text">
          7、总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%BA%BF%E7%A8%8B%E9%87%8D%E8%A6%81"><span class="toc-number">17.1.3.</span> <span class="toc-text">
          3.为什么线程重要?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-start%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.4.</span> <span class="toc-text">
          4.start一个线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%94%A8%E6%88%B7%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.5.</span> <span class="toc-text">
          5.用户线程与守护线程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.5.1.</span> <span class="toc-text">
          1.守护线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%94%A8%E6%88%B7%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.1.5.2.</span> <span class="toc-text">
          2.用户线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%87%8D%E7%82%B9"><span class="toc-number">17.1.5.3.</span> <span class="toc-text">
          3.重点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%8E%B7%E5%BE%97%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">17.1.6.</span> <span class="toc-text">
          6.获得多线程的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Callable%E6%8E%A5%E5%8F%A3"><span class="toc-number">17.1.7.</span> <span class="toc-text">
          7.Callable接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%8Erunnable%E5%AF%B9%E6%AF%94"><span class="toc-number">17.1.7.1.</span> <span class="toc-text">
          1.与runnable对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8-1"><span class="toc-number">17.1.7.2.</span> <span class="toc-text">
          2.使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-number">17.2.</span> <span class="toc-text">
          2.线程池</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-number">17.2.1.</span> <span class="toc-text">
          1.什么是线程池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-number">17.2.2.</span> <span class="toc-text">
          2.为什么用线程池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">17.2.3.</span> <span class="toc-text">
          3.线程池的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Executors-newFixedThreadPool-int"><span class="toc-number">17.2.3.1.</span> <span class="toc-text">
          1.Executors.newFixedThreadPool(int)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Executors-newSingleThreadExecutor"><span class="toc-number">17.2.3.2.</span> <span class="toc-text">
          2.Executors.newSingleThreadExecutor()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Executors-newCachedThreadPool"><span class="toc-number">17.2.3.3.</span> <span class="toc-text">
          3.Executors.newCachedThreadPool()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-ThreadPoolExecutor%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">17.2.4.</span> <span class="toc-text">
          4.ThreadPoolExecutor底层原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5-%E5%A6%82%E4%BD%95%E5%90%88%E7%90%86%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">17.2.5.</span> <span class="toc-text">
          5.拒绝策略,如何合理设置参数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5"><span class="toc-number">17.2.5.1.</span> <span class="toc-text">
          1.线程池的拒绝策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-JDK%E5%86%85%E7%BD%AE%E7%9A%84%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5"><span class="toc-number">17.2.5.2.</span> <span class="toc-text">
          2.JDK内置的拒绝策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%94%9F%E4%BA%A7%E4%B8%AD%E5%90%88%E7%90%86%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">17.2.5.3.</span> <span class="toc-text">
          3.生产中合理设置参数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-CPU%E5%AF%86%E9%9B%86%E5%9E%8B"><span class="toc-number">17.2.5.3.1.</span> <span class="toc-text">
          1.CPU密集型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-IO%E5%AF%86%E9%9B%86%E5%9E%8B"><span class="toc-number">17.2.5.3.2.</span> <span class="toc-text">
          2.IO密集型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%9C%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E5%8D%95%E4%B8%80%E7%9A%84-x2F-%E5%9B%BA%E5%AE%9A%E6%95%B0%E7%9A%84-x2F-%E5%8F%AF%E5%8F%98%E7%9A%84%E4%B8%89%E7%A7%8D%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E6%96%B9%E6%B3%95%E5%93%AA%E4%B8%AA%E7%94%A8%E7%9A%84%E5%A4%9A%EF%BC%9F-%E5%9D%91"><span class="toc-number">17.2.6.</span> <span class="toc-text">
          6.在工作中单一的&#x2F;固定数的&#x2F;可变的三种创建线程池的方法哪个用的多？(坑)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E7%A8%8B"><span class="toc-number">17.2.7.</span> <span class="toc-text">
          7.自定义线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E4%B8%AD%E7%9A%842%E4%B8%AA%E5%85%B3%E9%97%AD%E6%96%B9%E6%B3%95"><span class="toc-number">17.2.8.</span> <span class="toc-text">
          8.线程池中的2个关闭方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-BlockingQueue%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97"><span class="toc-number">17.2.9.</span> <span class="toc-text">
          9.BlockingQueue阻塞队列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97"><span class="toc-number">17.2.9.1.</span> <span class="toc-text">
          1.栈与队列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97"><span class="toc-number">17.2.9.2.</span> <span class="toc-text">
          2.阻塞队列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%A7%8D%E7%B1%BB%E5%88%86%E6%9E%90"><span class="toc-number">17.2.9.3.</span> <span class="toc-text">
          3.种类分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-BlockQueue%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95"><span class="toc-number">17.2.9.4.</span> <span class="toc-text">
          4.BlockQueue核心方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E6%89%A9%E5%B1%95%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="toc-number">17.2.10.</span> <span class="toc-text">
          10.扩展线程池</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-CompletableFuture"><span class="toc-number">17.3.</span> <span class="toc-text">
          3.CompletableFuture</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Future%E5%92%8CCallable%E6%8E%A5%E5%8F%A3"><span class="toc-number">17.3.1.</span> <span class="toc-text">
          1.Future和Callable接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-FutureTask%E5%BC%80%E5%A7%8B"><span class="toc-number">17.3.2.</span> <span class="toc-text">
          2.FutureTask开始</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%B9Future%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="toc-number">17.3.3.</span> <span class="toc-text">
          3.对Future的改进</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B1%BB-CompletableFuture"><span class="toc-number">17.3.3.1.</span> <span class="toc-text">
          1.类 CompletableFuture</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%8E%A5%E5%8F%A3CompletionStage"><span class="toc-number">17.3.3.2.</span> <span class="toc-text">
          2.接口CompletionStage</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%A0%B8%E5%BF%83%E7%9A%84%E5%9B%9B%E4%B8%AA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.4.</span> <span class="toc-text">
          4.核心的四个静态方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-runAsync-%E6%97%A0%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">17.3.4.1.</span> <span class="toc-text">
          1.runAsync 无返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-supplyAsync-%E6%9C%89-%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">17.3.4.2.</span> <span class="toc-text">
          2.supplyAsync 有 返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Code-%E6%97%A0-%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">17.3.4.3.</span> <span class="toc-text">
          3.Code 无 返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Code-%E6%9C%89-%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">17.3.4.4.</span> <span class="toc-text">
          4.Code 有 返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Code-%E5%87%8F%E5%B0%91%E9%98%BB%E5%A1%9E%E5%92%8C%E8%BD%AE%E8%AF%A2"><span class="toc-number">17.3.4.5.</span> <span class="toc-text">
          5.Code 减少阻塞和轮询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-CompletableFuture%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">17.3.4.6.</span> <span class="toc-text">
          6.CompletableFuture的优点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Join%E5%92%8C%E9%93%BE%E5%BC%8F%E8%AF%AD%E6%B3%95"><span class="toc-number">17.3.5.</span> <span class="toc-text">
          5.Join和链式语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%A1%88%E4%BE%8B%E7%B2%BE%E8%AE%B2-%E4%BB%8E%E7%94%B5%E5%95%86%E7%BD%91%E7%AB%99%E7%9A%84%E6%AF%94%E4%BB%B7%E9%9C%80%E6%B1%82%E8%AF%B4%E5%BC%80%E5%8E%BB"><span class="toc-number">17.3.6.</span> <span class="toc-text">
          6.案例精讲-从电商网站的比价需求说开去</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-CompletableFuture%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.7.</span> <span class="toc-text">
          7.CompletableFuture常用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%8E%B7%E5%8F%96%E7%BB%93%E6%9E%9C%E5%92%8C%E8%A7%A6%E5%8F%91%E8%AE%A1%E7%AE%97"><span class="toc-number">17.3.7.1.</span> <span class="toc-text">
          1.获取结果和触发计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%B9%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86"><span class="toc-number">17.3.7.2.</span> <span class="toc-text">
          2.对计算结果进行处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AF%B9%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E6%B6%88%E8%B4%B9"><span class="toc-number">17.3.7.3.</span> <span class="toc-text">
          3.对计算结果进行消费</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%AF%B9%E8%AE%A1%E7%AE%97%E9%80%9F%E5%BA%A6%E8%BF%9B%E8%A1%8C%E9%80%89%E7%94%A8"><span class="toc-number">17.3.7.4.</span> <span class="toc-text">
          4.对计算速度进行选用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%AF%B9%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%90%88%E5%B9%B6"><span class="toc-number">17.3.7.5.</span> <span class="toc-text">
          5.对计算结果进行合并</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-Async%E8%AF%B4%E6%98%8E"><span class="toc-number">17.3.7.6.</span> <span class="toc-text">
          6.Async说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%BC%82%E6%AD%A5%E7%BC%96%E6%8E%92-%E9%87%8D"><span class="toc-number">17.3.7.7.</span> <span class="toc-text">
          7.异步编排(重)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%BC%82%E6%AD%A5%E5%AF%B9%E8%B1%A1"><span class="toc-number">17.3.7.7.1.</span> <span class="toc-text">
          1.创建异步对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%AE%A1%E7%AE%97%E5%AE%8C%E6%88%90%E6%97%B6%E5%9B%9E%E8%B0%83%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.7.7.2.</span> <span class="toc-text">
          2.计算完成时回调方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-handle%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.7.7.3.</span> <span class="toc-text">
          3.handle方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E7%BA%BF%E7%A8%8B%E4%B8%B2%E8%A1%8C%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.7.7.4.</span> <span class="toc-text">
          4.线程串行化方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-%E4%B8%A4%E4%BB%BB%E5%8A%A1%E7%BB%84%E5%90%88-%E9%83%BD%E8%A6%81%E5%AE%8C%E6%88%90"><span class="toc-number">17.3.7.7.5.</span> <span class="toc-text">
          5.两任务组合-都要完成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-%E4%B8%A4%E4%BB%BB%E5%8A%A1%E7%BB%84%E5%90%88-%E4%B8%80%E4%B8%AA%E5%AE%8C%E6%88%90"><span class="toc-number">17.3.7.7.6.</span> <span class="toc-text">
          6.两任务组合-一个完成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-%E5%A4%9A%E4%BB%BB%E5%8A%A1%E7%BB%84%E5%90%88"><span class="toc-number">17.3.7.7.7.</span> <span class="toc-text">
          7.多任务组合</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%88%86%E6%94%AF%E5%90%88%E5%B9%B6%E6%A1%86%E6%9E%B6"><span class="toc-number">17.3.8.</span> <span class="toc-text">
          8.分支合并框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%9B%B8%E5%85%B3%E7%B1%BB"><span class="toc-number">17.3.8.1.</span> <span class="toc-text">
          1.相关类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-ForkJoinPool"><span class="toc-number">17.3.8.1.1.</span> <span class="toc-text">
          1.ForkJoinPool</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-ForkJoinTask"><span class="toc-number">17.3.8.1.2.</span> <span class="toc-text">
          2.ForkJoinTask</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-RecursiveTask"><span class="toc-number">17.3.8.1.3.</span> <span class="toc-text">
          3.RecursiveTask</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%A4%BA%E4%BE%8B-1"><span class="toc-number">17.3.8.2.</span> <span class="toc-text">
          2.示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Java-%E2%80%9C%E9%94%81%E2%80%9D%E4%BA%8B"><span class="toc-number">17.4.</span> <span class="toc-text">
          4.Java “锁”事</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Lock"><span class="toc-number">17.4.1.</span> <span class="toc-text">
          1.Lock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Synchronized%E4%B8%8ELock%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">17.4.2.</span> <span class="toc-text">
          2.Synchronized与Lock的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-synchronized"><span class="toc-number">17.4.3.</span> <span class="toc-text">
          3.synchronized</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-synchronized%E4%BD%9C%E7%94%A8%E4%BA%8E%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1"><span class="toc-number">17.4.3.1.</span> <span class="toc-text">
          1.synchronized作用于实例对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-synchronized%E4%BD%9C%E7%94%A8%E4%BA%8E%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">17.4.3.2.</span> <span class="toc-text">
          2.synchronized作用于静态方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-synchronized%E5%90%8C%E6%AD%A5%E4%BB%A3%E7%A0%81%E5%9D%97"><span class="toc-number">17.4.3.3.</span> <span class="toc-text">
          3.synchronized同步代码块</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-ReentrantLock"><span class="toc-number">17.4.4.</span> <span class="toc-text">
          4.ReentrantLock</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-synchronized%E7%9A%84%E5%B1%80%E9%99%90%E6%80%A7"><span class="toc-number">17.4.4.1.</span> <span class="toc-text">
          1.synchronized的局限性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ReentrantLock%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">17.4.4.2.</span> <span class="toc-text">
          2.ReentrantLock基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-ReentrantLock%E8%8E%B7%E5%8F%96%E9%94%81%E7%9A%84%E8%BF%87%E7%A8%8B%E6%98%AF%E5%8F%AF%E4%B8%AD%E6%96%AD%E7%9A%84"><span class="toc-number">17.4.4.3.</span> <span class="toc-text">
          3.ReentrantLock获取锁的过程是可中断的</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-ReentrantLock%E9%94%81%E7%94%B3%E8%AF%B7%E7%AD%89%E5%BE%85%E9%99%90%E6%97%B6"><span class="toc-number">17.4.4.4.</span> <span class="toc-text">
          4.ReentrantLock锁申请等待限时</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-ReentrantLock%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">17.4.4.5.</span> <span class="toc-text">
          5.ReentrantLock其他常用的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%80%BB%E7%BB%93"><span class="toc-number">17.4.4.6.</span> <span class="toc-text">
          6.总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%82%B2%E8%A7%82%E9%94%81"><span class="toc-number">17.4.5.</span> <span class="toc-text">
          5.悲观锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">17.4.6.</span> <span class="toc-text">
          6.乐观锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%85%AB%E9%94%81%E6%A1%88%E4%BE%8B"><span class="toc-number">17.4.7.</span> <span class="toc-text">
          7.八锁案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%85%AC%E5%B9%B3%E9%94%81%E5%92%8C%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81"><span class="toc-number">17.4.8.</span> <span class="toc-text">
          8.公平锁和非公平锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81"><span class="toc-number">17.4.9.</span> <span class="toc-text">
          9.可重入锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E6%AD%BB%E9%94%81"><span class="toc-number">17.4.10.</span> <span class="toc-text">
          10.死锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-number">17.5.</span> <span class="toc-text">
          5.线程间通信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-LockSupport%E4%B8%8E%E7%BA%BF%E7%A8%8B%E4%B8%AD%E6%96%AD"><span class="toc-number">17.6.</span> <span class="toc-text">
          6.LockSupport与线程中断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%9B%86%E5%90%88%E4%B8%8D%E5%AE%89%E5%85%A8"><span class="toc-number">17.7.</span> <span class="toc-text">
          7.集合不安全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-JUC%E5%BC%BA%E5%A4%A7%E7%9A%84%E8%BE%85%E5%8A%A9%E7%B1%BB"><span class="toc-number">17.8.</span> <span class="toc-text">
          8.JUC强大的辅助类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B9%8BJMM"><span class="toc-number">17.9.</span> <span class="toc-text">
          9.Java内存模型之JMM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-Volatile%E4%B8%8EJava%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B"><span class="toc-number">17.10.</span> <span class="toc-text">
          10.Volatile与Java内存模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-CAS"><span class="toc-number">17.11.</span> <span class="toc-text">
          11.CAS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E7%B1%BB%E4%B9%8B18%E7%BD%97%E6%B1%89%E5%A2%9E%E5%BC%BA"><span class="toc-number">17.12.</span> <span class="toc-text">
          12.原子操作类之18罗汉增强</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-ThreadLocal-InheritableThreadLocal"><span class="toc-number">17.13.</span> <span class="toc-text">
          13.ThreadLocal,InheritableThreadLocal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Java%E5%AF%B9%E8%B1%A1%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E5%92%8C%E5%AF%B9%E8%B1%A1%E5%A4%B4"><span class="toc-number">17.14.</span> <span class="toc-text">
          14.Java对象内存布局和对象头</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Synchronized%E4%B8%8E%E9%94%81%E5%8D%87%E7%BA%A7"><span class="toc-number">17.15.</span> <span class="toc-text">
          15.Synchronized与锁升级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-AbstractQueuedSynchronizer%E4%B9%8BAQS"><span class="toc-number">17.16.</span> <span class="toc-text">
          16.AbstractQueuedSynchronizer之AQS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-ReentrantLock%E3%80%81ReentrantReadWriteLock%E3%80%81StampedLock"><span class="toc-number">17.17.</span> <span class="toc-text">
          17.ReentrantLock、ReentrantReadWriteLock、StampedLock</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-JUC-%E6%97%A7"><span class="toc-number">18.</span> <span class="toc-text">
          Java JUC(旧)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-number">18.1.</span> <span class="toc-text">
          1.创建多线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BB%A7%E6%89%BFThread%E7%B1%BB"><span class="toc-number">18.1.1.</span> <span class="toc-text">
          1.继承Thread类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%9E%E7%8E%B0Runnable%E6%8E%A5%E5%8F%A3"><span class="toc-number">18.1.2.</span> <span class="toc-text">
          2.实现Runnable接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%9E%E7%8E%B0callable%E6%8E%A5%E5%8F%A3"><span class="toc-number">18.1.3.</span> <span class="toc-text">
          3.实现callable接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%BA%BF%E7%A8%8B%E6%B1%A0-%E5%88%9B%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">18.1.4.</span> <span class="toc-text">
          4.线程池(创建多线程的一种方式)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%A8%8B%E5%BA%8F-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B"><span class="toc-number">18.2.</span> <span class="toc-text">
          2.程序,进程与线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Java%E6%97%A0%E6%B3%95%E5%BC%80%E5%90%AF%E7%BA%BF%E7%A8%8B"><span class="toc-number">18.2.1.</span> <span class="toc-text">
          1.Java无法开启线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C"><span class="toc-number">18.2.2.</span> <span class="toc-text">
          2.并发与并行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E2%BD%A4%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-number">18.2.3.</span> <span class="toc-text">
          3.为什么要使⽤多线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BD%BF%E2%BD%A4%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%8F%AF%E8%83%BD%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">18.2.4.</span> <span class="toc-text">
          4.使⽤多线程可能带来的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%BA%BF%E7%A8%8B%E7%9A%84%E2%BD%A3%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E7%8A%B6%E6%80%81"><span class="toc-number">18.2.5.</span> <span class="toc-text">
          5.线程的⽣命周期和状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Wait%E4%B8%8ESleep%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E5%85%B1%E5%90%8C%E7%82%B9"><span class="toc-number">18.2.6.</span> <span class="toc-text">
          6.Wait与Sleep的区别和共同点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%94%81"><span class="toc-number">18.3.</span> <span class="toc-text">
          3.锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-synchronized%E9%94%81"><span class="toc-number">18.3.1.</span> <span class="toc-text">
          1.synchronized锁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BB%8B%E7%BB%8D-6"><span class="toc-number">18.3.1.1.</span> <span class="toc-text">
          1.介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%94%AE%E7%A5%A8%E4%BE%8B%E5%AD%90"><span class="toc-number">18.3.1.2.</span> <span class="toc-text">
          2.售票例子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%89%E7%A7%8D%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">18.3.1.3.</span> <span class="toc-text">
          3.三种使用方式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-lock"><span class="toc-number">18.3.2.</span> <span class="toc-text">
          2.lock</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ReentrantLock"><span class="toc-number">18.3.2.1.</span> <span class="toc-text">
          1.ReentrantLock</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ReadLock"><span class="toc-number">18.3.2.2.</span> <span class="toc-text">
          2.ReadLock</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-WriteLock"><span class="toc-number">18.3.2.3.</span> <span class="toc-text">
          3.WriteLock</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Synchronized%E4%B8%8ELock%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">18.3.2.4.</span> <span class="toc-text">
          4.Synchronized与Lock的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Condition"><span class="toc-number">18.3.2.5.</span> <span class="toc-text">
          5.Condition</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA"><span class="toc-number">18.3.2.5.1.</span> <span class="toc-text">
          1.创建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8"><span class="toc-number">18.3.2.5.2.</span> <span class="toc-text">
          2.方法使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E7%B2%BE%E5%87%86%E9%80%9A%E7%9F%A5-%E4%B8%AA%E4%BA%BA%E8%A7%89%E5%BE%97%E6%B2%A1%E5%95%A5%E7%94%A8"><span class="toc-number">18.3.2.5.3.</span> <span class="toc-text">
          3.精准通知(个人觉得没啥用)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98"><span class="toc-number">18.3.3.</span> <span class="toc-text">
          3.生产者消费者问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Synchronized-wait-notify"><span class="toc-number">18.3.3.1.</span> <span class="toc-text">
          1,Synchronized wait notify</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%99%9A%E5%81%87%E5%94%A4%E9%86%92"><span class="toc-number">18.3.3.1.1.</span> <span class="toc-text">
          虚假唤醒</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-JUC-Lock"><span class="toc-number">18.3.3.2.</span> <span class="toc-text">
          2.JUC Lock</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%85%AB%E9%94%81%E7%8E%B0%E8%B1%A1-%E7%90%86%E8%A7%A3%E9%94%81%E7%9A%84%E5%AF%B9%E8%B1%A1-%E5%8D%B3%E4%BD%BF%E7%94%A8%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-number">18.3.4.</span> <span class="toc-text">
          4.八锁现象(理解锁的对象,即使用的方式)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%9B%86%E5%90%88%E7%B1%BB%E4%B8%8EMap%E4%B8%8D%E5%AE%89%E5%85%A8"><span class="toc-number">18.4.</span> <span class="toc-text">
          4.集合类与Map不安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-List"><span class="toc-number">18.4.1.</span> <span class="toc-text">
          1.List</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%9E%E7%8E%B0"><span class="toc-number">18.4.1.1.</span> <span class="toc-text">
          1.实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BC%9A%E6%8A%A5%E5%87%BA%E5%BC%82%E5%B8%B8"><span class="toc-number">18.4.1.2.</span> <span class="toc-text">
          2.会报出异常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%A7%A3%E5%86%B3"><span class="toc-number">18.4.1.3.</span> <span class="toc-text">
          3.解决</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Set"><span class="toc-number">18.4.2.</span> <span class="toc-text">
          2.Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Map"><span class="toc-number">18.4.3.</span> <span class="toc-text">
          3.Map</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Callable"><span class="toc-number">18.5.</span> <span class="toc-text">
          5.Callable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%89%B9%E7%82%B9-2"><span class="toc-number">18.5.1.</span> <span class="toc-text">
          1.特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8-2"><span class="toc-number">18.5.2.</span> <span class="toc-text">
          2.使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%B8%B8%E7%94%A8%E8%BE%85%E5%8A%A9%E7%B1%BB"><span class="toc-number">18.6.</span> <span class="toc-text">
          6.常用辅助类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1CountDownLatch"><span class="toc-number">18.6.1.</span> <span class="toc-text">
          6.1CountDownLatch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2CyclicBarrier"><span class="toc-number">18.6.2.</span> <span class="toc-text">
          6.2CyclicBarrier</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3Semaphore"><span class="toc-number">18.6.3.</span> <span class="toc-text">
          6.3Semaphore</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%AF%BB%E5%86%99%E9%94%81"><span class="toc-number">18.7.</span> <span class="toc-text">
          7.读写锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ReadWriteLock"><span class="toc-number">18.7.1.</span> <span class="toc-text">
          ReadWriteLock</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C"><span class="toc-number">18.8.</span> <span class="toc-text">
          并行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">18.9.</span> <span class="toc-text">
          静态代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8"><span class="toc-number">18.10.</span> <span class="toc-text">
          安全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">18.11.</span> <span class="toc-text">
          Lambda表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2"><span class="toc-number">18.12.</span> <span class="toc-text">
          面</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">2</div><div class="sidebar-ov-state-item__name">归档</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>John Doe</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 强力驱动</span><span> v6.2.0</span><span class="footer__devider">|</span><span>主题 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.7.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.7.0"></script><script src="/js/stun-boot.js?v=2.7.0"></script><script src="/js/scroll.js?v=2.7.0"></script><script src="/js/header.js?v=2.7.0"></script><script src="/js/sidebar.js?v=2.7.0"></script></body></html>